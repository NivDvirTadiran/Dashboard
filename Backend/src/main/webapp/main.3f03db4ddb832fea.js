"use strict";(self.webpackChunkaccdashboard=self.webpackChunkaccdashboard||[]).push([[179],{2411:(mn,Ke,Z)=>{var E=Z(6593),ie=Z(9212),ze=Z(4581);let Pe=(()=>{class c{title="Angular 17 Multiple Files Upload example";static \u0275fac=function(r){return new(r||c)};static \u0275cmp=ie.Xpm({type:c,selectors:[["app-root"]],decls:1,vars:0,consts:[["id","app"]],template:function(r,o){1&r&&ie._UZ(0,"router-outlet",0)},dependencies:[ze.lC]})}return c})();var be=Z(9862),xe=Z(6814),it=Z(6223);let ht=(()=>{class c{http;baseUrl="http://localhost:8080";constructor(t){this.http=t}upload(t){const r=new FormData;r.append("file",t);const o=new be.aW("POST",`${this.baseUrl}/upload`,r,{responseType:"json"});return this.http.request(o)}getFiles(){return this.http.get(`${this.baseUrl}/files`)}static \u0275fac=function(r){return new(r||c)(ie.LFG(be.eN))};static \u0275prov=ie.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var pt=Z(5861);const _n=1,mi=2,ui=3,Ss=0,nn=1,ii=2,Gn=0,Ul=1,Qs=2,It=3,Kr=4,gr=5,bi=6,Li=7,ta="attached",Yi=301,sn=302,ns=306,ws=1e3,vr=1001,_i=1003,Oe=1005,oe=1006,Lt=1008,Bn=1009,Mi=1010,yr=1011,_r=1012,Ti=1013,Jt=1014,Fr=1015,to=1016,ds=1017,Oo=1018,gi=1020,wa=35902,Xs=1021,Ls=1022,br=1023,na=1024,Ca=1025,ve=1026,ue=1027,he=1028,Le=1029,at=1030,We=1031,Vn=1033,Bt=33776,Ui=33777,wi=33778,Fn=33779,qi=35840,Ur=35841,an=35842,Jn=35843,ti=36196,er=37492,Cs=37496,ur=37808,Ys=37809,Fa=37810,Vs=37811,Lo=37812,ia=37813,kl=37814,Fo=37815,Jr=37816,ra=37817,Ua=37818,ka=37819,Ba=37820,vo=37821,yo=36492,Va=36494,hs=36495,Ha=36283,dr=36284,sa=36285,Hn=36286,ko=2300,Hs=2301,Mr="srgb",Ai="srgb-linear",za="linear",ki="srgb",_o=7680,Cn="300 es",rr=2e3;class rs{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const o=this._listeners[e];if(void 0!==o){const l=o.indexOf(t);-1!==l&&o.splice(l,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const r=this._listeners[e.type];if(void 0!==r){e.target=this;const o=r.slice(0);for(let l=0,u=o.length;l<u;l++)o[l].call(this,e);e.target=null}}}const Pr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const tr=Math.PI/180,xo=180/Math.PI;function ss(){const c=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Pr[255&c]+Pr[c>>8&255]+Pr[c>>16&255]+Pr[c>>24&255]+"-"+Pr[255&e]+Pr[e>>8&255]+"-"+Pr[e>>16&15|64]+Pr[e>>24&255]+"-"+Pr[63&t|128]+Pr[t>>8&255]+"-"+Pr[t>>16&255]+Pr[t>>24&255]+Pr[255&r]+Pr[r>>8&255]+Pr[r>>16&255]+Pr[r>>24&255]).toLowerCase()}function Gi(c,e,t){return Math.max(e,Math.min(t,c))}function $a(c,e){return(c%e+e)%e}function ca(c,e,t){return(1-t)*c+t*e}function hr(c,e){switch(e.constructor){case Float32Array:return c;case Uint32Array:return c/4294967295;case Uint16Array:return c/65535;case Uint8Array:return c/255;case Int32Array:return Math.max(c/2147483647,-1);case Int16Array:return Math.max(c/32767,-1);case Int8Array:return Math.max(c/127,-1);default:throw new Error("Invalid component type.")}}function qn(c,e){switch(e.constructor){case Float32Array:return c;case Uint32Array:return Math.round(4294967295*c);case Uint16Array:return Math.round(65535*c);case Uint8Array:return Math.round(255*c);case Int32Array:return Math.round(2147483647*c);case Int16Array:return Math.round(32767*c);case Int8Array:return Math.round(127*c);default:throw new Error("Invalid component type.")}}const Ou_DEG2RAD=tr,Ou_radToDeg=function Qr(c){return c*xo};class Je{constructor(e=0,t=0){Je.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,o=e.elements;return this.x=o[0]*t+o[3]*r+o[6],this.y=o[1]*t+o[4]*r+o[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Gi(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),o=Math.sin(t),l=this.x-e.x,u=this.y-e.y;return this.x=l*r-u*o+e.x,this.y=l*o+u*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class zn{constructor(e,t,r,o,l,u,h,p,m){zn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,r,o,l,u,h,p,m)}set(e,t,r,o,l,u,h,p,m){const v=this.elements;return v[0]=e,v[1]=o,v[2]=h,v[3]=t,v[4]=l,v[5]=p,v[6]=r,v[7]=u,v[8]=m,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,o=t.elements,l=this.elements,u=r[0],h=r[3],p=r[6],m=r[1],v=r[4],y=r[7],M=r[2],S=r[5],A=r[8],N=o[0],R=o[3],T=o[6],B=o[1],V=o[4],F=o[7],ne=o[2],Q=o[5],te=o[8];return l[0]=u*N+h*B+p*ne,l[3]=u*R+h*V+p*Q,l[6]=u*T+h*F+p*te,l[1]=m*N+v*B+y*ne,l[4]=m*R+v*V+y*Q,l[7]=m*T+v*F+y*te,l[2]=M*N+S*B+A*ne,l[5]=M*R+S*V+A*Q,l[8]=M*T+S*F+A*te,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],o=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],v=e[8];return t*u*v-t*h*m-r*l*v+r*h*p+o*l*m-o*u*p}invert(){const e=this.elements,t=e[0],r=e[1],o=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],v=e[8],y=v*u-h*m,M=h*p-v*l,S=m*l-u*p,A=t*y+r*M+o*S;if(0===A)return this.set(0,0,0,0,0,0,0,0,0);const N=1/A;return e[0]=y*N,e[1]=(o*m-v*r)*N,e[2]=(h*r-o*u)*N,e[3]=M*N,e[4]=(v*t-o*p)*N,e[5]=(o*l-h*t)*N,e[6]=S*N,e[7]=(r*p-m*t)*N,e[8]=(u*t-r*l)*N,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,o,l,u,h){const p=Math.cos(l),m=Math.sin(l);return this.set(r*p,r*m,-r*(p*u+m*h)+u+e,-o*m,o*p,-o*(-m*u+p*h)+h+t,0,0,1),this}scale(e,t){return this.premultiply(Wl.makeScale(e,t)),this}rotate(e){return this.premultiply(Wl.makeRotation(-e)),this}translate(e,t){return this.premultiply(Wl.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let o=0;o<9;o++)if(t[o]!==r[o])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const Wl=new zn;function Rd(c){for(let e=c.length-1;e>=0;--e)if(c[e]>=65535)return!0;return!1}function Ic(c){return document.createElementNS("http://www.w3.org/1999/xhtml",c)}function kp(){const c=Ic("canvas");return c.style.display="block",c}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const Wh={};function Rc(c){c in Wh||(Wh[c]=!0,console.warn(c))}const fi={enabled:!0,workingColorSpace:Ai,spaces:{},convert:function(c,e,t){return!1===this.enabled||e===t||!e||!t||(this.spaces[e].transfer===ki&&(c.r=Aa(c.r),c.g=Aa(c.g),c.b=Aa(c.b)),this.spaces[e].primaries!==this.spaces[t].primaries&&(c.applyMatrix3(this.spaces[e].toXYZ),c.applyMatrix3(this.spaces[t].fromXYZ)),this.spaces[t].transfer===ki&&(c.r=C(c.r),c.g=C(c.g),c.b=C(c.b))),c},fromWorkingColorSpace:function(c,e){return this.convert(c,this.workingColorSpace,e)},toWorkingColorSpace:function(c,e){return this.convert(c,e,this.workingColorSpace)},getPrimaries:function(c){return this.spaces[c].primaries},getTransfer:function(c){return""===c?za:this.spaces[c].transfer},getLuminanceCoefficients:function(c,e=this.workingColorSpace){return c.fromArray(this.spaces[e].luminanceCoefficients)},define:function(c){Object.assign(this.spaces,c)},_getMatrix:function(c,e,t){return c.copy(this.spaces[e].toXYZ).multiply(this.spaces[t].fromXYZ)},_getDrawingBufferColorSpace:function(c){return this.spaces[c].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(c=this.workingColorSpace){return this.spaces[c].workingColorSpaceConfig.unpackColorSpace}};function Aa(c){return c<.04045?.0773993808*c:Math.pow(.9478672986*c+.0521327014,2.4)}function C(c){return c<.0031308?12.92*c:1.055*Math.pow(c,.41666)-.055}const W=[.64,.33,.3,.6,.15,.06],O=[.2126,.7152,.0722],z=[.3127,.329],le=(new zn).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Te=(new zn).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);let Ze;fi.define({[Ai]:{primaries:W,whitePoint:z,transfer:za,toXYZ:le,fromXYZ:Te,luminanceCoefficients:O,workingColorSpaceConfig:{unpackColorSpace:Mr},outputColorSpaceConfig:{drawingBufferColorSpace:Mr}},[Mr]:{primaries:W,whitePoint:z,transfer:ki,toXYZ:le,fromXYZ:Te,luminanceCoefficients:O,outputColorSpaceConfig:{drawingBufferColorSpace:Mr}}});class qt{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Ze&&(Ze=Ic("canvas")),Ze.width=e.width,Ze.height=e.height;const r=Ze.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Ze}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Ic("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const o=r.getImageData(0,0,e.width,e.height),l=o.data;for(let u=0;u<l.length;u++)l[u]=255*Aa(l[u]/255);return r.putImageData(o,0,0),t}if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t[r]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Aa(t[r]/255)):Aa(t[r]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let xi=0;class vi{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:xi++}),this.uuid=ss(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const r={uuid:this.uuid,url:""},o=this.data;if(null!==o){let l;if(Array.isArray(o)){l=[];for(let u=0,h=o.length;u<h;u++)l.push(Di(o[u].isDataTexture?o[u].image:o[u]))}else l=Di(o);r.url=l}return t||(e.images[this.uuid]=r),r}}function Di(c){return typeof HTMLImageElement<"u"&&c instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&c instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&c instanceof ImageBitmap?qt.getDataURL(c):c.data?{data:Array.from(c.data),width:c.width,height:c.height,type:c.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let di=0,Ii=(()=>{class c extends rs{constructor(t=c.DEFAULT_IMAGE,r=c.DEFAULT_MAPPING,o=vr,l=vr,u=oe,h=Lt,p=br,m=Bn,v=c.DEFAULT_ANISOTROPY,y=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:di++}),this.uuid=ss(),this.name="",this.source=new vi(t),this.mipmaps=[],this.mapping=r,this.channel=0,this.wrapS=o,this.wrapT=l,this.magFilter=u,this.minFilter=h,this.anisotropy=v,this.format=p,this.internalFormat=null,this.type=m,this.offset=new Je(0,0),this.repeat=new Je(1,1),this.center=new Je(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new zn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=y,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const r=void 0===t||"string"==typeof t;if(!r&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const o={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(o.userData=this.userData),r||(t.textures[this.uuid]=o),o}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case ws:t.x=t.x-Math.floor(t.x);break;case vr:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case ws:t.y=t.y-Math.floor(t.y);break;case vr:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){!0===t&&this.pmremVersion++}}return c.DEFAULT_IMAGE=null,c.DEFAULT_MAPPING=300,c.DEFAULT_ANISOTROPY=1,c})();class dn{constructor(e=0,t=0,r=0,o=1){dn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=o}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,o){return this.x=e,this.y=t,this.z=r,this.w=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,o=this.z,l=this.w,u=e.elements;return this.x=u[0]*t+u[4]*r+u[8]*o+u[12]*l,this.y=u[1]*t+u[5]*r+u[9]*o+u[13]*l,this.z=u[2]*t+u[6]*r+u[10]*o+u[14]*l,this.w=u[3]*t+u[7]*r+u[11]*o+u[15]*l,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,o,l;const p=e.elements,m=p[0],v=p[4],y=p[8],M=p[1],S=p[5],A=p[9],N=p[2],R=p[6],T=p[10];if(Math.abs(v-M)<.01&&Math.abs(y-N)<.01&&Math.abs(A-R)<.01){if(Math.abs(v+M)<.1&&Math.abs(y+N)<.1&&Math.abs(A+R)<.1&&Math.abs(m+S+T-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const V=(m+1)/2,F=(S+1)/2,ne=(T+1)/2,Q=(v+M)/4,te=(y+N)/4,se=(A+R)/4;return V>F&&V>ne?V<.01?(r=0,o=.707106781,l=.707106781):(r=Math.sqrt(V),o=Q/r,l=te/r):F>ne?F<.01?(r=.707106781,o=0,l=.707106781):(o=Math.sqrt(F),r=Q/o,l=se/o):ne<.01?(r=.707106781,o=.707106781,l=0):(l=Math.sqrt(ne),r=te/l,o=se/l),this.set(r,o,l,t),this}let B=Math.sqrt((R-A)*(R-A)+(y-N)*(y-N)+(M-v)*(M-v));return Math.abs(B)<.001&&(B=1),this.x=(R-A)/B,this.y=(y-N)/B,this.z=(M-v)/B,this.w=Math.acos((m+S+T-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Nr extends rs{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new dn(0,0,e,t),this.scissorTest=!1,this.viewport=new dn(0,0,e,t);const o={width:e,height:t,depth:1};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:oe,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},r);const l=new Ii(o,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);l.flipY=!1,l.generateMipmaps=r.generateMipmaps,l.internalFormat=r.internalFormat,this.textures=[];const u=r.count;for(let h=0;h<u;h++)this.textures[h]=l.clone(),this.textures[h].isRenderTargetTexture=!0;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let o=0,l=this.textures.length;o<l;o++)this.textures[o].image.width=e,this.textures[o].image.height=t,this.textures[o].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let r=0,o=e.textures.length;r<o;r++)this.textures[r]=e.textures[r].clone(),this.textures[r].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new vi(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ds extends Nr{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class Gs extends Ii{constructor(e=null,t=1,r=1,o=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:o},this.magFilter=_i,this.minFilter=_i,this.wrapR=vr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Ho extends Ii{constructor(e=null,t=1,r=1,o=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:o},this.magFilter=_i,this.minFilter=_i,this.wrapR=vr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ki{constructor(e=0,t=0,r=0,o=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=o}static slerpFlat(e,t,r,o,l,u,h){let p=r[o+0],m=r[o+1],v=r[o+2],y=r[o+3];const M=l[u+0],S=l[u+1],A=l[u+2],N=l[u+3];if(0===h)return e[t+0]=p,e[t+1]=m,e[t+2]=v,void(e[t+3]=y);if(1===h)return e[t+0]=M,e[t+1]=S,e[t+2]=A,void(e[t+3]=N);if(y!==N||p!==M||m!==S||v!==A){let R=1-h;const T=p*M+m*S+v*A+y*N,B=T>=0?1:-1,V=1-T*T;if(V>Number.EPSILON){const ne=Math.sqrt(V),Q=Math.atan2(ne,T*B);R=Math.sin(R*Q)/ne,h=Math.sin(h*Q)/ne}const F=h*B;if(p=p*R+M*F,m=m*R+S*F,v=v*R+A*F,y=y*R+N*F,R===1-h){const ne=1/Math.sqrt(p*p+m*m+v*v+y*y);p*=ne,m*=ne,v*=ne,y*=ne}}e[t]=p,e[t+1]=m,e[t+2]=v,e[t+3]=y}static multiplyQuaternionsFlat(e,t,r,o,l,u){const h=r[o],p=r[o+1],m=r[o+2],v=r[o+3],y=l[u],M=l[u+1],S=l[u+2],A=l[u+3];return e[t]=h*A+v*y+p*S-m*M,e[t+1]=p*A+v*M+m*y-h*S,e[t+2]=m*A+v*S+h*M-p*y,e[t+3]=v*A-h*y-p*M-m*S,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,o){return this._x=e,this._y=t,this._z=r,this._w=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,o=e._y,l=e._z,u=e._order,h=Math.cos,p=Math.sin,m=h(r/2),v=h(o/2),y=h(l/2),M=p(r/2),S=p(o/2),A=p(l/2);switch(u){case"XYZ":this._x=M*v*y+m*S*A,this._y=m*S*y-M*v*A,this._z=m*v*A+M*S*y,this._w=m*v*y-M*S*A;break;case"YXZ":this._x=M*v*y+m*S*A,this._y=m*S*y-M*v*A,this._z=m*v*A-M*S*y,this._w=m*v*y+M*S*A;break;case"ZXY":this._x=M*v*y-m*S*A,this._y=m*S*y+M*v*A,this._z=m*v*A+M*S*y,this._w=m*v*y-M*S*A;break;case"ZYX":this._x=M*v*y-m*S*A,this._y=m*S*y+M*v*A,this._z=m*v*A-M*S*y,this._w=m*v*y+M*S*A;break;case"YZX":this._x=M*v*y+m*S*A,this._y=m*S*y+M*v*A,this._z=m*v*A-M*S*y,this._w=m*v*y-M*S*A;break;case"XZY":this._x=M*v*y-m*S*A,this._y=m*S*y-M*v*A,this._z=m*v*A+M*S*y,this._w=m*v*y+M*S*A;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,o=Math.sin(r);return this._x=e.x*o,this._y=e.y*o,this._z=e.z*o,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],o=t[4],l=t[8],u=t[1],h=t[5],p=t[9],m=t[2],v=t[6],y=t[10],M=r+h+y;if(M>0){const S=.5/Math.sqrt(M+1);this._w=.25/S,this._x=(v-p)*S,this._y=(l-m)*S,this._z=(u-o)*S}else if(r>h&&r>y){const S=2*Math.sqrt(1+r-h-y);this._w=(v-p)/S,this._x=.25*S,this._y=(o+u)/S,this._z=(l+m)/S}else if(h>y){const S=2*Math.sqrt(1+h-r-y);this._w=(l-m)/S,this._x=(o+u)/S,this._y=.25*S,this._z=(p+v)/S}else{const S=2*Math.sqrt(1+y-r-h);this._w=(u-o)/S,this._x=(l+m)/S,this._y=(p+v)/S,this._z=.25*S}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Gi(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(0===r)return this;const o=Math.min(1,t/r);return this.slerp(e,o),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,o=e._y,l=e._z,u=e._w,h=t._x,p=t._y,m=t._z,v=t._w;return this._x=r*v+u*h+o*m-l*p,this._y=o*v+u*p+l*h-r*m,this._z=l*v+u*m+r*p-o*h,this._w=u*v-r*h-o*p-l*m,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const r=this._x,o=this._y,l=this._z,u=this._w;let h=u*e._w+r*e._x+o*e._y+l*e._z;if(h<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,h=-h):this.copy(e),h>=1)return this._w=u,this._x=r,this._y=o,this._z=l,this;const p=1-h*h;if(p<=Number.EPSILON){const S=1-t;return this._w=S*u+t*this._w,this._x=S*r+t*this._x,this._y=S*o+t*this._y,this._z=S*l+t*this._z,this.normalize(),this}const m=Math.sqrt(p),v=Math.atan2(m,h),y=Math.sin((1-t)*v)/m,M=Math.sin(t*v)/m;return this._w=u*y+this._w*M,this._x=r*y+this._x*M,this._y=o*y+this._y*M,this._z=l*y+this._z*M,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),o=Math.sqrt(1-r),l=Math.sqrt(r);return this.set(o*Math.sin(e),o*Math.cos(e),l*Math.sin(t),l*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ee{constructor(e=0,t=0,r=0){ee.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return void 0===r&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion($h.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion($h.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,o=this.z,l=e.elements;return this.x=l[0]*t+l[3]*r+l[6]*o,this.y=l[1]*t+l[4]*r+l[7]*o,this.z=l[2]*t+l[5]*r+l[8]*o,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,o=this.z,l=e.elements,u=1/(l[3]*t+l[7]*r+l[11]*o+l[15]);return this.x=(l[0]*t+l[4]*r+l[8]*o+l[12])*u,this.y=(l[1]*t+l[5]*r+l[9]*o+l[13])*u,this.z=(l[2]*t+l[6]*r+l[10]*o+l[14])*u,this}applyQuaternion(e){const t=this.x,r=this.y,o=this.z,l=e.x,u=e.y,h=e.z,p=e.w,m=2*(u*o-h*r),v=2*(h*t-l*o),y=2*(l*r-u*t);return this.x=t+p*m+u*y-h*v,this.y=r+p*v+h*m-l*y,this.z=o+p*y+l*v-u*m,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,o=this.z,l=e.elements;return this.x=l[0]*t+l[4]*r+l[8]*o,this.y=l[1]*t+l[5]*r+l[9]*o,this.z=l[2]*t+l[6]*r+l[10]*o,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,o=e.y,l=e.z,u=t.x,h=t.y,p=t.z;return this.x=o*p-l*h,this.y=l*u-r*p,this.z=r*h-o*u,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return Ka.copy(this).projectOnVector(e),this.sub(Ka)}reflect(e){return this.sub(Ka.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Gi(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,o=this.z-e.z;return t*t+r*r+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const o=Math.sin(t)*e;return this.x=o*Math.sin(r),this.y=Math.cos(t)*e,this.z=o*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),o=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=o,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Ka=new ee,$h=new Ki;class Ks{constructor(e=new ee(1/0,1/0,1/0),t=new ee(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(ao.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(ao.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=ao.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(void 0!==r){const l=r.getAttribute("position");if(!0===t&&void 0!==l&&!0!==e.isInstancedMesh)for(let u=0,h=l.count;u<h;u++)!0===e.isMesh?e.getVertexPosition(u,ao):ao.fromBufferAttribute(l,u),ao.applyMatrix4(e.matrixWorld),this.expandByPoint(ao);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),bo.copy(e.boundingBox)):(null===r.boundingBox&&r.computeBoundingBox(),bo.copy(r.boundingBox)),bo.applyMatrix4(e.matrixWorld),this.union(bo)}const o=e.children;for(let l=0,u=o.length;l<u;l++)this.expandByObject(o[l],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,ao),ao.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(gl),Xl.subVectors(this.max,gl),Xr.subVectors(e.a,gl),$l.subVectors(e.b,gl),da.subVectors(e.c,gl),lo.subVectors($l,Xr),Zi.subVectors(da,$l),ml.subVectors(Xr,da);let t=[0,-lo.z,lo.y,0,-Zi.z,Zi.y,0,-ml.z,ml.y,lo.z,0,-lo.x,Zi.z,0,-Zi.x,ml.z,0,-ml.x,-lo.y,lo.x,0,-Zi.y,Zi.x,0,-ml.y,ml.x,0];return!(!Fu(t,Xr,$l,da,Xl)||(t=[1,0,0,0,1,0,0,0,1],!Fu(t,Xr,$l,da,Xl)))&&(co.crossVectors(lo,Zi),t=[co.x,co.y,co.z],Fu(t,Xr,$l,da,Xl))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ao).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(ao).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Ri[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ri[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ri[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ri[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ri[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ri[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ri[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ri[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ri)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ri=[new ee,new ee,new ee,new ee,new ee,new ee,new ee,new ee],ao=new ee,bo=new Ks,Xr=new ee,$l=new ee,da=new ee,lo=new ee,Zi=new ee,ml=new ee,gl=new ee,Xl=new ee,co=new ee,Za=new ee;function Fu(c,e,t,r,o){for(let l=0,u=c.length-3;l<=u;l+=3){Za.fromArray(c,l);const h=o.x*Math.abs(Za.x)+o.y*Math.abs(Za.y)+o.z*Math.abs(Za.z),p=e.dot(Za),m=t.dot(Za),v=r.dot(Za);if(Math.max(-Math.max(p,m,v),Math.min(p,m,v))>h)return!1}return!0}const Vp=new Ks,Pc=new ee,Nc=new ee;class Br{constructor(e=new ee,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;void 0!==t?r.copy(t):Vp.setFromPoints(e).getCenter(r);let o=0;for(let l=0,u=e.length;l<u;l++)o=Math.max(o,r.distanceToSquared(e[l]));return this.radius=Math.sqrt(o),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Pc.subVectors(e,this.center);const t=Pc.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),o=.5*(r-this.radius);this.center.addScaledVector(Pc,o/r),this.radius+=o}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Nc.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Pc.copy(e.center).add(Nc)),this.expandByPoint(Pc.copy(e.center).sub(Nc))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const uo=new ee,Uu=new ee,On=new ee,ps=new ee,Xh=new ee,Pd=new ee,Yh=new ee;class Oc{constructor(e=new ee,t=new ee(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,uo)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=uo.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(uo.copy(this.origin).addScaledVector(this.direction,t),uo.distanceToSquared(e))}distanceSqToSegment(e,t,r,o){Uu.copy(e).add(t).multiplyScalar(.5),On.copy(t).sub(e).normalize(),ps.copy(this.origin).sub(Uu);const l=.5*e.distanceTo(t),u=-this.direction.dot(On),h=ps.dot(this.direction),p=-ps.dot(On),m=ps.lengthSq(),v=Math.abs(1-u*u);let y,M,S,A;if(v>0)if(y=u*p-h,M=u*h-p,A=l*v,y>=0)if(M>=-A)if(M<=A){const N=1/v;y*=N,M*=N,S=y*(y+u*M+2*h)+M*(u*y+M+2*p)+m}else M=l,y=Math.max(0,-(u*M+h)),S=-y*y+M*(M+2*p)+m;else M=-l,y=Math.max(0,-(u*M+h)),S=-y*y+M*(M+2*p)+m;else M<=-A?(y=Math.max(0,-(-u*l+h)),M=y>0?-l:Math.min(Math.max(-l,-p),l),S=-y*y+M*(M+2*p)+m):M<=A?(y=0,M=Math.min(Math.max(-l,-p),l),S=M*(M+2*p)+m):(y=Math.max(0,-(u*l+h)),M=y>0?l:Math.min(Math.max(-l,-p),l),S=-y*y+M*(M+2*p)+m);else M=u>0?-l:l,y=Math.max(0,-(u*M+h)),S=-y*y+M*(M+2*p)+m;return r&&r.copy(this.origin).addScaledVector(this.direction,y),o&&o.copy(Uu).addScaledVector(On,M),S}intersectSphere(e,t){uo.subVectors(e.center,this.origin);const r=uo.dot(this.direction),o=uo.dot(uo)-r*r,l=e.radius*e.radius;if(o>l)return null;const u=Math.sqrt(l-o),h=r-u,p=r+u;return p<0?null:this.at(h<0?p:h,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return null===r?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,o,l,u,h,p;const m=1/this.direction.x,v=1/this.direction.y,y=1/this.direction.z,M=this.origin;return m>=0?(r=(e.min.x-M.x)*m,o=(e.max.x-M.x)*m):(r=(e.max.x-M.x)*m,o=(e.min.x-M.x)*m),v>=0?(l=(e.min.y-M.y)*v,u=(e.max.y-M.y)*v):(l=(e.max.y-M.y)*v,u=(e.min.y-M.y)*v),r>u||l>o||((l>r||isNaN(r))&&(r=l),(u<o||isNaN(o))&&(o=u),y>=0?(h=(e.min.z-M.z)*y,p=(e.max.z-M.z)*y):(h=(e.max.z-M.z)*y,p=(e.min.z-M.z)*y),r>p||h>o)||((h>r||r!=r)&&(r=h),(p<o||o!=o)&&(o=p),o<0)?null:this.at(r>=0?r:o,t)}intersectsBox(e){return null!==this.intersectBox(e,uo)}intersectTriangle(e,t,r,o,l){Xh.subVectors(t,e),Pd.subVectors(r,e),Yh.crossVectors(Xh,Pd);let h,u=this.direction.dot(Yh);if(u>0){if(o)return null;h=1}else{if(!(u<0))return null;h=-1,u=-u}ps.subVectors(this.origin,e);const p=h*this.direction.dot(Pd.crossVectors(ps,Pd));if(p<0)return null;const m=h*this.direction.dot(Xh.cross(ps));if(m<0||p+m>u)return null;const v=-h*ps.dot(Yh);return v<0?null:this.at(v/u,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class In{constructor(e,t,r,o,l,u,h,p,m,v,y,M,S,A,N,R){In.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,r,o,l,u,h,p,m,v,y,M,S,A,N,R)}set(e,t,r,o,l,u,h,p,m,v,y,M,S,A,N,R){const T=this.elements;return T[0]=e,T[4]=t,T[8]=r,T[12]=o,T[1]=l,T[5]=u,T[9]=h,T[13]=p,T[2]=m,T[6]=v,T[10]=y,T[14]=M,T[3]=S,T[7]=A,T[11]=N,T[15]=R,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new In).fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,o=1/So.setFromMatrixColumn(e,0).length(),l=1/So.setFromMatrixColumn(e,1).length(),u=1/So.setFromMatrixColumn(e,2).length();return t[0]=r[0]*o,t[1]=r[1]*o,t[2]=r[2]*o,t[3]=0,t[4]=r[4]*l,t[5]=r[5]*l,t[6]=r[6]*l,t[7]=0,t[8]=r[8]*u,t[9]=r[9]*u,t[10]=r[10]*u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,o=e.y,l=e.z,u=Math.cos(r),h=Math.sin(r),p=Math.cos(o),m=Math.sin(o),v=Math.cos(l),y=Math.sin(l);if("XYZ"===e.order){const M=u*v,S=u*y,A=h*v,N=h*y;t[0]=p*v,t[4]=-p*y,t[8]=m,t[1]=S+A*m,t[5]=M-N*m,t[9]=-h*p,t[2]=N-M*m,t[6]=A+S*m,t[10]=u*p}else if("YXZ"===e.order){const M=p*v,S=p*y,A=m*v,N=m*y;t[0]=M+N*h,t[4]=A*h-S,t[8]=u*m,t[1]=u*y,t[5]=u*v,t[9]=-h,t[2]=S*h-A,t[6]=N+M*h,t[10]=u*p}else if("ZXY"===e.order){const M=p*v,S=p*y,A=m*v,N=m*y;t[0]=M-N*h,t[4]=-u*y,t[8]=A+S*h,t[1]=S+A*h,t[5]=u*v,t[9]=N-M*h,t[2]=-u*m,t[6]=h,t[10]=u*p}else if("ZYX"===e.order){const M=u*v,S=u*y,A=h*v,N=h*y;t[0]=p*v,t[4]=A*m-S,t[8]=M*m+N,t[1]=p*y,t[5]=N*m+M,t[9]=S*m-A,t[2]=-m,t[6]=h*p,t[10]=u*p}else if("YZX"===e.order){const M=u*p,S=u*m,A=h*p,N=h*m;t[0]=p*v,t[4]=N-M*y,t[8]=A*y+S,t[1]=y,t[5]=u*v,t[9]=-h*v,t[2]=-m*v,t[6]=S*y+A,t[10]=M-N*y}else if("XZY"===e.order){const M=u*p,S=u*m,A=h*p,N=h*m;t[0]=p*v,t[4]=-y,t[8]=m*v,t[1]=M*y+N,t[5]=u*v,t[9]=S*y-A,t[2]=A*y-S,t[6]=h*v,t[10]=N*y+M}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Hp,e,zp)}lookAt(e,t,r){const o=this.elements;return He.subVectors(e,t),0===He.lengthSq()&&(He.z=1),He.normalize(),vl.crossVectors(r,He),0===vl.lengthSq()&&(1===Math.abs(r.z)?He.x+=1e-4:He.z+=1e-4,He.normalize(),vl.crossVectors(r,He)),vl.normalize(),Lc.crossVectors(He,vl),o[0]=vl.x,o[4]=Lc.x,o[8]=He.x,o[1]=vl.y,o[5]=Lc.y,o[9]=He.y,o[2]=vl.z,o[6]=Lc.z,o[10]=He.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,o=t.elements,l=this.elements,u=r[0],h=r[4],p=r[8],m=r[12],v=r[1],y=r[5],M=r[9],S=r[13],A=r[2],N=r[6],R=r[10],T=r[14],B=r[3],V=r[7],F=r[11],ne=r[15],Q=o[0],te=o[4],se=o[8],X=o[12],j=o[1],fe=o[5],Re=o[9],Ce=o[13],Fe=o[2],st=o[6],Be=o[10],bt=o[14],je=o[3],Ot=o[7],Xt=o[11],on=o[15];return l[0]=u*Q+h*j+p*Fe+m*je,l[4]=u*te+h*fe+p*st+m*Ot,l[8]=u*se+h*Re+p*Be+m*Xt,l[12]=u*X+h*Ce+p*bt+m*on,l[1]=v*Q+y*j+M*Fe+S*je,l[5]=v*te+y*fe+M*st+S*Ot,l[9]=v*se+y*Re+M*Be+S*Xt,l[13]=v*X+y*Ce+M*bt+S*on,l[2]=A*Q+N*j+R*Fe+T*je,l[6]=A*te+N*fe+R*st+T*Ot,l[10]=A*se+N*Re+R*Be+T*Xt,l[14]=A*X+N*Ce+R*bt+T*on,l[3]=B*Q+V*j+F*Fe+ne*je,l[7]=B*te+V*fe+F*st+ne*Ot,l[11]=B*se+V*Re+F*Be+ne*Xt,l[15]=B*X+V*Ce+F*bt+ne*on,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],o=e[8],l=e[12],u=e[1],h=e[5],p=e[9],m=e[13],v=e[2],y=e[6],M=e[10],S=e[14];return e[3]*(+l*p*y-o*m*y-l*h*M+r*m*M+o*h*S-r*p*S)+e[7]*(+t*p*S-t*m*M+l*u*M-o*u*S+o*m*v-l*p*v)+e[11]*(+t*m*y-t*h*S-l*u*y+r*u*S+l*h*v-r*m*v)+e[15]*(-o*h*v-t*p*y+t*h*M+o*u*y-r*u*M+r*p*v)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const o=this.elements;return e.isVector3?(o[12]=e.x,o[13]=e.y,o[14]=e.z):(o[12]=e,o[13]=t,o[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],o=e[2],l=e[3],u=e[4],h=e[5],p=e[6],m=e[7],v=e[8],y=e[9],M=e[10],S=e[11],A=e[12],N=e[13],R=e[14],T=e[15],B=y*R*m-N*M*m+N*p*S-h*R*S-y*p*T+h*M*T,V=A*M*m-v*R*m-A*p*S+u*R*S+v*p*T-u*M*T,F=v*N*m-A*y*m+A*h*S-u*N*S-v*h*T+u*y*T,ne=A*y*p-v*N*p-A*h*M+u*N*M+v*h*R-u*y*R,Q=t*B+r*V+o*F+l*ne;if(0===Q)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const te=1/Q;return e[0]=B*te,e[1]=(N*M*l-y*R*l-N*o*S+r*R*S+y*o*T-r*M*T)*te,e[2]=(h*R*l-N*p*l+N*o*m-r*R*m-h*o*T+r*p*T)*te,e[3]=(y*p*l-h*M*l-y*o*m+r*M*m+h*o*S-r*p*S)*te,e[4]=V*te,e[5]=(v*R*l-A*M*l+A*o*S-t*R*S-v*o*T+t*M*T)*te,e[6]=(A*p*l-u*R*l-A*o*m+t*R*m+u*o*T-t*p*T)*te,e[7]=(u*M*l-v*p*l+v*o*m-t*M*m-u*o*S+t*p*S)*te,e[8]=F*te,e[9]=(A*y*l-v*N*l-A*r*S+t*N*S+v*r*T-t*y*T)*te,e[10]=(u*N*l-A*h*l+A*r*m-t*N*m-u*r*T+t*h*T)*te,e[11]=(v*h*l-u*y*l-v*r*m+t*y*m+u*r*S-t*h*S)*te,e[12]=ne*te,e[13]=(v*N*o-A*y*o+A*r*M-t*N*M-v*r*R+t*y*R)*te,e[14]=(A*h*o-u*N*o-A*r*p+t*N*p+u*r*R-t*h*R)*te,e[15]=(u*y*o-v*h*o+v*r*p-t*y*p-u*r*M+t*h*M)*te,this}scale(e){const t=this.elements,r=e.x,o=e.y,l=e.z;return t[0]*=r,t[4]*=o,t[8]*=l,t[1]*=r,t[5]*=o,t[9]*=l,t[2]*=r,t[6]*=o,t[10]*=l,t[3]*=r,t[7]*=o,t[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),o=Math.sin(t),l=1-r,u=e.x,h=e.y,p=e.z,m=l*u,v=l*h;return this.set(m*u+r,m*h-o*p,m*p+o*h,0,m*h+o*p,v*h+r,v*p-o*u,0,m*p-o*h,v*p+o*u,l*p*p+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,o,l,u){return this.set(1,r,l,0,e,1,u,0,t,o,1,0,0,0,0,1),this}compose(e,t,r){const o=this.elements,l=t._x,u=t._y,h=t._z,p=t._w,m=l+l,v=u+u,y=h+h,M=l*m,S=l*v,A=l*y,N=u*v,R=u*y,T=h*y,B=p*m,V=p*v,F=p*y,ne=r.x,Q=r.y,te=r.z;return o[0]=(1-(N+T))*ne,o[1]=(S+F)*ne,o[2]=(A-V)*ne,o[3]=0,o[4]=(S-F)*Q,o[5]=(1-(M+T))*Q,o[6]=(R+B)*Q,o[7]=0,o[8]=(A+V)*te,o[9]=(R-B)*te,o[10]=(1-(M+N))*te,o[11]=0,o[12]=e.x,o[13]=e.y,o[14]=e.z,o[15]=1,this}decompose(e,t,r){const o=this.elements;let l=So.set(o[0],o[1],o[2]).length();const u=So.set(o[4],o[5],o[6]).length(),h=So.set(o[8],o[9],o[10]).length();this.determinant()<0&&(l=-l),e.x=o[12],e.y=o[13],e.z=o[14],ho.copy(this);const m=1/l,v=1/u,y=1/h;return ho.elements[0]*=m,ho.elements[1]*=m,ho.elements[2]*=m,ho.elements[4]*=v,ho.elements[5]*=v,ho.elements[6]*=v,ho.elements[8]*=y,ho.elements[9]*=y,ho.elements[10]*=y,t.setFromRotationMatrix(ho),r.x=l,r.y=u,r.z=h,this}makePerspective(e,t,r,o,l,u,h=rr){const p=this.elements,m=2*l/(t-e),v=2*l/(r-o),y=(t+e)/(t-e),M=(r+o)/(r-o);let S,A;if(h===rr)S=-(u+l)/(u-l),A=-2*u*l/(u-l);else{if(2001!==h)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+h);S=-u/(u-l),A=-u*l/(u-l)}return p[0]=m,p[4]=0,p[8]=y,p[12]=0,p[1]=0,p[5]=v,p[9]=M,p[13]=0,p[2]=0,p[6]=0,p[10]=S,p[14]=A,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,r,o,l,u,h=rr){const p=this.elements,m=1/(t-e),v=1/(r-o),y=1/(u-l),M=(t+e)*m,S=(r+o)*v;let A,N;if(h===rr)A=(u+l)*y,N=-2*y;else{if(2001!==h)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+h);A=l*y,N=-1*y}return p[0]=2*m,p[4]=0,p[8]=0,p[12]=-M,p[1]=0,p[5]=2*v,p[9]=0,p[13]=-S,p[2]=0,p[6]=0,p[10]=N,p[14]=-A,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let o=0;o<16;o++)if(t[o]!==r[o])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const So=new ee,ho=new In,Hp=new ee(0,0,0),zp=new ee(1,1,1),vl=new ee,Lc=new ee,He=new ee,Pi=new In,qh=new Ki;let Da=(()=>{class c{constructor(t=0,r=0,o=0,l=c.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=r,this._z=o,this._order=l}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,r,o,l=this._order){return this._x=t,this._y=r,this._z=o,this._order=l,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,r=this._order,o=!0){const l=t.elements,u=l[0],h=l[4],p=l[8],m=l[1],v=l[5],y=l[9],M=l[2],S=l[6],A=l[10];switch(r){case"XYZ":this._y=Math.asin(Gi(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-y,A),this._z=Math.atan2(-h,u)):(this._x=Math.atan2(S,v),this._z=0);break;case"YXZ":this._x=Math.asin(-Gi(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(p,A),this._z=Math.atan2(m,v)):(this._y=Math.atan2(-M,u),this._z=0);break;case"ZXY":this._x=Math.asin(Gi(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(-M,A),this._z=Math.atan2(-h,v)):(this._y=0,this._z=Math.atan2(m,u));break;case"ZYX":this._y=Math.asin(-Gi(M,-1,1)),Math.abs(M)<.9999999?(this._x=Math.atan2(S,A),this._z=Math.atan2(m,u)):(this._x=0,this._z=Math.atan2(-h,v));break;case"YZX":this._z=Math.asin(Gi(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(-y,v),this._y=Math.atan2(-M,u)):(this._x=0,this._y=Math.atan2(p,A));break;case"XZY":this._z=Math.asin(-Gi(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(S,v),this._y=Math.atan2(p,u)):(this._x=Math.atan2(-y,A),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,!0===o&&this._onChangeCallback(),this}setFromQuaternion(t,r,o){return Pi.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Pi,r,o)}setFromVector3(t,r=this._order){return this.set(t.x,t.y,t.z,r)}reorder(t){return qh.setFromEuler(this),this.setFromQuaternion(qh,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],r=0){return t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return c.DEFAULT_ORDER="XYZ",c})();class nr{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Kh=0;const Fc=new ee,Fs=new Ki,zo=new In,Yl=new ee,Uc=new ee,sv=new ee,Zh=new Ki,Us=new ee(1,0,0),ha=new ee(0,1,0),ku=new ee(0,0,1),Go={type:"added"},Ja={type:"removed"},kc={type:"childadded",child:null},Nd={type:"childremoved",child:null};let ms=(()=>{class c extends rs{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Kh++}),this.uuid=ss(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=c.DEFAULT_UP.clone();const t=new ee,r=new Da,o=new Ki,l=new ee(1,1,1);r._onChange(function u(){o.setFromEuler(r,!1)}),o._onChange(function h(){r.setFromQuaternion(o,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:l},modelViewMatrix:{value:new In},normalMatrix:{value:new zn}}),this.matrix=new In,this.matrixWorld=new In,this.matrixAutoUpdate=c.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=c.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new nr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,r){this.quaternion.setFromAxisAngle(t,r)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,r){return Fs.setFromAxisAngle(t,r),this.quaternion.multiply(Fs),this}rotateOnWorldAxis(t,r){return Fs.setFromAxisAngle(t,r),this.quaternion.premultiply(Fs),this}rotateX(t){return this.rotateOnAxis(Us,t)}rotateY(t){return this.rotateOnAxis(ha,t)}rotateZ(t){return this.rotateOnAxis(ku,t)}translateOnAxis(t,r){return Fc.copy(t).applyQuaternion(this.quaternion),this.position.add(Fc.multiplyScalar(r)),this}translateX(t){return this.translateOnAxis(Us,t)}translateY(t){return this.translateOnAxis(ha,t)}translateZ(t){return this.translateOnAxis(ku,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(zo.copy(this.matrixWorld).invert())}lookAt(t,r,o){t.isVector3?Yl.copy(t):Yl.set(t,r,o);const l=this.parent;this.updateWorldMatrix(!0,!1),Uc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?zo.lookAt(Uc,Yl,this.up):zo.lookAt(Yl,Uc,this.up),this.quaternion.setFromRotationMatrix(zo),l&&(zo.extractRotation(l.matrixWorld),Fs.setFromRotationMatrix(zo),this.quaternion.premultiply(Fs.invert()))}add(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(Go),kc.child=t,this.dispatchEvent(kc),kc.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}const r=this.children.indexOf(t);return-1!==r&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(Ja),Nd.child=t,this.dispatchEvent(Nd),Nd.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),zo.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),zo.multiply(t.parent.matrixWorld)),t.applyMatrix4(zo),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(Go),kc.child=t,this.dispatchEvent(kc),kc.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,r){if(this[t]===r)return this;for(let o=0,l=this.children.length;o<l;o++){const h=this.children[o].getObjectByProperty(t,r);if(void 0!==h)return h}}getObjectsByProperty(t,r,o=[]){this[t]===r&&o.push(this);const l=this.children;for(let u=0,h=l.length;u<h;u++)l[u].getObjectsByProperty(t,r,o);return o}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Uc,t,sv),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Uc,Zh,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const r=this.matrixWorld.elements;return t.set(r[8],r[9],r[10]).normalize()}raycast(){}traverse(t){t(this);const r=this.children;for(let o=0,l=r.length;o<l;o++)r[o].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const r=this.children;for(let o=0,l=r.length;o<l;o++)r[o].traverseVisible(t)}traverseAncestors(t){const r=this.parent;null!==r&&(t(r),r.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const r=this.children;for(let o=0,l=r.length;o<l;o++)r[o].updateMatrixWorld(t)}updateWorldMatrix(t,r){const o=this.parent;if(!0===t&&null!==o&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===r){const l=this.children;for(let u=0,h=l.length;u<h;u++)l[u].updateWorldMatrix(!1,!0)}}toJSON(t){const r=void 0===t||"string"==typeof t,o={};r&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},o.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const l={};function u(p,m){return void 0===p[m.uuid]&&(p[m.uuid]=m.toJSON(t)),m.uuid}if(l.uuid=this.uuid,l.type=this.type,""!==this.name&&(l.name=this.name),!0===this.castShadow&&(l.castShadow=!0),!0===this.receiveShadow&&(l.receiveShadow=!0),!1===this.visible&&(l.visible=!1),!1===this.frustumCulled&&(l.frustumCulled=!1),0!==this.renderOrder&&(l.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(l.userData=this.userData),l.layers=this.layers.mask,l.matrix=this.matrix.toArray(),l.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(l.matrixAutoUpdate=!1),this.isInstancedMesh&&(l.type="InstancedMesh",l.count=this.count,l.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(l.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(l.type="BatchedMesh",l.perObjectFrustumCulled=this.perObjectFrustumCulled,l.sortObjects=this.sortObjects,l.drawRanges=this._drawRanges,l.reservedRanges=this._reservedRanges,l.visibility=this._visibility,l.active=this._active,l.bounds=this._bounds.map(p=>({boxInitialized:p.boxInitialized,boxMin:p.box.min.toArray(),boxMax:p.box.max.toArray(),sphereInitialized:p.sphereInitialized,sphereRadius:p.sphere.radius,sphereCenter:p.sphere.center.toArray()})),l.maxInstanceCount=this._maxInstanceCount,l.maxVertexCount=this._maxVertexCount,l.maxIndexCount=this._maxIndexCount,l.geometryInitialized=this._geometryInitialized,l.geometryCount=this._geometryCount,l.matricesTexture=this._matricesTexture.toJSON(t),null!==this._colorsTexture&&(l.colorsTexture=this._colorsTexture.toJSON(t)),null!==this.boundingSphere&&(l.boundingSphere={center:l.boundingSphere.center.toArray(),radius:l.boundingSphere.radius}),null!==this.boundingBox&&(l.boundingBox={min:l.boundingBox.min.toArray(),max:l.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?l.background=this.background.toJSON():this.background.isTexture&&(l.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(l.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){l.geometry=u(t.geometries,this.geometry);const p=this.geometry.parameters;if(void 0!==p&&void 0!==p.shapes){const m=p.shapes;if(Array.isArray(m))for(let v=0,y=m.length;v<y;v++)u(t.shapes,m[v]);else u(t.shapes,m)}}if(this.isSkinnedMesh&&(l.bindMode=this.bindMode,l.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(u(t.skeletons,this.skeleton),l.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const p=[];for(let m=0,v=this.material.length;m<v;m++)p.push(u(t.materials,this.material[m]));l.material=p}else l.material=u(t.materials,this.material);if(this.children.length>0){l.children=[];for(let p=0;p<this.children.length;p++)l.children.push(this.children[p].toJSON(t).object)}if(this.animations.length>0){l.animations=[];for(let p=0;p<this.animations.length;p++)l.animations.push(u(t.animations,this.animations[p]))}if(r){const p=h(t.geometries),m=h(t.materials),v=h(t.textures),y=h(t.images),M=h(t.shapes),S=h(t.skeletons),A=h(t.animations),N=h(t.nodes);p.length>0&&(o.geometries=p),m.length>0&&(o.materials=m),v.length>0&&(o.textures=v),y.length>0&&(o.images=y),M.length>0&&(o.shapes=M),S.length>0&&(o.skeletons=S),A.length>0&&(o.animations=A),N.length>0&&(o.nodes=N)}return o.object=l,o;function h(p){const m=[];for(const v in p){const y=p[v];delete y.metadata,m.push(y)}return m}}clone(t){return(new this.constructor).copy(this,t)}copy(t,r=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===r)for(let o=0;o<t.children.length;o++)this.add(t.children[o].clone());return this}}return c.DEFAULT_UP=new ee(0,1,0),c.DEFAULT_MATRIX_AUTO_UPDATE=!0,c.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,c})();const fa=new ee,pa=new ee,x=new ee,D=new ee,b=new ee,I=new ee,k=new ee,$=new ee,ae=new ee,we=new ee,Ee=new dn,Ft=new dn,$n=new dn;class kn{constructor(e=new ee,t=new ee,r=new ee){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,o){o.subVectors(r,t),fa.subVectors(e,t),o.cross(fa);const l=o.lengthSq();return l>0?o.multiplyScalar(1/Math.sqrt(l)):o.set(0,0,0)}static getBarycoord(e,t,r,o,l){fa.subVectors(o,t),pa.subVectors(r,t),x.subVectors(e,t);const u=fa.dot(fa),h=fa.dot(pa),p=fa.dot(x),m=pa.dot(pa),v=pa.dot(x),y=u*m-h*h;if(0===y)return l.set(0,0,0),null;const M=1/y,S=(m*p-h*v)*M,A=(u*v-h*p)*M;return l.set(1-S-A,A,S)}static containsPoint(e,t,r,o){return null!==this.getBarycoord(e,t,r,o,D)&&D.x>=0&&D.y>=0&&D.x+D.y<=1}static getInterpolation(e,t,r,o,l,u,h,p){return null===this.getBarycoord(e,t,r,o,D)?(p.x=0,p.y=0,"z"in p&&(p.z=0),"w"in p&&(p.w=0),null):(p.setScalar(0),p.addScaledVector(l,D.x),p.addScaledVector(u,D.y),p.addScaledVector(h,D.z),p)}static getInterpolatedAttribute(e,t,r,o,l,u){return Ee.setScalar(0),Ft.setScalar(0),$n.setScalar(0),Ee.fromBufferAttribute(e,t),Ft.fromBufferAttribute(e,r),$n.fromBufferAttribute(e,o),u.setScalar(0),u.addScaledVector(Ee,l.x),u.addScaledVector(Ft,l.y),u.addScaledVector($n,l.z),u}static isFrontFacing(e,t,r,o){return fa.subVectors(r,t),pa.subVectors(e,t),fa.cross(pa).dot(o)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,o){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[o]),this}setFromAttributeAndIndices(e,t,r,o){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,o),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return fa.subVectors(this.c,this.b),pa.subVectors(this.a,this.b),.5*fa.cross(pa).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return kn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return kn.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,o,l){return kn.getInterpolation(e,this.a,this.b,this.c,t,r,o,l)}containsPoint(e){return kn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return kn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,o=this.b,l=this.c;let u,h;b.subVectors(o,r),I.subVectors(l,r),$.subVectors(e,r);const p=b.dot($),m=I.dot($);if(p<=0&&m<=0)return t.copy(r);ae.subVectors(e,o);const v=b.dot(ae),y=I.dot(ae);if(v>=0&&y<=v)return t.copy(o);const M=p*y-v*m;if(M<=0&&p>=0&&v<=0)return u=p/(p-v),t.copy(r).addScaledVector(b,u);we.subVectors(e,l);const S=b.dot(we),A=I.dot(we);if(A>=0&&S<=A)return t.copy(l);const N=S*m-p*A;if(N<=0&&m>=0&&A<=0)return h=m/(m-A),t.copy(r).addScaledVector(I,h);const R=v*A-S*y;if(R<=0&&y-v>=0&&S-A>=0)return k.subVectors(l,o),h=(y-v)/(y-v+(S-A)),t.copy(o).addScaledVector(k,h);const T=1/(R+N+M);return u=N*T,h=M*T,t.copy(r).addScaledVector(b,u).addScaledVector(I,h)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Si={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},gs={h:0,s:0,l:0},Wi={h:0,s:0,l:0};function yl(c,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?c+6*(e-c)*t:t<.5?e:t<2/3?c+6*(e-c)*(2/3-t):c}class kt{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(void 0===t&&void 0===r){const o=e;o&&o.isColor?this.copy(o):"number"==typeof o?this.setHex(o):"string"==typeof o&&this.setStyle(o)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Mr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,fi.toWorkingColorSpace(this,t),this}setRGB(e,t,r,o=fi.workingColorSpace){return this.r=e,this.g=t,this.b=r,fi.toWorkingColorSpace(this,o),this}setHSL(e,t,r,o=fi.workingColorSpace){if(e=$a(e,1),t=Gi(t,0,1),r=Gi(r,0,1),0===t)this.r=this.g=this.b=r;else{const l=r<=.5?r*(1+t):r+t-r*t,u=2*r-l;this.r=yl(u,l,e+1/3),this.g=yl(u,l,e),this.b=yl(u,l,e-1/3)}return fi.toWorkingColorSpace(this,o),this}setStyle(e,t=Mr){function r(l){void 0!==l&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let o;if(o=/^(\w+)\(([^\)]*)\)/.exec(e)){let l;const h=o[2];switch(o[1]){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return r(l[4]),this.setRGB(Math.min(255,parseInt(l[1],10))/255,Math.min(255,parseInt(l[2],10))/255,Math.min(255,parseInt(l[3],10))/255,t);if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return r(l[4]),this.setRGB(Math.min(100,parseInt(l[1],10))/100,Math.min(100,parseInt(l[2],10))/100,Math.min(100,parseInt(l[3],10))/100,t);break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return r(l[4]),this.setHSL(parseFloat(l[1])/360,parseFloat(l[2])/100,parseFloat(l[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(e)){const l=o[1],u=l.length;if(3===u)return this.setRGB(parseInt(l.charAt(0),16)/15,parseInt(l.charAt(1),16)/15,parseInt(l.charAt(2),16)/15,t);if(6===u)return this.setHex(parseInt(l,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Mr){const r=Si[e.toLowerCase()];return void 0!==r?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Aa(e.r),this.g=Aa(e.g),this.b=Aa(e.b),this}copyLinearToSRGB(e){return this.r=C(e.r),this.g=C(e.g),this.b=C(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Mr){return fi.fromWorkingColorSpace(Vr.copy(this),e),65536*Math.round(Gi(255*Vr.r,0,255))+256*Math.round(Gi(255*Vr.g,0,255))+Math.round(Gi(255*Vr.b,0,255))}getHexString(e=Mr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=fi.workingColorSpace){fi.fromWorkingColorSpace(Vr.copy(this),t);const r=Vr.r,o=Vr.g,l=Vr.b,u=Math.max(r,o,l),h=Math.min(r,o,l);let p,m;const v=(h+u)/2;if(h===u)p=0,m=0;else{const y=u-h;switch(m=v<=.5?y/(u+h):y/(2-u-h),u){case r:p=(o-l)/y+(o<l?6:0);break;case o:p=(l-r)/y+2;break;case l:p=(r-o)/y+4}p/=6}return e.h=p,e.s=m,e.l=v,e}getRGB(e,t=fi.workingColorSpace){return fi.fromWorkingColorSpace(Vr.copy(this),t),e.r=Vr.r,e.g=Vr.g,e.b=Vr.b,e}getStyle(e=Mr){fi.fromWorkingColorSpace(Vr.copy(this),e);const t=Vr.r,r=Vr.g,o=Vr.b;return e!==Mr?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${o.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*r)},${Math.round(255*o)})`}offsetHSL(e,t,r){return this.getHSL(gs),this.setHSL(gs.h+e,gs.s+t,gs.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(gs),e.getHSL(Wi);const r=ca(gs.h,Wi.h,t),o=ca(gs.s,Wi.s,t),l=ca(gs.l,Wi.l,t);return this.setHSL(r,o,l),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,o=this.b,l=e.elements;return this.r=l[0]*t+l[3]*r+l[6]*o,this.g=l[1]*t+l[4]*r+l[7]*o,this.b=l[2]*t+l[5]*r+l[8]*o,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Vr=new kt;kt.NAMES=Si;let x0=0;class Wo extends rs{static get type(){return"Material"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:x0++}),this.uuid=ss(),this.name="",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new kt(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=_o,this.stencilZFail=_o,this.stencilZPass=_o,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const r=e[t];if(void 0===r){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const o=this[t];void 0!==o?o&&o.isColor?o.set(r):o&&o.isVector3&&r&&r.isVector3?o.copy(r):this[t]=r:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function o(l){const u=[];for(const h in l){const p=l[h];delete p.metadata,u.push(p)}return u}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(r.dispersion=this.dispersion),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(r.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapRotation&&(r.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),0!==this.side&&(r.side=this.side),!0===this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=!0),204!==this.blendSrc&&(r.blendSrc=this.blendSrc),205!==this.blendDst&&(r.blendDst=this.blendDst),100!==this.blendEquation&&(r.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(r.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(r.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(r.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(r.depthFunc=this.depthFunc),!1===this.depthTest&&(r.depthTest=this.depthTest),!1===this.depthWrite&&(r.depthWrite=this.depthWrite),!1===this.colorWrite&&(r.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(r.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(r.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(r.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==_o&&(r.stencilFail=this.stencilFail),this.stencilZFail!==_o&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==_o&&(r.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(r.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaHash&&(r.alphaHash=!0),!0===this.alphaToCoverage&&(r.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=!0),!0===this.forceSinglePass&&(r.forceSinglePass=!0),!0===this.wireframe&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=!0),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData),t){const l=o(e.textures),u=o(e.images);l.length>0&&(r.textures=l),u.length>0&&(r.images=u)}return r}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(null!==t){const o=t.length;r=new Array(o);for(let l=0;l!==o;++l)r[l]=t[l].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class jo extends Wo{static get type(){return"MeshBasicMaterial"}constructor(e){super(),this.isMeshBasicMaterial=!0,this.color=new kt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Da,this.combine=Ss,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Yr=new ee,Bu=new Je;class xr{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=r,this.usage=35044,this.updateRanges=[],this.gpuType=Fr,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let o=0,l=this.itemSize;o<l;o++)this.array[e+o]=t.array[r+o];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)Bu.fromBufferAttribute(this,t),Bu.applyMatrix3(e),this.setXY(t,Bu.x,Bu.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)Yr.fromBufferAttribute(this,t),Yr.applyMatrix3(e),this.setXYZ(t,Yr.x,Yr.y,Yr.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Yr.fromBufferAttribute(this,t),Yr.applyMatrix4(e),this.setXYZ(t,Yr.x,Yr.y,Yr.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Yr.fromBufferAttribute(this,t),Yr.applyNormalMatrix(e),this.setXYZ(t,Yr.x,Yr.y,Yr.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Yr.fromBufferAttribute(this,t),Yr.transformDirection(e),this.setXYZ(t,Yr.x,Yr.y,Yr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=hr(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=qn(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=hr(t,this.array)),t}setX(e,t){return this.normalized&&(t=qn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=hr(t,this.array)),t}setY(e,t){return this.normalized&&(t=qn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=hr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=qn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=hr(t,this.array)),t}setW(e,t){return this.normalized&&(t=qn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=qn(t,this.array),r=qn(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,o){return e*=this.itemSize,this.normalized&&(t=qn(t,this.array),r=qn(r,this.array),o=qn(o,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=o,this}setXYZW(e,t,r,o,l){return e*=this.itemSize,this.normalized&&(t=qn(t,this.array),r=qn(r,this.array),o=qn(o,this.array),l=qn(l,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=o,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}}class ov extends xr{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class lv extends xr{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class vn extends xr{constructor(e,t,r){super(new Float32Array(e),t,r)}}let ub=0;const Ia=new In,Ld=new ms,Qa=new ee,$o=new Ks,_l=new Ks,vs=new ee;class si extends rs{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:ub++}),this.uuid=ss(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(Rd(e)?lv:ov)(e,1):e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(void 0!==r){const l=(new zn).getNormalMatrix(e);r.applyNormalMatrix(l),r.needsUpdate=!0}const o=this.attributes.tangent;return void 0!==o&&(o.transformDirection(e),o.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ia.makeRotationFromQuaternion(e),this.applyMatrix4(Ia),this}rotateX(e){return Ia.makeRotationX(e),this.applyMatrix4(Ia),this}rotateY(e){return Ia.makeRotationY(e),this.applyMatrix4(Ia),this}rotateZ(e){return Ia.makeRotationZ(e),this.applyMatrix4(Ia),this}translate(e,t,r){return Ia.makeTranslation(e,t,r),this.applyMatrix4(Ia),this}scale(e,t,r){return Ia.makeScale(e,t,r),this.applyMatrix4(Ia),this}lookAt(e){return Ld.lookAt(e),Ld.updateMatrix(),this.applyMatrix4(Ld.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Qa).negate(),this.translate(Qa.x,Qa.y,Qa.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const r=[];for(let o=0,l=e.length;o<l;o++){const u=e[o];r.push(u.x,u.y,u.z||0)}this.setAttribute("position",new vn(r,3))}else{for(let r=0,o=t.count;r<o;r++){const l=e[r];t.setXYZ(r,l.x,l.y,l.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ks);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new ee(-1/0,-1/0,-1/0),new ee(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,o=t.length;r<o;r++)$o.setFromBufferAttribute(t[r]),this.morphTargetsRelative?(vs.addVectors(this.boundingBox.min,$o.min),this.boundingBox.expandByPoint(vs),vs.addVectors(this.boundingBox.max,$o.max),this.boundingBox.expandByPoint(vs)):(this.boundingBox.expandByPoint($o.min),this.boundingBox.expandByPoint($o.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Br);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new ee,1/0);if(e){const r=this.boundingSphere.center;if($o.setFromBufferAttribute(e),t)for(let l=0,u=t.length;l<u;l++)_l.setFromBufferAttribute(t[l]),this.morphTargetsRelative?(vs.addVectors($o.min,_l.min),$o.expandByPoint(vs),vs.addVectors($o.max,_l.max),$o.expandByPoint(vs)):($o.expandByPoint(_l.min),$o.expandByPoint(_l.max));$o.getCenter(r);let o=0;for(let l=0,u=e.count;l<u;l++)vs.fromBufferAttribute(e,l),o=Math.max(o,r.distanceToSquared(vs));if(t)for(let l=0,u=t.length;l<u;l++){const h=t[l],p=this.morphTargetsRelative;for(let m=0,v=h.count;m<v;m++)vs.fromBufferAttribute(h,m),p&&(Qa.fromBufferAttribute(e,m),vs.add(Qa)),o=Math.max(o,r.distanceToSquared(vs))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const r=t.position,o=t.normal,l=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new xr(new Float32Array(4*r.count),4));const u=this.getAttribute("tangent"),h=[],p=[];for(let se=0;se<r.count;se++)h[se]=new ee,p[se]=new ee;const m=new ee,v=new ee,y=new ee,M=new Je,S=new Je,A=new Je,N=new ee,R=new ee;function T(se,X,j){m.fromBufferAttribute(r,se),v.fromBufferAttribute(r,X),y.fromBufferAttribute(r,j),M.fromBufferAttribute(l,se),S.fromBufferAttribute(l,X),A.fromBufferAttribute(l,j),v.sub(m),y.sub(m),S.sub(M),A.sub(M);const fe=1/(S.x*A.y-A.x*S.y);isFinite(fe)&&(N.copy(v).multiplyScalar(A.y).addScaledVector(y,-S.y).multiplyScalar(fe),R.copy(y).multiplyScalar(S.x).addScaledVector(v,-A.x).multiplyScalar(fe),h[se].add(N),h[X].add(N),h[j].add(N),p[se].add(R),p[X].add(R),p[j].add(R))}let B=this.groups;0===B.length&&(B=[{start:0,count:e.count}]);for(let se=0,X=B.length;se<X;++se){const j=B[se],fe=j.start;for(let Ce=fe,Fe=fe+j.count;Ce<Fe;Ce+=3)T(e.getX(Ce+0),e.getX(Ce+1),e.getX(Ce+2))}const V=new ee,F=new ee,ne=new ee,Q=new ee;function te(se){ne.fromBufferAttribute(o,se),Q.copy(ne);const X=h[se];V.copy(X),V.sub(ne.multiplyScalar(ne.dot(X))).normalize(),F.crossVectors(Q,X);const fe=F.dot(p[se])<0?-1:1;u.setXYZW(se,V.x,V.y,V.z,fe)}for(let se=0,X=B.length;se<X;++se){const j=B[se],fe=j.start;for(let Ce=fe,Fe=fe+j.count;Ce<Fe;Ce+=3)te(e.getX(Ce+0)),te(e.getX(Ce+1)),te(e.getX(Ce+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new xr(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let M=0,S=r.count;M<S;M++)r.setXYZ(M,0,0,0);const o=new ee,l=new ee,u=new ee,h=new ee,p=new ee,m=new ee,v=new ee,y=new ee;if(e)for(let M=0,S=e.count;M<S;M+=3){const A=e.getX(M+0),N=e.getX(M+1),R=e.getX(M+2);o.fromBufferAttribute(t,A),l.fromBufferAttribute(t,N),u.fromBufferAttribute(t,R),v.subVectors(u,l),y.subVectors(o,l),v.cross(y),h.fromBufferAttribute(r,A),p.fromBufferAttribute(r,N),m.fromBufferAttribute(r,R),h.add(v),p.add(v),m.add(v),r.setXYZ(A,h.x,h.y,h.z),r.setXYZ(N,p.x,p.y,p.z),r.setXYZ(R,m.x,m.y,m.z)}else for(let M=0,S=t.count;M<S;M+=3)o.fromBufferAttribute(t,M+0),l.fromBufferAttribute(t,M+1),u.fromBufferAttribute(t,M+2),v.subVectors(u,l),y.subVectors(o,l),v.cross(y),r.setXYZ(M+0,v.x,v.y,v.z),r.setXYZ(M+1,v.x,v.y,v.z),r.setXYZ(M+2,v.x,v.y,v.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)vs.fromBufferAttribute(e,t),vs.normalize(),e.setXYZ(t,vs.x,vs.y,vs.z)}toNonIndexed(){function e(h,p){const m=h.array,v=h.itemSize,y=h.normalized,M=new m.constructor(p.length*v);let S=0,A=0;for(let N=0,R=p.length;N<R;N++){S=h.isInterleavedBufferAttribute?p[N]*h.data.stride+h.offset:p[N]*v;for(let T=0;T<v;T++)M[A++]=m[S++]}return new xr(M,v,y)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new si,r=this.index.array,o=this.attributes;for(const h in o){const m=e(o[h],r);t.setAttribute(h,m)}const l=this.morphAttributes;for(const h in l){const p=[],m=l[h];for(let v=0,y=m.length;v<y;v++){const S=e(m[v],r);p.push(S)}t.morphAttributes[h]=p}t.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let h=0,p=u.length;h<p;h++){const m=u[h];t.addGroup(m.start,m.count,m.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const p=this.parameters;for(const m in p)void 0!==p[m]&&(e[m]=p[m]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const p in r)e.data.attributes[p]=r[p].toJSON(e.data);const o={};let l=!1;for(const p in this.morphAttributes){const m=this.morphAttributes[p],v=[];for(let y=0,M=m.length;y<M;y++)v.push(m[y].toJSON(e.data));v.length>0&&(o[p]=v,l=!0)}l&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(e.data.groups=JSON.parse(JSON.stringify(u)));const h=this.boundingSphere;return null!==h&&(e.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;null!==r&&this.setIndex(r.clone(t));const o=e.attributes;for(const m in o)this.setAttribute(m,o[m].clone(t));const l=e.morphAttributes;for(const m in l){const v=[],y=l[m];for(let M=0,S=y.length;M<S;M++)v.push(y[M].clone(t));this.morphAttributes[m]=v}this.morphTargetsRelative=e.morphTargetsRelative;const u=e.groups;for(let m=0,v=u.length;m<v;m++){const y=u[m];this.addGroup(y.start,y.count,y.materialIndex)}const h=e.boundingBox;null!==h&&(this.boundingBox=h.clone());const p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const b0=new In,Zl=new Oc,Fd=new Br,cv=new ee,Xo=new ee,Qh=new ee,Bc=new ee,Ud=new ee,kd=new ee,Bd=new ee,Vu=new ee;class Rs extends ms{constructor(e=new si,t=new jo){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const o=t[r[0]];if(void 0!==o){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=o.length;l<u;l++){const h=o[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}getVertexPosition(e,t){const r=this.geometry,l=r.morphAttributes.position,u=r.morphTargetsRelative;t.fromBufferAttribute(r.attributes.position,e);const h=this.morphTargetInfluences;if(l&&h){kd.set(0,0,0);for(let p=0,m=l.length;p<m;p++){const v=h[p];0!==v&&(Ud.fromBufferAttribute(l[p],e),kd.addScaledVector(u?Ud:Ud.sub(t),v))}t.add(kd)}return t}raycast(e,t){const r=this.geometry,l=this.matrixWorld;void 0!==this.material&&(null===r.boundingSphere&&r.computeBoundingSphere(),Fd.copy(r.boundingSphere),Fd.applyMatrix4(l),Zl.copy(e.ray).recast(e.near),(!1!==Fd.containsPoint(Zl.origin)||!(null===Zl.intersectSphere(Fd,cv)||Zl.origin.distanceToSquared(cv)>(e.far-e.near)**2))&&(b0.copy(l).invert(),Zl.copy(e.ray).applyMatrix4(b0),(null===r.boundingBox||!1!==Zl.intersectsBox(r.boundingBox))&&this._computeIntersections(e,t,Zl)))}_computeIntersections(e,t,r){let o;const l=this.geometry,u=this.material,h=l.index,p=l.attributes.position,m=l.attributes.uv,v=l.attributes.uv1,y=l.attributes.normal,M=l.groups,S=l.drawRange;if(null!==h)if(Array.isArray(u))for(let A=0,N=M.length;A<N;A++){const R=M[A],T=u[R.materialIndex];for(let F=Math.max(R.start,S.start),ne=Math.min(h.count,Math.min(R.start+R.count,S.start+S.count));F<ne;F+=3)o=Vd(this,T,e,r,m,v,y,h.getX(F),h.getX(F+1),h.getX(F+2)),o&&(o.faceIndex=Math.floor(F/3),o.face.materialIndex=R.materialIndex,t.push(o))}else for(let R=Math.max(0,S.start),T=Math.min(h.count,S.start+S.count);R<T;R+=3)o=Vd(this,u,e,r,m,v,y,h.getX(R),h.getX(R+1),h.getX(R+2)),o&&(o.faceIndex=Math.floor(R/3),t.push(o));else if(void 0!==p)if(Array.isArray(u))for(let A=0,N=M.length;A<N;A++){const R=M[A],T=u[R.materialIndex];for(let F=Math.max(R.start,S.start),ne=Math.min(p.count,Math.min(R.start+R.count,S.start+S.count));F<ne;F+=3)o=Vd(this,T,e,r,m,v,y,F,F+1,F+2),o&&(o.faceIndex=Math.floor(F/3),o.face.materialIndex=R.materialIndex,t.push(o))}else for(let R=Math.max(0,S.start),T=Math.min(p.count,S.start+S.count);R<T;R+=3)o=Vd(this,u,e,r,m,v,y,R,R+1,R+2),o&&(o.faceIndex=Math.floor(R/3),t.push(o))}}function Vd(c,e,t,r,o,l,u,h,p,m){c.getVertexPosition(h,Xo),c.getVertexPosition(p,Qh),c.getVertexPosition(m,Bc);const v=function uv(c,e,t,r,o,l,u,h){let p;if(p=1===e.side?r.intersectTriangle(u,l,o,!0,h):r.intersectTriangle(o,l,u,0===e.side,h),null===p)return null;Vu.copy(h),Vu.applyMatrix4(c.matrixWorld);const m=t.ray.origin.distanceTo(Vu);return m<t.near||m>t.far?null:{distance:m,point:Vu.clone(),object:c}}(c,e,t,r,Xo,Qh,Bc,Bd);if(v){const y=new ee;kn.getBarycoord(Bd,Xo,Qh,Bc,y),o&&(v.uv=kn.getInterpolatedAttribute(o,h,p,m,y,new Je)),l&&(v.uv1=kn.getInterpolatedAttribute(l,h,p,m,y,new Je)),u&&(v.normal=kn.getInterpolatedAttribute(u,h,p,m,y,new ee),v.normal.dot(r.direction)>0&&v.normal.multiplyScalar(-1));const M={a:h,b:p,c:m,normal:new ee,materialIndex:0};kn.getNormal(Xo,Qh,Bc,M.normal),v.face=M,v.barycoord=y}return v}class Vc extends si{constructor(e=1,t=1,r=1,o=1,l=1,u=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:o,heightSegments:l,depthSegments:u};const h=this;o=Math.floor(o),l=Math.floor(l),u=Math.floor(u);const p=[],m=[],v=[],y=[];let M=0,S=0;function A(N,R,T,B,V,F,ne,Q,te,se,X){const j=F/te,fe=ne/se,Re=F/2,Ce=ne/2,Fe=Q/2,st=te+1,Be=se+1;let bt=0,je=0;const Ot=new ee;for(let Xt=0;Xt<Be;Xt++){const on=Xt*fe-Ce;for(let oi=0;oi<st;oi++)Ot[N]=(oi*j-Re)*B,Ot[R]=on*V,Ot[T]=Fe,m.push(Ot.x,Ot.y,Ot.z),Ot[N]=0,Ot[R]=0,Ot[T]=Q>0?1:-1,v.push(Ot.x,Ot.y,Ot.z),y.push(oi/te),y.push(1-Xt/se),bt+=1}for(let Xt=0;Xt<se;Xt++)for(let on=0;on<te;on++){const Ni=M+on+st*(Xt+1),tt=M+(on+1)+st*(Xt+1),Ct=M+(on+1)+st*Xt;p.push(M+on+st*Xt,Ni,Ct),p.push(Ni,tt,Ct),je+=6}h.addGroup(S,je,X),S+=je,M+=bt}A("z","y","x",-1,-1,r,t,e,u,l,0),A("z","y","x",1,-1,r,t,-e,u,l,1),A("x","z","y",1,1,e,r,t,o,u,2),A("x","z","y",1,-1,e,r,-t,o,u,3),A("x","y","z",1,-1,e,t,r,o,l,4),A("x","y","z",-1,-1,e,t,-r,o,l,5),this.setIndex(p),this.setAttribute("position",new vn(m,3)),this.setAttribute("normal",new vn(v,3)),this.setAttribute("uv",new vn(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Vc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Hc(c){const e={};for(const t in c){e[t]={};for(const r in c[t]){const o=c[t][r];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture||o.isQuaternion)?o.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=o.clone():e[t][r]=Array.isArray(o)?o.slice():o}}return e}function fo(c){const e={};for(let t=0;t<c.length;t++){const r=Hc(c[t]);for(const o in r)e[o]=r[o]}return e}function Jl(c){const e=c.getRenderTarget();return null===e?c.outputColorSpace:!0===e.isXRRenderTarget?e.texture.colorSpace:fi.workingColorSpace}const S0={clone:Hc,merge:fo};class Co extends Wo{static get type(){return"ShaderMaterial"}constructor(e){super(),this.isShaderMaterial=!0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Hc(e.uniforms),this.uniformsGroups=function ef(c){const e=[];for(let t=0;t<c.length;t++)e.push(c[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const o in this.uniforms){const u=this.uniforms[o].value;t.uniforms[o]=u&&u.isTexture?{type:"t",value:u.toJSON(e).uuid}:u&&u.isColor?{type:"c",value:u.getHex()}:u&&u.isVector2?{type:"v2",value:u.toArray()}:u&&u.isVector3?{type:"v3",value:u.toArray()}:u&&u.isVector4?{type:"v4",value:u.toArray()}:u&&u.isMatrix3?{type:"m3",value:u.toArray()}:u&&u.isMatrix4?{type:"m4",value:u.toArray()}:{value:u}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const o in this.extensions)!0===this.extensions[o]&&(r[o]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class Ql extends ms{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new In,this.projectionMatrix=new In,this.projectionMatrixInverse=new In,this.coordinateSystem=rr}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const wr=new ee,fv=new Je,Wp=new Je;class ys extends Ql{constructor(e=50,t=1,r=.1,o=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=o,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*xo*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*tr*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*xo*Math.atan(Math.tan(.5*tr*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){wr.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(wr.x,wr.y).multiplyScalar(-e/wr.z),wr.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(wr.x,wr.y).multiplyScalar(-e/wr.z)}getViewSize(e,t){return this.getViewBounds(e,fv,Wp),t.subVectors(Wp,fv)}setViewOffset(e,t,r,o,l,u){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=o,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*tr*this.fov)/this.zoom,r=2*t,o=this.aspect*r,l=-.5*o;const u=this.view;if(null!==this.view&&this.view.enabled){const p=u.fullWidth,m=u.fullHeight;l+=u.offsetX*o/p,t-=u.offsetY*r/m,o*=u.width/p,r*=u.height/m}const h=this.filmOffset;0!==h&&(l+=e*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+o,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class jp extends ms{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const o=new ys(-90,1,e,t);o.layers=this.layers,this.add(o);const l=new ys(-90,1,e,t);l.layers=this.layers,this.add(l);const u=new ys(-90,1,e,t);u.layers=this.layers,this.add(u);const h=new ys(-90,1,e,t);h.layers=this.layers,this.add(h);const p=new ys(-90,1,e,t);p.layers=this.layers,this.add(p);const m=new ys(-90,1,e,t);m.layers=this.layers,this.add(m)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,o,l,u,h,p]=t;for(const m of t)this.remove(m);if(e===rr)r.up.set(0,1,0),r.lookAt(1,0,0),o.up.set(0,1,0),o.lookAt(-1,0,0),l.up.set(0,0,-1),l.lookAt(0,1,0),u.up.set(0,0,1),u.lookAt(0,-1,0),h.up.set(0,1,0),h.lookAt(0,0,1),p.up.set(0,1,0),p.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);r.up.set(0,-1,0),r.lookAt(-1,0,0),o.up.set(0,-1,0),o.lookAt(1,0,0),l.up.set(0,0,1),l.lookAt(0,1,0),u.up.set(0,0,-1),u.lookAt(0,-1,0),h.up.set(0,-1,0),h.lookAt(0,0,1),p.up.set(0,-1,0),p.lookAt(0,0,-1)}for(const m of t)this.add(m),m.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:o}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[l,u,h,p,m,v]=this.children,y=e.getRenderTarget(),M=e.getActiveCubeFace(),S=e.getActiveMipmapLevel(),A=e.xr.enabled;e.xr.enabled=!1;const N=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,o),e.render(t,l),e.setRenderTarget(r,1,o),e.render(t,u),e.setRenderTarget(r,2,o),e.render(t,h),e.setRenderTarget(r,3,o),e.render(t,p),e.setRenderTarget(r,4,o),e.render(t,m),r.texture.generateMipmaps=N,e.setRenderTarget(r,5,o),e.render(t,v),e.setRenderTarget(y,M,S),e.xr.enabled=A,r.texture.needsPMREMUpdate=!0}}class Ml extends Ii{constructor(e,t,r,o,l,u,h,p,m,v){super(e=void 0!==e?e:[],t=void 0!==t?t:Yi,r,o,l,u,h,p,m,v),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class zu extends Ds{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1};this.texture=new Ml([r,r,r,r,r,r],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:oe}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r_uniforms={tEquirect:{value:null}},r_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",o=new Vc(5,5,5),l=new Co({name:"CubemapFromEquirect",uniforms:Hc(r_uniforms),vertexShader:r_vertexShader,fragmentShader:r_fragmentShader,side:1,blending:0});l.uniforms.tEquirect.value=t;const u=new Rs(o,l),h=t.minFilter;return t.minFilter===Lt&&(t.minFilter=oe),new jp(1,10,this).update(e,u),t.minFilter=h,u.geometry.dispose(),u.material.dispose(),this}clear(e,t,r,o){const l=e.getRenderTarget();for(let u=0;u<6;u++)e.setRenderTarget(this,u),e.clear(t,r,o);e.setRenderTarget(l)}}const ec=new ee,pv=new ee,$p=new zn;class Yo{constructor(e=new ee(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,o){return this.normal.set(e,t,r),this.constant=o,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const o=ec.subVectors(r,t).cross(pv.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(o,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(ec),o=this.normal.dot(r);if(0===o)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/o;return l<0||l>1?null:t.copy(e.start).addScaledVector(r,l)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||$p.getNormalMatrix(e),o=this.coplanarPoint(ec).applyMatrix4(e),l=this.normal.applyMatrix3(r).normalize();return this.constant=-o.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Gu=new Br,tf=new ee;class Xp{constructor(e=new Yo,t=new Yo,r=new Yo,o=new Yo,l=new Yo,u=new Yo){this.planes=[e,t,r,o,l,u]}set(e,t,r,o,l,u){const h=this.planes;return h[0].copy(e),h[1].copy(t),h[2].copy(r),h[3].copy(o),h[4].copy(l),h[5].copy(u),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=rr){const r=this.planes,o=e.elements,l=o[0],u=o[1],h=o[2],p=o[3],m=o[4],v=o[5],y=o[6],M=o[7],S=o[8],A=o[9],N=o[10],R=o[11],T=o[12],B=o[13],V=o[14],F=o[15];if(r[0].setComponents(p-l,M-m,R-S,F-T).normalize(),r[1].setComponents(p+l,M+m,R+S,F+T).normalize(),r[2].setComponents(p+u,M+v,R+A,F+B).normalize(),r[3].setComponents(p-u,M-v,R-A,F-B).normalize(),r[4].setComponents(p-h,M-y,R-N,F-V).normalize(),t===rr)r[5].setComponents(p+h,M+y,R+N,F+V).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);r[5].setComponents(h,y,N,V).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Gu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Gu.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Gu)}intersectsSprite(e){return Gu.center.set(0,0,0),Gu.radius=.7071067811865476,Gu.applyMatrix4(e.matrixWorld),this.intersectsSphere(Gu)}intersectsSphere(e){const t=this.planes,r=e.center,o=-e.radius;for(let l=0;l<6;l++)if(t[l].distanceToPoint(r)<o)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const o=t[r];if(tf.x=o.normal.x>0?e.max.x:e.min.x,tf.y=o.normal.y>0?e.max.y:e.min.y,tf.z=o.normal.z>0?e.max.z:e.min.z,o.distanceToPoint(tf)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function w0(){let c=null,e=!1,t=null,r=null;function o(l,u){t(l,u),r=c.requestAnimationFrame(o)}return{start:function(){!0!==e&&null!==t&&(r=c.requestAnimationFrame(o),e=!0)},stop:function(){c.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(l){t=l},setContext:function(l){c=l}}}function db(c){const e=new WeakMap;return{get:function o(h){return h.isInterleavedBufferAttribute&&(h=h.data),e.get(h)},remove:function l(h){h.isInterleavedBufferAttribute&&(h=h.data);const p=e.get(h);p&&(c.deleteBuffer(p.buffer),e.delete(h))},update:function u(h,p){if(h.isInterleavedBufferAttribute&&(h=h.data),h.isGLBufferAttribute){const v=e.get(h);return void((!v||v.version<h.version)&&e.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version}))}const m=e.get(h);if(void 0===m)e.set(h,function t(h,p){const m=h.array,v=h.usage,y=m.byteLength,M=c.createBuffer();let S;if(c.bindBuffer(p,M),c.bufferData(p,m,v),h.onUploadCallback(),m instanceof Float32Array)S=c.FLOAT;else if(m instanceof Uint16Array)S=h.isFloat16BufferAttribute?c.HALF_FLOAT:c.UNSIGNED_SHORT;else if(m instanceof Int16Array)S=c.SHORT;else if(m instanceof Uint32Array)S=c.UNSIGNED_INT;else if(m instanceof Int32Array)S=c.INT;else if(m instanceof Int8Array)S=c.BYTE;else if(m instanceof Uint8Array)S=c.UNSIGNED_BYTE;else{if(!(m instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+m);S=c.UNSIGNED_BYTE}return{buffer:M,type:S,bytesPerElement:m.BYTES_PER_ELEMENT,version:h.version,size:y}}(h,p));else if(m.version<h.version){if(m.size!==h.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");(function r(h,p,m){const v=p.array,y=p.updateRanges;if(c.bindBuffer(m,h),0===y.length)c.bufferSubData(m,0,v);else{y.sort((S,A)=>S.start-A.start);let M=0;for(let S=1;S<y.length;S++){const A=y[M],N=y[S];N.start<=A.start+A.count+1?A.count=Math.max(A.count,N.start+N.count-A.start):(++M,y[M]=N)}y.length=M+1;for(let S=0,A=y.length;S<A;S++){const N=y[S];c.bufferSubData(m,N.start*v.BYTES_PER_ELEMENT,v,N.start,N.count)}p.clearUpdateRanges()}p.onUploadCallback()})(m.buffer,h,p),m.version=h.version}}}}class nf extends si{constructor(e=1,t=1,r=1,o=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:o};const l=e/2,u=t/2,h=Math.floor(r),p=Math.floor(o),m=h+1,v=p+1,y=e/h,M=t/p,S=[],A=[],N=[],R=[];for(let T=0;T<v;T++){const B=T*M-u;for(let V=0;V<m;V++)A.push(V*y-l,-B,0),N.push(0,0,1),R.push(V/h),R.push(1-T/p)}for(let T=0;T<p;T++)for(let B=0;B<h;B++){const F=B+m*(T+1),ne=B+1+m*(T+1),Q=B+1+m*T;S.push(B+m*T,F,Q),S.push(F,ne,Q)}this.setIndex(S),this.setAttribute("position",new vn(A,3)),this.setAttribute("normal",new vn(N,3)),this.setAttribute("uv",new vn(R,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nf(e.width,e.height,e.widthSegments,e.heightSegments)}}const pi={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t\n\t\t#else\n\t\t\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Gt={common:{diffuse:{value:new kt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new zn},alphaMap:{value:null},alphaMapTransform:{value:new zn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new zn}},envmap:{envMap:{value:null},envMapRotation:{value:new zn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new zn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new zn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new zn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new zn},normalScale:{value:new Je(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new zn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new zn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new zn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new zn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new kt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new kt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new zn},alphaTest:{value:0},uvTransform:{value:new zn}},sprite:{diffuse:{value:new kt(16777215)},opacity:{value:1},center:{value:new Je(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new zn},alphaMap:{value:null},alphaMapTransform:{value:new zn},alphaTest:{value:0}}},xl={basic:{uniforms:fo([Gt.common,Gt.specularmap,Gt.envmap,Gt.aomap,Gt.lightmap,Gt.fog]),vertexShader:pi.meshbasic_vert,fragmentShader:pi.meshbasic_frag},lambert:{uniforms:fo([Gt.common,Gt.specularmap,Gt.envmap,Gt.aomap,Gt.lightmap,Gt.emissivemap,Gt.bumpmap,Gt.normalmap,Gt.displacementmap,Gt.fog,Gt.lights,{emissive:{value:new kt(0)}}]),vertexShader:pi.meshlambert_vert,fragmentShader:pi.meshlambert_frag},phong:{uniforms:fo([Gt.common,Gt.specularmap,Gt.envmap,Gt.aomap,Gt.lightmap,Gt.emissivemap,Gt.bumpmap,Gt.normalmap,Gt.displacementmap,Gt.fog,Gt.lights,{emissive:{value:new kt(0)},specular:{value:new kt(1118481)},shininess:{value:30}}]),vertexShader:pi.meshphong_vert,fragmentShader:pi.meshphong_frag},standard:{uniforms:fo([Gt.common,Gt.envmap,Gt.aomap,Gt.lightmap,Gt.emissivemap,Gt.bumpmap,Gt.normalmap,Gt.displacementmap,Gt.roughnessmap,Gt.metalnessmap,Gt.fog,Gt.lights,{emissive:{value:new kt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:pi.meshphysical_vert,fragmentShader:pi.meshphysical_frag},toon:{uniforms:fo([Gt.common,Gt.aomap,Gt.lightmap,Gt.emissivemap,Gt.bumpmap,Gt.normalmap,Gt.displacementmap,Gt.gradientmap,Gt.fog,Gt.lights,{emissive:{value:new kt(0)}}]),vertexShader:pi.meshtoon_vert,fragmentShader:pi.meshtoon_frag},matcap:{uniforms:fo([Gt.common,Gt.bumpmap,Gt.normalmap,Gt.displacementmap,Gt.fog,{matcap:{value:null}}]),vertexShader:pi.meshmatcap_vert,fragmentShader:pi.meshmatcap_frag},points:{uniforms:fo([Gt.points,Gt.fog]),vertexShader:pi.points_vert,fragmentShader:pi.points_frag},dashed:{uniforms:fo([Gt.common,Gt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:pi.linedashed_vert,fragmentShader:pi.linedashed_frag},depth:{uniforms:fo([Gt.common,Gt.displacementmap]),vertexShader:pi.depth_vert,fragmentShader:pi.depth_frag},normal:{uniforms:fo([Gt.common,Gt.bumpmap,Gt.normalmap,Gt.displacementmap,{opacity:{value:1}}]),vertexShader:pi.meshnormal_vert,fragmentShader:pi.meshnormal_frag},sprite:{uniforms:fo([Gt.sprite,Gt.fog]),vertexShader:pi.sprite_vert,fragmentShader:pi.sprite_frag},background:{uniforms:{uvTransform:{value:new zn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:pi.background_vert,fragmentShader:pi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new zn}},vertexShader:pi.backgroundCube_vert,fragmentShader:pi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:pi.cube_vert,fragmentShader:pi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:pi.equirect_vert,fragmentShader:pi.equirect_frag},distanceRGBA:{uniforms:fo([Gt.common,Gt.displacementmap,{referencePosition:{value:new ee},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:pi.distanceRGBA_vert,fragmentShader:pi.distanceRGBA_frag},shadow:{uniforms:fo([Gt.lights,Gt.fog,{color:{value:new kt(0)},opacity:{value:1}}]),vertexShader:pi.shadow_vert,fragmentShader:pi.shadow_frag}};xl.physical={uniforms:fo([xl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new zn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new zn},clearcoatNormalScale:{value:new Je(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new zn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new zn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new zn},sheen:{value:0},sheenColor:{value:new kt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new zn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new zn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new zn},transmissionSamplerSize:{value:new Je},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new zn},attenuationDistance:{value:0},attenuationColor:{value:new kt(0)},specularColor:{value:new kt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new zn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new zn},anisotropyVector:{value:new Je},anisotropyMap:{value:null},anisotropyMapTransform:{value:new zn}}]),vertexShader:pi.meshphysical_vert,fragmentShader:pi.meshphysical_frag};const um={r:0,b:0,g:0},Ku=new Da,Pb=new In;function gM(c,e,t,r,o,l,u){const h=new kt(0);let m,v,p=!0===l?0:1,y=null,M=0,S=null;function A(B){let V=!0===B.isScene?B.background:null;return V&&V.isTexture&&(V=(B.backgroundBlurriness>0?t:e).get(V)),V}function T(B,V){B.getRGB(um,Jl(c)),r.buffers.color.setClear(um.r,um.g,um.b,V,u)}return{getClearColor:function(){return h},setClearColor:function(B,V=1){h.set(B),p=V,T(h,p)},getClearAlpha:function(){return p},setClearAlpha:function(B){p=B,T(h,p)},render:function N(B){let V=!1;const F=A(B);null===F?T(h,p):F&&F.isColor&&(T(F,1),V=!0);const ne=c.xr.getEnvironmentBlendMode();"additive"===ne?r.buffers.color.setClear(0,0,0,1,u):"alpha-blend"===ne&&r.buffers.color.setClear(0,0,0,0,u),(c.autoClear||V)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),c.clear(c.autoClearColor,c.autoClearDepth,c.autoClearStencil))},addToRenderList:function R(B,V){const F=A(V);F&&(F.isCubeTexture||F.mapping===ns)?(void 0===v&&(v=new Rs(new Vc(1,1,1),new Co({name:"BackgroundCubeMaterial",uniforms:Hc(xl.backgroundCube.uniforms),vertexShader:xl.backgroundCube.vertexShader,fragmentShader:xl.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),v.geometry.deleteAttribute("normal"),v.geometry.deleteAttribute("uv"),v.onBeforeRender=function(ne,Q,te){this.matrixWorld.copyPosition(te.matrixWorld)},Object.defineProperty(v.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),o.update(v)),Ku.copy(V.backgroundRotation),Ku.x*=-1,Ku.y*=-1,Ku.z*=-1,F.isCubeTexture&&!1===F.isRenderTargetTexture&&(Ku.y*=-1,Ku.z*=-1),v.material.uniforms.envMap.value=F,v.material.uniforms.flipEnvMap.value=F.isCubeTexture&&!1===F.isRenderTargetTexture?-1:1,v.material.uniforms.backgroundBlurriness.value=V.backgroundBlurriness,v.material.uniforms.backgroundIntensity.value=V.backgroundIntensity,v.material.uniforms.backgroundRotation.value.setFromMatrix4(Pb.makeRotationFromEuler(Ku)),v.material.toneMapped=fi.getTransfer(F.colorSpace)!==ki,(y!==F||M!==F.version||S!==c.toneMapping)&&(v.material.needsUpdate=!0,y=F,M=F.version,S=c.toneMapping),v.layers.enableAll(),B.unshift(v,v.geometry,v.material,0,0,null)):F&&F.isTexture&&(void 0===m&&(m=new Rs(new nf(2,2),new Co({name:"BackgroundMaterial",uniforms:Hc(xl.background.uniforms),vertexShader:xl.background.vertexShader,fragmentShader:xl.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),Object.defineProperty(m.material,"map",{get:function(){return this.uniforms.t2D.value}}),o.update(m)),m.material.uniforms.t2D.value=F,m.material.uniforms.backgroundIntensity.value=V.backgroundIntensity,m.material.toneMapped=fi.getTransfer(F.colorSpace)!==ki,!0===F.matrixAutoUpdate&&F.updateMatrix(),m.material.uniforms.uvTransform.value.copy(F.matrix),(y!==F||M!==F.version||S!==c.toneMapping)&&(m.material.needsUpdate=!0,y=F,M=F.version,S=c.toneMapping),m.layers.enableAll(),B.unshift(m,m.geometry,m.material,0,0,null))}}}function gf(c,e){const t=c.getParameter(c.MAX_VERTEX_ATTRIBS),r={},o=M(null);let l=o,u=!1;function m(j){return c.bindVertexArray(j)}function v(j){return c.deleteVertexArray(j)}function M(j){const fe=[],Re=[],Ce=[];for(let Fe=0;Fe<t;Fe++)fe[Fe]=0,Re[Fe]=0,Ce[Fe]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:fe,enabledAttributes:Re,attributeDivisors:Ce,object:j,attributes:{},index:null}}function N(){const j=l.newAttributes;for(let fe=0,Re=j.length;fe<Re;fe++)j[fe]=0}function R(j){T(j,0)}function T(j,fe){const Ce=l.enabledAttributes,Fe=l.attributeDivisors;l.newAttributes[j]=1,0===Ce[j]&&(c.enableVertexAttribArray(j),Ce[j]=1),Fe[j]!==fe&&(c.vertexAttribDivisor(j,fe),Fe[j]=fe)}function B(){const j=l.newAttributes,fe=l.enabledAttributes;for(let Re=0,Ce=fe.length;Re<Ce;Re++)fe[Re]!==j[Re]&&(c.disableVertexAttribArray(Re),fe[Re]=0)}function V(j,fe,Re,Ce,Fe,st,Be){!0===Be?c.vertexAttribIPointer(j,fe,Re,Fe,st):c.vertexAttribPointer(j,fe,Re,Ce,Fe,st)}function se(){X(),u=!0,l!==o&&(l=o,m(l.object))}function X(){o.geometry=null,o.program=null,o.wireframe=!1}return{setup:function h(j,fe,Re,Ce,Fe){let st=!1;const Be=function y(j,fe,Re){const Ce=!0===Re.wireframe;let Fe=r[j.id];void 0===Fe&&(Fe={},r[j.id]=Fe);let st=Fe[fe.id];void 0===st&&(st={},Fe[fe.id]=st);let Be=st[Ce];return void 0===Be&&(Be=M(function p(){return c.createVertexArray()}()),st[Ce]=Be),Be}(Ce,Re,fe);l!==Be&&(l=Be,m(l.object)),st=function S(j,fe,Re,Ce){const Fe=l.attributes,st=fe.attributes;let Be=0;const bt=Re.getAttributes();for(const je in bt)if(bt[je].location>=0){const Xt=Fe[je];let on=st[je];if(void 0===on&&("instanceMatrix"===je&&j.instanceMatrix&&(on=j.instanceMatrix),"instanceColor"===je&&j.instanceColor&&(on=j.instanceColor)),void 0===Xt||Xt.attribute!==on||on&&Xt.data!==on.data)return!0;Be++}return l.attributesNum!==Be||l.index!==Ce}(j,Ce,Re,Fe),st&&function A(j,fe,Re,Ce){const Fe={},st=fe.attributes;let Be=0;const bt=Re.getAttributes();for(const je in bt)if(bt[je].location>=0){let Xt=st[je];void 0===Xt&&("instanceMatrix"===je&&j.instanceMatrix&&(Xt=j.instanceMatrix),"instanceColor"===je&&j.instanceColor&&(Xt=j.instanceColor));const on={};on.attribute=Xt,Xt&&Xt.data&&(on.data=Xt.data),Fe[je]=on,Be++}l.attributes=Fe,l.attributesNum=Be,l.index=Ce}(j,Ce,Re,Fe),null!==Fe&&e.update(Fe,c.ELEMENT_ARRAY_BUFFER),(st||u)&&(u=!1,function F(j,fe,Re,Ce){N();const Fe=Ce.attributes,st=Re.getAttributes(),Be=fe.defaultAttributeValues;for(const bt in st){const je=st[bt];if(je.location>=0){let Ot=Fe[bt];if(void 0===Ot&&("instanceMatrix"===bt&&j.instanceMatrix&&(Ot=j.instanceMatrix),"instanceColor"===bt&&j.instanceColor&&(Ot=j.instanceColor)),void 0!==Ot){const Xt=Ot.normalized,on=Ot.itemSize,oi=e.get(Ot);if(void 0===oi)continue;const Ni=oi.buffer,tt=oi.type,Ct=oi.bytesPerElement,Yt=tt===c.INT||tt===c.UNSIGNED_INT||Ot.gpuType===Ti;if(Ot.isInterleavedBufferAttribute){const Pt=Ot.data,bn=Pt.stride,Yn=Ot.offset;if(Pt.isInstancedInterleavedBuffer){for(let Rn=0;Rn<je.locationSize;Rn++)T(je.location+Rn,Pt.meshPerAttribute);!0!==j.isInstancedMesh&&void 0===Ce._maxInstanceCount&&(Ce._maxInstanceCount=Pt.meshPerAttribute*Pt.count)}else for(let Rn=0;Rn<je.locationSize;Rn++)R(je.location+Rn);c.bindBuffer(c.ARRAY_BUFFER,Ni);for(let Rn=0;Rn<je.locationSize;Rn++)V(je.location+Rn,on/je.locationSize,tt,Xt,bn*Ct,(Yn+on/je.locationSize*Rn)*Ct,Yt)}else{if(Ot.isInstancedBufferAttribute){for(let Pt=0;Pt<je.locationSize;Pt++)T(je.location+Pt,Ot.meshPerAttribute);!0!==j.isInstancedMesh&&void 0===Ce._maxInstanceCount&&(Ce._maxInstanceCount=Ot.meshPerAttribute*Ot.count)}else for(let Pt=0;Pt<je.locationSize;Pt++)R(je.location+Pt);c.bindBuffer(c.ARRAY_BUFFER,Ni);for(let Pt=0;Pt<je.locationSize;Pt++)V(je.location+Pt,on/je.locationSize,tt,Xt,on*Ct,on/je.locationSize*Pt*Ct,Yt)}}else if(void 0!==Be){const Xt=Be[bt];if(void 0!==Xt)switch(Xt.length){case 2:c.vertexAttrib2fv(je.location,Xt);break;case 3:c.vertexAttrib3fv(je.location,Xt);break;case 4:c.vertexAttrib4fv(je.location,Xt);break;default:c.vertexAttrib1fv(je.location,Xt)}}}}B()}(j,fe,Re,Ce),null!==Fe&&c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,e.get(Fe).buffer))},reset:se,resetDefaultState:X,dispose:function ne(){se();for(const j in r){const fe=r[j];for(const Re in fe){const Ce=fe[Re];for(const Fe in Ce)v(Ce[Fe].object),delete Ce[Fe];delete fe[Re]}delete r[j]}},releaseStatesOfGeometry:function Q(j){if(void 0===r[j.id])return;const fe=r[j.id];for(const Re in fe){const Ce=fe[Re];for(const Fe in Ce)v(Ce[Fe].object),delete Ce[Fe];delete fe[Re]}delete r[j.id]},releaseStatesOfProgram:function te(j){for(const fe in r){const Re=r[fe];if(void 0===Re[j.id])continue;const Ce=Re[j.id];for(const Fe in Ce)v(Ce[Fe].object),delete Ce[Fe];delete Re[j.id]}},initAttributes:N,enableAttribute:R,disableUnusedAttributes:B}}function vf(c,e,t){let r;function u(m,v,y){0!==y&&(c.drawArraysInstanced(r,m,v,y),t.update(v,r,y))}this.setMode=function o(m){r=m},this.render=function l(m,v){c.drawArrays(r,m,v),t.update(v,r,1)},this.renderInstances=u,this.renderMultiDraw=function h(m,v,y){if(0===y)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,m,0,v,0,y);let S=0;for(let A=0;A<y;A++)S+=v[A];t.update(S,r,1)},this.renderMultiDrawInstances=function p(m,v,y,M){if(0===y)return;const S=e.get("WEBGL_multi_draw");if(null===S)for(let A=0;A<m.length;A++)u(m[A],v[A],M[A]);else{S.multiDrawArraysInstancedWEBGL(r,m,0,v,0,M,0,y);let A=0;for(let N=0;N<y;N++)A+=v[N]*M[N];t.update(A,r,1)}}}function dm(c,e,t,r){let o;function p(te){if("highp"===te){if(c.getShaderPrecisionFormat(c.VERTEX_SHADER,c.HIGH_FLOAT).precision>0&&c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.HIGH_FLOAT).precision>0)return"highp";te="mediump"}return"mediump"===te&&c.getShaderPrecisionFormat(c.VERTEX_SHADER,c.MEDIUM_FLOAT).precision>0&&c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let m=void 0!==t.precision?t.precision:"highp";const v=p(m);v!==m&&(console.warn("THREE.WebGLRenderer:",m,"not supported, using",v,"instead."),m=v);const y=!0===t.logarithmicDepthBuffer,M=!0===t.reverseDepthBuffer&&e.has("EXT_clip_control"),S=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS),A=c.getParameter(c.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function l(){if(void 0!==o)return o;if(!0===e.has("EXT_texture_filter_anisotropic")){const te=e.get("EXT_texture_filter_anisotropic");o=c.getParameter(te.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else o=0;return o},getMaxPrecision:p,textureFormatReadable:function u(te){return!(te!==br&&r.convert(te)!==c.getParameter(c.IMPLEMENTATION_COLOR_READ_FORMAT))},textureTypeReadable:function h(te){const se=te===to&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(te!==Bn&&r.convert(te)!==c.getParameter(c.IMPLEMENTATION_COLOR_READ_TYPE)&&te!==Fr&&!se)},precision:m,logarithmicDepthBuffer:y,reverseDepthBuffer:M,maxTextures:S,maxVertexTextures:A,maxTextureSize:c.getParameter(c.MAX_TEXTURE_SIZE),maxCubemapSize:c.getParameter(c.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:c.getParameter(c.MAX_VERTEX_ATTRIBS),maxVertexUniforms:c.getParameter(c.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:c.getParameter(c.MAX_VARYING_VECTORS),maxFragmentUniforms:c.getParameter(c.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:A>0,maxSamples:c.getParameter(c.MAX_SAMPLES)}}function Fv(c){const e=this;let t=null,r=0,o=!1,l=!1;const u=new Yo,h=new zn,p={value:null,needsUpdate:!1};function v(y,M,S,A){const N=null!==y?y.length:0;let R=null;if(0!==N){if(R=p.value,!0!==A||null===R){const T=S+4*N,B=M.matrixWorldInverse;h.getNormalMatrix(B),(null===R||R.length<T)&&(R=new Float32Array(T));for(let V=0,F=S;V!==N;++V,F+=4)u.copy(y[V]).applyMatrix4(B,h),u.normal.toArray(R,F),R[F+3]=u.constant}p.value=R,p.needsUpdate=!0}return e.numPlanes=N,e.numIntersection=0,R}this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(y,M){const S=0!==y.length||M||0!==r||o;return o=M,r=y.length,S},this.beginShadows=function(){l=!0,v(null)},this.endShadows=function(){l=!1},this.setGlobalState=function(y,M){t=v(y,M,0)},this.setState=function(y,M,S){const A=y.clippingPlanes,N=y.clipIntersection,R=y.clipShadows,T=c.get(y);if(!o||null===A||0===A.length||l&&!R)l?v(null):function m(){p.value!==t&&(p.value=t,p.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}();else{const B=l?0:r,V=4*B;let F=T.clippingState||null;p.value=F,F=v(A,M,V,S);for(let ne=0;ne!==V;++ne)F[ne]=t[ne];T.clippingState=F,this.numIntersection=N?this.numPlanes:0,this.numPlanes+=B}}}function Uv(c){let e=new WeakMap;function t(u,h){return 303===h?u.mapping=Yi:304===h&&(u.mapping=sn),u}function o(u){const h=u.target;h.removeEventListener("dispose",o);const p=e.get(h);void 0!==p&&(e.delete(h),p.dispose())}return{get:function r(u){if(u&&u.isTexture){const h=u.mapping;if(303===h||304===h){if(e.has(u))return t(e.get(u).texture,u.mapping);{const p=u.image;if(p&&p.height>0){const m=new zu(p.height);return m.fromEquirectangularTexture(c,u),e.set(u,m),u.addEventListener("dispose",o),t(m.texture,u.mapping)}return null}}}return u},dispose:function l(){e=new WeakMap}}}class nc extends Ql{constructor(e=-1,t=1,r=1,o=-1,l=.1,u=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=o,this.near=l,this.far=u,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,r,o,l,u){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=o,this.view.width=l,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,o=(this.top+this.bottom)/2;let l=r-e,u=r+e,h=o+t,p=o-t;if(null!==this.view&&this.view.enabled){const m=(this.right-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=m*this.view.offsetX,u=l+m*this.view.width,h-=v*this.view.offsetY,p=h-v*this.view.height}this.projectionMatrix.makeOrthographic(l,u,h,p,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const hm=[.125,.215,.35,.446,.526,.582],Ju=new nc,$d=new kt;let Qu=null,fm=0,pm=0,mm=!1;const rc=(1+Math.sqrt(5))/2,sc=1/rc,kv=[new ee(-rc,sc,0),new ee(rc,sc,0),new ee(-sc,0,rc),new ee(sc,0,rc),new ee(0,rc,-sc),new ee(0,rc,sc),new ee(-1,1,-1),new ee(1,1,-1),new ee(-1,1,1),new ee(1,1,1)];class Bv{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,o=100){Qu=this._renderer.getRenderTarget(),fm=this._renderer.getActiveCubeFace(),pm=this._renderer.getActiveMipmapLevel(),mm=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,r,o,l),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=_f(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=po(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Qu,fm,pm),this._renderer.xr.enabled=mm,e.scissorTest=!1,yf(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===Yi||e.mapping===sn?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Qu=this._renderer.getRenderTarget(),fm=this._renderer.getActiveCubeFace(),pm=this._renderer.getActiveMipmapLevel(),mm=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:oe,minFilter:oe,generateMipmaps:!1,type:to,format:br,colorSpace:Ai,depthBuffer:!1},o=gm(e,t,r);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=gm(e,t,r);const{_lodMax:l}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function vM(c){const e=[],t=[],r=[];let o=c;const l=c-4+1+hm.length;for(let u=0;u<l;u++){const h=Math.pow(2,o);t.push(h);let p=1/h;u>c-4?p=hm[u-c+4-1]:0===u&&(p=0),r.push(p);const m=1/(h-2),v=-m,y=1+m,M=[v,v,y,v,y,y,v,v,y,y,v,y],S=6,A=6,N=3,R=2,T=1,B=new Float32Array(N*A*S),V=new Float32Array(R*A*S),F=new Float32Array(T*A*S);for(let Q=0;Q<S;Q++){const te=Q%3*2/3-1,se=Q>2?0:-1;B.set([te,se,0,te+2/3,se,0,te+2/3,se+1,0,te,se,0,te+2/3,se+1,0,te,se+1,0],N*A*Q),V.set(M,R*A*Q),F.set([Q,Q,Q,Q,Q,Q],T*A*Q)}const ne=new si;ne.setAttribute("position",new xr(B,N)),ne.setAttribute("uv",new xr(V,R)),ne.setAttribute("faceIndex",new xr(F,T)),e.push(ne),o>4&&o--}return{lodPlanes:e,sizeLods:t,sigmas:r}}(l)),this._blurMaterial=function yM(c,e,t){const r=new Float32Array(20),o=new ee(0,1,0);return new Co({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${c}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:o}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(l,e,t)}return o}_compileMaterial(e){const t=new Rs(this._lodPlanes[0],e);this._renderer.compile(t,Ju)}_sceneToCubeUV(e,t,r,o){const h=new ys(90,1,t,r),p=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],v=this._renderer,y=v.autoClear,M=v.toneMapping;v.getClearColor($d),v.toneMapping=Gn,v.autoClear=!1;const S=new jo({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),A=new Rs(new Vc,S);let N=!1;const R=e.background;R?R.isColor&&(S.color.copy(R),e.background=null,N=!0):(S.color.copy($d),N=!0);for(let T=0;T<6;T++){const B=T%3;0===B?(h.up.set(0,p[T],0),h.lookAt(m[T],0,0)):1===B?(h.up.set(0,0,p[T]),h.lookAt(0,m[T],0)):(h.up.set(0,p[T],0),h.lookAt(0,0,m[T]));const V=this._cubeSize;yf(o,B*V,T>2?V:0,V,V),v.setRenderTarget(o),N&&v.render(A,h),v.render(e,h)}A.geometry.dispose(),A.material.dispose(),v.toneMapping=M,v.autoClear=y,e.background=R}_textureToCubeUV(e,t){const r=this._renderer,o=e.mapping===Yi||e.mapping===sn;o?(null===this._cubemapMaterial&&(this._cubemapMaterial=_f()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=po());const l=o?this._cubemapMaterial:this._equirectMaterial,u=new Rs(this._lodPlanes[0],l);l.uniforms.envMap.value=e;const p=this._cubeSize;yf(t,0,0,3*p,2*p),r.setRenderTarget(t),r.render(u,Ju)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;const o=this._lodPlanes.length;for(let l=1;l<o;l++){const u=Math.sqrt(this._sigmas[l]*this._sigmas[l]-this._sigmas[l-1]*this._sigmas[l-1]);this._blur(e,l-1,l,u,kv[(o-l-1)%kv.length])}t.autoClear=r}_blur(e,t,r,o,l){const u=this._pingPongRenderTarget;this._halfBlur(e,u,t,r,o,"latitudinal",l),this._halfBlur(u,e,r,r,o,"longitudinal",l)}_halfBlur(e,t,r,o,l,u,h){const p=this._renderer,m=this._blurMaterial;"latitudinal"!==u&&"longitudinal"!==u&&console.error("blur direction must be either latitudinal or longitudinal!");const y=new Rs(this._lodPlanes[o],m),M=m.uniforms,S=this._sizeLods[r]-1,A=isFinite(l)?Math.PI/(2*S):2*Math.PI/39,N=l/A,R=isFinite(l)?1+Math.floor(3*N):20;R>20&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${R} samples when the maximum is set to 20`);const T=[];let B=0;for(let te=0;te<20;++te){const se=te/N,X=Math.exp(-se*se/2);T.push(X),0===te?B+=X:te<R&&(B+=2*X)}for(let te=0;te<T.length;te++)T[te]=T[te]/B;M.envMap.value=e.texture,M.samples.value=R,M.weights.value=T,M.latitudinal.value="latitudinal"===u,h&&(M.poleAxis.value=h);const{_lodMax:V}=this;M.dTheta.value=A,M.mipInt.value=V-r;const F=this._sizeLods[o];yf(t,3*F*(o>V-4?o-V+4:0),4*(this._cubeSize-F),3*F,2*F),p.setRenderTarget(t),p.render(y,Ju)}}function gm(c,e,t){const r=new Ds(c,e,t);return r.texture.mapping=ns,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function yf(c,e,t,r,o){c.viewport.set(e,t,r,o),c.scissor.set(e,t,r,o)}function po(){return new Co({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function _f(){return new Co({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function vm(c){let e=new WeakMap,t=null;function l(h){const p=h.target;p.removeEventListener("dispose",l);const m=e.get(p);void 0!==m&&(e.delete(p),m.dispose())}return{get:function r(h){if(h&&h.isTexture){const p=h.mapping,m=303===p||304===p,v=p===Yi||p===sn;if(m||v){let y=e.get(h);if(h.isRenderTargetTexture&&h.pmremVersion!==(void 0!==y?y.texture.pmremVersion:0))return null===t&&(t=new Bv(c)),y=m?t.fromEquirectangular(h,y):t.fromCubemap(h,y),y.texture.pmremVersion=h.pmremVersion,e.set(h,y),y.texture;if(void 0!==y)return y.texture;{const S=h.image;return m&&S&&S.height>0||v&&S&&function o(h){let p=0;for(let v=0;v<6;v++)void 0!==h[v]&&p++;return 6===p}(S)?(null===t&&(t=new Bv(c)),y=m?t.fromEquirectangular(h):t.fromCubemap(h),y.texture.pmremVersion=h.pmremVersion,e.set(h,y),h.addEventListener("dispose",l),y.texture):null}}}return h},dispose:function u(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Zs(c){const e={};function t(r){if(void 0!==e[r])return e[r];let o;switch(r){case"WEBGL_depth_texture":o=c.getExtension("WEBGL_depth_texture")||c.getExtension("MOZ_WEBGL_depth_texture")||c.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":o=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":o=c.getExtension("WEBGL_compressed_texture_s3tc")||c.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||c.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":o=c.getExtension("WEBGL_compressed_texture_pvrtc")||c.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:o=c.getExtension(r)}return e[r]=o,o}return{has:function(r){return null!==t(r)},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(r){const o=t(r);return null===o&&Rc("THREE.WebGLRenderer: "+r+" extension not supported."),o}}}function Xd(c,e,t,r){const o={},l=new WeakMap;function u(y){const M=y.target;null!==M.index&&e.remove(M.index);for(const A in M.attributes)e.remove(M.attributes[A]);for(const A in M.morphAttributes){const N=M.morphAttributes[A];for(let R=0,T=N.length;R<T;R++)e.remove(N[R])}M.removeEventListener("dispose",u),delete o[M.id];const S=l.get(M);S&&(e.remove(S),l.delete(M)),r.releaseStatesOfGeometry(M),!0===M.isInstancedBufferGeometry&&delete M._maxInstanceCount,t.memory.geometries--}function m(y){const M=[],S=y.index,A=y.attributes.position;let N=0;if(null!==S){const B=S.array;N=S.version;for(let V=0,F=B.length;V<F;V+=3){const ne=B[V+0],Q=B[V+1],te=B[V+2];M.push(ne,Q,Q,te,te,ne)}}else{if(void 0===A)return;N=A.version;for(let V=0,F=A.array.length/3-1;V<F;V+=3){const ne=V+0,Q=V+1,te=V+2;M.push(ne,Q,Q,te,te,ne)}}const R=new(Rd(M)?lv:ov)(M,1);R.version=N;const T=l.get(y);T&&e.remove(T),l.set(y,R)}return{get:function h(y,M){return!0===o[M.id]||(M.addEventListener("dispose",u),o[M.id]=!0,t.memory.geometries++),M},update:function p(y){const M=y.attributes;for(const A in M)e.update(M[A],c.ARRAY_BUFFER);const S=y.morphAttributes;for(const A in S){const N=S[A];for(let R=0,T=N.length;R<T;R++)e.update(N[R],c.ARRAY_BUFFER)}},getWireframeAttribute:function v(y){const M=l.get(y);if(M){const S=y.index;null!==S&&M.version<S.version&&m(y)}else m(y);return l.get(y)}}}function Vv(c,e,t){let r,l,u;function m(M,S,A){0!==A&&(c.drawElementsInstanced(r,S,l,M*u,A),t.update(S,r,A))}this.setMode=function o(M){r=M},this.setIndex=function h(M){l=M.type,u=M.bytesPerElement},this.render=function p(M,S){c.drawElements(r,S,l,M*u),t.update(S,r,1)},this.renderInstances=m,this.renderMultiDraw=function v(M,S,A){if(0===A)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,S,0,l,M,0,A);let R=0;for(let T=0;T<A;T++)R+=S[T];t.update(R,r,1)},this.renderMultiDrawInstances=function y(M,S,A,N){if(0===A)return;const R=e.get("WEBGL_multi_draw");if(null===R)for(let T=0;T<M.length;T++)m(M[T]/u,S[T],N[T]);else{R.multiDrawElementsInstancedWEBGL(r,S,0,l,M,0,N,0,A);let T=0;for(let B=0;B<A;B++)T+=S[B]*N[B];t.update(T,r,1)}}}function Hv(c){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function o(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function r(l,u,h){switch(t.calls++,u){case c.TRIANGLES:t.triangles+=h*(l/3);break;case c.LINES:t.lines+=h*(l/2);break;case c.LINE_STRIP:t.lines+=h*(l-1);break;case c.LINE_LOOP:t.lines+=h*l;break;case c.POINTS:t.points+=h*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",u)}}}}function _M(c,e,t){const r=new WeakMap,o=new dn;return{update:function l(u,h,p){const m=u.morphTargetInfluences,v=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,y=void 0!==v?v.length:0;let M=r.get(h);if(void 0===M||M.count!==y){let X=function(){te.dispose(),r.delete(h),h.removeEventListener("dispose",X)};void 0!==M&&M.texture.dispose();const S=void 0!==h.morphAttributes.position,A=void 0!==h.morphAttributes.normal,N=void 0!==h.morphAttributes.color,R=h.morphAttributes.position||[],T=h.morphAttributes.normal||[],B=h.morphAttributes.color||[];let V=0;!0===S&&(V=1),!0===A&&(V=2),!0===N&&(V=3);let F=h.attributes.position.count*V,ne=1;F>e.maxTextureSize&&(ne=Math.ceil(F/e.maxTextureSize),F=e.maxTextureSize);const Q=new Float32Array(F*ne*4*y),te=new Gs(Q,F,ne,y);te.type=Fr,te.needsUpdate=!0;const se=4*V;for(let j=0;j<y;j++){const fe=R[j],Re=T[j],Ce=B[j],Fe=F*ne*4*j;for(let st=0;st<fe.count;st++){const Be=st*se;!0===S&&(o.fromBufferAttribute(fe,st),Q[Fe+Be+0]=o.x,Q[Fe+Be+1]=o.y,Q[Fe+Be+2]=o.z,Q[Fe+Be+3]=0),!0===A&&(o.fromBufferAttribute(Re,st),Q[Fe+Be+4]=o.x,Q[Fe+Be+5]=o.y,Q[Fe+Be+6]=o.z,Q[Fe+Be+7]=0),!0===N&&(o.fromBufferAttribute(Ce,st),Q[Fe+Be+8]=o.x,Q[Fe+Be+9]=o.y,Q[Fe+Be+10]=o.z,Q[Fe+Be+11]=4===Ce.itemSize?o.w:1)}}M={count:y,texture:te,size:new Je(F,ne)},r.set(h,M),h.addEventListener("dispose",X)}if(!0===u.isInstancedMesh&&null!==u.morphTexture)p.getUniforms().setValue(c,"morphTexture",u.morphTexture,t);else{let S=0;for(let N=0;N<m.length;N++)S+=m[N];const A=h.morphTargetsRelative?1:1-S;p.getUniforms().setValue(c,"morphTargetBaseInfluence",A),p.getUniforms().setValue(c,"morphTargetInfluences",m)}p.getUniforms().setValue(c,"morphTargetsTexture",M.texture,t),p.getUniforms().setValue(c,"morphTargetsTextureSize",M.size)}}}function zv(c,e,t,r){let o=new WeakMap;function h(p){const m=p.target;m.removeEventListener("dispose",h),t.remove(m.instanceMatrix),null!==m.instanceColor&&t.remove(m.instanceColor)}return{update:function l(p){const m=r.render.frame,y=e.get(p,p.geometry);if(o.get(y)!==m&&(e.update(y),o.set(y,m)),p.isInstancedMesh&&(!1===p.hasEventListener("dispose",h)&&p.addEventListener("dispose",h),o.get(p)!==m&&(t.update(p.instanceMatrix,c.ARRAY_BUFFER),null!==p.instanceColor&&t.update(p.instanceColor,c.ARRAY_BUFFER),o.set(p,m))),p.isSkinnedMesh){const M=p.skeleton;o.get(M)!==m&&(M.update(),o.set(M,m))}return y},dispose:function u(){o=new WeakMap}}}class Gv extends Ii{constructor(e,t,r,o,l,u,h,p,m,v=ve){if(v!==ve&&v!==ue)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&v===ve&&(r=Jt),void 0===r&&v===ue&&(r=gi),super(null,o,l,u,h,p,v,r,m),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==h?h:_i,this.minFilter=void 0!==p?p:_i,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}const ym=new Ii,Wv=new Gv(1,1),_m=new Gs,jv=new Ho,$v=new Ml,xf=[],Ef=[],Xv=new Float32Array(16),ed=new Float32Array(9),Yv=new Float32Array(4);function td(c,e,t){const r=c[0];if(r<=0||r>0)return c;const o=e*t;let l=xf[o];if(void 0===l&&(l=new Float32Array(o),xf[o]=l),0!==e){r.toArray(l,0);for(let u=1,h=0;u!==e;++u)h+=t,c[u].toArray(l,h)}return l}function _s(c,e){if(c.length!==e.length)return!1;for(let t=0,r=c.length;t<r;t++)if(c[t]!==e[t])return!1;return!0}function Ms(c,e){for(let t=0,r=e.length;t<r;t++)c[t]=e[t]}function Yd(c,e){let t=Ef[e];void 0===t&&(t=new Int32Array(e),Ef[e]=t);for(let r=0;r!==e;++r)t[r]=c.allocateTextureUnit();return t}function nd(c,e){const t=this.cache;t[0]!==e&&(c.uniform1f(this.addr,e),t[0]=e)}function bf(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(c.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_s(t,e))return;c.uniform2fv(this.addr,e),Ms(t,e)}}function qv(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(c.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(c.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(_s(t,e))return;c.uniform3fv(this.addr,e),Ms(t,e)}}function Mm(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(c.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_s(t,e))return;c.uniform4fv(this.addr,e),Ms(t,e)}}function Sf(c,e){const t=this.cache,r=e.elements;if(void 0===r){if(_s(t,e))return;c.uniformMatrix2fv(this.addr,!1,e),Ms(t,e)}else{if(_s(t,r))return;Yv.set(r),c.uniformMatrix2fv(this.addr,!1,Yv),Ms(t,r)}}function MM(c,e){const t=this.cache,r=e.elements;if(void 0===r){if(_s(t,e))return;c.uniformMatrix3fv(this.addr,!1,e),Ms(t,e)}else{if(_s(t,r))return;ed.set(r),c.uniformMatrix3fv(this.addr,!1,ed),Ms(t,r)}}function xM(c,e){const t=this.cache,r=e.elements;if(void 0===r){if(_s(t,e))return;c.uniformMatrix4fv(this.addr,!1,e),Ms(t,e)}else{if(_s(t,r))return;Xv.set(r),c.uniformMatrix4fv(this.addr,!1,Xv),Ms(t,r)}}function EM(c,e){const t=this.cache;t[0]!==e&&(c.uniform1i(this.addr,e),t[0]=e)}function bM(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(c.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_s(t,e))return;c.uniform2iv(this.addr,e),Ms(t,e)}}function SM(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(c.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(_s(t,e))return;c.uniform3iv(this.addr,e),Ms(t,e)}}function wM(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(c.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_s(t,e))return;c.uniform4iv(this.addr,e),Ms(t,e)}}function Kv(c,e){const t=this.cache;t[0]!==e&&(c.uniform1ui(this.addr,e),t[0]=e)}function qd(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(c.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_s(t,e))return;c.uniform2uiv(this.addr,e),Ms(t,e)}}function wf(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(c.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(_s(t,e))return;c.uniform3uiv(this.addr,e),Ms(t,e)}}function xm(c,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(c.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_s(t,e))return;c.uniform4uiv(this.addr,e),Ms(t,e)}}function CM(c,e,t){const r=this.cache,o=t.allocateTextureUnit();let l;r[0]!==o&&(c.uniform1i(this.addr,o),r[0]=o),this.type===c.SAMPLER_2D_SHADOW?(Wv.compareFunction=515,l=Wv):l=ym,t.setTexture2D(e||l,o)}function TM(c,e,t){const r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(c.uniform1i(this.addr,o),r[0]=o),t.setTexture3D(e||jv,o)}function Em(c,e,t){const r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(c.uniform1i(this.addr,o),r[0]=o),t.setTextureCube(e||$v,o)}function Zv(c,e,t){const r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(c.uniform1i(this.addr,o),r[0]=o),t.setTexture2DArray(e||_m,o)}function Jv(c,e){c.uniform1fv(this.addr,e)}function Qv(c,e){const t=td(e,this.size,2);c.uniform2fv(this.addr,t)}function AM(c,e){const t=td(e,this.size,3);c.uniform3fv(this.addr,t)}function Nb(c,e){const t=td(e,this.size,4);c.uniform4fv(this.addr,t)}function Cf(c,e){const t=td(e,this.size,4);c.uniformMatrix2fv(this.addr,!1,t)}function DM(c,e){const t=td(e,this.size,9);c.uniformMatrix3fv(this.addr,!1,t)}function ey(c,e){const t=td(e,this.size,16);c.uniformMatrix4fv(this.addr,!1,t)}function ty(c,e){c.uniform1iv(this.addr,e)}function ny(c,e){c.uniform2iv(this.addr,e)}function bm(c,e){c.uniform3iv(this.addr,e)}function iy(c,e){c.uniform4iv(this.addr,e)}function Tf(c,e){c.uniform1uiv(this.addr,e)}function Kd(c,e){c.uniform2uiv(this.addr,e)}function ry(c,e){c.uniform3uiv(this.addr,e)}function Sm(c,e){c.uniform4uiv(this.addr,e)}function Af(c,e,t){const r=this.cache,o=e.length,l=Yd(t,o);_s(r,l)||(c.uniform1iv(this.addr,l),Ms(r,l));for(let u=0;u!==o;++u)t.setTexture2D(e[u]||ym,l[u])}function sy(c,e,t){const r=this.cache,o=e.length,l=Yd(t,o);_s(r,l)||(c.uniform1iv(this.addr,l),Ms(r,l));for(let u=0;u!==o;++u)t.setTexture3D(e[u]||jv,l[u])}function wm(c,e,t){const r=this.cache,o=e.length,l=Yd(t,o);_s(r,l)||(c.uniform1iv(this.addr,l),Ms(r,l));for(let u=0;u!==o;++u)t.setTextureCube(e[u]||$v,l[u])}function Zd(c,e,t){const r=this.cache,o=e.length,l=Yd(t,o);_s(r,l)||(c.uniform1iv(this.addr,l),Ms(r,l));for(let u=0;u!==o;++u)t.setTexture2DArray(e[u]||_m,l[u])}class oy{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=function Yc(c){switch(c){case 5126:return nd;case 35664:return bf;case 35665:return qv;case 35666:return Mm;case 35674:return Sf;case 35675:return MM;case 35676:return xM;case 5124:case 35670:return EM;case 35667:case 35671:return bM;case 35668:case 35672:return SM;case 35669:case 35673:return wM;case 5125:return Kv;case 36294:return qd;case 36295:return wf;case 36296:return xm;case 35678:case 36198:case 36298:case 36306:case 35682:return CM;case 35679:case 36299:case 36307:return TM;case 35680:case 36300:case 36308:case 36293:return Em;case 36289:case 36303:case 36311:case 36292:return Zv}}(t.type)}}class RM{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function IM(c){switch(c){case 5126:return Jv;case 35664:return Qv;case 35665:return AM;case 35666:return Nb;case 35674:return Cf;case 35675:return DM;case 35676:return ey;case 5124:case 35670:return ty;case 35667:case 35671:return ny;case 35668:case 35672:return bm;case 35669:case 35673:return iy;case 5125:return Tf;case 36294:return Kd;case 36295:return ry;case 36296:return Sm;case 35678:case 36198:case 36298:case 36306:case 35682:return Af;case 35679:case 36299:case 36307:return sy;case 35680:case 36300:case 36308:case 36293:return wm;case 36289:case 36303:case 36311:case 36292:return Zd}}(t.type)}}class PM{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const o=this.seq;for(let l=0,u=o.length;l!==u;++l){const h=o[l];h.setValue(e,t[h.id],r)}}}const Cm=/(\w+)(\])?(\[|\.)?/g;function Tm(c,e){c.seq.push(e),c.map[e.id]=e}function ay(c,e,t){const r=c.name,o=r.length;for(Cm.lastIndex=0;;){const l=Cm.exec(r);let h=l[1];const m=l[3];if("]"===l[2]&&(h|=0),void 0===m||"["===m&&Cm.lastIndex+2===o){Tm(t,void 0===m?new oy(h,c,e):new RM(h,c,e));break}{let y=t.map[h];void 0===y&&(y=new PM(h),Tm(t,y)),t=y}}}class qc{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let o=0;o<r;++o){const l=e.getActiveUniform(t,o);ay(l,e.getUniformLocation(t,l.name),this)}}setValue(e,t,r,o){const l=this.map[t];void 0!==l&&l.setValue(e,r,o)}setOptional(e,t,r){const o=t[r];void 0!==o&&this.setValue(e,r,o)}static upload(e,t,r,o){for(let l=0,u=t.length;l!==u;++l){const h=t[l],p=r[h.id];!1!==p.needsUpdate&&h.setValue(e,p.value,o)}}static seqWithValue(e,t){const r=[];for(let o=0,l=e.length;o!==l;++o){const u=e[o];u.id in t&&r.push(u)}return r}}function Df(c,e,t){const r=c.createShader(e);return c.shaderSource(r,t),c.compileShader(r),r}const id=37297;let NM=0;const LM=new zn;function Jd(c,e,t){const r=c.getShaderParameter(e,c.COMPILE_STATUS),o=c.getShaderInfoLog(e).trim();if(r&&""===o)return"";const l=/ERROR: 0:(\d+)/.exec(o);if(l){const u=parseInt(l[1]);return t.toUpperCase()+"\n\n"+o+"\n\n"+function OM(c,e){const t=c.split("\n"),r=[],o=Math.max(e-6,0),l=Math.min(e+6,t.length);for(let u=o;u<l;u++){const h=u+1;r.push(`${h===e?">":" "} ${h}: ${t[u]}`)}return r.join("\n")}(c.getShaderSource(e),u)}return o}function Am(c,e){const t=function FM(c){fi._getMatrix(LM,fi.workingColorSpace,c);const e=`mat3( ${LM.elements.map(t=>t.toFixed(4))} )`;switch(fi.getTransfer(c)){case za:return[e,"LinearTransferOETF"];case ki:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",c),[e,"LinearTransferOETF"]}}(e);return[`vec4 ${c}( vec4 value ) {`,`\treturn ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join("\n")}function ly(c,e){let t;switch(e){case Ul:t="Linear";break;case Qs:t="Reinhard";break;case It:t="Cineon";break;case Kr:t="ACESFilmic";break;case bi:t="AgX";break;case Li:t="Neutral";break;case gr:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+c+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Qd=new ee;function eh(c){return""!==c}function uy(c,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return c.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function dy(c,e){return c.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const El=/^[ \t]*#include +<([\w\d./]+)>/gm;function oc(c){return c.replace(El,VM)}const BM=new Map;function VM(c,e){let t=pi[e];if(void 0===t){const r=BM.get(e);if(void 0===r)throw new Error("Can not resolve #include <"+e+">");t=pi[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r)}return oc(t)}const HM=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function hy(c){return c.replace(HM,zM)}function zM(c,e,t,r){let o="";for(let l=parseInt(e);l<parseInt(t);l++)o+=r.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return o}function fy(c){let e=`precision ${c.precision} float;\n\tprecision ${c.precision} int;\n\tprecision ${c.precision} sampler2D;\n\tprecision ${c.precision} samplerCube;\n\tprecision ${c.precision} sampler3D;\n\tprecision ${c.precision} sampler2DArray;\n\tprecision ${c.precision} sampler2DShadow;\n\tprecision ${c.precision} samplerCubeShadow;\n\tprecision ${c.precision} sampler2DArrayShadow;\n\tprecision ${c.precision} isampler2D;\n\tprecision ${c.precision} isampler3D;\n\tprecision ${c.precision} isamplerCube;\n\tprecision ${c.precision} isampler2DArray;\n\tprecision ${c.precision} usampler2D;\n\tprecision ${c.precision} usampler3D;\n\tprecision ${c.precision} usamplerCube;\n\tprecision ${c.precision} usampler2DArray;\n\t`;return"highp"===c.precision?e+="\n#define HIGH_PRECISION":"mediump"===c.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===c.precision&&(e+="\n#define LOW_PRECISION"),e}function If(c,e,t,r){const o=c.getContext(),l=t.defines;let u=t.vertexShader,h=t.fragmentShader;const p=function py(c){let e="SHADOWMAP_TYPE_BASIC";return c.shadowMapType===_n?e="SHADOWMAP_TYPE_PCF":c.shadowMapType===mi?e="SHADOWMAP_TYPE_PCF_SOFT":c.shadowMapType===ui&&(e="SHADOWMAP_TYPE_VSM"),e}(t),m=function GM(c){let e="ENVMAP_TYPE_CUBE";if(c.envMap)switch(c.envMapMode){case Yi:case sn:e="ENVMAP_TYPE_CUBE";break;case ns:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),v=function WM(c){let e="ENVMAP_MODE_REFLECTION";return c.envMap&&c.envMapMode===sn&&(e="ENVMAP_MODE_REFRACTION"),e}(t),y=function jM(c){let e="ENVMAP_BLENDING_NONE";if(c.envMap)switch(c.combine){case Ss:e="ENVMAP_BLENDING_MULTIPLY";break;case nn:e="ENVMAP_BLENDING_MIX";break;case ii:e="ENVMAP_BLENDING_ADD"}return e}(t),M=function $M(c){const e=c.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:r,maxMip:t}}(t),S=function Kc(c){return[c.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",c.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(eh).join("\n")}(t),A=function UM(c){const e=[];for(const t in c){const r=c[t];!1!==r&&e.push("#define "+t+" "+r)}return e.join("\n")}(l),N=o.createProgram();let R,T,B=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(R=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A].filter(eh).join("\n"),R.length>0&&(R+="\n"),T=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A].filter(eh).join("\n"),T.length>0&&(T+="\n")):(R=[fy(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+v:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(eh).join("\n"),T=[fy(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,A,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.envMap?"#define "+v:"",t.envMap?"#define "+y:"",M?"#define CUBEUV_TEXEL_WIDTH "+M.texelWidth:"",M?"#define CUBEUV_TEXEL_HEIGHT "+M.texelHeight:"",M?"#define CUBEUV_MAX_MIP "+M.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Gn?"#define TONE_MAPPING":"",t.toneMapping!==Gn?pi.tonemapping_pars_fragment:"",t.toneMapping!==Gn?ly("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",pi.colorspace_pars_fragment,Am("linearToOutputTexel",t.outputColorSpace),(fi.getLuminanceCoefficients(Qd),["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${Qd.x.toFixed(4)}, ${Qd.y.toFixed(4)}, ${Qd.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(eh).join("\n")),u=oc(u),u=uy(u,t),u=dy(u,t),h=oc(h),h=uy(h,t),h=dy(h,t),u=hy(u),h=hy(h),!0!==t.isRawShaderMaterial&&(B="#version 300 es\n",R=[S,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+R,T=["#define varying in",t.glslVersion===Cn?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Cn?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+T);const F=B+T+h,ne=Df(o,o.VERTEX_SHADER,B+R+u),Q=Df(o,o.FRAGMENT_SHADER,F);function te(fe){if(c.debug.checkShaderErrors){const Re=o.getProgramInfoLog(N).trim(),Ce=o.getShaderInfoLog(ne).trim(),Fe=o.getShaderInfoLog(Q).trim();let st=!0,Be=!0;if(!1===o.getProgramParameter(N,o.LINK_STATUS))if(st=!1,"function"==typeof c.debug.onShaderError)c.debug.onShaderError(o,N,ne,Q);else{const bt=Jd(o,ne,"vertex"),je=Jd(o,Q,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(N,o.VALIDATE_STATUS)+"\n\nMaterial Name: "+fe.name+"\nMaterial Type: "+fe.type+"\n\nProgram Info Log: "+Re+"\n"+bt+"\n"+je)}else""!==Re?console.warn("THREE.WebGLProgram: Program Info Log:",Re):(""===Ce||""===Fe)&&(Be=!1);Be&&(fe.diagnostics={runnable:st,programLog:Re,vertexShader:{log:Ce,prefix:R},fragmentShader:{log:Fe,prefix:T}})}o.deleteShader(ne),o.deleteShader(Q),se=new qc(o,N),X=function kM(c,e){const t={},r=c.getProgramParameter(e,c.ACTIVE_ATTRIBUTES);for(let o=0;o<r;o++){const l=c.getActiveAttrib(e,o),u=l.name;let h=1;l.type===c.FLOAT_MAT2&&(h=2),l.type===c.FLOAT_MAT3&&(h=3),l.type===c.FLOAT_MAT4&&(h=4),t[u]={type:l.type,location:c.getAttribLocation(e,u),locationSize:h}}return t}(o,N)}let se,X;o.attachShader(N,ne),o.attachShader(N,Q),void 0!==t.index0AttributeName?o.bindAttribLocation(N,0,t.index0AttributeName):!0===t.morphTargets&&o.bindAttribLocation(N,0,"position"),o.linkProgram(N),this.getUniforms=function(){return void 0===se&&te(this),se},this.getAttributes=function(){return void 0===X&&te(this),X};let j=!1===t.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===j&&(j=o.getProgramParameter(N,id)),j},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(N),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=NM++,this.cacheKey=e,this.usedTimes=1,this.program=N,this.vertexShader=ne,this.fragmentShader=Q,this}let bl=0;class th{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const r=e.fragmentShader,o=this._getShaderStage(e.vertexShader),l=this._getShaderStage(r),u=this._getShaderCacheForMaterial(e);return!1===u.has(o)&&(u.add(o),o.usedTimes++),!1===u.has(l)&&(u.add(l),l.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,0===r.usedTimes&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return void 0===r&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return void 0===r&&(r=new my(e),t.set(e,r)),r}}class my{constructor(e){this.id=bl++,this.code=e,this.usedTimes=0}}function gy(c,e,t,r,o,l,u){const h=new nr,p=new th,m=new Set,v=[],y=o.logarithmicDepthBuffer,M=o.vertexTextures;let S=o.precision;const A={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function N(X){return m.add(X),0===X?"uv":`uv${X}`}return{getParameters:function R(X,j,fe,Re,Ce){const Fe=Re.fog,st=Ce.geometry,bt=(X.isMeshStandardMaterial?t:e).get(X.envMap||(X.isMeshStandardMaterial?Re.environment:null)),je=bt&&bt.mapping===ns?bt.image.height:null,Ot=A[X.type];null!==X.precision&&(S=o.getMaxPrecision(X.precision),S!==X.precision&&console.warn("THREE.WebGLProgram.getParameters:",X.precision,"not supported, using",S,"instead."));const Xt=st.morphAttributes.position||st.morphAttributes.normal||st.morphAttributes.color,on=void 0!==Xt?Xt.length:0;let Ni,tt,Ct,Yt,oi=0;if(void 0!==st.morphAttributes.position&&(oi=1),void 0!==st.morphAttributes.normal&&(oi=2),void 0!==st.morphAttributes.color&&(oi=3),Ot){const fr=xl[Ot];Ni=fr.vertexShader,tt=fr.fragmentShader}else Ni=X.vertexShader,tt=X.fragmentShader,p.update(X),Ct=p.getVertexShaderID(X),Yt=p.getFragmentShaderID(X);const Pt=c.getRenderTarget(),bn=c.state.buffers.depth.getReversed(),Yn=!0===Ce.isInstancedMesh,Rn=!0===Ce.isBatchedMesh,Oi=!!X.map,Dt=!!bt,ce=!!X.aoMap,hn=!!X.lightMap,Et=!!X.bumpMap,ln=!!X.normalMap,Ut=!!X.displacementMap,Xn=!!X.emissiveMap,Kt=!!X.metalnessMap,re=!!X.roughnessMap,q=X.anisotropy>0,Ae=X.clearcoat>0,vt=X.iridescence>0,nt=X.sheen>0,gn=X.transmission>0,Ht=q&&!!X.anisotropyMap,rn=Ae&&!!X.clearcoatMap,Fi=Ae&&!!X.clearcoatNormalMap,At=Ae&&!!X.clearcoatRoughnessMap,pn=vt&&!!X.iridescenceMap,jn=vt&&!!X.iridescenceThicknessMap,Kn=nt&&!!X.sheenColorMap,fn=nt&&!!X.sheenRoughnessMap,Bi=!!X.specularMap,Ei=!!X.specularColorMap,Cr=!!X.specularIntensityMap,ye=gn&&!!X.transmissionMap,Wt=gn&&!!X.thicknessMap,ct=!!X.alphaMap,ei=!!X.extensions;let cs=Gn;X.toneMapped&&(null===Pt||!0===Pt.isXRRenderTarget)&&(cs=c.toneMapping);const ks={shaderID:Ot,shaderType:X.type,shaderName:X.name,vertexShader:Ni,fragmentShader:tt,defines:X.defines,customVertexShaderID:Ct,customFragmentShaderID:Yt,isRawShaderMaterial:!0===X.isRawShaderMaterial,glslVersion:X.glslVersion,precision:S,batching:Rn,batchingColor:Rn&&null!==Ce._colorsTexture,instancing:Yn,instancingColor:Yn&&null!==Ce.instanceColor,instancingMorph:Yn&&null!==Ce.morphTexture,supportsVertexTextures:M,outputColorSpace:null===Pt?c.outputColorSpace:!0===Pt.isXRRenderTarget?Pt.texture.colorSpace:Ai,alphaToCoverage:!!X.alphaToCoverage,map:Oi,matcap:!!X.matcap,envMap:Dt,envMapMode:Dt&&bt.mapping,envMapCubeUVHeight:je,aoMap:ce,lightMap:hn,bumpMap:Et,normalMap:ln,displacementMap:M&&Ut,emissiveMap:Xn,normalMapObjectSpace:ln&&1===X.normalMapType,normalMapTangentSpace:ln&&0===X.normalMapType,metalnessMap:Kt,roughnessMap:re,anisotropy:q,anisotropyMap:Ht,clearcoat:Ae,clearcoatMap:rn,clearcoatNormalMap:Fi,clearcoatRoughnessMap:At,dispersion:X.dispersion>0,iridescence:vt,iridescenceMap:pn,iridescenceThicknessMap:jn,sheen:nt,sheenColorMap:Kn,sheenRoughnessMap:fn,specularMap:Bi,specularColorMap:Ei,specularIntensityMap:Cr,transmission:gn,transmissionMap:ye,thicknessMap:Wt,gradientMap:!!X.gradientMap,opaque:!1===X.transparent&&1===X.blending&&!1===X.alphaToCoverage,alphaMap:ct,alphaTest:X.alphaTest>0,alphaHash:!!X.alphaHash,combine:X.combine,mapUv:Oi&&N(X.map.channel),aoMapUv:ce&&N(X.aoMap.channel),lightMapUv:hn&&N(X.lightMap.channel),bumpMapUv:Et&&N(X.bumpMap.channel),normalMapUv:ln&&N(X.normalMap.channel),displacementMapUv:Ut&&N(X.displacementMap.channel),emissiveMapUv:Xn&&N(X.emissiveMap.channel),metalnessMapUv:Kt&&N(X.metalnessMap.channel),roughnessMapUv:re&&N(X.roughnessMap.channel),anisotropyMapUv:Ht&&N(X.anisotropyMap.channel),clearcoatMapUv:rn&&N(X.clearcoatMap.channel),clearcoatNormalMapUv:Fi&&N(X.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:At&&N(X.clearcoatRoughnessMap.channel),iridescenceMapUv:pn&&N(X.iridescenceMap.channel),iridescenceThicknessMapUv:jn&&N(X.iridescenceThicknessMap.channel),sheenColorMapUv:Kn&&N(X.sheenColorMap.channel),sheenRoughnessMapUv:fn&&N(X.sheenRoughnessMap.channel),specularMapUv:Bi&&N(X.specularMap.channel),specularColorMapUv:Ei&&N(X.specularColorMap.channel),specularIntensityMapUv:Cr&&N(X.specularIntensityMap.channel),transmissionMapUv:ye&&N(X.transmissionMap.channel),thicknessMapUv:Wt&&N(X.thicknessMap.channel),alphaMapUv:ct&&N(X.alphaMap.channel),vertexTangents:!!st.attributes.tangent&&(ln||q),vertexColors:X.vertexColors,vertexAlphas:!0===X.vertexColors&&!!st.attributes.color&&4===st.attributes.color.itemSize,pointsUvs:!0===Ce.isPoints&&!!st.attributes.uv&&(Oi||ct),fog:!!Fe,useFog:!0===X.fog,fogExp2:!!Fe&&Fe.isFogExp2,flatShading:!0===X.flatShading,sizeAttenuation:!0===X.sizeAttenuation,logarithmicDepthBuffer:y,reverseDepthBuffer:bn,skinning:!0===Ce.isSkinnedMesh,morphTargets:void 0!==st.morphAttributes.position,morphNormals:void 0!==st.morphAttributes.normal,morphColors:void 0!==st.morphAttributes.color,morphTargetsCount:on,morphTextureStride:oi,numDirLights:j.directional.length,numPointLights:j.point.length,numSpotLights:j.spot.length,numSpotLightMaps:j.spotLightMap.length,numRectAreaLights:j.rectArea.length,numHemiLights:j.hemi.length,numDirLightShadows:j.directionalShadowMap.length,numPointLightShadows:j.pointShadowMap.length,numSpotLightShadows:j.spotShadowMap.length,numSpotLightShadowsWithMaps:j.numSpotLightShadowsWithMaps,numLightProbes:j.numLightProbes,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,dithering:X.dithering,shadowMapEnabled:c.shadowMap.enabled&&fe.length>0,shadowMapType:c.shadowMap.type,toneMapping:cs,decodeVideoTexture:Oi&&!0===X.map.isVideoTexture&&fi.getTransfer(X.map.colorSpace)===ki,decodeVideoTextureEmissive:Xn&&!0===X.emissiveMap.isVideoTexture&&fi.getTransfer(X.emissiveMap.colorSpace)===ki,premultipliedAlpha:X.premultipliedAlpha,doubleSided:2===X.side,flipSided:1===X.side,useDepthPacking:X.depthPacking>=0,depthPacking:X.depthPacking||0,index0AttributeName:X.index0AttributeName,extensionClipCullDistance:ei&&!0===X.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ei&&!0===X.extensions.multiDraw||Rn)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:X.customProgramCacheKey()};return ks.vertexUv1s=m.has(1),ks.vertexUv2s=m.has(2),ks.vertexUv3s=m.has(3),m.clear(),ks},getProgramCacheKey:function T(X){const j=[];if(X.shaderID?j.push(X.shaderID):(j.push(X.customVertexShaderID),j.push(X.customFragmentShaderID)),void 0!==X.defines)for(const fe in X.defines)j.push(fe),j.push(X.defines[fe]);return!1===X.isRawShaderMaterial&&(function B(X,j){X.push(j.precision),X.push(j.outputColorSpace),X.push(j.envMapMode),X.push(j.envMapCubeUVHeight),X.push(j.mapUv),X.push(j.alphaMapUv),X.push(j.lightMapUv),X.push(j.aoMapUv),X.push(j.bumpMapUv),X.push(j.normalMapUv),X.push(j.displacementMapUv),X.push(j.emissiveMapUv),X.push(j.metalnessMapUv),X.push(j.roughnessMapUv),X.push(j.anisotropyMapUv),X.push(j.clearcoatMapUv),X.push(j.clearcoatNormalMapUv),X.push(j.clearcoatRoughnessMapUv),X.push(j.iridescenceMapUv),X.push(j.iridescenceThicknessMapUv),X.push(j.sheenColorMapUv),X.push(j.sheenRoughnessMapUv),X.push(j.specularMapUv),X.push(j.specularColorMapUv),X.push(j.specularIntensityMapUv),X.push(j.transmissionMapUv),X.push(j.thicknessMapUv),X.push(j.combine),X.push(j.fogExp2),X.push(j.sizeAttenuation),X.push(j.morphTargetsCount),X.push(j.morphAttributeCount),X.push(j.numDirLights),X.push(j.numPointLights),X.push(j.numSpotLights),X.push(j.numSpotLightMaps),X.push(j.numHemiLights),X.push(j.numRectAreaLights),X.push(j.numDirLightShadows),X.push(j.numPointLightShadows),X.push(j.numSpotLightShadows),X.push(j.numSpotLightShadowsWithMaps),X.push(j.numLightProbes),X.push(j.shadowMapType),X.push(j.toneMapping),X.push(j.numClippingPlanes),X.push(j.numClipIntersection),X.push(j.depthPacking)}(j,X),function V(X,j){h.disableAll(),j.supportsVertexTextures&&h.enable(0),j.instancing&&h.enable(1),j.instancingColor&&h.enable(2),j.instancingMorph&&h.enable(3),j.matcap&&h.enable(4),j.envMap&&h.enable(5),j.normalMapObjectSpace&&h.enable(6),j.normalMapTangentSpace&&h.enable(7),j.clearcoat&&h.enable(8),j.iridescence&&h.enable(9),j.alphaTest&&h.enable(10),j.vertexColors&&h.enable(11),j.vertexAlphas&&h.enable(12),j.vertexUv1s&&h.enable(13),j.vertexUv2s&&h.enable(14),j.vertexUv3s&&h.enable(15),j.vertexTangents&&h.enable(16),j.anisotropy&&h.enable(17),j.alphaHash&&h.enable(18),j.batching&&h.enable(19),j.dispersion&&h.enable(20),j.batchingColor&&h.enable(21),X.push(h.mask),h.disableAll(),j.fog&&h.enable(0),j.useFog&&h.enable(1),j.flatShading&&h.enable(2),j.logarithmicDepthBuffer&&h.enable(3),j.reverseDepthBuffer&&h.enable(4),j.skinning&&h.enable(5),j.morphTargets&&h.enable(6),j.morphNormals&&h.enable(7),j.morphColors&&h.enable(8),j.premultipliedAlpha&&h.enable(9),j.shadowMapEnabled&&h.enable(10),j.doubleSided&&h.enable(11),j.flipSided&&h.enable(12),j.useDepthPacking&&h.enable(13),j.dithering&&h.enable(14),j.transmission&&h.enable(15),j.sheen&&h.enable(16),j.opaque&&h.enable(17),j.pointsUvs&&h.enable(18),j.decodeVideoTexture&&h.enable(19),j.decodeVideoTextureEmissive&&h.enable(20),j.alphaToCoverage&&h.enable(21),X.push(h.mask)}(j,X),j.push(c.outputColorSpace)),j.push(X.customProgramCacheKey),j.join()},getUniforms:function F(X){const j=A[X.type];let fe;return fe=j?S0.clone(xl[j].uniforms):X.uniforms,fe},acquireProgram:function ne(X,j){let fe;for(let Re=0,Ce=v.length;Re<Ce;Re++){const Fe=v[Re];if(Fe.cacheKey===j){fe=Fe,++fe.usedTimes;break}}return void 0===fe&&(fe=new If(c,j,X,l),v.push(fe)),fe},releaseProgram:function Q(X){if(0==--X.usedTimes){const j=v.indexOf(X);v[j]=v[v.length-1],v.pop(),X.destroy()}},releaseShaderCache:function te(X){p.remove(X)},programs:v,dispose:function se(){p.dispose()}}}function vy(){let c=new WeakMap;return{has:function e(u){return c.has(u)},get:function t(u){let h=c.get(u);return void 0===h&&(h={},c.set(u,h)),h},remove:function r(u){c.delete(u)},update:function o(u,h,p){c.get(u)[h]=p},dispose:function l(){c=new WeakMap}}}function Ob(c,e){return c.groupOrder!==e.groupOrder?c.groupOrder-e.groupOrder:c.renderOrder!==e.renderOrder?c.renderOrder-e.renderOrder:c.material.id!==e.material.id?c.material.id-e.material.id:c.z!==e.z?c.z-e.z:c.id-e.id}function XM(c,e){return c.groupOrder!==e.groupOrder?c.groupOrder-e.groupOrder:c.renderOrder!==e.renderOrder?c.renderOrder-e.renderOrder:c.z!==e.z?e.z-c.z:c.id-e.id}function YM(){const c=[];let e=0;const t=[],r=[],o=[];function u(y,M,S,A,N,R){let T=c[e];return void 0===T?(T={id:y.id,object:y,geometry:M,material:S,groupOrder:A,renderOrder:y.renderOrder,z:N,group:R},c[e]=T):(T.id=y.id,T.object=y,T.geometry=M,T.material=S,T.groupOrder=A,T.renderOrder=y.renderOrder,T.z=N,T.group=R),e++,T}return{opaque:t,transmissive:r,transparent:o,init:function l(){e=0,t.length=0,r.length=0,o.length=0},push:function h(y,M,S,A,N,R){const T=u(y,M,S,A,N,R);S.transmission>0?r.push(T):!0===S.transparent?o.push(T):t.push(T)},unshift:function p(y,M,S,A,N,R){const T=u(y,M,S,A,N,R);S.transmission>0?r.unshift(T):!0===S.transparent?o.unshift(T):t.unshift(T)},finish:function v(){for(let y=e,M=c.length;y<M;y++){const S=c[y];if(null===S.id)break;S.id=null,S.object=null,S.geometry=null,S.material=null,S.group=null}},sort:function m(y,M){t.length>1&&t.sort(y||Ob),r.length>1&&r.sort(M||XM),o.length>1&&o.sort(M||XM)}}}function Dm(){let c=new WeakMap;return{get:function e(r,o){const l=c.get(r);let u;return void 0===l?(u=new YM,c.set(r,[u])):o>=l.length?(u=new YM,l.push(u)):u=l[o],u},dispose:function t(){c=new WeakMap}}}function Im(){const c={};return{get:function(e){if(void 0!==c[e.id])return c[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ee,color:new kt};break;case"SpotLight":t={position:new ee,direction:new ee,color:new kt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ee,color:new kt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ee,skyColor:new kt,groundColor:new kt};break;case"RectAreaLight":t={color:new kt,position:new ee,halfWidth:new ee,halfHeight:new ee}}return c[e.id]=t,t}}}let Fb=0;function yy(c,e){return(e.castShadow?2:0)-(c.castShadow?2:0)+(e.map?1:0)-(c.map?1:0)}function qM(c){const e=new Im,t=function Lb(){const c={};return{get:function(e){if(void 0!==c[e.id])return c[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Je};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Je,shadowCameraNear:1,shadowCameraFar:1e3}}return c[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let m=0;m<9;m++)r.probe.push(new ee);const o=new ee,l=new In,u=new In;return{setup:function h(m){let v=0,y=0,M=0;for(let X=0;X<9;X++)r.probe[X].set(0,0,0);let S=0,A=0,N=0,R=0,T=0,B=0,V=0,F=0,ne=0,Q=0,te=0;m.sort(yy);for(let X=0,j=m.length;X<j;X++){const fe=m[X],Re=fe.color,Ce=fe.intensity,Fe=fe.distance,st=fe.shadow&&fe.shadow.map?fe.shadow.map.texture:null;if(fe.isAmbientLight)v+=Re.r*Ce,y+=Re.g*Ce,M+=Re.b*Ce;else if(fe.isLightProbe){for(let Be=0;Be<9;Be++)r.probe[Be].addScaledVector(fe.sh.coefficients[Be],Ce);te++}else if(fe.isDirectionalLight){const Be=e.get(fe);if(Be.color.copy(fe.color).multiplyScalar(fe.intensity),fe.castShadow){const bt=fe.shadow,je=t.get(fe);je.shadowIntensity=bt.intensity,je.shadowBias=bt.bias,je.shadowNormalBias=bt.normalBias,je.shadowRadius=bt.radius,je.shadowMapSize=bt.mapSize,r.directionalShadow[S]=je,r.directionalShadowMap[S]=st,r.directionalShadowMatrix[S]=fe.shadow.matrix,B++}r.directional[S]=Be,S++}else if(fe.isSpotLight){const Be=e.get(fe);Be.position.setFromMatrixPosition(fe.matrixWorld),Be.color.copy(Re).multiplyScalar(Ce),Be.distance=Fe,Be.coneCos=Math.cos(fe.angle),Be.penumbraCos=Math.cos(fe.angle*(1-fe.penumbra)),Be.decay=fe.decay,r.spot[N]=Be;const bt=fe.shadow;if(fe.map&&(r.spotLightMap[ne]=fe.map,ne++,bt.updateMatrices(fe),fe.castShadow&&Q++),r.spotLightMatrix[N]=bt.matrix,fe.castShadow){const je=t.get(fe);je.shadowIntensity=bt.intensity,je.shadowBias=bt.bias,je.shadowNormalBias=bt.normalBias,je.shadowRadius=bt.radius,je.shadowMapSize=bt.mapSize,r.spotShadow[N]=je,r.spotShadowMap[N]=st,F++}N++}else if(fe.isRectAreaLight){const Be=e.get(fe);Be.color.copy(Re).multiplyScalar(Ce),Be.halfWidth.set(.5*fe.width,0,0),Be.halfHeight.set(0,.5*fe.height,0),r.rectArea[R]=Be,R++}else if(fe.isPointLight){const Be=e.get(fe);if(Be.color.copy(fe.color).multiplyScalar(fe.intensity),Be.distance=fe.distance,Be.decay=fe.decay,fe.castShadow){const bt=fe.shadow,je=t.get(fe);je.shadowIntensity=bt.intensity,je.shadowBias=bt.bias,je.shadowNormalBias=bt.normalBias,je.shadowRadius=bt.radius,je.shadowMapSize=bt.mapSize,je.shadowCameraNear=bt.camera.near,je.shadowCameraFar=bt.camera.far,r.pointShadow[A]=je,r.pointShadowMap[A]=st,r.pointShadowMatrix[A]=fe.shadow.matrix,V++}r.point[A]=Be,A++}else if(fe.isHemisphereLight){const Be=e.get(fe);Be.skyColor.copy(fe.color).multiplyScalar(Ce),Be.groundColor.copy(fe.groundColor).multiplyScalar(Ce),r.hemi[T]=Be,T++}}R>0&&(!0===c.has("OES_texture_float_linear")?(r.rectAreaLTC1=Gt.LTC_FLOAT_1,r.rectAreaLTC2=Gt.LTC_FLOAT_2):(r.rectAreaLTC1=Gt.LTC_HALF_1,r.rectAreaLTC2=Gt.LTC_HALF_2)),r.ambient[0]=v,r.ambient[1]=y,r.ambient[2]=M;const se=r.hash;(se.directionalLength!==S||se.pointLength!==A||se.spotLength!==N||se.rectAreaLength!==R||se.hemiLength!==T||se.numDirectionalShadows!==B||se.numPointShadows!==V||se.numSpotShadows!==F||se.numSpotMaps!==ne||se.numLightProbes!==te)&&(r.directional.length=S,r.spot.length=N,r.rectArea.length=R,r.point.length=A,r.hemi.length=T,r.directionalShadow.length=B,r.directionalShadowMap.length=B,r.pointShadow.length=V,r.pointShadowMap.length=V,r.spotShadow.length=F,r.spotShadowMap.length=F,r.directionalShadowMatrix.length=B,r.pointShadowMatrix.length=V,r.spotLightMatrix.length=F+ne-Q,r.spotLightMap.length=ne,r.numSpotLightShadowsWithMaps=Q,r.numLightProbes=te,se.directionalLength=S,se.pointLength=A,se.spotLength=N,se.rectAreaLength=R,se.hemiLength=T,se.numDirectionalShadows=B,se.numPointShadows=V,se.numSpotShadows=F,se.numSpotMaps=ne,se.numLightProbes=te,r.version=Fb++)},setupView:function p(m,v){let y=0,M=0,S=0,A=0,N=0;const R=v.matrixWorldInverse;for(let T=0,B=m.length;T<B;T++){const V=m[T];if(V.isDirectionalLight){const F=r.directional[y];F.direction.setFromMatrixPosition(V.matrixWorld),o.setFromMatrixPosition(V.target.matrixWorld),F.direction.sub(o),F.direction.transformDirection(R),y++}else if(V.isSpotLight){const F=r.spot[S];F.position.setFromMatrixPosition(V.matrixWorld),F.position.applyMatrix4(R),F.direction.setFromMatrixPosition(V.matrixWorld),o.setFromMatrixPosition(V.target.matrixWorld),F.direction.sub(o),F.direction.transformDirection(R),S++}else if(V.isRectAreaLight){const F=r.rectArea[A];F.position.setFromMatrixPosition(V.matrixWorld),F.position.applyMatrix4(R),u.identity(),l.copy(V.matrixWorld),l.premultiply(R),u.extractRotation(l),F.halfWidth.set(.5*V.width,0,0),F.halfHeight.set(0,.5*V.height,0),F.halfWidth.applyMatrix4(u),F.halfHeight.applyMatrix4(u),A++}else if(V.isPointLight){const F=r.point[M];F.position.setFromMatrixPosition(V.matrixWorld),F.position.applyMatrix4(R),M++}else if(V.isHemisphereLight){const F=r.hemi[N];F.direction.setFromMatrixPosition(V.matrixWorld),F.direction.transformDirection(R),N++}}},state:r}}function _y(c){const e=new qM(c),t=[],r=[],m={lightsArray:t,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:function o(v){m.camera=v,t.length=0,r.length=0},state:m,setupLights:function h(){e.setup(t)},setupLightsView:function p(v){e.setupView(t,v)},pushLight:function l(v){t.push(v)},pushShadow:function u(v){r.push(v)}}}function KM(c){let e=new WeakMap;return{get:function t(o,l=0){const u=e.get(o);let h;return void 0===u?(h=new _y(c),e.set(o,[h])):l>=u.length?(h=new _y(c),u.push(h)):h=u[l],h},dispose:function r(){e=new WeakMap}}}class My extends Wo{static get type(){return"MeshDepthMaterial"}constructor(e){super(),this.isMeshDepthMaterial=!0,this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Rm extends Wo{static get type(){return"MeshDistanceMaterial"}constructor(e){super(),this.isMeshDistanceMaterial=!0,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Pm(c,e,t){let r=new Xp;const o=new Je,l=new Je,u=new dn,h=new My({depthPacking:3201}),p=new Rm,m={},v=t.maxTextureSize,y={0:1,1:0,2:2},M=new Co({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Je},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),S=M.clone();S.defines.HORIZONTAL_PASS=1;const A=new si;A.setAttribute("position",new xr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const N=new Rs(A,M),R=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=_n;let T=this.type;function B(Q,te){const se=e.update(N);M.defines.VSM_SAMPLES!==Q.blurSamples&&(M.defines.VSM_SAMPLES=Q.blurSamples,S.defines.VSM_SAMPLES=Q.blurSamples,M.needsUpdate=!0,S.needsUpdate=!0),null===Q.mapPass&&(Q.mapPass=new Ds(o.x,o.y)),M.uniforms.shadow_pass.value=Q.map.texture,M.uniforms.resolution.value=Q.mapSize,M.uniforms.radius.value=Q.radius,c.setRenderTarget(Q.mapPass),c.clear(),c.renderBufferDirect(te,null,se,M,N,null),S.uniforms.shadow_pass.value=Q.mapPass.texture,S.uniforms.resolution.value=Q.mapSize,S.uniforms.radius.value=Q.radius,c.setRenderTarget(Q.map),c.clear(),c.renderBufferDirect(te,null,se,S,N,null)}function V(Q,te,se,X){let j=null;const fe=!0===se.isPointLight?Q.customDistanceMaterial:Q.customDepthMaterial;if(void 0!==fe)j=fe;else if(j=!0===se.isPointLight?p:h,c.localClippingEnabled&&!0===te.clipShadows&&Array.isArray(te.clippingPlanes)&&0!==te.clippingPlanes.length||te.displacementMap&&0!==te.displacementScale||te.alphaMap&&te.alphaTest>0||te.map&&te.alphaTest>0){const Re=j.uuid,Ce=te.uuid;let Fe=m[Re];void 0===Fe&&(Fe={},m[Re]=Fe);let st=Fe[Ce];void 0===st&&(st=j.clone(),Fe[Ce]=st,te.addEventListener("dispose",ne)),j=st}return j.visible=te.visible,j.wireframe=te.wireframe,j.side=X===ui?null!==te.shadowSide?te.shadowSide:te.side:null!==te.shadowSide?te.shadowSide:y[te.side],j.alphaMap=te.alphaMap,j.alphaTest=te.alphaTest,j.map=te.map,j.clipShadows=te.clipShadows,j.clippingPlanes=te.clippingPlanes,j.clipIntersection=te.clipIntersection,j.displacementMap=te.displacementMap,j.displacementScale=te.displacementScale,j.displacementBias=te.displacementBias,j.wireframeLinewidth=te.wireframeLinewidth,j.linewidth=te.linewidth,!0===se.isPointLight&&!0===j.isMeshDistanceMaterial&&(c.properties.get(j).light=se),j}function F(Q,te,se,X,j){if(!1===Q.visible)return;if(Q.layers.test(te.layers)&&(Q.isMesh||Q.isLine||Q.isPoints)&&(Q.castShadow||Q.receiveShadow&&j===ui)&&(!Q.frustumCulled||r.intersectsObject(Q))){Q.modelViewMatrix.multiplyMatrices(se.matrixWorldInverse,Q.matrixWorld);const Ce=e.update(Q),Fe=Q.material;if(Array.isArray(Fe)){const st=Ce.groups;for(let Be=0,bt=st.length;Be<bt;Be++){const je=st[Be],Ot=Fe[je.materialIndex];if(Ot&&Ot.visible){const Xt=V(Q,Ot,X,j);Q.onBeforeShadow(c,Q,te,se,Ce,Xt,je),c.renderBufferDirect(se,null,Ce,Xt,Q,je),Q.onAfterShadow(c,Q,te,se,Ce,Xt,je)}}}else if(Fe.visible){const st=V(Q,Fe,X,j);Q.onBeforeShadow(c,Q,te,se,Ce,st,null),c.renderBufferDirect(se,null,Ce,st,Q,null),Q.onAfterShadow(c,Q,te,se,Ce,st,null)}}const Re=Q.children;for(let Ce=0,Fe=Re.length;Ce<Fe;Ce++)F(Re[Ce],te,se,X,j)}function ne(Q){Q.target.removeEventListener("dispose",ne);for(const se in m){const X=m[se],j=Q.target.uuid;j in X&&(X[j].dispose(),delete X[j])}}this.render=function(Q,te,se){if(!1===R.enabled||!1===R.autoUpdate&&!1===R.needsUpdate||0===Q.length)return;const X=c.getRenderTarget(),j=c.getActiveCubeFace(),fe=c.getActiveMipmapLevel(),Re=c.state;Re.setBlending(0),Re.buffers.color.setClear(1,1,1,1),Re.buffers.depth.setTest(!0),Re.setScissorTest(!1);const Ce=T!==ui&&this.type===ui,Fe=T===ui&&this.type!==ui;for(let st=0,Be=Q.length;st<Be;st++){const bt=Q[st],je=bt.shadow;if(void 0===je){console.warn("THREE.WebGLShadowMap:",bt,"has no shadow.");continue}if(!1===je.autoUpdate&&!1===je.needsUpdate)continue;o.copy(je.mapSize);const Ot=je.getFrameExtents();if(o.multiply(Ot),l.copy(je.mapSize),(o.x>v||o.y>v)&&(o.x>v&&(l.x=Math.floor(v/Ot.x),o.x=l.x*Ot.x,je.mapSize.x=l.x),o.y>v&&(l.y=Math.floor(v/Ot.y),o.y=l.y*Ot.y,je.mapSize.y=l.y)),null===je.map||!0===Ce||!0===Fe){const on=this.type!==ui?{minFilter:_i,magFilter:_i}:{};null!==je.map&&je.map.dispose(),je.map=new Ds(o.x,o.y,on),je.map.texture.name=bt.name+".shadowMap",je.camera.updateProjectionMatrix()}c.setRenderTarget(je.map),c.clear();const Xt=je.getViewportCount();for(let on=0;on<Xt;on++){const oi=je.getViewport(on);u.set(l.x*oi.x,l.y*oi.y,l.x*oi.z,l.y*oi.w),Re.viewport(u),je.updateMatrices(bt,on),r=je.getFrustum(),F(te,se,je.camera,bt,this.type)}!0!==je.isPointLightShadow&&this.type===ui&&B(je,se),je.needsUpdate=!1}T=this.type,R.needsUpdate=!1,c.setRenderTarget(X,j,fe)}}const ZM={0:1,2:6,4:7,3:5,1:0,6:2,7:4,5:3};function Zc(c,e){const l=new function t(){let ye=!1;const Wt=new dn;let Xe=null;const ct=new dn(0,0,0,0);return{setMask:function(Qt){Xe!==Qt&&!ye&&(c.colorMask(Qt,Qt,Qt,Qt),Xe=Qt)},setLocked:function(Qt){ye=Qt},setClear:function(Qt,Zt,ei,cs,ks){!0===ks&&(Qt*=cs,Zt*=cs,ei*=cs),Wt.set(Qt,Zt,ei,cs),!1===ct.equals(Wt)&&(c.clearColor(Qt,Zt,ei,cs),ct.copy(Wt))},reset:function(){ye=!1,Xe=null,ct.set(-1,0,0,0)}}},u=new function r(){let ye=!1,Wt=!1,Xe=null,ct=null,Qt=null;return{setReversed:function(Zt){if(Wt!==Zt){const ei=e.get("EXT_clip_control");ei.clipControlEXT(ei.LOWER_LEFT_EXT,Wt?ei.ZERO_TO_ONE_EXT:ei.NEGATIVE_ONE_TO_ONE_EXT);const cs=Qt;Qt=null,this.setClear(cs)}Wt=Zt},getReversed:function(){return Wt},setTest:function(Zt){Zt?Pt(c.DEPTH_TEST):bn(c.DEPTH_TEST)},setMask:function(Zt){Xe!==Zt&&!ye&&(c.depthMask(Zt),Xe=Zt)},setFunc:function(Zt){if(Wt&&(Zt=ZM[Zt]),ct!==Zt){switch(Zt){case 0:c.depthFunc(c.NEVER);break;case 1:c.depthFunc(c.ALWAYS);break;case 2:c.depthFunc(c.LESS);break;case 3:default:c.depthFunc(c.LEQUAL);break;case 4:c.depthFunc(c.EQUAL);break;case 5:c.depthFunc(c.GEQUAL);break;case 6:c.depthFunc(c.GREATER);break;case 7:c.depthFunc(c.NOTEQUAL)}ct=Zt}},setLocked:function(Zt){ye=Zt},setClear:function(Zt){Qt!==Zt&&(Wt&&(Zt=1-Zt),c.clearDepth(Zt),Qt=Zt)},reset:function(){ye=!1,Xe=null,ct=null,Qt=null,Wt=!1}}},h=new function o(){let ye=!1,Wt=null,Xe=null,ct=null,Qt=null,Zt=null,ei=null,cs=null,ks=null;return{setTest:function(fr){ye||(fr?Pt(c.STENCIL_TEST):bn(c.STENCIL_TEST))},setMask:function(fr){Wt!==fr&&!ye&&(c.stencilMask(fr),Wt=fr)},setFunc:function(fr,ba,ll){(Xe!==fr||ct!==ba||Qt!==ll)&&(c.stencilFunc(fr,ba,ll),Xe=fr,ct=ba,Qt=ll)},setOp:function(fr,ba,ll){(Zt!==fr||ei!==ba||cs!==ll)&&(c.stencilOp(fr,ba,ll),Zt=fr,ei=ba,cs=ll)},setLocked:function(fr){ye=fr},setClear:function(fr){ks!==fr&&(c.clearStencil(fr),ks=fr)},reset:function(){ye=!1,Wt=null,Xe=null,ct=null,Qt=null,Zt=null,ei=null,cs=null,ks=null}}},p=new WeakMap,m=new WeakMap;let v={},y={},M=new WeakMap,S=[],A=null,N=!1,R=null,T=null,B=null,V=null,F=null,ne=null,Q=null,te=new kt(0,0,0),se=0,X=!1,j=null,fe=null,Re=null,Ce=null,Fe=null;const st=c.getParameter(c.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Be=!1,bt=0;const je=c.getParameter(c.VERSION);-1!==je.indexOf("WebGL")?(bt=parseFloat(/^WebGL (\d)/.exec(je)[1]),Be=bt>=1):-1!==je.indexOf("OpenGL ES")&&(bt=parseFloat(/^OpenGL ES (\d)/.exec(je)[1]),Be=bt>=2);let Ot=null,Xt={};const on=c.getParameter(c.SCISSOR_BOX),oi=c.getParameter(c.VIEWPORT),Ni=(new dn).fromArray(on),tt=(new dn).fromArray(oi);function Ct(ye,Wt,Xe,ct){const Qt=new Uint8Array(4),Zt=c.createTexture();c.bindTexture(ye,Zt),c.texParameteri(ye,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(ye,c.TEXTURE_MAG_FILTER,c.NEAREST);for(let ei=0;ei<Xe;ei++)ye===c.TEXTURE_3D||ye===c.TEXTURE_2D_ARRAY?c.texImage3D(Wt,0,c.RGBA,1,1,ct,0,c.RGBA,c.UNSIGNED_BYTE,Qt):c.texImage2D(Wt+ei,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,Qt);return Zt}const Yt={};function Pt(ye){!0!==v[ye]&&(c.enable(ye),v[ye]=!0)}function bn(ye){!1!==v[ye]&&(c.disable(ye),v[ye]=!1)}Yt[c.TEXTURE_2D]=Ct(c.TEXTURE_2D,c.TEXTURE_2D,1),Yt[c.TEXTURE_CUBE_MAP]=Ct(c.TEXTURE_CUBE_MAP,c.TEXTURE_CUBE_MAP_POSITIVE_X,6),Yt[c.TEXTURE_2D_ARRAY]=Ct(c.TEXTURE_2D_ARRAY,c.TEXTURE_2D_ARRAY,1,1),Yt[c.TEXTURE_3D]=Ct(c.TEXTURE_3D,c.TEXTURE_3D,1,1),l.setClear(0,0,0,1),u.setClear(1),h.setClear(0),Pt(c.DEPTH_TEST),u.setFunc(3),Et(!1),ln(1),Pt(c.CULL_FACE),ce(0);const ft={100:c.FUNC_ADD,101:c.FUNC_SUBTRACT,102:c.FUNC_REVERSE_SUBTRACT};ft[103]=c.MIN,ft[104]=c.MAX;const Dt={200:c.ZERO,201:c.ONE,202:c.SRC_COLOR,204:c.SRC_ALPHA,210:c.SRC_ALPHA_SATURATE,208:c.DST_COLOR,206:c.DST_ALPHA,203:c.ONE_MINUS_SRC_COLOR,205:c.ONE_MINUS_SRC_ALPHA,209:c.ONE_MINUS_DST_COLOR,207:c.ONE_MINUS_DST_ALPHA,211:c.CONSTANT_COLOR,212:c.ONE_MINUS_CONSTANT_COLOR,213:c.CONSTANT_ALPHA,214:c.ONE_MINUS_CONSTANT_ALPHA};function ce(ye,Wt,Xe,ct,Qt,Zt,ei,cs,ks,fr){if(0!==ye){if(!1===N&&(Pt(c.BLEND),N=!0),5===ye)Qt=Qt||Wt,Zt=Zt||Xe,ei=ei||ct,(Wt!==T||Qt!==F)&&(c.blendEquationSeparate(ft[Wt],ft[Qt]),T=Wt,F=Qt),(Xe!==B||ct!==V||Zt!==ne||ei!==Q)&&(c.blendFuncSeparate(Dt[Xe],Dt[ct],Dt[Zt],Dt[ei]),B=Xe,V=ct,ne=Zt,Q=ei),(!1===cs.equals(te)||ks!==se)&&(c.blendColor(cs.r,cs.g,cs.b,ks),te.copy(cs),se=ks),R=ye,X=!1;else if(ye!==R||fr!==X){if((100!==T||100!==F)&&(c.blendEquation(c.FUNC_ADD),T=100,F=100),fr)switch(ye){case 1:c.blendFuncSeparate(c.ONE,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);break;case 2:c.blendFunc(c.ONE,c.ONE);break;case 3:c.blendFuncSeparate(c.ZERO,c.ONE_MINUS_SRC_COLOR,c.ZERO,c.ONE);break;case 4:c.blendFuncSeparate(c.ZERO,c.SRC_COLOR,c.ZERO,c.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ye)}else switch(ye){case 1:c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);break;case 2:c.blendFunc(c.SRC_ALPHA,c.ONE);break;case 3:c.blendFuncSeparate(c.ZERO,c.ONE_MINUS_SRC_COLOR,c.ZERO,c.ONE);break;case 4:c.blendFunc(c.ZERO,c.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ye)}B=null,V=null,ne=null,Q=null,te.set(0,0,0),se=0,R=ye,X=fr}}else!0===N&&(bn(c.BLEND),N=!1)}function Et(ye){j!==ye&&(c.frontFace(ye?c.CW:c.CCW),j=ye)}function ln(ye){0!==ye?(Pt(c.CULL_FACE),ye!==fe&&c.cullFace(1===ye?c.BACK:2===ye?c.FRONT:c.FRONT_AND_BACK)):bn(c.CULL_FACE),fe=ye}function Xn(ye,Wt,Xe){ye?(Pt(c.POLYGON_OFFSET_FILL),(Ce!==Wt||Fe!==Xe)&&(c.polygonOffset(Wt,Xe),Ce=Wt,Fe=Xe)):bn(c.POLYGON_OFFSET_FILL)}return{buffers:{color:l,depth:u,stencil:h},enable:Pt,disable:bn,bindFramebuffer:function Yn(ye,Wt){return y[ye]!==Wt&&(c.bindFramebuffer(ye,Wt),y[ye]=Wt,ye===c.DRAW_FRAMEBUFFER&&(y[c.FRAMEBUFFER]=Wt),ye===c.FRAMEBUFFER&&(y[c.DRAW_FRAMEBUFFER]=Wt),!0)},drawBuffers:function Rn(ye,Wt){let Xe=S,ct=!1;if(ye){Xe=M.get(Wt),void 0===Xe&&(Xe=[],M.set(Wt,Xe));const Qt=ye.textures;if(Xe.length!==Qt.length||Xe[0]!==c.COLOR_ATTACHMENT0){for(let Zt=0,ei=Qt.length;Zt<ei;Zt++)Xe[Zt]=c.COLOR_ATTACHMENT0+Zt;Xe.length=Qt.length,ct=!0}}else Xe[0]!==c.BACK&&(Xe[0]=c.BACK,ct=!0);ct&&c.drawBuffers(Xe)},useProgram:function Oi(ye){return A!==ye&&(c.useProgram(ye),A=ye,!0)},setBlending:ce,setMaterial:function hn(ye,Wt){2===ye.side?bn(c.CULL_FACE):Pt(c.CULL_FACE);let Xe=1===ye.side;Wt&&(Xe=!Xe),Et(Xe),1===ye.blending&&!1===ye.transparent?ce(0):ce(ye.blending,ye.blendEquation,ye.blendSrc,ye.blendDst,ye.blendEquationAlpha,ye.blendSrcAlpha,ye.blendDstAlpha,ye.blendColor,ye.blendAlpha,ye.premultipliedAlpha),u.setFunc(ye.depthFunc),u.setTest(ye.depthTest),u.setMask(ye.depthWrite),l.setMask(ye.colorWrite);const ct=ye.stencilWrite;h.setTest(ct),ct&&(h.setMask(ye.stencilWriteMask),h.setFunc(ye.stencilFunc,ye.stencilRef,ye.stencilFuncMask),h.setOp(ye.stencilFail,ye.stencilZFail,ye.stencilZPass)),Xn(ye.polygonOffset,ye.polygonOffsetFactor,ye.polygonOffsetUnits),!0===ye.alphaToCoverage?Pt(c.SAMPLE_ALPHA_TO_COVERAGE):bn(c.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Et,setCullFace:ln,setLineWidth:function Ut(ye){ye!==Re&&(Be&&c.lineWidth(ye),Re=ye)},setPolygonOffset:Xn,setScissorTest:function Kt(ye){ye?Pt(c.SCISSOR_TEST):bn(c.SCISSOR_TEST)},activeTexture:function re(ye){void 0===ye&&(ye=c.TEXTURE0+st-1),Ot!==ye&&(c.activeTexture(ye),Ot=ye)},bindTexture:function q(ye,Wt,Xe){void 0===Xe&&(Xe=null===Ot?c.TEXTURE0+st-1:Ot);let ct=Xt[Xe];void 0===ct&&(ct={type:void 0,texture:void 0},Xt[Xe]=ct),(ct.type!==ye||ct.texture!==Wt)&&(Ot!==Xe&&(c.activeTexture(Xe),Ot=Xe),c.bindTexture(ye,Wt||Yt[ye]),ct.type=ye,ct.texture=Wt)},unbindTexture:function Ae(){const ye=Xt[Ot];void 0!==ye&&void 0!==ye.type&&(c.bindTexture(ye.type,null),ye.type=void 0,ye.texture=void 0)},compressedTexImage2D:function Qe(){try{c.compressedTexImage2D.apply(c,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}},compressedTexImage3D:function vt(){try{c.compressedTexImage3D.apply(c,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}},texImage2D:function pn(){try{c.texImage2D.apply(c,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}},texImage3D:function jn(){try{c.texImage3D.apply(c,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}},updateUBOMapping:function Bi(ye,Wt){let Xe=m.get(Wt);void 0===Xe&&(Xe=new WeakMap,m.set(Wt,Xe));let ct=Xe.get(ye);void 0===ct&&(ct=c.getUniformBlockIndex(Wt,ye.name),Xe.set(ye,ct))},uniformBlockBinding:function Ei(ye,Wt){const ct=m.get(Wt).get(ye);p.get(Wt)!==ct&&(c.uniformBlockBinding(Wt,ct,ye.__bindingPointIndex),p.set(Wt,ct))},texStorage2D:function Fi(){try{c.texStorage2D.apply(c,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}},texStorage3D:function At(){try{c.texStorage3D.apply(c,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}},texSubImage2D:function nt(){try{c.texSubImage2D.apply(c,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}},texSubImage3D:function gn(){try{c.texSubImage3D.apply(c,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}},compressedTexSubImage2D:function Ht(){try{c.compressedTexSubImage2D.apply(c,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}},compressedTexSubImage3D:function rn(){try{c.compressedTexSubImage3D.apply(c,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}},scissor:function Kn(ye){!1===Ni.equals(ye)&&(c.scissor(ye.x,ye.y,ye.z,ye.w),Ni.copy(ye))},viewport:function fn(ye){!1===tt.equals(ye)&&(c.viewport(ye.x,ye.y,ye.z,ye.w),tt.copy(ye))},reset:function Cr(){c.disable(c.BLEND),c.disable(c.CULL_FACE),c.disable(c.DEPTH_TEST),c.disable(c.POLYGON_OFFSET_FILL),c.disable(c.SCISSOR_TEST),c.disable(c.STENCIL_TEST),c.disable(c.SAMPLE_ALPHA_TO_COVERAGE),c.blendEquation(c.FUNC_ADD),c.blendFunc(c.ONE,c.ZERO),c.blendFuncSeparate(c.ONE,c.ZERO,c.ONE,c.ZERO),c.blendColor(0,0,0,0),c.colorMask(!0,!0,!0,!0),c.clearColor(0,0,0,0),c.depthMask(!0),c.depthFunc(c.LESS),u.setReversed(!1),c.clearDepth(1),c.stencilMask(4294967295),c.stencilFunc(c.ALWAYS,0,4294967295),c.stencilOp(c.KEEP,c.KEEP,c.KEEP),c.clearStencil(0),c.cullFace(c.BACK),c.frontFace(c.CCW),c.polygonOffset(0,0),c.activeTexture(c.TEXTURE0),c.bindFramebuffer(c.FRAMEBUFFER,null),c.bindFramebuffer(c.DRAW_FRAMEBUFFER,null),c.bindFramebuffer(c.READ_FRAMEBUFFER,null),c.useProgram(null),c.lineWidth(1),c.scissor(0,0,c.canvas.width,c.canvas.height),c.viewport(0,0,c.canvas.width,c.canvas.height),v={},Ot=null,Xt={},y={},M=new WeakMap,S=[],A=null,N=!1,R=null,T=null,B=null,V=null,F=null,ne=null,Q=null,te=new kt(0,0,0),se=0,X=!1,j=null,fe=null,Re=null,Ce=null,Fe=null,Ni.set(0,0,c.canvas.width,c.canvas.height),tt.set(0,0,c.canvas.width,c.canvas.height),l.reset(),u.reset(),h.reset()}}}function Pf(c,e,t,r){const o=function ex(c){switch(c){case Bn:case Mi:return{byteLength:1,components:1};case _r:case yr:case to:return{byteLength:2,components:1};case ds:case Oo:return{byteLength:2,components:4};case Jt:case Ti:case Fr:return{byteLength:4,components:1};case wa:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${c}.`)}(r);switch(t){case Xs:case na:return c*e;case Ca:return c*e*2;case he:case Le:return c*e/o.components*o.byteLength;case at:case We:return c*e*2/o.components*o.byteLength;case Ls:return c*e*3/o.components*o.byteLength;case br:case Vn:return c*e*4/o.components*o.byteLength;case Bt:case Ui:return Math.floor((c+3)/4)*Math.floor((e+3)/4)*8;case wi:case Fn:return Math.floor((c+3)/4)*Math.floor((e+3)/4)*16;case Ur:case Jn:return Math.max(c,16)*Math.max(e,8)/4;case qi:case an:return Math.max(c,8)*Math.max(e,8)/2;case ti:case er:return Math.floor((c+3)/4)*Math.floor((e+3)/4)*8;case Cs:case ur:return Math.floor((c+3)/4)*Math.floor((e+3)/4)*16;case Ys:return Math.floor((c+4)/5)*Math.floor((e+3)/4)*16;case Fa:return Math.floor((c+4)/5)*Math.floor((e+4)/5)*16;case Vs:return Math.floor((c+5)/6)*Math.floor((e+4)/5)*16;case Lo:return Math.floor((c+5)/6)*Math.floor((e+5)/6)*16;case ia:return Math.floor((c+7)/8)*Math.floor((e+4)/5)*16;case kl:return Math.floor((c+7)/8)*Math.floor((e+5)/6)*16;case Fo:return Math.floor((c+7)/8)*Math.floor((e+7)/8)*16;case Jr:return Math.floor((c+9)/10)*Math.floor((e+4)/5)*16;case ra:return Math.floor((c+9)/10)*Math.floor((e+5)/6)*16;case Ua:return Math.floor((c+9)/10)*Math.floor((e+7)/8)*16;case ka:return Math.floor((c+9)/10)*Math.floor((e+9)/10)*16;case Ba:return Math.floor((c+11)/12)*Math.floor((e+9)/10)*16;case vo:return Math.floor((c+11)/12)*Math.floor((e+11)/12)*16;case yo:case Va:case hs:return Math.ceil(c/4)*Math.ceil(e/4)*16;case Ha:case dr:return Math.ceil(c/4)*Math.ceil(e/4)*8;case sa:case Hn:return Math.ceil(c/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function tx(c,e,t,r,o,l,u){const h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,p=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),m=new Je,v=new WeakMap;let y;const M=new WeakMap;let S=!1;try{S=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function A(re,q){return S?new OffscreenCanvas(re,q):Ic("canvas")}function N(re,q,Ae){let Qe=1;const vt=Kt(re);if((vt.width>Ae||vt.height>Ae)&&(Qe=Ae/Math.max(vt.width,vt.height)),Qe<1){if(typeof HTMLImageElement<"u"&&re instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&re instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&re instanceof ImageBitmap||typeof VideoFrame<"u"&&re instanceof VideoFrame){const nt=Math.floor(Qe*vt.width),gn=Math.floor(Qe*vt.height);void 0===y&&(y=A(nt,gn));const Ht=q?A(nt,gn):y;return Ht.width=nt,Ht.height=gn,Ht.getContext("2d").drawImage(re,0,0,nt,gn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+vt.width+"x"+vt.height+") to ("+nt+"x"+gn+")."),Ht}return"data"in re&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+vt.width+"x"+vt.height+")."),re}return re}function R(re){return re.generateMipmaps}function T(re){c.generateMipmap(re)}function B(re){return re.isWebGLCubeRenderTarget?c.TEXTURE_CUBE_MAP:re.isWebGL3DRenderTarget?c.TEXTURE_3D:re.isWebGLArrayRenderTarget||re.isCompressedArrayTexture?c.TEXTURE_2D_ARRAY:c.TEXTURE_2D}function V(re,q,Ae,Qe,vt=!1){if(null!==re){if(void 0!==c[re])return c[re];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+re+"'")}let nt=q;if(q===c.RED&&(Ae===c.FLOAT&&(nt=c.R32F),Ae===c.HALF_FLOAT&&(nt=c.R16F),Ae===c.UNSIGNED_BYTE&&(nt=c.R8)),q===c.RED_INTEGER&&(Ae===c.UNSIGNED_BYTE&&(nt=c.R8UI),Ae===c.UNSIGNED_SHORT&&(nt=c.R16UI),Ae===c.UNSIGNED_INT&&(nt=c.R32UI),Ae===c.BYTE&&(nt=c.R8I),Ae===c.SHORT&&(nt=c.R16I),Ae===c.INT&&(nt=c.R32I)),q===c.RG&&(Ae===c.FLOAT&&(nt=c.RG32F),Ae===c.HALF_FLOAT&&(nt=c.RG16F),Ae===c.UNSIGNED_BYTE&&(nt=c.RG8)),q===c.RG_INTEGER&&(Ae===c.UNSIGNED_BYTE&&(nt=c.RG8UI),Ae===c.UNSIGNED_SHORT&&(nt=c.RG16UI),Ae===c.UNSIGNED_INT&&(nt=c.RG32UI),Ae===c.BYTE&&(nt=c.RG8I),Ae===c.SHORT&&(nt=c.RG16I),Ae===c.INT&&(nt=c.RG32I)),q===c.RGB_INTEGER&&(Ae===c.UNSIGNED_BYTE&&(nt=c.RGB8UI),Ae===c.UNSIGNED_SHORT&&(nt=c.RGB16UI),Ae===c.UNSIGNED_INT&&(nt=c.RGB32UI),Ae===c.BYTE&&(nt=c.RGB8I),Ae===c.SHORT&&(nt=c.RGB16I),Ae===c.INT&&(nt=c.RGB32I)),q===c.RGBA_INTEGER&&(Ae===c.UNSIGNED_BYTE&&(nt=c.RGBA8UI),Ae===c.UNSIGNED_SHORT&&(nt=c.RGBA16UI),Ae===c.UNSIGNED_INT&&(nt=c.RGBA32UI),Ae===c.BYTE&&(nt=c.RGBA8I),Ae===c.SHORT&&(nt=c.RGBA16I),Ae===c.INT&&(nt=c.RGBA32I)),q===c.RGB&&Ae===c.UNSIGNED_INT_5_9_9_9_REV&&(nt=c.RGB9_E5),q===c.RGBA){const gn=vt?za:fi.getTransfer(Qe);Ae===c.FLOAT&&(nt=c.RGBA32F),Ae===c.HALF_FLOAT&&(nt=c.RGBA16F),Ae===c.UNSIGNED_BYTE&&(nt=gn===ki?c.SRGB8_ALPHA8:c.RGBA8),Ae===c.UNSIGNED_SHORT_4_4_4_4&&(nt=c.RGBA4),Ae===c.UNSIGNED_SHORT_5_5_5_1&&(nt=c.RGB5_A1)}return(nt===c.R16F||nt===c.R32F||nt===c.RG16F||nt===c.RG32F||nt===c.RGBA16F||nt===c.RGBA32F)&&e.get("EXT_color_buffer_float"),nt}function F(re,q){let Ae;return re?null===q||q===Jt||q===gi?Ae=c.DEPTH24_STENCIL8:q===Fr?Ae=c.DEPTH32F_STENCIL8:q===_r&&(Ae=c.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===q||q===Jt||q===gi?Ae=c.DEPTH_COMPONENT24:q===Fr?Ae=c.DEPTH_COMPONENT32F:q===_r&&(Ae=c.DEPTH_COMPONENT16),Ae}function ne(re,q){return!0===R(re)||re.isFramebufferTexture&&re.minFilter!==_i&&re.minFilter!==oe?Math.log2(Math.max(q.width,q.height))+1:void 0!==re.mipmaps&&re.mipmaps.length>0?re.mipmaps.length:re.isCompressedTexture&&Array.isArray(re.image)?q.mipmaps.length:1}function Q(re){const q=re.target;q.removeEventListener("dispose",Q),function se(re){const q=r.get(re);if(void 0===q.__webglInit)return;const Ae=re.source,Qe=M.get(Ae);if(Qe){const vt=Qe[q.__cacheKey];vt.usedTimes--,0===vt.usedTimes&&X(re),0===Object.keys(Qe).length&&M.delete(Ae)}r.remove(re)}(q),q.isVideoTexture&&v.delete(q)}function te(re){const q=re.target;q.removeEventListener("dispose",te),function j(re){const q=r.get(re);if(re.depthTexture&&(re.depthTexture.dispose(),r.remove(re.depthTexture)),re.isWebGLCubeRenderTarget)for(let Qe=0;Qe<6;Qe++){if(Array.isArray(q.__webglFramebuffer[Qe]))for(let vt=0;vt<q.__webglFramebuffer[Qe].length;vt++)c.deleteFramebuffer(q.__webglFramebuffer[Qe][vt]);else c.deleteFramebuffer(q.__webglFramebuffer[Qe]);q.__webglDepthbuffer&&c.deleteRenderbuffer(q.__webglDepthbuffer[Qe])}else{if(Array.isArray(q.__webglFramebuffer))for(let Qe=0;Qe<q.__webglFramebuffer.length;Qe++)c.deleteFramebuffer(q.__webglFramebuffer[Qe]);else c.deleteFramebuffer(q.__webglFramebuffer);if(q.__webglDepthbuffer&&c.deleteRenderbuffer(q.__webglDepthbuffer),q.__webglMultisampledFramebuffer&&c.deleteFramebuffer(q.__webglMultisampledFramebuffer),q.__webglColorRenderbuffer)for(let Qe=0;Qe<q.__webglColorRenderbuffer.length;Qe++)q.__webglColorRenderbuffer[Qe]&&c.deleteRenderbuffer(q.__webglColorRenderbuffer[Qe]);q.__webglDepthRenderbuffer&&c.deleteRenderbuffer(q.__webglDepthRenderbuffer)}const Ae=re.textures;for(let Qe=0,vt=Ae.length;Qe<vt;Qe++){const nt=r.get(Ae[Qe]);nt.__webglTexture&&(c.deleteTexture(nt.__webglTexture),u.memory.textures--),r.remove(Ae[Qe])}r.remove(re)}(q)}function X(re){const q=r.get(re);c.deleteTexture(q.__webglTexture),delete M.get(re.source)[q.__cacheKey],u.memory.textures--}let fe=0;function st(re,q){const Ae=r.get(re);if(re.isVideoTexture&&function Ut(re){const q=u.render.frame;v.get(re)!==q&&(v.set(re,q),re.update())}(re),!1===re.isRenderTargetTexture&&re.version>0&&Ae.__version!==re.version){const Qe=re.image;if(null===Qe)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Qe.complete)return void tt(Ae,re,q);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(c.TEXTURE_2D,Ae.__webglTexture,c.TEXTURE0+q)}const Ot={[ws]:c.REPEAT,[vr]:c.CLAMP_TO_EDGE,1002:c.MIRRORED_REPEAT},Xt={[_i]:c.NEAREST,1004:c.NEAREST_MIPMAP_NEAREST,[Oe]:c.NEAREST_MIPMAP_LINEAR,[oe]:c.LINEAR,1007:c.LINEAR_MIPMAP_NEAREST,[Lt]:c.LINEAR_MIPMAP_LINEAR},on={512:c.NEVER,519:c.ALWAYS,513:c.LESS,515:c.LEQUAL,514:c.EQUAL,518:c.GEQUAL,516:c.GREATER,517:c.NOTEQUAL};function oi(re,q){if(q.type===Fr&&!1===e.has("OES_texture_float_linear")&&(q.magFilter===oe||1007===q.magFilter||q.magFilter===Oe||q.magFilter===Lt||q.minFilter===oe||1007===q.minFilter||q.minFilter===Oe||q.minFilter===Lt)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),c.texParameteri(re,c.TEXTURE_WRAP_S,Ot[q.wrapS]),c.texParameteri(re,c.TEXTURE_WRAP_T,Ot[q.wrapT]),(re===c.TEXTURE_3D||re===c.TEXTURE_2D_ARRAY)&&c.texParameteri(re,c.TEXTURE_WRAP_R,Ot[q.wrapR]),c.texParameteri(re,c.TEXTURE_MAG_FILTER,Xt[q.magFilter]),c.texParameteri(re,c.TEXTURE_MIN_FILTER,Xt[q.minFilter]),q.compareFunction&&(c.texParameteri(re,c.TEXTURE_COMPARE_MODE,c.COMPARE_REF_TO_TEXTURE),c.texParameteri(re,c.TEXTURE_COMPARE_FUNC,on[q.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){if(q.magFilter===_i||q.minFilter!==Oe&&q.minFilter!==Lt||q.type===Fr&&!1===e.has("OES_texture_float_linear"))return;if(q.anisotropy>1||r.get(q).__currentAnisotropy){const Ae=e.get("EXT_texture_filter_anisotropic");c.texParameterf(re,Ae.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(q.anisotropy,o.getMaxAnisotropy())),r.get(q).__currentAnisotropy=q.anisotropy}}}function Ni(re,q){let Ae=!1;void 0===re.__webglInit&&(re.__webglInit=!0,q.addEventListener("dispose",Q));const Qe=q.source;let vt=M.get(Qe);void 0===vt&&(vt={},M.set(Qe,vt));const nt=function Fe(re){const q=[];return q.push(re.wrapS),q.push(re.wrapT),q.push(re.wrapR||0),q.push(re.magFilter),q.push(re.minFilter),q.push(re.anisotropy),q.push(re.internalFormat),q.push(re.format),q.push(re.type),q.push(re.generateMipmaps),q.push(re.premultiplyAlpha),q.push(re.flipY),q.push(re.unpackAlignment),q.push(re.colorSpace),q.join()}(q);if(nt!==re.__cacheKey){void 0===vt[nt]&&(vt[nt]={texture:c.createTexture(),usedTimes:0},u.memory.textures++,Ae=!0),vt[nt].usedTimes++;const gn=vt[re.__cacheKey];void 0!==gn&&(vt[re.__cacheKey].usedTimes--,0===gn.usedTimes&&X(q)),re.__cacheKey=nt,re.__webglTexture=vt[nt].texture}return Ae}function tt(re,q,Ae){let Qe=c.TEXTURE_2D;(q.isDataArrayTexture||q.isCompressedArrayTexture)&&(Qe=c.TEXTURE_2D_ARRAY),q.isData3DTexture&&(Qe=c.TEXTURE_3D);const vt=Ni(re,q),nt=q.source;t.bindTexture(Qe,re.__webglTexture,c.TEXTURE0+Ae);const gn=r.get(nt);if(nt.version!==gn.__version||!0===vt){t.activeTexture(c.TEXTURE0+Ae);const Ht=fi.getPrimaries(fi.workingColorSpace),rn=""===q.colorSpace?null:fi.getPrimaries(q.colorSpace),Fi=""===q.colorSpace||Ht===rn?c.NONE:c.BROWSER_DEFAULT_WEBGL;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,q.flipY),c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,q.premultiplyAlpha),c.pixelStorei(c.UNPACK_ALIGNMENT,q.unpackAlignment),c.pixelStorei(c.UNPACK_COLORSPACE_CONVERSION_WEBGL,Fi);let At=N(q.image,!1,o.maxTextureSize);At=Xn(q,At);const pn=l.convert(q.format,q.colorSpace),jn=l.convert(q.type);let fn,Kn=V(q.internalFormat,pn,jn,q.colorSpace,q.isVideoTexture);oi(Qe,q);const Bi=q.mipmaps,Ei=!0!==q.isVideoTexture,Cr=void 0===gn.__version||!0===vt,ye=nt.dataReady,Wt=ne(q,At);if(q.isDepthTexture)Kn=F(q.format===ue,q.type),Cr&&(Ei?t.texStorage2D(c.TEXTURE_2D,1,Kn,At.width,At.height):t.texImage2D(c.TEXTURE_2D,0,Kn,At.width,At.height,0,pn,jn,null));else if(q.isDataTexture)if(Bi.length>0){Ei&&Cr&&t.texStorage2D(c.TEXTURE_2D,Wt,Kn,Bi[0].width,Bi[0].height);for(let Xe=0,ct=Bi.length;Xe<ct;Xe++)fn=Bi[Xe],Ei?ye&&t.texSubImage2D(c.TEXTURE_2D,Xe,0,0,fn.width,fn.height,pn,jn,fn.data):t.texImage2D(c.TEXTURE_2D,Xe,Kn,fn.width,fn.height,0,pn,jn,fn.data);q.generateMipmaps=!1}else Ei?(Cr&&t.texStorage2D(c.TEXTURE_2D,Wt,Kn,At.width,At.height),ye&&t.texSubImage2D(c.TEXTURE_2D,0,0,0,At.width,At.height,pn,jn,At.data)):t.texImage2D(c.TEXTURE_2D,0,Kn,At.width,At.height,0,pn,jn,At.data);else if(q.isCompressedTexture)if(q.isCompressedArrayTexture){Ei&&Cr&&t.texStorage3D(c.TEXTURE_2D_ARRAY,Wt,Kn,Bi[0].width,Bi[0].height,At.depth);for(let Xe=0,ct=Bi.length;Xe<ct;Xe++)if(fn=Bi[Xe],q.format!==br)if(null!==pn)if(Ei){if(ye)if(q.layerUpdates.size>0){const Qt=Pf(fn.width,fn.height,q.format,q.type);for(const Zt of q.layerUpdates){const ei=fn.data.subarray(Zt*Qt/fn.data.BYTES_PER_ELEMENT,(Zt+1)*Qt/fn.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(c.TEXTURE_2D_ARRAY,Xe,0,0,Zt,fn.width,fn.height,1,pn,ei)}q.clearLayerUpdates()}else t.compressedTexSubImage3D(c.TEXTURE_2D_ARRAY,Xe,0,0,0,fn.width,fn.height,At.depth,pn,fn.data)}else t.compressedTexImage3D(c.TEXTURE_2D_ARRAY,Xe,Kn,fn.width,fn.height,At.depth,0,fn.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Ei?ye&&t.texSubImage3D(c.TEXTURE_2D_ARRAY,Xe,0,0,0,fn.width,fn.height,At.depth,pn,jn,fn.data):t.texImage3D(c.TEXTURE_2D_ARRAY,Xe,Kn,fn.width,fn.height,At.depth,0,pn,jn,fn.data)}else{Ei&&Cr&&t.texStorage2D(c.TEXTURE_2D,Wt,Kn,Bi[0].width,Bi[0].height);for(let Xe=0,ct=Bi.length;Xe<ct;Xe++)fn=Bi[Xe],q.format!==br?null!==pn?Ei?ye&&t.compressedTexSubImage2D(c.TEXTURE_2D,Xe,0,0,fn.width,fn.height,pn,fn.data):t.compressedTexImage2D(c.TEXTURE_2D,Xe,Kn,fn.width,fn.height,0,fn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ei?ye&&t.texSubImage2D(c.TEXTURE_2D,Xe,0,0,fn.width,fn.height,pn,jn,fn.data):t.texImage2D(c.TEXTURE_2D,Xe,Kn,fn.width,fn.height,0,pn,jn,fn.data)}else if(q.isDataArrayTexture)if(Ei){if(Cr&&t.texStorage3D(c.TEXTURE_2D_ARRAY,Wt,Kn,At.width,At.height,At.depth),ye)if(q.layerUpdates.size>0){const Xe=Pf(At.width,At.height,q.format,q.type);for(const ct of q.layerUpdates){const Qt=At.data.subarray(ct*Xe/At.data.BYTES_PER_ELEMENT,(ct+1)*Xe/At.data.BYTES_PER_ELEMENT);t.texSubImage3D(c.TEXTURE_2D_ARRAY,0,0,0,ct,At.width,At.height,1,pn,jn,Qt)}q.clearLayerUpdates()}else t.texSubImage3D(c.TEXTURE_2D_ARRAY,0,0,0,0,At.width,At.height,At.depth,pn,jn,At.data)}else t.texImage3D(c.TEXTURE_2D_ARRAY,0,Kn,At.width,At.height,At.depth,0,pn,jn,At.data);else if(q.isData3DTexture)Ei?(Cr&&t.texStorage3D(c.TEXTURE_3D,Wt,Kn,At.width,At.height,At.depth),ye&&t.texSubImage3D(c.TEXTURE_3D,0,0,0,0,At.width,At.height,At.depth,pn,jn,At.data)):t.texImage3D(c.TEXTURE_3D,0,Kn,At.width,At.height,At.depth,0,pn,jn,At.data);else if(q.isFramebufferTexture){if(Cr)if(Ei)t.texStorage2D(c.TEXTURE_2D,Wt,Kn,At.width,At.height);else{let Xe=At.width,ct=At.height;for(let Qt=0;Qt<Wt;Qt++)t.texImage2D(c.TEXTURE_2D,Qt,Kn,Xe,ct,0,pn,jn,null),Xe>>=1,ct>>=1}}else if(Bi.length>0){if(Ei&&Cr){const Xe=Kt(Bi[0]);t.texStorage2D(c.TEXTURE_2D,Wt,Kn,Xe.width,Xe.height)}for(let Xe=0,ct=Bi.length;Xe<ct;Xe++)fn=Bi[Xe],Ei?ye&&t.texSubImage2D(c.TEXTURE_2D,Xe,0,0,pn,jn,fn):t.texImage2D(c.TEXTURE_2D,Xe,Kn,pn,jn,fn);q.generateMipmaps=!1}else if(Ei){if(Cr){const Xe=Kt(At);t.texStorage2D(c.TEXTURE_2D,Wt,Kn,Xe.width,Xe.height)}ye&&t.texSubImage2D(c.TEXTURE_2D,0,0,0,pn,jn,At)}else t.texImage2D(c.TEXTURE_2D,0,Kn,pn,jn,At);R(q)&&T(Qe),gn.__version=nt.version,q.onUpdate&&q.onUpdate(q)}re.__version=q.version}function Yt(re,q,Ae,Qe,vt,nt){const gn=l.convert(Ae.format,Ae.colorSpace),Ht=l.convert(Ae.type),rn=V(Ae.internalFormat,gn,Ht,Ae.colorSpace),Fi=r.get(q),At=r.get(Ae);if(At.__renderTarget=q,!Fi.__hasExternalTextures){const pn=Math.max(1,q.width>>nt),jn=Math.max(1,q.height>>nt);vt===c.TEXTURE_3D||vt===c.TEXTURE_2D_ARRAY?t.texImage3D(vt,nt,rn,pn,jn,q.depth,0,gn,Ht,null):t.texImage2D(vt,nt,rn,pn,jn,0,gn,Ht,null)}t.bindFramebuffer(c.FRAMEBUFFER,re),ln(q)?h.framebufferTexture2DMultisampleEXT(c.FRAMEBUFFER,Qe,vt,At.__webglTexture,0,Et(q)):(vt===c.TEXTURE_2D||vt>=c.TEXTURE_CUBE_MAP_POSITIVE_X&&vt<=c.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&c.framebufferTexture2D(c.FRAMEBUFFER,Qe,vt,At.__webglTexture,nt),t.bindFramebuffer(c.FRAMEBUFFER,null)}function Pt(re,q,Ae){if(c.bindRenderbuffer(c.RENDERBUFFER,re),q.depthBuffer){const Qe=q.depthTexture,nt=F(q.stencilBuffer,Qe&&Qe.isDepthTexture?Qe.type:null),gn=q.stencilBuffer?c.DEPTH_STENCIL_ATTACHMENT:c.DEPTH_ATTACHMENT,Ht=Et(q);ln(q)?h.renderbufferStorageMultisampleEXT(c.RENDERBUFFER,Ht,nt,q.width,q.height):Ae?c.renderbufferStorageMultisample(c.RENDERBUFFER,Ht,nt,q.width,q.height):c.renderbufferStorage(c.RENDERBUFFER,nt,q.width,q.height),c.framebufferRenderbuffer(c.FRAMEBUFFER,gn,c.RENDERBUFFER,re)}else{const Qe=q.textures;for(let vt=0;vt<Qe.length;vt++){const nt=Qe[vt],gn=l.convert(nt.format,nt.colorSpace),Ht=l.convert(nt.type),rn=V(nt.internalFormat,gn,Ht,nt.colorSpace),Fi=Et(q);Ae&&!1===ln(q)?c.renderbufferStorageMultisample(c.RENDERBUFFER,Fi,rn,q.width,q.height):ln(q)?h.renderbufferStorageMultisampleEXT(c.RENDERBUFFER,Fi,rn,q.width,q.height):c.renderbufferStorage(c.RENDERBUFFER,rn,q.width,q.height)}}c.bindRenderbuffer(c.RENDERBUFFER,null)}function Yn(re){const q=r.get(re),Ae=!0===re.isWebGLCubeRenderTarget;if(q.__boundDepthTexture!==re.depthTexture){const Qe=re.depthTexture;if(q.__depthDisposeCallback&&q.__depthDisposeCallback(),Qe){const vt=()=>{delete q.__boundDepthTexture,delete q.__depthDisposeCallback,Qe.removeEventListener("dispose",vt)};Qe.addEventListener("dispose",vt),q.__depthDisposeCallback=vt}q.__boundDepthTexture=Qe}if(re.depthTexture&&!q.__autoAllocateDepthBuffer){if(Ae)throw new Error("target.depthTexture not supported in Cube render targets");!function bn(re,q){if(q&&q.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(c.FRAMEBUFFER,re),!q.depthTexture||!q.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Qe=r.get(q.depthTexture);Qe.__renderTarget=q,(!Qe.__webglTexture||q.depthTexture.image.width!==q.width||q.depthTexture.image.height!==q.height)&&(q.depthTexture.image.width=q.width,q.depthTexture.image.height=q.height,q.depthTexture.needsUpdate=!0),st(q.depthTexture,0);const vt=Qe.__webglTexture,nt=Et(q);if(q.depthTexture.format===ve)ln(q)?h.framebufferTexture2DMultisampleEXT(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.TEXTURE_2D,vt,0,nt):c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.TEXTURE_2D,vt,0);else{if(q.depthTexture.format!==ue)throw new Error("Unknown depthTexture format");ln(q)?h.framebufferTexture2DMultisampleEXT(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,vt,0,nt):c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,vt,0)}}(q.__webglFramebuffer,re)}else if(Ae){q.__webglDepthbuffer=[];for(let Qe=0;Qe<6;Qe++)if(t.bindFramebuffer(c.FRAMEBUFFER,q.__webglFramebuffer[Qe]),void 0===q.__webglDepthbuffer[Qe])q.__webglDepthbuffer[Qe]=c.createRenderbuffer(),Pt(q.__webglDepthbuffer[Qe],re,!1);else{const vt=re.stencilBuffer?c.DEPTH_STENCIL_ATTACHMENT:c.DEPTH_ATTACHMENT,nt=q.__webglDepthbuffer[Qe];c.bindRenderbuffer(c.RENDERBUFFER,nt),c.framebufferRenderbuffer(c.FRAMEBUFFER,vt,c.RENDERBUFFER,nt)}}else if(t.bindFramebuffer(c.FRAMEBUFFER,q.__webglFramebuffer),void 0===q.__webglDepthbuffer)q.__webglDepthbuffer=c.createRenderbuffer(),Pt(q.__webglDepthbuffer,re,!1);else{const Qe=re.stencilBuffer?c.DEPTH_STENCIL_ATTACHMENT:c.DEPTH_ATTACHMENT,vt=q.__webglDepthbuffer;c.bindRenderbuffer(c.RENDERBUFFER,vt),c.framebufferRenderbuffer(c.FRAMEBUFFER,Qe,c.RENDERBUFFER,vt)}t.bindFramebuffer(c.FRAMEBUFFER,null)}const Dt=[],ce=[];function Et(re){return Math.min(o.maxSamples,re.samples)}function ln(re){const q=r.get(re);return re.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==q.__useRenderToTexture}function Xn(re,q){const Ae=re.colorSpace,Qe=re.format,vt=re.type;return!0===re.isCompressedTexture||!0===re.isVideoTexture||Ae!==Ai&&""!==Ae&&(fi.getTransfer(Ae)===ki?(Qe!==br||vt!==Bn)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ae)),q}function Kt(re){return typeof HTMLImageElement<"u"&&re instanceof HTMLImageElement?(m.width=re.naturalWidth||re.width,m.height=re.naturalHeight||re.height):typeof VideoFrame<"u"&&re instanceof VideoFrame?(m.width=re.displayWidth,m.height=re.displayHeight):(m.width=re.width,m.height=re.height),m}this.allocateTextureUnit=function Ce(){const re=fe;return re>=o.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+re+" texture units while this GPU supports only "+o.maxTextures),fe+=1,re},this.resetTextureUnits=function Re(){fe=0},this.setTexture2D=st,this.setTexture2DArray=function Be(re,q){const Ae=r.get(re);re.version>0&&Ae.__version!==re.version?tt(Ae,re,q):t.bindTexture(c.TEXTURE_2D_ARRAY,Ae.__webglTexture,c.TEXTURE0+q)},this.setTexture3D=function bt(re,q){const Ae=r.get(re);re.version>0&&Ae.__version!==re.version?tt(Ae,re,q):t.bindTexture(c.TEXTURE_3D,Ae.__webglTexture,c.TEXTURE0+q)},this.setTextureCube=function je(re,q){const Ae=r.get(re);re.version>0&&Ae.__version!==re.version?function Ct(re,q,Ae){if(6!==q.image.length)return;const Qe=Ni(re,q),vt=q.source;t.bindTexture(c.TEXTURE_CUBE_MAP,re.__webglTexture,c.TEXTURE0+Ae);const nt=r.get(vt);if(vt.version!==nt.__version||!0===Qe){t.activeTexture(c.TEXTURE0+Ae);const gn=fi.getPrimaries(fi.workingColorSpace),Ht=""===q.colorSpace?null:fi.getPrimaries(q.colorSpace),rn=""===q.colorSpace||gn===Ht?c.NONE:c.BROWSER_DEFAULT_WEBGL;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,q.flipY),c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,q.premultiplyAlpha),c.pixelStorei(c.UNPACK_ALIGNMENT,q.unpackAlignment),c.pixelStorei(c.UNPACK_COLORSPACE_CONVERSION_WEBGL,rn);const Fi=q.isCompressedTexture||q.image[0].isCompressedTexture,At=q.image[0]&&q.image[0].isDataTexture,pn=[];for(let ct=0;ct<6;ct++)pn[ct]=Fi||At?At?q.image[ct].image:q.image[ct]:N(q.image[ct],!0,o.maxCubemapSize),pn[ct]=Xn(q,pn[ct]);const jn=pn[0],Kn=l.convert(q.format,q.colorSpace),fn=l.convert(q.type),Bi=V(q.internalFormat,Kn,fn,q.colorSpace),Ei=!0!==q.isVideoTexture,Cr=void 0===nt.__version||!0===Qe,ye=vt.dataReady;let Xe,Wt=ne(q,jn);if(oi(c.TEXTURE_CUBE_MAP,q),Fi){Ei&&Cr&&t.texStorage2D(c.TEXTURE_CUBE_MAP,Wt,Bi,jn.width,jn.height);for(let ct=0;ct<6;ct++){Xe=pn[ct].mipmaps;for(let Qt=0;Qt<Xe.length;Qt++){const Zt=Xe[Qt];q.format!==br?null!==Kn?Ei?ye&&t.compressedTexSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+ct,Qt,0,0,Zt.width,Zt.height,Kn,Zt.data):t.compressedTexImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+ct,Qt,Bi,Zt.width,Zt.height,0,Zt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ei?ye&&t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+ct,Qt,0,0,Zt.width,Zt.height,Kn,fn,Zt.data):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+ct,Qt,Bi,Zt.width,Zt.height,0,Kn,fn,Zt.data)}}}else{if(Xe=q.mipmaps,Ei&&Cr){Xe.length>0&&Wt++;const ct=Kt(pn[0]);t.texStorage2D(c.TEXTURE_CUBE_MAP,Wt,Bi,ct.width,ct.height)}for(let ct=0;ct<6;ct++)if(At){Ei?ye&&t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+ct,0,0,0,pn[ct].width,pn[ct].height,Kn,fn,pn[ct].data):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+ct,0,Bi,pn[ct].width,pn[ct].height,0,Kn,fn,pn[ct].data);for(let Qt=0;Qt<Xe.length;Qt++){const ei=Xe[Qt].image[ct].image;Ei?ye&&t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+ct,Qt+1,0,0,ei.width,ei.height,Kn,fn,ei.data):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+ct,Qt+1,Bi,ei.width,ei.height,0,Kn,fn,ei.data)}}else{Ei?ye&&t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+ct,0,0,0,Kn,fn,pn[ct]):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+ct,0,Bi,Kn,fn,pn[ct]);for(let Qt=0;Qt<Xe.length;Qt++){const Zt=Xe[Qt];Ei?ye&&t.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+ct,Qt+1,0,0,Kn,fn,Zt.image[ct]):t.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+ct,Qt+1,Bi,Kn,fn,Zt.image[ct])}}}R(q)&&T(c.TEXTURE_CUBE_MAP),nt.__version=vt.version,q.onUpdate&&q.onUpdate(q)}re.__version=q.version}(Ae,re,q):t.bindTexture(c.TEXTURE_CUBE_MAP,Ae.__webglTexture,c.TEXTURE0+q)},this.rebindTextures=function Rn(re,q,Ae){const Qe=r.get(re);void 0!==q&&Yt(Qe.__webglFramebuffer,re,re.texture,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,0),void 0!==Ae&&Yn(re)},this.setupRenderTarget=function Oi(re){const q=re.texture,Ae=r.get(re),Qe=r.get(q);re.addEventListener("dispose",te);const vt=re.textures,nt=!0===re.isWebGLCubeRenderTarget,gn=vt.length>1;if(gn||(void 0===Qe.__webglTexture&&(Qe.__webglTexture=c.createTexture()),Qe.__version=q.version,u.memory.textures++),nt){Ae.__webglFramebuffer=[];for(let Ht=0;Ht<6;Ht++)if(q.mipmaps&&q.mipmaps.length>0){Ae.__webglFramebuffer[Ht]=[];for(let rn=0;rn<q.mipmaps.length;rn++)Ae.__webglFramebuffer[Ht][rn]=c.createFramebuffer()}else Ae.__webglFramebuffer[Ht]=c.createFramebuffer()}else{if(q.mipmaps&&q.mipmaps.length>0){Ae.__webglFramebuffer=[];for(let Ht=0;Ht<q.mipmaps.length;Ht++)Ae.__webglFramebuffer[Ht]=c.createFramebuffer()}else Ae.__webglFramebuffer=c.createFramebuffer();if(gn)for(let Ht=0,rn=vt.length;Ht<rn;Ht++){const Fi=r.get(vt[Ht]);void 0===Fi.__webglTexture&&(Fi.__webglTexture=c.createTexture(),u.memory.textures++)}if(re.samples>0&&!1===ln(re)){Ae.__webglMultisampledFramebuffer=c.createFramebuffer(),Ae.__webglColorRenderbuffer=[],t.bindFramebuffer(c.FRAMEBUFFER,Ae.__webglMultisampledFramebuffer);for(let Ht=0;Ht<vt.length;Ht++){const rn=vt[Ht];Ae.__webglColorRenderbuffer[Ht]=c.createRenderbuffer(),c.bindRenderbuffer(c.RENDERBUFFER,Ae.__webglColorRenderbuffer[Ht]);const Fi=l.convert(rn.format,rn.colorSpace),At=l.convert(rn.type),pn=V(rn.internalFormat,Fi,At,rn.colorSpace,!0===re.isXRRenderTarget),jn=Et(re);c.renderbufferStorageMultisample(c.RENDERBUFFER,jn,pn,re.width,re.height),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0+Ht,c.RENDERBUFFER,Ae.__webglColorRenderbuffer[Ht])}c.bindRenderbuffer(c.RENDERBUFFER,null),re.depthBuffer&&(Ae.__webglDepthRenderbuffer=c.createRenderbuffer(),Pt(Ae.__webglDepthRenderbuffer,re,!0)),t.bindFramebuffer(c.FRAMEBUFFER,null)}}if(nt){t.bindTexture(c.TEXTURE_CUBE_MAP,Qe.__webglTexture),oi(c.TEXTURE_CUBE_MAP,q);for(let Ht=0;Ht<6;Ht++)if(q.mipmaps&&q.mipmaps.length>0)for(let rn=0;rn<q.mipmaps.length;rn++)Yt(Ae.__webglFramebuffer[Ht][rn],re,q,c.COLOR_ATTACHMENT0,c.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,rn);else Yt(Ae.__webglFramebuffer[Ht],re,q,c.COLOR_ATTACHMENT0,c.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,0);R(q)&&T(c.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(gn){for(let Ht=0,rn=vt.length;Ht<rn;Ht++){const Fi=vt[Ht],At=r.get(Fi);t.bindTexture(c.TEXTURE_2D,At.__webglTexture),oi(c.TEXTURE_2D,Fi),Yt(Ae.__webglFramebuffer,re,Fi,c.COLOR_ATTACHMENT0+Ht,c.TEXTURE_2D,0),R(Fi)&&T(c.TEXTURE_2D)}t.unbindTexture()}else{let Ht=c.TEXTURE_2D;if((re.isWebGL3DRenderTarget||re.isWebGLArrayRenderTarget)&&(Ht=re.isWebGL3DRenderTarget?c.TEXTURE_3D:c.TEXTURE_2D_ARRAY),t.bindTexture(Ht,Qe.__webglTexture),oi(Ht,q),q.mipmaps&&q.mipmaps.length>0)for(let rn=0;rn<q.mipmaps.length;rn++)Yt(Ae.__webglFramebuffer[rn],re,q,c.COLOR_ATTACHMENT0,Ht,rn);else Yt(Ae.__webglFramebuffer,re,q,c.COLOR_ATTACHMENT0,Ht,0);R(q)&&T(Ht),t.unbindTexture()}re.depthBuffer&&Yn(re)},this.updateRenderTargetMipmap=function ft(re){const q=re.textures;for(let Ae=0,Qe=q.length;Ae<Qe;Ae++){const vt=q[Ae];if(R(vt)){const nt=B(re),gn=r.get(vt).__webglTexture;t.bindTexture(nt,gn),T(nt),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function hn(re){if(re.samples>0)if(!1===ln(re)){const q=re.textures,Ae=re.width,Qe=re.height;let vt=c.COLOR_BUFFER_BIT;const nt=re.stencilBuffer?c.DEPTH_STENCIL_ATTACHMENT:c.DEPTH_ATTACHMENT,gn=r.get(re),Ht=q.length>1;if(Ht)for(let rn=0;rn<q.length;rn++)t.bindFramebuffer(c.FRAMEBUFFER,gn.__webglMultisampledFramebuffer),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0+rn,c.RENDERBUFFER,null),t.bindFramebuffer(c.FRAMEBUFFER,gn.__webglFramebuffer),c.framebufferTexture2D(c.DRAW_FRAMEBUFFER,c.COLOR_ATTACHMENT0+rn,c.TEXTURE_2D,null,0);t.bindFramebuffer(c.READ_FRAMEBUFFER,gn.__webglMultisampledFramebuffer),t.bindFramebuffer(c.DRAW_FRAMEBUFFER,gn.__webglFramebuffer);for(let rn=0;rn<q.length;rn++){if(re.resolveDepthBuffer&&(re.depthBuffer&&(vt|=c.DEPTH_BUFFER_BIT),re.stencilBuffer&&re.resolveStencilBuffer&&(vt|=c.STENCIL_BUFFER_BIT)),Ht){c.framebufferRenderbuffer(c.READ_FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.RENDERBUFFER,gn.__webglColorRenderbuffer[rn]);const Fi=r.get(q[rn]).__webglTexture;c.framebufferTexture2D(c.DRAW_FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,Fi,0)}c.blitFramebuffer(0,0,Ae,Qe,0,0,Ae,Qe,vt,c.NEAREST),!0===p&&(Dt.length=0,ce.length=0,Dt.push(c.COLOR_ATTACHMENT0+rn),re.depthBuffer&&!1===re.resolveDepthBuffer&&(Dt.push(nt),ce.push(nt),c.invalidateFramebuffer(c.DRAW_FRAMEBUFFER,ce)),c.invalidateFramebuffer(c.READ_FRAMEBUFFER,Dt))}if(t.bindFramebuffer(c.READ_FRAMEBUFFER,null),t.bindFramebuffer(c.DRAW_FRAMEBUFFER,null),Ht)for(let rn=0;rn<q.length;rn++){t.bindFramebuffer(c.FRAMEBUFFER,gn.__webglMultisampledFramebuffer),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0+rn,c.RENDERBUFFER,gn.__webglColorRenderbuffer[rn]);const Fi=r.get(q[rn]).__webglTexture;t.bindFramebuffer(c.FRAMEBUFFER,gn.__webglFramebuffer),c.framebufferTexture2D(c.DRAW_FRAMEBUFFER,c.COLOR_ATTACHMENT0+rn,c.TEXTURE_2D,Fi,0)}t.bindFramebuffer(c.DRAW_FRAMEBUFFER,gn.__webglMultisampledFramebuffer)}else re.depthBuffer&&!1===re.resolveDepthBuffer&&p&&c.invalidateFramebuffer(c.DRAW_FRAMEBUFFER,[re.stencilBuffer?c.DEPTH_STENCIL_ATTACHMENT:c.DEPTH_ATTACHMENT])},this.setupDepthRenderbuffer=Yn,this.setupFrameBufferTexture=Yt,this.useMultisampledRTT=ln}function nx(c,e){return{convert:function t(r,o=""){let l;const u=fi.getTransfer(o);if(r===Bn)return c.UNSIGNED_BYTE;if(r===ds)return c.UNSIGNED_SHORT_4_4_4_4;if(r===Oo)return c.UNSIGNED_SHORT_5_5_5_1;if(r===wa)return c.UNSIGNED_INT_5_9_9_9_REV;if(r===Mi)return c.BYTE;if(r===yr)return c.SHORT;if(r===_r)return c.UNSIGNED_SHORT;if(r===Ti)return c.INT;if(r===Jt)return c.UNSIGNED_INT;if(r===Fr)return c.FLOAT;if(r===to)return c.HALF_FLOAT;if(r===Xs)return c.ALPHA;if(r===Ls)return c.RGB;if(r===br)return c.RGBA;if(r===na)return c.LUMINANCE;if(r===Ca)return c.LUMINANCE_ALPHA;if(r===ve)return c.DEPTH_COMPONENT;if(r===ue)return c.DEPTH_STENCIL;if(r===he)return c.RED;if(r===Le)return c.RED_INTEGER;if(r===at)return c.RG;if(r===We)return c.RG_INTEGER;if(r===Vn)return c.RGBA_INTEGER;if(r===Bt||r===Ui||r===wi||r===Fn)if(u===ki){if(l=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===l)return null;if(r===Bt)return l.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===Ui)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===wi)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===Fn)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(l=e.get("WEBGL_compressed_texture_s3tc"),null===l)return null;if(r===Bt)return l.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===Ui)return l.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===wi)return l.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===Fn)return l.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(r===qi||r===Ur||r===an||r===Jn){if(l=e.get("WEBGL_compressed_texture_pvrtc"),null===l)return null;if(r===qi)return l.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===Ur)return l.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===an)return l.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===Jn)return l.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===ti||r===er||r===Cs){if(l=e.get("WEBGL_compressed_texture_etc"),null===l)return null;if(r===ti||r===er)return u===ki?l.COMPRESSED_SRGB8_ETC2:l.COMPRESSED_RGB8_ETC2;if(r===Cs)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:l.COMPRESSED_RGBA8_ETC2_EAC}if(r===ur||r===Ys||r===Fa||r===Vs||r===Lo||r===ia||r===kl||r===Fo||r===Jr||r===ra||r===Ua||r===ka||r===Ba||r===vo){if(l=e.get("WEBGL_compressed_texture_astc"),null===l)return null;if(r===ur)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:l.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===Ys)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:l.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===Fa)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:l.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===Vs)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:l.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===Lo)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:l.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===ia)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:l.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===kl)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:l.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===Fo)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:l.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===Jr)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:l.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===ra)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:l.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===Ua)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:l.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===ka)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:l.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===Ba)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:l.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===vo)return u===ki?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:l.COMPRESSED_RGBA_ASTC_12x12_KHR}if(r===yo||r===Va||r===hs){if(l=e.get("EXT_texture_compression_bptc"),null===l)return null;if(r===yo)return u===ki?l.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:l.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===Va)return l.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===hs)return l.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(r===Ha||r===dr||r===sa||r===Hn){if(l=e.get("EXT_texture_compression_rgtc"),null===l)return null;if(r===yo)return l.COMPRESSED_RED_RGTC1_EXT;if(r===dr)return l.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===sa)return l.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===Hn)return l.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return r===gi?c.UNSIGNED_INT_24_8:void 0!==c[r]?c[r]:null}}}class Ey extends ys{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Jc extends ms{constructor(){super(),this.isGroup=!0,this.type="Group"}}const kb={type:"move"};class Qc{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Jc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Jc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ee,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ee),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Jc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ee,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ee),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,r){let o=null,l=null,u=null;const h=this._targetRay,p=this._grip,m=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(m&&e.hand){u=!0;for(const N of e.hand.values()){const R=t.getJointPose(N,r),T=this._getHandJoint(m,N);null!==R&&(T.matrix.fromArray(R.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale),T.matrixWorldNeedsUpdate=!0,T.jointRadius=R.radius),T.visible=null!==R}const M=m.joints["index-finger-tip"].position.distanceTo(m.joints["thumb-tip"].position),S=.02,A=.005;m.inputState.pinching&&M>S+A?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&M<=S-A&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==p&&e.gripSpace&&(l=t.getPose(e.gripSpace,r),null!==l&&(p.matrix.fromArray(l.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,l.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(l.linearVelocity)):p.hasLinearVelocity=!1,l.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(l.angularVelocity)):p.hasAngularVelocity=!1));null!==h&&(o=t.getPose(e.targetRaySpace,r),null===o&&null!==l&&(o=l),null!==o&&(h.matrix.fromArray(o.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,o.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(o.linearVelocity)):h.hasLinearVelocity=!1,o.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(o.angularVelocity)):h.hasAngularVelocity=!1,this.dispatchEvent(kb)))}return null!==h&&(h.visible=null!==o),null!==p&&(p.visible=null!==l),null!==m&&(m.visible=null!==u),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const r=new Jc;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class Vb{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,r){if(null===this.texture){const o=new Ii;e.properties.get(o).__webglTexture=t.texture,(t.depthNear!=r.depthNear||t.depthFar!=r.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=o}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,r=new Co({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Rs(new nf(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Nf extends rs{constructor(e,t){super();const r=this;let o=null,l=1,u=null,h="local-floor",p=1,m=null,v=null,y=null,M=null,S=null,A=null;const N=new Vb,R=t.getContextAttributes();let T=null,B=null;const V=[],F=[],ne=new Je;let Q=null;const te=new ys;te.viewport=new dn;const se=new ys;se.viewport=new dn;const X=[te,se],j=new Ey;let fe=null,Re=null;function Ce(tt){const Ct=F.indexOf(tt.inputSource);if(-1===Ct)return;const Yt=V[Ct];void 0!==Yt&&(Yt.update(tt.inputSource,tt.frame,m||u),Yt.dispatchEvent({type:tt.type,data:tt.inputSource}))}function Fe(){o.removeEventListener("select",Ce),o.removeEventListener("selectstart",Ce),o.removeEventListener("selectend",Ce),o.removeEventListener("squeeze",Ce),o.removeEventListener("squeezestart",Ce),o.removeEventListener("squeezeend",Ce),o.removeEventListener("end",Fe),o.removeEventListener("inputsourceschange",st);for(let tt=0;tt<V.length;tt++){const Ct=F[tt];null!==Ct&&(F[tt]=null,V[tt].disconnect(Ct))}fe=null,Re=null,N.reset(),e.setRenderTarget(T),S=null,M=null,y=null,o=null,B=null,Ni.stop(),r.isPresenting=!1,e.setPixelRatio(Q),e.setSize(ne.width,ne.height,!1),r.dispatchEvent({type:"sessionend"})}function st(tt){for(let Ct=0;Ct<tt.removed.length;Ct++){const Yt=tt.removed[Ct],Pt=F.indexOf(Yt);Pt>=0&&(F[Pt]=null,V[Pt].disconnect(Yt))}for(let Ct=0;Ct<tt.added.length;Ct++){const Yt=tt.added[Ct];let Pt=F.indexOf(Yt);if(-1===Pt){for(let Yn=0;Yn<V.length;Yn++){if(Yn>=F.length){F.push(Yt),Pt=Yn;break}if(null===F[Yn]){F[Yn]=Yt,Pt=Yn;break}}if(-1===Pt)break}const bn=V[Pt];bn&&bn.connect(Yt)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(tt){let Ct=V[tt];return void 0===Ct&&(Ct=new Qc,V[tt]=Ct),Ct.getTargetRaySpace()},this.getControllerGrip=function(tt){let Ct=V[tt];return void 0===Ct&&(Ct=new Qc,V[tt]=Ct),Ct.getGripSpace()},this.getHand=function(tt){let Ct=V[tt];return void 0===Ct&&(Ct=new Qc,V[tt]=Ct),Ct.getHandSpace()},this.setFramebufferScaleFactor=function(tt){l=tt,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(tt){h=tt,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return m||u},this.setReferenceSpace=function(tt){m=tt},this.getBaseLayer=function(){return null!==M?M:S},this.getBinding=function(){return y},this.getFrame=function(){return A},this.getSession=function(){return o},this.setSession=function(){var tt=(0,pt.Z)(function*(Ct){if(o=Ct,null!==o){if(T=e.getRenderTarget(),o.addEventListener("select",Ce),o.addEventListener("selectstart",Ce),o.addEventListener("selectend",Ce),o.addEventListener("squeeze",Ce),o.addEventListener("squeezestart",Ce),o.addEventListener("squeezeend",Ce),o.addEventListener("end",Fe),o.addEventListener("inputsourceschange",st),!0!==R.xrCompatible&&(yield t.makeXRCompatible()),Q=e.getPixelRatio(),e.getSize(ne),void 0===o.renderState.layers)S=new XRWebGLLayer(o,t,{antialias:R.antialias,alpha:!0,depth:R.depth,stencil:R.stencil,framebufferScaleFactor:l}),o.updateRenderState({baseLayer:S}),e.setPixelRatio(1),e.setSize(S.framebufferWidth,S.framebufferHeight,!1),B=new Ds(S.framebufferWidth,S.framebufferHeight,{format:br,type:Bn,colorSpace:e.outputColorSpace,stencilBuffer:R.stencil});else{let Yt=null,Pt=null,bn=null;R.depth&&(bn=R.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Yt=R.stencil?ue:ve,Pt=R.stencil?gi:Jt);const Yn={colorFormat:t.RGBA8,depthFormat:bn,scaleFactor:l};y=new XRWebGLBinding(o,t),M=y.createProjectionLayer(Yn),o.updateRenderState({layers:[M]}),e.setPixelRatio(1),e.setSize(M.textureWidth,M.textureHeight,!1),B=new Ds(M.textureWidth,M.textureHeight,{format:br,type:Bn,depthTexture:new Gv(M.textureWidth,M.textureHeight,Pt,void 0,void 0,void 0,void 0,void 0,void 0,Yt),stencilBuffer:R.stencil,colorSpace:e.outputColorSpace,samples:R.antialias?4:0,resolveDepthBuffer:!1===M.ignoreDepthValues})}B.isXRRenderTarget=!0,this.setFoveation(p),m=null,u=yield o.requestReferenceSpace(h),Ni.setContext(o),Ni.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}});return function(Ct){return tt.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==o)return o.environmentBlendMode},this.getDepthTexture=function(){return N.getDepthTexture()};const Be=new ee,bt=new ee;function Ot(tt,Ct){null===Ct?tt.matrixWorld.copy(tt.matrix):tt.matrixWorld.multiplyMatrices(Ct.matrixWorld,tt.matrix),tt.matrixWorldInverse.copy(tt.matrixWorld).invert()}this.updateCamera=function(tt){if(null===o)return;let Ct=tt.near,Yt=tt.far;null!==N.texture&&(N.depthNear>0&&(Ct=N.depthNear),N.depthFar>0&&(Yt=N.depthFar)),j.near=se.near=te.near=Ct,j.far=se.far=te.far=Yt,(fe!==j.near||Re!==j.far)&&(o.updateRenderState({depthNear:j.near,depthFar:j.far}),fe=j.near,Re=j.far),te.layers.mask=2|tt.layers.mask,se.layers.mask=4|tt.layers.mask,j.layers.mask=te.layers.mask|se.layers.mask;const Pt=tt.parent,bn=j.cameras;Ot(j,Pt);for(let Yn=0;Yn<bn.length;Yn++)Ot(bn[Yn],Pt);2===bn.length?function je(tt,Ct,Yt){Be.setFromMatrixPosition(Ct.matrixWorld),bt.setFromMatrixPosition(Yt.matrixWorld);const Pt=Be.distanceTo(bt),bn=Ct.projectionMatrix.elements,Yn=Yt.projectionMatrix.elements,Rn=bn[14]/(bn[10]-1),Oi=bn[14]/(bn[10]+1),ft=(bn[9]+1)/bn[5],Dt=(bn[9]-1)/bn[5],ce=(bn[8]-1)/bn[0],hn=(Yn[8]+1)/Yn[0],Et=Rn*ce,ln=Rn*hn,Ut=Pt/(-ce+hn),Xn=Ut*-ce;if(Ct.matrixWorld.decompose(tt.position,tt.quaternion,tt.scale),tt.translateX(Xn),tt.translateZ(Ut),tt.matrixWorld.compose(tt.position,tt.quaternion,tt.scale),tt.matrixWorldInverse.copy(tt.matrixWorld).invert(),-1===bn[10])tt.projectionMatrix.copy(Ct.projectionMatrix),tt.projectionMatrixInverse.copy(Ct.projectionMatrixInverse);else{const Kt=Rn+Ut,re=Oi+Ut;tt.projectionMatrix.makePerspective(Et-Xn,ln+(Pt-Xn),ft*Oi/re*Kt,Dt*Oi/re*Kt,Kt,re),tt.projectionMatrixInverse.copy(tt.projectionMatrix).invert()}}(j,te,se):j.projectionMatrix.copy(te.projectionMatrix),function Xt(tt,Ct,Yt){null===Yt?tt.matrix.copy(Ct.matrixWorld):(tt.matrix.copy(Yt.matrixWorld),tt.matrix.invert(),tt.matrix.multiply(Ct.matrixWorld)),tt.matrix.decompose(tt.position,tt.quaternion,tt.scale),tt.updateMatrixWorld(!0),tt.projectionMatrix.copy(Ct.projectionMatrix),tt.projectionMatrixInverse.copy(Ct.projectionMatrixInverse),tt.isPerspectiveCamera&&(tt.fov=2*xo*Math.atan(1/tt.projectionMatrix.elements[5]),tt.zoom=1)}(tt,j,Pt)},this.getCamera=function(){return j},this.getFoveation=function(){if(null!==M||null!==S)return p},this.setFoveation=function(tt){p=tt,null!==M&&(M.fixedFoveation=tt),null!==S&&void 0!==S.fixedFoveation&&(S.fixedFoveation=tt)},this.hasDepthSensing=function(){return null!==N.texture},this.getDepthSensingMesh=function(){return N.getMesh(j)};let on=null;const Ni=new w0;Ni.setAnimationLoop(function oi(tt,Ct){if(v=Ct.getViewerPose(m||u),A=Ct,null!==v){const Yt=v.views;null!==S&&(e.setRenderTargetFramebuffer(B,S.framebuffer),e.setRenderTarget(B));let Pt=!1;Yt.length!==j.cameras.length&&(j.cameras.length=0,Pt=!0);for(let Yn=0;Yn<Yt.length;Yn++){const Rn=Yt[Yn];let Oi=null;if(null!==S)Oi=S.getViewport(Rn);else{const Dt=y.getViewSubImage(M,Rn);Oi=Dt.viewport,0===Yn&&(e.setRenderTargetTextures(B,Dt.colorTexture,M.ignoreDepthValues?void 0:Dt.depthStencilTexture),e.setRenderTarget(B))}let ft=X[Yn];void 0===ft&&(ft=new ys,ft.layers.enable(Yn),ft.viewport=new dn,X[Yn]=ft),ft.matrix.fromArray(Rn.transform.matrix),ft.matrix.decompose(ft.position,ft.quaternion,ft.scale),ft.projectionMatrix.fromArray(Rn.projectionMatrix),ft.projectionMatrixInverse.copy(ft.projectionMatrix).invert(),ft.viewport.set(Oi.x,Oi.y,Oi.width,Oi.height),0===Yn&&(j.matrix.copy(ft.matrix),j.matrix.decompose(j.position,j.quaternion,j.scale)),!0===Pt&&j.cameras.push(ft)}const bn=o.enabledFeatures;if(bn&&bn.includes("depth-sensing")){const Yn=y.getDepthInformation(Yt[0]);Yn&&Yn.isValid&&Yn.texture&&N.init(e,Yn,o.renderState)}}for(let Yt=0;Yt<V.length;Yt++){const Pt=F[Yt],bn=V[Yt];null!==Pt&&void 0!==bn&&bn.update(Pt,Ct,m||u)}on&&on(tt,Ct),Ct.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:Ct}),A=null}),this.setAnimationLoop=function(tt){on=tt},this.dispose=function(){}}}const eu=new Da,Om=new In;function Lm(c,e){function t(R,T){!0===R.matrixAutoUpdate&&R.updateMatrix(),T.value.copy(R.matrix)}function l(R,T){R.opacity.value=T.opacity,T.color&&R.diffuse.value.copy(T.color),T.emissive&&R.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(R.map.value=T.map,t(T.map,R.mapTransform)),T.alphaMap&&(R.alphaMap.value=T.alphaMap,t(T.alphaMap,R.alphaMapTransform)),T.bumpMap&&(R.bumpMap.value=T.bumpMap,t(T.bumpMap,R.bumpMapTransform),R.bumpScale.value=T.bumpScale,1===T.side&&(R.bumpScale.value*=-1)),T.normalMap&&(R.normalMap.value=T.normalMap,t(T.normalMap,R.normalMapTransform),R.normalScale.value.copy(T.normalScale),1===T.side&&R.normalScale.value.negate()),T.displacementMap&&(R.displacementMap.value=T.displacementMap,t(T.displacementMap,R.displacementMapTransform),R.displacementScale.value=T.displacementScale,R.displacementBias.value=T.displacementBias),T.emissiveMap&&(R.emissiveMap.value=T.emissiveMap,t(T.emissiveMap,R.emissiveMapTransform)),T.specularMap&&(R.specularMap.value=T.specularMap,t(T.specularMap,R.specularMapTransform)),T.alphaTest>0&&(R.alphaTest.value=T.alphaTest);const B=e.get(T),V=B.envMap,F=B.envMapRotation;V&&(R.envMap.value=V,eu.copy(F),eu.x*=-1,eu.y*=-1,eu.z*=-1,V.isCubeTexture&&!1===V.isRenderTargetTexture&&(eu.y*=-1,eu.z*=-1),R.envMapRotation.value.setFromMatrix4(Om.makeRotationFromEuler(eu)),R.flipEnvMap.value=V.isCubeTexture&&!1===V.isRenderTargetTexture?-1:1,R.reflectivity.value=T.reflectivity,R.ior.value=T.ior,R.refractionRatio.value=T.refractionRatio),T.lightMap&&(R.lightMap.value=T.lightMap,R.lightMapIntensity.value=T.lightMapIntensity,t(T.lightMap,R.lightMapTransform)),T.aoMap&&(R.aoMap.value=T.aoMap,R.aoMapIntensity.value=T.aoMapIntensity,t(T.aoMap,R.aoMapTransform))}return{refreshFogUniforms:function r(R,T){T.color.getRGB(R.fogColor.value,Jl(c)),T.isFog?(R.fogNear.value=T.near,R.fogFar.value=T.far):T.isFogExp2&&(R.fogDensity.value=T.density)},refreshMaterialUniforms:function o(R,T,B,V,F){T.isMeshBasicMaterial||T.isMeshLambertMaterial?l(R,T):T.isMeshToonMaterial?(l(R,T),function y(R,T){T.gradientMap&&(R.gradientMap.value=T.gradientMap)}(R,T)):T.isMeshPhongMaterial?(l(R,T),function v(R,T){R.specular.value.copy(T.specular),R.shininess.value=Math.max(T.shininess,1e-4)}(R,T)):T.isMeshStandardMaterial?(l(R,T),function M(R,T){R.metalness.value=T.metalness,T.metalnessMap&&(R.metalnessMap.value=T.metalnessMap,t(T.metalnessMap,R.metalnessMapTransform)),R.roughness.value=T.roughness,T.roughnessMap&&(R.roughnessMap.value=T.roughnessMap,t(T.roughnessMap,R.roughnessMapTransform)),T.envMap&&(R.envMapIntensity.value=T.envMapIntensity)}(R,T),T.isMeshPhysicalMaterial&&function S(R,T,B){R.ior.value=T.ior,T.sheen>0&&(R.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),R.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(R.sheenColorMap.value=T.sheenColorMap,t(T.sheenColorMap,R.sheenColorMapTransform)),T.sheenRoughnessMap&&(R.sheenRoughnessMap.value=T.sheenRoughnessMap,t(T.sheenRoughnessMap,R.sheenRoughnessMapTransform))),T.clearcoat>0&&(R.clearcoat.value=T.clearcoat,R.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(R.clearcoatMap.value=T.clearcoatMap,t(T.clearcoatMap,R.clearcoatMapTransform)),T.clearcoatRoughnessMap&&(R.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap,t(T.clearcoatRoughnessMap,R.clearcoatRoughnessMapTransform)),T.clearcoatNormalMap&&(R.clearcoatNormalMap.value=T.clearcoatNormalMap,t(T.clearcoatNormalMap,R.clearcoatNormalMapTransform),R.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),1===T.side&&R.clearcoatNormalScale.value.negate())),T.dispersion>0&&(R.dispersion.value=T.dispersion),T.iridescence>0&&(R.iridescence.value=T.iridescence,R.iridescenceIOR.value=T.iridescenceIOR,R.iridescenceThicknessMinimum.value=T.iridescenceThicknessRange[0],R.iridescenceThicknessMaximum.value=T.iridescenceThicknessRange[1],T.iridescenceMap&&(R.iridescenceMap.value=T.iridescenceMap,t(T.iridescenceMap,R.iridescenceMapTransform)),T.iridescenceThicknessMap&&(R.iridescenceThicknessMap.value=T.iridescenceThicknessMap,t(T.iridescenceThicknessMap,R.iridescenceThicknessMapTransform))),T.transmission>0&&(R.transmission.value=T.transmission,R.transmissionSamplerMap.value=B.texture,R.transmissionSamplerSize.value.set(B.width,B.height),T.transmissionMap&&(R.transmissionMap.value=T.transmissionMap,t(T.transmissionMap,R.transmissionMapTransform)),R.thickness.value=T.thickness,T.thicknessMap&&(R.thicknessMap.value=T.thicknessMap,t(T.thicknessMap,R.thicknessMapTransform)),R.attenuationDistance.value=T.attenuationDistance,R.attenuationColor.value.copy(T.attenuationColor)),T.anisotropy>0&&(R.anisotropyVector.value.set(T.anisotropy*Math.cos(T.anisotropyRotation),T.anisotropy*Math.sin(T.anisotropyRotation)),T.anisotropyMap&&(R.anisotropyMap.value=T.anisotropyMap,t(T.anisotropyMap,R.anisotropyMapTransform))),R.specularIntensity.value=T.specularIntensity,R.specularColor.value.copy(T.specularColor),T.specularColorMap&&(R.specularColorMap.value=T.specularColorMap,t(T.specularColorMap,R.specularColorMapTransform)),T.specularIntensityMap&&(R.specularIntensityMap.value=T.specularIntensityMap,t(T.specularIntensityMap,R.specularIntensityMapTransform))}(R,T,F)):T.isMeshMatcapMaterial?(l(R,T),function A(R,T){T.matcap&&(R.matcap.value=T.matcap)}(R,T)):T.isMeshDepthMaterial?l(R,T):T.isMeshDistanceMaterial?(l(R,T),function N(R,T){const B=e.get(T).light;R.referencePosition.value.setFromMatrixPosition(B.matrixWorld),R.nearDistance.value=B.shadow.camera.near,R.farDistance.value=B.shadow.camera.far}(R,T)):T.isMeshNormalMaterial?l(R,T):T.isLineBasicMaterial?(function u(R,T){R.diffuse.value.copy(T.color),R.opacity.value=T.opacity,T.map&&(R.map.value=T.map,t(T.map,R.mapTransform))}(R,T),T.isLineDashedMaterial&&function h(R,T){R.dashSize.value=T.dashSize,R.totalSize.value=T.dashSize+T.gapSize,R.scale.value=T.scale}(R,T)):T.isPointsMaterial?function p(R,T,B,V){R.diffuse.value.copy(T.color),R.opacity.value=T.opacity,R.size.value=T.size*B,R.scale.value=.5*V,T.map&&(R.map.value=T.map,t(T.map,R.uvTransform)),T.alphaMap&&(R.alphaMap.value=T.alphaMap,t(T.alphaMap,R.alphaMapTransform)),T.alphaTest>0&&(R.alphaTest.value=T.alphaTest)}(R,T,B,V):T.isSpriteMaterial?function m(R,T){R.diffuse.value.copy(T.color),R.opacity.value=T.opacity,R.rotation.value=T.rotation,T.map&&(R.map.value=T.map,t(T.map,R.mapTransform)),T.alphaMap&&(R.alphaMap.value=T.alphaMap,t(T.alphaMap,R.alphaMapTransform)),T.alphaTest>0&&(R.alphaTest.value=T.alphaTest)}(R,T):T.isShadowMaterial?(R.color.value.copy(T.color),R.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}}}function rd(c,e,t,r){let o={},l={},u=[];const h=c.getParameter(c.MAX_UNIFORM_BUFFER_BINDINGS);function S(B,V,F,ne){const Q=B.value,te=V+"_"+F;if(void 0===ne[te])return ne[te]="number"==typeof Q||"boolean"==typeof Q?Q:Q.clone(),!0;{const se=ne[te];if("number"==typeof Q||"boolean"==typeof Q){if(se!==Q)return ne[te]=Q,!0}else if(!1===se.equals(Q))return se.copy(Q),!0}return!1}function N(B){const V={boundary:0,storage:0};return"number"==typeof B||"boolean"==typeof B?(V.boundary=4,V.storage=4):B.isVector2?(V.boundary=8,V.storage=8):B.isVector3||B.isColor?(V.boundary=16,V.storage=12):B.isVector4?(V.boundary=16,V.storage=16):B.isMatrix3?(V.boundary=48,V.storage=48):B.isMatrix4?(V.boundary=64,V.storage=64):B.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",B),V}function R(B){const V=B.target;V.removeEventListener("dispose",R);const F=u.indexOf(V.__bindingPointIndex);u.splice(F,1),c.deleteBuffer(o[V.id]),delete o[V.id],delete l[V.id]}return{bind:function p(B,V){r.uniformBlockBinding(B,V.program)},update:function m(B,V){let F=o[B.id];void 0===F&&(function A(B){const V=B.uniforms;let F=0;for(let te=0,se=V.length;te<se;te++){const X=Array.isArray(V[te])?V[te]:[V[te]];for(let j=0,fe=X.length;j<fe;j++){const Re=X[j],Ce=Array.isArray(Re.value)?Re.value:[Re.value];for(let Fe=0,st=Ce.length;Fe<st;Fe++){const bt=N(Ce[Fe]),je=F%16,Ot=je%bt.boundary,Xt=je+Ot;F+=Ot,0!==Xt&&16-Xt<bt.storage&&(F+=16-Xt),Re.__data=new Float32Array(bt.storage/Float32Array.BYTES_PER_ELEMENT),Re.__offset=F,F+=bt.storage}}}const Q=F%16;Q>0&&(F+=16-Q),B.__size=F,B.__cache={}}(B),F=function v(B){const V=function y(){for(let B=0;B<h;B++)if(-1===u.indexOf(B))return u.push(B),B;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();B.__bindingPointIndex=V;const F=c.createBuffer(),ne=B.__size,Q=B.usage;return c.bindBuffer(c.UNIFORM_BUFFER,F),c.bufferData(c.UNIFORM_BUFFER,ne,Q),c.bindBuffer(c.UNIFORM_BUFFER,null),c.bindBufferBase(c.UNIFORM_BUFFER,V,F),F}(B),o[B.id]=F,B.addEventListener("dispose",R)),r.updateUBOMapping(B,V.program);const Q=e.render.frame;l[B.id]!==Q&&(function M(B){const F=B.uniforms,ne=B.__cache;c.bindBuffer(c.UNIFORM_BUFFER,o[B.id]);for(let Q=0,te=F.length;Q<te;Q++){const se=Array.isArray(F[Q])?F[Q]:[F[Q]];for(let X=0,j=se.length;X<j;X++){const fe=se[X];if(!0===S(fe,Q,X,ne)){const Re=fe.__offset,Ce=Array.isArray(fe.value)?fe.value:[fe.value];let Fe=0;for(let st=0;st<Ce.length;st++){const Be=Ce[st],bt=N(Be);"number"==typeof Be||"boolean"==typeof Be?(fe.__data[0]=Be,c.bufferSubData(c.UNIFORM_BUFFER,Re+Fe,fe.__data)):Be.isMatrix3?(fe.__data[0]=Be.elements[0],fe.__data[1]=Be.elements[1],fe.__data[2]=Be.elements[2],fe.__data[3]=0,fe.__data[4]=Be.elements[3],fe.__data[5]=Be.elements[4],fe.__data[6]=Be.elements[5],fe.__data[7]=0,fe.__data[8]=Be.elements[6],fe.__data[9]=Be.elements[7],fe.__data[10]=Be.elements[8],fe.__data[11]=0):(Be.toArray(fe.__data,Fe),Fe+=bt.storage/Float32Array.BYTES_PER_ELEMENT)}c.bufferSubData(c.UNIFORM_BUFFER,Re,fe.__data)}}}c.bindBuffer(c.UNIFORM_BUFFER,null)}(B),l[B.id]=Q)},dispose:function T(){for(const B in o)c.deleteBuffer(o[B]);u=[],o={},l={}}}}class Fm{constructor(e={}){const{canvas:t=kp(),context:r=null,depth:o=!0,stencil:l=!1,alpha:u=!1,antialias:h=!1,premultipliedAlpha:p=!0,preserveDrawingBuffer:m=!1,powerPreference:v="default",failIfMajorPerformanceCaveat:y=!1,reverseDepthBuffer:M=!1}=e;let S;if(this.isWebGLRenderer=!0,null!==r){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");S=r.getContextAttributes().alpha}else S=u;const A=new Uint32Array(4),N=new Int32Array(4);let R=null,T=null;const B=[],V=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Mr,this.toneMapping=Gn,this.toneMappingExposure=1;const F=this;let ne=!1,Q=0,te=0,se=null,X=-1,j=null;const fe=new dn,Re=new dn;let Ce=null;const Fe=new kt(0);let st=0,Be=t.width,bt=t.height,je=1,Ot=null,Xt=null;const on=new dn(0,0,Be,bt),oi=new dn(0,0,Be,bt);let Ni=!1;const tt=new Xp;let Ct=!1,Yt=!1;const Pt=new In,bn=new In,Yn=new ee,Rn=new dn,Oi={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ft=!1;function Dt(){return null===se?je:1}let Et,ln,Ut,Xn,Kt,re,q,Ae,Qe,vt,nt,gn,Ht,rn,Fi,At,pn,jn,Kn,fn,Bi,Ei,Cr,ye,ce=r;function hn(J,_e){return t.getContext(J,_e)}try{const J={alpha:!0,depth:o,stencil:l,antialias:h,premultipliedAlpha:p,preserveDrawingBuffer:m,powerPreference:v,failIfMajorPerformanceCaveat:y};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r170"),t.addEventListener("webglcontextlost",ct,!1),t.addEventListener("webglcontextrestored",Qt,!1),t.addEventListener("webglcontextcreationerror",Zt,!1),null===ce){const _e="webgl2";if(ce=hn(_e,J),null===ce)throw hn(_e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(J){throw console.error("THREE.WebGLRenderer: "+J.message),J}function Wt(){Et=new Zs(ce),Et.init(),Ei=new nx(ce,Et),ln=new dm(ce,Et,e,Ei),Ut=new Zc(ce,Et),ln.reverseDepthBuffer&&M&&Ut.buffers.depth.setReversed(!0),Xn=new Hv(ce),Kt=new vy,re=new tx(ce,Et,Ut,Kt,ln,Ei,Xn),q=new Uv(F),Ae=new vm(F),Qe=new db(ce),Cr=new gf(ce,Qe),vt=new Xd(ce,Qe,Xn,Cr),nt=new zv(ce,vt,Qe,Xn),Kn=new _M(ce,ln,re),At=new Fv(Kt),gn=new gy(F,q,Ae,Et,ln,Cr,At),Ht=new Lm(F,Kt),rn=new Dm,Fi=new KM(Et),jn=new gM(F,q,Ae,Ut,nt,S,p),pn=new Pm(F,nt,ln),ye=new rd(ce,Xn,ln,Ut),fn=new vf(ce,Et,Xn),Bi=new Vv(ce,Et,Xn),Xn.programs=gn.programs,F.capabilities=ln,F.extensions=Et,F.properties=Kt,F.renderLists=rn,F.shadowMap=pn,F.state=Ut,F.info=Xn}Wt();const Xe=new Nf(F,ce);function ct(J){J.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),ne=!0}function Qt(){console.log("THREE.WebGLRenderer: Context Restored."),ne=!1;const J=Xn.autoReset,_e=pn.enabled,ke=pn.autoUpdate,Ve=pn.needsUpdate,Me=pn.type;Wt(),Xn.autoReset=J,pn.enabled=_e,pn.autoUpdate=ke,pn.needsUpdate=Ve,pn.type=Me}function Zt(J){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",J.statusMessage)}function ei(J){const _e=J.target;_e.removeEventListener("dispose",ei),function cs(J){(function ks(J){const _e=Kt.get(J).programs;void 0!==_e&&(_e.forEach(function(ke){gn.releaseProgram(ke)}),J.isShaderMaterial&&gn.releaseShaderCache(J))})(J),Kt.remove(J)}(_e)}function fr(J,_e,ke){!0===J.transparent&&2===J.side&&!1===J.forceSinglePass?(J.side=1,J.needsUpdate=!0,Su(J,_e,ke),J.side=0,J.needsUpdate=!0,Su(J,_e,ke),J.side=2):Su(J,_e,ke)}this.xr=Xe,this.getContext=function(){return ce},this.getContextAttributes=function(){return ce.getContextAttributes()},this.forceContextLoss=function(){const J=Et.get("WEBGL_lose_context");J&&J.loseContext()},this.forceContextRestore=function(){const J=Et.get("WEBGL_lose_context");J&&J.restoreContext()},this.getPixelRatio=function(){return je},this.setPixelRatio=function(J){void 0!==J&&(je=J,this.setSize(Be,bt,!1))},this.getSize=function(J){return J.set(Be,bt)},this.setSize=function(J,_e,ke=!0){Xe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Be=J,bt=_e,t.width=Math.floor(J*je),t.height=Math.floor(_e*je),!0===ke&&(t.style.width=J+"px",t.style.height=_e+"px"),this.setViewport(0,0,J,_e))},this.getDrawingBufferSize=function(J){return J.set(Be*je,bt*je).floor()},this.setDrawingBufferSize=function(J,_e,ke){Be=J,bt=_e,je=ke,t.width=Math.floor(J*ke),t.height=Math.floor(_e*ke),this.setViewport(0,0,J,_e)},this.getCurrentViewport=function(J){return J.copy(fe)},this.getViewport=function(J){return J.copy(on)},this.setViewport=function(J,_e,ke,Ve){J.isVector4?on.set(J.x,J.y,J.z,J.w):on.set(J,_e,ke,Ve),Ut.viewport(fe.copy(on).multiplyScalar(je).round())},this.getScissor=function(J){return J.copy(oi)},this.setScissor=function(J,_e,ke,Ve){J.isVector4?oi.set(J.x,J.y,J.z,J.w):oi.set(J,_e,ke,Ve),Ut.scissor(Re.copy(oi).multiplyScalar(je).round())},this.getScissorTest=function(){return Ni},this.setScissorTest=function(J){Ut.setScissorTest(Ni=J)},this.setOpaqueSort=function(J){Ot=J},this.setTransparentSort=function(J){Xt=J},this.getClearColor=function(J){return J.copy(jn.getClearColor())},this.setClearColor=function(){jn.setClearColor.apply(jn,arguments)},this.getClearAlpha=function(){return jn.getClearAlpha()},this.setClearAlpha=function(){jn.setClearAlpha.apply(jn,arguments)},this.clear=function(J=!0,_e=!0,ke=!0){let Ve=0;if(J){let Me=!1;if(null!==se){const Rt=se.texture.format;Me=Rt===Vn||Rt===We||Rt===Le}if(Me){const Rt=se.texture.type,Vt=Rt===Bn||Rt===Jt||Rt===_r||Rt===gi||Rt===ds||Rt===Oo,An=jn.getClearColor(),yn=jn.getClearAlpha(),ai=An.r,li=An.g,Sn=An.b;Vt?(A[0]=ai,A[1]=li,A[2]=Sn,A[3]=yn,ce.clearBufferuiv(ce.COLOR,0,A)):(N[0]=ai,N[1]=li,N[2]=Sn,N[3]=yn,ce.clearBufferiv(ce.COLOR,0,N))}else Ve|=ce.COLOR_BUFFER_BIT}_e&&(Ve|=ce.DEPTH_BUFFER_BIT),ke&&(Ve|=ce.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ce.clear(Ve)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ct,!1),t.removeEventListener("webglcontextrestored",Qt,!1),t.removeEventListener("webglcontextcreationerror",Zt,!1),rn.dispose(),Fi.dispose(),Kt.dispose(),q.dispose(),Ae.dispose(),nt.dispose(),Cr.dispose(),ye.dispose(),gn.dispose(),Xe.dispose(),Xe.removeEventListener("sessionstart",ME),Xe.removeEventListener("sessionend",xu),Eu.stop()},this.renderBufferDirect=function(J,_e,ke,Ve,Me,Rt){null===_e&&(_e=Oi);const Vt=Me.isMesh&&Me.matrixWorld.determinant()<0,An=function e0(J,_e,ke,Ve,Me){!0!==_e.isScene&&(_e=Oi),re.resetTextureUnits();const Rt=_e.fog,An=null===se?F.outputColorSpace:!0===se.isXRRenderTarget?se.texture.colorSpace:Ai,yn=(Ve.isMeshStandardMaterial?Ae:q).get(Ve.envMap||(Ve.isMeshStandardMaterial?_e.environment:null)),ai=!0===Ve.vertexColors&&!!ke.attributes.color&&4===ke.attributes.color.itemSize,li=!!ke.attributes.tangent&&(!!Ve.normalMap||Ve.anisotropy>0),Sn=!!ke.morphAttributes.position,Vi=!!ke.morphAttributes.normal,Tr=!!ke.morphAttributes.color;let pr=Gn;Ve.toneMapped&&(null===se||!0===se.isXRRenderTarget)&&(pr=F.toneMapping);const Bs=ke.morphAttributes.position||ke.morphAttributes.normal||ke.morphAttributes.color,ji=void 0!==Bs?Bs.length:0,Dn=Kt.get(Ve),Fl=T.state.lights;!0!==Ct||!0!==Yt&&J===j||At.setState(Ve,J,J===j&&Ve.id===X);let sr=!1;Ve.version===Dn.__version?(Dn.needsLights&&Dn.lightsStateVersion!==Fl.state.version||Dn.outputColorSpace!==An||Me.isBatchedMesh&&!1===Dn.batching||!Me.isBatchedMesh&&!0===Dn.batching||Me.isBatchedMesh&&!0===Dn.batchingColor&&null===Me.colorTexture||Me.isBatchedMesh&&!1===Dn.batchingColor&&null!==Me.colorTexture||Me.isInstancedMesh&&!1===Dn.instancing||!Me.isInstancedMesh&&!0===Dn.instancing||Me.isSkinnedMesh&&!1===Dn.skinning||!Me.isSkinnedMesh&&!0===Dn.skinning||Me.isInstancedMesh&&!0===Dn.instancingColor&&null===Me.instanceColor||Me.isInstancedMesh&&!1===Dn.instancingColor&&null!==Me.instanceColor||Me.isInstancedMesh&&!0===Dn.instancingMorph&&null===Me.morphTexture||Me.isInstancedMesh&&!1===Dn.instancingMorph&&null!==Me.morphTexture||Dn.envMap!==yn||!0===Ve.fog&&Dn.fog!==Rt||void 0!==Dn.numClippingPlanes&&(Dn.numClippingPlanes!==At.numPlanes||Dn.numIntersection!==At.numIntersection)||Dn.vertexAlphas!==ai||Dn.vertexTangents!==li||Dn.morphTargets!==Sn||Dn.morphNormals!==Vi||Dn.morphColors!==Tr||Dn.toneMapping!==pr||Dn.morphTargetsCount!==ji)&&(sr=!0):(sr=!0,Dn.__version=Ve.version);let Sa=Dn.currentProgram;!0===sr&&(Sa=Su(Ve,_e,Me));let wu=!1,Po=!1,Bh=!1;const Ar=Sa.getUniforms(),cl=Dn.uniforms;if(Ut.useProgram(Sa.program)&&(wu=!0,Po=!0,Bh=!0),Ve.id!==X&&(X=Ve.id,Po=!0),wu||j!==J){Ut.buffers.depth.getReversed()?(Pt.copy(J.projectionMatrix),function rv(c){const e=c.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}(Pt),function Bp(c){const e=c.elements;-1===e[11]?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=1-e[14])}(Pt),Ar.setValue(ce,"projectionMatrix",Pt)):Ar.setValue(ce,"projectionMatrix",J.projectionMatrix),Ar.setValue(ce,"viewMatrix",J.matrixWorldInverse);const Cu=Ar.map.cameraPosition;void 0!==Cu&&Cu.setValue(ce,Yn.setFromMatrixPosition(J.matrixWorld)),ln.logarithmicDepthBuffer&&Ar.setValue(ce,"logDepthBufFC",2/(Math.log(J.far+1)/Math.LN2)),(Ve.isMeshPhongMaterial||Ve.isMeshToonMaterial||Ve.isMeshLambertMaterial||Ve.isMeshBasicMaterial||Ve.isMeshStandardMaterial||Ve.isShaderMaterial)&&Ar.setValue(ce,"isOrthographic",!0===J.isOrthographicCamera),j!==J&&(j=J,Po=!0,Bh=!0)}if(Me.isSkinnedMesh){Ar.setOptional(ce,Me,"bindMatrix"),Ar.setOptional(ce,Me,"bindMatrixInverse");const La=Me.skeleton;La&&(null===La.boneTexture&&La.computeBoneTexture(),Ar.setValue(ce,"boneTexture",La.boneTexture,re))}Me.isBatchedMesh&&(Ar.setOptional(ce,Me,"batchingTexture"),Ar.setValue(ce,"batchingTexture",Me._matricesTexture,re),Ar.setOptional(ce,Me,"batchingIdTexture"),Ar.setValue(ce,"batchingIdTexture",Me._indirectTexture,re),Ar.setOptional(ce,Me,"batchingColorTexture"),null!==Me._colorsTexture&&Ar.setValue(ce,"batchingColorTexture",Me._colorsTexture,re));const Vh=ke.morphAttributes;if((void 0!==Vh.position||void 0!==Vh.normal||void 0!==Vh.color)&&Kn.update(Me,ke,Sa),(Po||Dn.receiveShadow!==Me.receiveShadow)&&(Dn.receiveShadow=Me.receiveShadow,Ar.setValue(ce,"receiveShadow",Me.receiveShadow)),Ve.isMeshGouraudMaterial&&null!==Ve.envMap&&(cl.envMap.value=yn,cl.flipEnvMap.value=yn.isCubeTexture&&!1===yn.isRenderTargetTexture?-1:1),Ve.isMeshStandardMaterial&&null===Ve.envMap&&null!==_e.environment&&(cl.envMapIntensity.value=_e.environmentIntensity),Po&&(Ar.setValue(ce,"toneMappingExposure",F.toneMappingExposure),Dn.needsLights&&function xE(J,_e){J.ambientLightColor.needsUpdate=_e,J.lightProbe.needsUpdate=_e,J.directionalLights.needsUpdate=_e,J.directionalLightShadows.needsUpdate=_e,J.pointLights.needsUpdate=_e,J.pointLightShadows.needsUpdate=_e,J.spotLights.needsUpdate=_e,J.spotLightShadows.needsUpdate=_e,J.rectAreaLights.needsUpdate=_e,J.hemisphereLights.needsUpdate=_e}(cl,Bh),Rt&&!0===Ve.fog&&Ht.refreshFogUniforms(cl,Rt),Ht.refreshMaterialUniforms(cl,Ve,je,bt,T.state.transmissionRenderTarget[J.id]),qc.upload(ce,go(Dn),cl,re)),Ve.isShaderMaterial&&!0===Ve.uniformsNeedUpdate&&(qc.upload(ce,go(Dn),cl,re),Ve.uniformsNeedUpdate=!1),Ve.isSpriteMaterial&&Ar.setValue(ce,"center",Me.center),Ar.setValue(ce,"modelViewMatrix",Me.modelViewMatrix),Ar.setValue(ce,"normalMatrix",Me.normalMatrix),Ar.setValue(ce,"modelMatrix",Me.matrixWorld),Ve.isShaderMaterial||Ve.isRawShaderMaterial){const La=Ve.uniformsGroups;for(let Cu=0,Tu=La.length;Cu<Tu;Cu++){const EE=La[Cu];ye.update(EE,Sa),ye.bind(EE,Sa)}}return Sa}(J,_e,ke,Ve,Me);Ut.setMaterial(Ve,Vt);let yn=ke.index,ai=1;if(!0===Ve.wireframe){if(yn=vt.getWireframeAttribute(ke),void 0===yn)return;ai=2}const li=ke.drawRange,Sn=ke.attributes.position;let Vi=li.start*ai,Tr=(li.start+li.count)*ai;null!==Rt&&(Vi=Math.max(Vi,Rt.start*ai),Tr=Math.min(Tr,(Rt.start+Rt.count)*ai)),null!==yn?(Vi=Math.max(Vi,0),Tr=Math.min(Tr,yn.count)):null!=Sn&&(Vi=Math.max(Vi,0),Tr=Math.min(Tr,Sn.count));const pr=Tr-Vi;if(pr<0||pr===1/0)return;Cr.setup(Me,Ve,An,ke,yn);let Bs,ji=fn;if(null!==yn&&(Bs=Qe.get(yn),ji=Bi,ji.setIndex(Bs)),Me.isMesh)!0===Ve.wireframe?(Ut.setLineWidth(Ve.wireframeLinewidth*Dt()),ji.setMode(ce.LINES)):ji.setMode(ce.TRIANGLES);else if(Me.isLine){let Dn=Ve.linewidth;void 0===Dn&&(Dn=1),Ut.setLineWidth(Dn*Dt()),ji.setMode(Me.isLineSegments?ce.LINES:Me.isLineLoop?ce.LINE_LOOP:ce.LINE_STRIP)}else Me.isPoints?ji.setMode(ce.POINTS):Me.isSprite&&ji.setMode(ce.TRIANGLES);if(Me.isBatchedMesh)if(null!==Me._multiDrawInstances)ji.renderMultiDrawInstances(Me._multiDrawStarts,Me._multiDrawCounts,Me._multiDrawCount,Me._multiDrawInstances);else if(Et.get("WEBGL_multi_draw"))ji.renderMultiDraw(Me._multiDrawStarts,Me._multiDrawCounts,Me._multiDrawCount);else{const Dn=Me._multiDrawStarts,Fl=Me._multiDrawCounts,sr=Me._multiDrawCount,Sa=yn?Qe.get(yn).bytesPerElement:1,wu=Kt.get(Ve).currentProgram.getUniforms();for(let Po=0;Po<sr;Po++)wu.setValue(ce,"_gl_DrawID",Po),ji.render(Dn[Po]/Sa,Fl[Po])}else if(Me.isInstancedMesh)ji.renderInstances(Vi,pr,Me.count);else if(ke.isInstancedBufferGeometry){const Fl=Math.min(ke.instanceCount,void 0!==ke._maxInstanceCount?ke._maxInstanceCount:1/0);ji.renderInstances(Vi,pr,Fl)}else ji.render(Vi,pr)},this.compile=function(J,_e,ke=null){null===ke&&(ke=J),T=Fi.get(ke),T.init(_e),V.push(T),ke.traverseVisible(function(Me){Me.isLight&&Me.layers.test(_e.layers)&&(T.pushLight(Me),Me.castShadow&&T.pushShadow(Me))}),J!==ke&&J.traverseVisible(function(Me){Me.isLight&&Me.layers.test(_e.layers)&&(T.pushLight(Me),Me.castShadow&&T.pushShadow(Me))}),T.setupLights();const Ve=new Set;return J.traverse(function(Me){if(!(Me.isMesh||Me.isPoints||Me.isLine||Me.isSprite))return;const Rt=Me.material;if(Rt)if(Array.isArray(Rt))for(let Vt=0;Vt<Rt.length;Vt++){const An=Rt[Vt];fr(An,ke,Me),Ve.add(An)}else fr(Rt,ke,Me),Ve.add(Rt)}),V.pop(),T=null,Ve},this.compileAsync=function(J,_e,ke=null){const Ve=this.compile(J,_e,ke);return new Promise(Me=>{function Rt(){Ve.forEach(function(Vt){Kt.get(Vt).currentProgram.isReady()&&Ve.delete(Vt)}),0!==Ve.size?setTimeout(Rt,10):Me(J)}null!==Et.get("KHR_parallel_shader_compile")?Rt():setTimeout(Rt,10)})};let ba=null;function ME(){Eu.stop()}function xu(){Eu.start()}const Eu=new w0;function Xg(J,_e,ke,Ve){if(!1===J.visible)return;if(J.layers.test(_e.layers))if(J.isGroup)ke=J.renderOrder;else if(J.isLOD)!0===J.autoUpdate&&J.update(_e);else if(J.isLight)T.pushLight(J),J.castShadow&&T.pushShadow(J);else if(J.isSprite){if(!J.frustumCulled||tt.intersectsSprite(J)){Ve&&Rn.setFromMatrixPosition(J.matrixWorld).applyMatrix4(bn);const Vt=nt.update(J),An=J.material;An.visible&&R.push(J,Vt,An,ke,Rn.z,null)}}else if((J.isMesh||J.isLine||J.isPoints)&&(!J.frustumCulled||tt.intersectsObject(J))){const Vt=nt.update(J),An=J.material;if(Ve&&(void 0!==J.boundingSphere?(null===J.boundingSphere&&J.computeBoundingSphere(),Rn.copy(J.boundingSphere.center)):(null===Vt.boundingSphere&&Vt.computeBoundingSphere(),Rn.copy(Vt.boundingSphere.center)),Rn.applyMatrix4(J.matrixWorld).applyMatrix4(bn)),Array.isArray(An)){const yn=Vt.groups;for(let ai=0,li=yn.length;ai<li;ai++){const Sn=yn[ai],Vi=An[Sn.materialIndex];Vi&&Vi.visible&&R.push(J,Vt,Vi,ke,Rn.z,Sn)}}else An.visible&&R.push(J,Vt,An,ke,Rn.z,null)}const Rt=J.children;for(let Vt=0,An=Rt.length;Vt<An;Vt++)Xg(Rt[Vt],_e,ke,Ve)}function Q_(J,_e,ke,Ve){const Me=J.opaque,Rt=J.transmissive,Vt=J.transparent;T.setupLightsView(ke),!0===Ct&&At.setGlobalState(F.clippingPlanes,ke),Ve&&Ut.viewport(fe.copy(Ve)),Me.length>0&&Np(Me,_e,ke),Rt.length>0&&Np(Rt,_e,ke),Vt.length>0&&Np(Vt,_e,ke),Ut.buffers.depth.setTest(!0),Ut.buffers.depth.setMask(!0),Ut.buffers.color.setMask(!0),Ut.setPolygonOffset(!1)}function bu(J,_e,ke,Ve){if(null!==(!0===ke.isScene?ke.overrideMaterial:null))return;void 0===T.state.transmissionRenderTarget[Ve.id]&&(T.state.transmissionRenderTarget[Ve.id]=new Ds(1,1,{generateMipmaps:!0,type:Et.has("EXT_color_buffer_half_float")||Et.has("EXT_color_buffer_float")?to:Bn,minFilter:Lt,samples:4,stencilBuffer:l,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:fi.workingColorSpace}));const Rt=T.state.transmissionRenderTarget[Ve.id],Vt=Ve.viewport||fe;Rt.setSize(Vt.z,Vt.w);const An=F.getRenderTarget();F.setRenderTarget(Rt),F.getClearColor(Fe),st=F.getClearAlpha(),st<1&&F.setClearColor(16777215,.5),F.clear(),ft&&jn.render(ke);const yn=F.toneMapping;F.toneMapping=Gn;const ai=Ve.viewport;if(void 0!==Ve.viewport&&(Ve.viewport=void 0),T.setupLightsView(Ve),!0===Ct&&At.setGlobalState(F.clippingPlanes,Ve),Np(J,ke,Ve),re.updateMultisampleRenderTarget(Rt),re.updateRenderTargetMipmap(Rt),!1===Et.has("WEBGL_multisampled_render_to_texture")){let li=!1;for(let Sn=0,Vi=_e.length;Sn<Vi;Sn++){const Tr=_e[Sn],pr=Tr.object,Bs=Tr.geometry,ji=Tr.material,Dn=Tr.group;if(2===ji.side&&pr.layers.test(Ve.layers)){const Fl=ji.side;ji.side=1,ji.needsUpdate=!0,kh(pr,ke,Ve,Bs,ji,Dn),ji.side=Fl,ji.needsUpdate=!0,li=!0}}!0===li&&(re.updateMultisampleRenderTarget(Rt),re.updateRenderTargetMipmap(Rt))}F.setRenderTarget(An),F.setClearColor(Fe,st),void 0!==ai&&(Ve.viewport=ai),F.toneMapping=yn}function Np(J,_e,ke){const Ve=!0===_e.isScene?_e.overrideMaterial:null;for(let Me=0,Rt=J.length;Me<Rt;Me++){const Vt=J[Me],An=Vt.object,yn=Vt.geometry,ai=null===Ve?Vt.material:Ve,li=Vt.group;An.layers.test(ke.layers)&&kh(An,_e,ke,yn,ai,li)}}function kh(J,_e,ke,Ve,Me,Rt){J.onBeforeRender(F,_e,ke,Ve,Me,Rt),J.modelViewMatrix.multiplyMatrices(ke.matrixWorldInverse,J.matrixWorld),J.normalMatrix.getNormalMatrix(J.modelViewMatrix),Me.onBeforeRender(F,_e,ke,Ve,J,Rt),!0===Me.transparent&&2===Me.side&&!1===Me.forceSinglePass?(Me.side=1,Me.needsUpdate=!0,F.renderBufferDirect(ke,_e,Ve,Me,J,Rt),Me.side=0,Me.needsUpdate=!0,F.renderBufferDirect(ke,_e,Ve,Me,J,Rt),Me.side=2):F.renderBufferDirect(ke,_e,Ve,Me,J,Rt),J.onAfterRender(F,_e,ke,Ve,Me,Rt)}function Su(J,_e,ke){!0!==_e.isScene&&(_e=Oi);const Ve=Kt.get(J),Me=T.state.lights,Vt=Me.state.version,An=gn.getParameters(J,Me.state,T.state.shadowsArray,_e,ke),yn=gn.getProgramCacheKey(An);let ai=Ve.programs;Ve.environment=J.isMeshStandardMaterial?_e.environment:null,Ve.fog=_e.fog,Ve.envMap=(J.isMeshStandardMaterial?Ae:q).get(J.envMap||Ve.environment),Ve.envMapRotation=null!==Ve.environment&&null===J.envMap?_e.environmentRotation:J.envMapRotation,void 0===ai&&(J.addEventListener("dispose",ei),ai=new Map,Ve.programs=ai);let li=ai.get(yn);if(void 0!==li){if(Ve.currentProgram===li&&Ve.lightsStateVersion===Vt)return Yg(J,An),li}else An.uniforms=gn.getUniforms(J),J.onBeforeCompile(An,F),li=gn.acquireProgram(An,yn),ai.set(yn,li),Ve.uniforms=An.uniforms;const Sn=Ve.uniforms;return(!J.isShaderMaterial&&!J.isRawShaderMaterial||!0===J.clipping)&&(Sn.clippingPlanes=At.uniform),Yg(J,An),Ve.needsLights=function t0(J){return J.isMeshLambertMaterial||J.isMeshToonMaterial||J.isMeshPhongMaterial||J.isMeshStandardMaterial||J.isShadowMaterial||J.isShaderMaterial&&!0===J.lights}(J),Ve.lightsStateVersion=Vt,Ve.needsLights&&(Sn.ambientLightColor.value=Me.state.ambient,Sn.lightProbe.value=Me.state.probe,Sn.directionalLights.value=Me.state.directional,Sn.directionalLightShadows.value=Me.state.directionalShadow,Sn.spotLights.value=Me.state.spot,Sn.spotLightShadows.value=Me.state.spotShadow,Sn.rectAreaLights.value=Me.state.rectArea,Sn.ltc_1.value=Me.state.rectAreaLTC1,Sn.ltc_2.value=Me.state.rectAreaLTC2,Sn.pointLights.value=Me.state.point,Sn.pointLightShadows.value=Me.state.pointShadow,Sn.hemisphereLights.value=Me.state.hemi,Sn.directionalShadowMap.value=Me.state.directionalShadowMap,Sn.directionalShadowMatrix.value=Me.state.directionalShadowMatrix,Sn.spotShadowMap.value=Me.state.spotShadowMap,Sn.spotLightMatrix.value=Me.state.spotLightMatrix,Sn.spotLightMap.value=Me.state.spotLightMap,Sn.pointShadowMap.value=Me.state.pointShadowMap,Sn.pointShadowMatrix.value=Me.state.pointShadowMatrix),Ve.currentProgram=li,Ve.uniformsList=null,li}function go(J){if(null===J.uniformsList){const _e=J.currentProgram.getUniforms();J.uniformsList=qc.seqWithValue(_e.seq,J.uniforms)}return J.uniformsList}function Yg(J,_e){const ke=Kt.get(J);ke.outputColorSpace=_e.outputColorSpace,ke.batching=_e.batching,ke.batchingColor=_e.batchingColor,ke.instancing=_e.instancing,ke.instancingColor=_e.instancingColor,ke.instancingMorph=_e.instancingMorph,ke.skinning=_e.skinning,ke.morphTargets=_e.morphTargets,ke.morphNormals=_e.morphNormals,ke.morphColors=_e.morphColors,ke.morphTargetsCount=_e.morphTargetsCount,ke.numClippingPlanes=_e.numClippingPlanes,ke.numIntersection=_e.numClipIntersection,ke.vertexAlphas=_e.vertexAlphas,ke.vertexTangents=_e.vertexTangents,ke.toneMapping=_e.toneMapping}Eu.setAnimationLoop(function ll(J){ba&&ba(J)}),typeof self<"u"&&Eu.setContext(self),this.setAnimationLoop=function(J){ba=J,Xe.setAnimationLoop(J),null===J?Eu.stop():Eu.start()},Xe.addEventListener("sessionstart",ME),Xe.addEventListener("sessionend",xu),this.render=function(J,_e){if(void 0!==_e&&!0!==_e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===ne)return;if(!0===J.matrixWorldAutoUpdate&&J.updateMatrixWorld(),null===_e.parent&&!0===_e.matrixWorldAutoUpdate&&_e.updateMatrixWorld(),!0===Xe.enabled&&!0===Xe.isPresenting&&(!0===Xe.cameraAutoUpdate&&Xe.updateCamera(_e),_e=Xe.getCamera()),!0===J.isScene&&J.onBeforeRender(F,J,_e,se),T=Fi.get(J,V.length),T.init(_e),V.push(T),bn.multiplyMatrices(_e.projectionMatrix,_e.matrixWorldInverse),tt.setFromProjectionMatrix(bn),Yt=this.localClippingEnabled,Ct=At.init(this.clippingPlanes,Yt),R=rn.get(J,B.length),R.init(),B.push(R),!0===Xe.enabled&&!0===Xe.isPresenting){const Rt=F.xr.getDepthSensingMesh();null!==Rt&&Xg(Rt,_e,-1/0,F.sortObjects)}Xg(J,_e,0,F.sortObjects),R.finish(),!0===F.sortObjects&&R.sort(Ot,Xt),ft=!1===Xe.enabled||!1===Xe.isPresenting||!1===Xe.hasDepthSensing(),ft&&jn.addToRenderList(R,J),this.info.render.frame++,!0===Ct&&At.beginShadows(),pn.render(T.state.shadowsArray,J,_e),!0===Ct&&At.endShadows(),!0===this.info.autoReset&&this.info.reset();const Ve=R.opaque,Me=R.transmissive;if(T.setupLights(),_e.isArrayCamera){const Rt=_e.cameras;if(Me.length>0)for(let Vt=0,An=Rt.length;Vt<An;Vt++)bu(Ve,Me,J,Rt[Vt]);ft&&jn.render(J);for(let Vt=0,An=Rt.length;Vt<An;Vt++){const yn=Rt[Vt];Q_(R,J,yn,yn.viewport)}}else Me.length>0&&bu(Ve,Me,J,_e),ft&&jn.render(J),Q_(R,J,_e);null!==se&&(re.updateMultisampleRenderTarget(se),re.updateRenderTargetMipmap(se)),!0===J.isScene&&J.onAfterRender(F,J,_e),Cr.resetDefaultState(),X=-1,j=null,V.pop(),V.length>0?(T=V[V.length-1],!0===Ct&&At.setGlobalState(F.clippingPlanes,T.state.camera)):T=null,B.pop(),R=B.length>0?B[B.length-1]:null},this.getActiveCubeFace=function(){return Q},this.getActiveMipmapLevel=function(){return te},this.getRenderTarget=function(){return se},this.setRenderTargetTextures=function(J,_e,ke){Kt.get(J.texture).__webglTexture=_e,Kt.get(J.depthTexture).__webglTexture=ke;const Ve=Kt.get(J);Ve.__hasExternalTextures=!0,Ve.__autoAllocateDepthBuffer=void 0===ke,Ve.__autoAllocateDepthBuffer||!0===Et.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Ve.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(J,_e){const ke=Kt.get(J);ke.__webglFramebuffer=_e,ke.__useDefaultFramebuffer=void 0===_e},this.setRenderTarget=function(J,_e=0,ke=0){se=J,Q=_e,te=ke;let Ve=!0,Me=null,Rt=!1,Vt=!1;if(J){const yn=Kt.get(J);if(void 0!==yn.__useDefaultFramebuffer)Ut.bindFramebuffer(ce.FRAMEBUFFER,null),Ve=!1;else if(void 0===yn.__webglFramebuffer)re.setupRenderTarget(J);else if(yn.__hasExternalTextures)re.rebindTextures(J,Kt.get(J.texture).__webglTexture,Kt.get(J.depthTexture).__webglTexture);else if(J.depthBuffer){const Sn=J.depthTexture;if(yn.__boundDepthTexture!==Sn){if(null!==Sn&&Kt.has(Sn)&&(J.width!==Sn.image.width||J.height!==Sn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");re.setupDepthRenderbuffer(J)}}const ai=J.texture;(ai.isData3DTexture||ai.isDataArrayTexture||ai.isCompressedArrayTexture)&&(Vt=!0);const li=Kt.get(J).__webglFramebuffer;J.isWebGLCubeRenderTarget?(Me=Array.isArray(li[_e])?li[_e][ke]:li[_e],Rt=!0):Me=J.samples>0&&!1===re.useMultisampledRTT(J)?Kt.get(J).__webglMultisampledFramebuffer:Array.isArray(li)?li[ke]:li,fe.copy(J.viewport),Re.copy(J.scissor),Ce=J.scissorTest}else fe.copy(on).multiplyScalar(je).floor(),Re.copy(oi).multiplyScalar(je).floor(),Ce=Ni;if(Ut.bindFramebuffer(ce.FRAMEBUFFER,Me)&&Ve&&Ut.drawBuffers(J,Me),Ut.viewport(fe),Ut.scissor(Re),Ut.setScissorTest(Ce),Rt){const yn=Kt.get(J.texture);ce.framebufferTexture2D(ce.FRAMEBUFFER,ce.COLOR_ATTACHMENT0,ce.TEXTURE_CUBE_MAP_POSITIVE_X+_e,yn.__webglTexture,ke)}else if(Vt){const yn=Kt.get(J.texture);ce.framebufferTextureLayer(ce.FRAMEBUFFER,ce.COLOR_ATTACHMENT0,yn.__webglTexture,ke||0,_e||0)}X=-1},this.readRenderTargetPixels=function(J,_e,ke,Ve,Me,Rt,Vt){if(!J||!J.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let An=Kt.get(J).__webglFramebuffer;if(J.isWebGLCubeRenderTarget&&void 0!==Vt&&(An=An[Vt]),An){Ut.bindFramebuffer(ce.FRAMEBUFFER,An);try{const yn=J.texture,ai=yn.format,li=yn.type;if(!ln.textureFormatReadable(ai))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!ln.textureTypeReadable(li))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");_e>=0&&_e<=J.width-Ve&&ke>=0&&ke<=J.height-Me&&ce.readPixels(_e,ke,Ve,Me,Ei.convert(ai),Ei.convert(li),Rt)}finally{const yn=null!==se?Kt.get(se).__webglFramebuffer:null;Ut.bindFramebuffer(ce.FRAMEBUFFER,yn)}}},this.readRenderTargetPixelsAsync=function(){var J=(0,pt.Z)(function*(_e,ke,Ve,Me,Rt,Vt,An){if(!_e||!_e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let yn=Kt.get(_e).__webglFramebuffer;if(_e.isWebGLCubeRenderTarget&&void 0!==An&&(yn=yn[An]),yn){const ai=_e.texture,li=ai.format,Sn=ai.type;if(!ln.textureFormatReadable(li))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!ln.textureTypeReadable(Sn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(ke>=0&&ke<=_e.width-Me&&Ve>=0&&Ve<=_e.height-Rt){Ut.bindFramebuffer(ce.FRAMEBUFFER,yn);const Vi=ce.createBuffer();ce.bindBuffer(ce.PIXEL_PACK_BUFFER,Vi),ce.bufferData(ce.PIXEL_PACK_BUFFER,Vt.byteLength,ce.STREAM_READ),ce.readPixels(ke,Ve,Me,Rt,Ei.convert(li),Ei.convert(Sn),0);const Tr=null!==se?Kt.get(se).__webglFramebuffer:null;Ut.bindFramebuffer(ce.FRAMEBUFFER,Tr);const pr=ce.fenceSync(ce.SYNC_GPU_COMMANDS_COMPLETE,0);return ce.flush(),yield function jh(c,e,t){return new Promise(function(r,o){setTimeout(function l(){switch(c.clientWaitSync(e,c.SYNC_FLUSH_COMMANDS_BIT,0)){case c.WAIT_FAILED:o();break;case c.TIMEOUT_EXPIRED:setTimeout(l,t);break;default:r()}},t)})}(ce,pr,4),ce.bindBuffer(ce.PIXEL_PACK_BUFFER,Vi),ce.getBufferSubData(ce.PIXEL_PACK_BUFFER,0,Vt),ce.deleteBuffer(Vi),ce.deleteSync(pr),Vt}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}});return function(_e,ke,Ve,Me,Rt,Vt,An){return J.apply(this,arguments)}}(),this.copyFramebufferToTexture=function(J,_e=null,ke=0){!0!==J.isTexture&&(Rc("WebGLRenderer: copyFramebufferToTexture function signature has changed."),_e=arguments[0]||null,J=arguments[1]);const Ve=Math.pow(2,-ke),Me=Math.floor(J.image.width*Ve),Rt=Math.floor(J.image.height*Ve),Vt=null!==_e?_e.x:0,An=null!==_e?_e.y:0;re.setTexture2D(J,0),ce.copyTexSubImage2D(ce.TEXTURE_2D,ke,0,0,Vt,An,Me,Rt),Ut.unbindTexture()},this.copyTextureToTexture=function(J,_e,ke=null,Ve=null,Me=0){let Rt,Vt,An,yn,ai,li,Sn,Vi,Tr;!0!==J.isTexture&&(Rc("WebGLRenderer: copyTextureToTexture function signature has changed."),Ve=arguments[0]||null,J=arguments[1],_e=arguments[2],Me=arguments[3]||0,ke=null);const pr=J.isCompressedTexture?J.mipmaps[Me]:J.image;null!==ke?(Rt=ke.max.x-ke.min.x,Vt=ke.max.y-ke.min.y,An=ke.isBox3?ke.max.z-ke.min.z:1,yn=ke.min.x,ai=ke.min.y,li=ke.isBox3?ke.min.z:0):(Rt=pr.width,Vt=pr.height,An=pr.depth||1,yn=0,ai=0,li=0),null!==Ve?(Sn=Ve.x,Vi=Ve.y,Tr=Ve.z):(Sn=0,Vi=0,Tr=0);const Bs=Ei.convert(_e.format),ji=Ei.convert(_e.type);let Dn;_e.isData3DTexture?(re.setTexture3D(_e,0),Dn=ce.TEXTURE_3D):_e.isDataArrayTexture||_e.isCompressedArrayTexture?(re.setTexture2DArray(_e,0),Dn=ce.TEXTURE_2D_ARRAY):(re.setTexture2D(_e,0),Dn=ce.TEXTURE_2D),ce.pixelStorei(ce.UNPACK_FLIP_Y_WEBGL,_e.flipY),ce.pixelStorei(ce.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_e.premultiplyAlpha),ce.pixelStorei(ce.UNPACK_ALIGNMENT,_e.unpackAlignment);const Fl=ce.getParameter(ce.UNPACK_ROW_LENGTH),sr=ce.getParameter(ce.UNPACK_IMAGE_HEIGHT),Sa=ce.getParameter(ce.UNPACK_SKIP_PIXELS),wu=ce.getParameter(ce.UNPACK_SKIP_ROWS),Po=ce.getParameter(ce.UNPACK_SKIP_IMAGES);ce.pixelStorei(ce.UNPACK_ROW_LENGTH,pr.width),ce.pixelStorei(ce.UNPACK_IMAGE_HEIGHT,pr.height),ce.pixelStorei(ce.UNPACK_SKIP_PIXELS,yn),ce.pixelStorei(ce.UNPACK_SKIP_ROWS,ai),ce.pixelStorei(ce.UNPACK_SKIP_IMAGES,li);const Bh=J.isDataArrayTexture||J.isData3DTexture,Ar=_e.isDataArrayTexture||_e.isData3DTexture;if(J.isRenderTargetTexture||J.isDepthTexture){const cl=Kt.get(J),Vh=Kt.get(_e),La=Kt.get(cl.__renderTarget),Cu=Kt.get(Vh.__renderTarget);Ut.bindFramebuffer(ce.READ_FRAMEBUFFER,La.__webglFramebuffer),Ut.bindFramebuffer(ce.DRAW_FRAMEBUFFER,Cu.__webglFramebuffer);for(let Tu=0;Tu<An;Tu++)Bh&&ce.framebufferTextureLayer(ce.READ_FRAMEBUFFER,ce.COLOR_ATTACHMENT0,Kt.get(J).__webglTexture,Me,li+Tu),J.isDepthTexture?(Ar&&ce.framebufferTextureLayer(ce.DRAW_FRAMEBUFFER,ce.COLOR_ATTACHMENT0,Kt.get(_e).__webglTexture,Me,Tr+Tu),ce.blitFramebuffer(yn,ai,Rt,Vt,Sn,Vi,Rt,Vt,ce.DEPTH_BUFFER_BIT,ce.NEAREST)):Ar?ce.copyTexSubImage3D(Dn,Me,Sn,Vi,Tr+Tu,yn,ai,Rt,Vt):ce.copyTexSubImage2D(Dn,Me,Sn,Vi,Tr+Tu,yn,ai,Rt,Vt);Ut.bindFramebuffer(ce.READ_FRAMEBUFFER,null),Ut.bindFramebuffer(ce.DRAW_FRAMEBUFFER,null)}else Ar?J.isDataTexture||J.isData3DTexture?ce.texSubImage3D(Dn,Me,Sn,Vi,Tr,Rt,Vt,An,Bs,ji,pr.data):_e.isCompressedArrayTexture?ce.compressedTexSubImage3D(Dn,Me,Sn,Vi,Tr,Rt,Vt,An,Bs,pr.data):ce.texSubImage3D(Dn,Me,Sn,Vi,Tr,Rt,Vt,An,Bs,ji,pr):J.isDataTexture?ce.texSubImage2D(ce.TEXTURE_2D,Me,Sn,Vi,Rt,Vt,Bs,ji,pr.data):J.isCompressedTexture?ce.compressedTexSubImage2D(ce.TEXTURE_2D,Me,Sn,Vi,pr.width,pr.height,Bs,pr.data):ce.texSubImage2D(ce.TEXTURE_2D,Me,Sn,Vi,Rt,Vt,Bs,ji,pr);ce.pixelStorei(ce.UNPACK_ROW_LENGTH,Fl),ce.pixelStorei(ce.UNPACK_IMAGE_HEIGHT,sr),ce.pixelStorei(ce.UNPACK_SKIP_PIXELS,Sa),ce.pixelStorei(ce.UNPACK_SKIP_ROWS,wu),ce.pixelStorei(ce.UNPACK_SKIP_IMAGES,Po),0===Me&&_e.generateMipmaps&&ce.generateMipmap(Dn),Ut.unbindTexture()},this.copyTextureToTexture3D=function(J,_e,ke=null,Ve=null,Me=0){return!0!==J.isTexture&&(Rc("WebGLRenderer: copyTextureToTexture3D function signature has changed."),ke=arguments[0]||null,Ve=arguments[1]||null,J=arguments[2],_e=arguments[3],Me=arguments[4]||0),Rc('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(J,_e,ke,Ve,Me)},this.initRenderTarget=function(J){void 0===Kt.get(J).__webglFramebuffer&&re.setupRenderTarget(J)},this.initTexture=function(J){J.isCubeTexture?re.setTextureCube(J,0):J.isData3DTexture?re.setTexture3D(J,0):J.isDataArrayTexture||J.isCompressedArrayTexture?re.setTexture2DArray(J,0):re.setTexture2D(J,0),Ut.unbindTexture()},this.resetState=function(){Q=0,te=0,se=null,Ut.reset(),Cr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return rr}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorspace=fi._getDrawingBufferColorSpace(e),t.unpackColorSpace=fi._getUnpackColorSpace()}}class ih extends ms{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Da,this.environmentIntensity=1,this.environmentRotation=new Da,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class ac{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRanges=[],this.version=0,this.uuid=ss()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let o=0,l=this.stride;o<l;o++)this.array[e+o]=t.array[r+o];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ss()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ss()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ws=new ee;class Sl{constructor(e,t,r,o=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=o}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Ws.fromBufferAttribute(this,t),Ws.applyMatrix4(e),this.setXYZ(t,Ws.x,Ws.y,Ws.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Ws.fromBufferAttribute(this,t),Ws.applyNormalMatrix(e),this.setXYZ(t,Ws.x,Ws.y,Ws.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Ws.fromBufferAttribute(this,t),Ws.transformDirection(e),this.setXYZ(t,Ws.x,Ws.y,Ws.z);return this}getComponent(e,t){let r=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(r=hr(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=qn(r,this.array)),this.data.array[e*this.data.stride+this.offset+t]=r,this}setX(e,t){return this.normalized&&(t=qn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=qn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=qn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=qn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=hr(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=hr(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=hr(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=hr(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=qn(t,this.array),r=qn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,o){return e=e*this.data.stride+this.offset,this.normalized&&(t=qn(t,this.array),r=qn(r,this.array),o=qn(o,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=o,this}setXYZW(e,t,r,o,l){return e=e*this.data.stride+this.offset,this.normalized&&(t=qn(t,this.array),r=qn(r,this.array),o=qn(o,this.array),l=qn(l,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=o,this.data.array[e+3]=l,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const o=r*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[o+l])}return new xr(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Sl(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const o=r*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[o+l])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const ah=new ee,Ty=new dn,Bm=new dn,rx=new ee,Vm=new In,Hm=new ee,zm=new Br,cd=new In,Gm=new Oc;class ru extends Rs{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=ta,this.bindMatrix=new In,this.bindMatrixInverse=new In,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Ks),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,Hm),this.boundingBox.expandByPoint(Hm)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new Br),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,Hm),this.boundingSphere.expandByPoint(Hm)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const o=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),zm.copy(this.boundingSphere),zm.applyMatrix4(o),!1!==e.ray.intersectsSphere(zm)&&(cd.copy(o).invert(),Gm.copy(e.ray).applyMatrix4(cd),(null===this.boundingBox||!1!==Gm.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,Gm)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new dn,t=this.geometry.attributes.skinWeight;for(let r=0,o=t.count;r<o;r++){e.fromBufferAttribute(t,r);const l=1/e.manhattanLength();l!==1/0?e.multiplyScalar(l):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===ta?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const r=this.skeleton,o=this.geometry;Ty.fromBufferAttribute(o.attributes.skinIndex,e),Bm.fromBufferAttribute(o.attributes.skinWeight,e),ah.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let l=0;l<4;l++){const u=Bm.getComponent(l);if(0!==u){const h=Ty.getComponent(l);Vm.multiplyMatrices(r.bones[h].matrixWorld,r.boneInverses[h]),t.addScaledVector(rx.copy(ah).applyMatrix4(Vm),u)}}return t.applyMatrix4(this.bindMatrixInverse)}}class su extends ms{constructor(){super(),this.isBone=!0,this.type="Bone"}}class wl extends Ii{constructor(e=null,t=1,r=1,o,l,u,h,p,m=_i,v=_i,y,M){super(null,u,h,p,m,v,o,l,y,M),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Wm=new In,sx=new In;class Uf{constructor(e=[],t=[]){this.uuid=ss(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,o=this.bones.length;r<o;r++)this.boneInverses.push(new In)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new In;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,o=this.boneTexture;for(let l=0,u=e.length;l<u;l++)Wm.multiplyMatrices(e[l]?e[l].matrixWorld:sx,t[l]),Wm.toArray(r,16*l);null!==o&&(o.needsUpdate=!0)}clone(){return new Uf(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new wl(t,e,e,br,Fr);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const o=this.bones[t];if(o.name===e)return o}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,o=e.bones.length;r<o;r++){const l=e.bones[r];let u=t[l];void 0===u&&(console.warn("THREE.Skeleton: No bone found with UUID:",l),u=new su),this.bones.push(u),this.boneInverses.push((new In).fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let o=0,l=t.length;o<l;o++)e.bones.push(t[o].uuid),e.boneInverses.push(r[o].toArray());return e}}class ud extends xr{constructor(e,t,r,o=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=o}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const lc=new In,ox=new In,jm=[],ax=new Ks,lx=new In,lh=new Rs,kf=new Br;class ch extends Rs{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new ud(new Float32Array(16*r),16),this.instanceColor=null,this.morphTexture=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let o=0;o<r;o++)this.setMatrixAt(o,lx)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Ks),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,lc),ax.copy(e.boundingBox).applyMatrix4(lc),this.boundingBox.union(ax)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new Br),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,lc),kf.copy(e.boundingSphere).applyMatrix4(lc),this.boundingSphere.union(kf)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){const r=t.morphTargetInfluences,o=this.morphTexture.source.data.data,u=e*(r.length+1)+1;for(let h=0;h<r.length;h++)r[h]=o[u+h]}raycast(e,t){const r=this.matrixWorld,o=this.count;if(lh.geometry=this.geometry,lh.material=this.material,void 0!==lh.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),kf.copy(this.boundingSphere),kf.applyMatrix4(r),!1!==e.ray.intersectsSphere(kf)))for(let l=0;l<o;l++){this.getMatrixAt(l,lc),ox.multiplyMatrices(r,lc),lh.matrixWorld=ox,lh.raycast(e,jm);for(let u=0,h=jm.length;u<h;u++){const p=jm[u];p.instanceId=l,p.object=this,t.push(p)}jm.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new ud(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){const r=t.morphTargetInfluences,o=r.length+1;null===this.morphTexture&&(this.morphTexture=new wl(new Float32Array(o*this.count),o,this.count,he,Fr));const l=this.morphTexture.source.data.data;let u=0;for(let m=0;m<r.length;m++)u+=r[m];const p=o*e;l[p]=this.geometry.morphTargetsRelative?1:1-u,l.set(r,p+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null),this}}class Do extends Wo{static get type(){return"LineBasicMaterial"}constructor(e){super(),this.isLineBasicMaterial=!0,this.color=new kt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const dc=new ee,uh=new ee,Jm=new In,dh=new Oc,Vf=new Br,Qm=new ee,Dy=new ee;class hc extends ms{constructor(e=new si,t=new Do){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,r=[0];for(let o=1,l=t.count;o<l;o++)dc.fromBufferAttribute(t,o-1),uh.fromBufferAttribute(t,o),r[o]=r[o-1],r[o]+=dc.distanceTo(uh);e.setAttribute("lineDistance",new vn(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,o=this.matrixWorld,l=e.params.Line.threshold,u=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),Vf.copy(r.boundingSphere),Vf.applyMatrix4(o),Vf.radius+=l,!1===e.ray.intersectsSphere(Vf))return;Jm.copy(o).invert(),dh.copy(e.ray).applyMatrix4(Jm);const h=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=h*h,m=this.isLineSegments?2:1,v=r.index,M=r.attributes.position;if(null!==v){const S=Math.max(0,u.start),A=Math.min(v.count,u.start+u.count);for(let N=S,R=A-1;N<R;N+=m){const T=v.getX(N),B=v.getX(N+1),V=eg(this,e,dh,p,T,B);V&&t.push(V)}if(this.isLineLoop){const N=v.getX(A-1),R=v.getX(S),T=eg(this,e,dh,p,N,R);T&&t.push(T)}}else{const S=Math.max(0,u.start),A=Math.min(M.count,u.start+u.count);for(let N=S,R=A-1;N<R;N+=m){const T=eg(this,e,dh,p,N,N+1);T&&t.push(T)}if(this.isLineLoop){const N=eg(this,e,dh,p,A-1,S);N&&t.push(N)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const o=t[r[0]];if(void 0!==o){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=o.length;l<u;l++){const h=o[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}}function eg(c,e,t,r,o,l){const u=c.geometry.attributes.position;if(dc.fromBufferAttribute(u,o),uh.fromBufferAttribute(u,l),t.distanceSqToSegment(dc,uh,Qm,Dy)>r)return;Qm.applyMatrix4(c.matrixWorld);const p=e.ray.origin.distanceTo(Qm);return p<e.near||p>e.far?void 0:{distance:p,point:Dy.clone().applyMatrix4(c.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:c}}const Hf=new ee,Cl=new ee;class zf extends hc{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,r=[];for(let o=0,l=t.count;o<l;o+=2)Hf.fromBufferAttribute(t,o),Cl.fromBufferAttribute(t,o+1),r[o]=0===o?0:r[o-1],r[o+1]=r[o]+Hf.distanceTo(Cl);e.setAttribute("lineDistance",new vn(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class hh extends hc{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Gf extends Wo{static get type(){return"PointsMaterial"}constructor(e){super(),this.isPointsMaterial=!0,this.color=new kt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const tg=new In,ng=new Oc,Wf=new Br,jf=new ee;class Iy extends ms{constructor(e=new si,t=new Gf){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,o=this.matrixWorld,l=e.params.Points.threshold,u=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),Wf.copy(r.boundingSphere),Wf.applyMatrix4(o),Wf.radius+=l,!1===e.ray.intersectsSphere(Wf))return;tg.copy(o).invert(),ng.copy(e.ray).applyMatrix4(tg);const h=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=h*h,m=r.index,y=r.attributes.position;if(null!==m)for(let A=Math.max(0,u.start),N=Math.min(m.count,u.start+u.count);A<N;A++){const R=m.getX(A);jf.fromBufferAttribute(y,R),ig(jf,R,p,o,e,t,this)}else for(let A=Math.max(0,u.start),N=Math.min(y.count,u.start+u.count);A<N;A++)jf.fromBufferAttribute(y,A),ig(jf,A,p,o,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const o=t[r[0]];if(void 0!==o){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,u=o.length;l<u;l++){const h=o[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}}function ig(c,e,t,r,o,l,u){const h=ng.distanceSqToPoint(c);if(h<t){const p=new ee;ng.closestPointToPoint(c,p),p.applyMatrix4(r);const m=o.ray.origin.distanceTo(p);if(m<o.near||m>o.far)return;l.push({distance:m,distanceToRay:Math.sqrt(h),point:p,index:e,face:null,faceIndex:null,barycoord:null,object:u})}}class Kf extends si{constructor(e=1,t=32,r=0,o=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:o},t=Math.max(3,t);const l=[],u=[],h=[],p=[],m=new ee,v=new Je;u.push(0,0,0),h.push(0,0,1),p.push(.5,.5);for(let y=0,M=3;y<=t;y++,M+=3){const S=r+y/t*o;m.x=e*Math.cos(S),m.y=e*Math.sin(S),u.push(m.x,m.y,m.z),h.push(0,0,1),v.x=(u[M]/e+1)/2,v.y=(u[M+1]/e+1)/2,p.push(v.x,v.y)}for(let y=1;y<=t;y++)l.push(y,y+1,0);this.setIndex(l),this.setAttribute("position",new vn(u,3)),this.setAttribute("normal",new vn(h,3)),this.setAttribute("uv",new vn(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Kf(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class _a extends Wo{static get type(){return"MeshStandardMaterial"}constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.color=new kt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Da,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ra extends _a{static get type(){return"MeshPhysicalMaterial"}constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Je(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Gi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new kt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new kt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new kt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class dp extends Wo{static get type(){return"MeshPhongMaterial"}constructor(e){super(),this.isMeshPhongMaterial=!0,this.color=new kt(16777215),this.specular=new kt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Da,this.combine=Ss,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function cu(c,e,t){return!c||!t&&c.constructor===e?c:"number"==typeof e.BYTES_PER_ELEMENT?new e(c):Array.prototype.slice.call(c)}function Qy(c){const t=c.length,r=new Array(t);for(let o=0;o!==t;++o)r[o]=o;return r.sort(function e(o,l){return c[o]-c[l]}),r}function _g(c,e,t){const r=c.length,o=new c.constructor(r);for(let l=0,u=0;u!==r;++l){const h=t[l]*e;for(let p=0;p!==e;++p)o[u++]=c[h+p]}return o}function Mh(c,e,t,r){let o=1,l=c[0];for(;void 0!==l&&void 0===l[r];)l=c[o++];if(void 0===l)return;let u=l[r];if(void 0!==u)if(Array.isArray(u))do{u=l[r],void 0!==u&&(e.push(l.time),t.push.apply(t,u)),l=c[o++]}while(void 0!==l);else if(void 0!==u.toArray)do{u=l[r],void 0!==u&&(e.push(l.time),u.toArray(t,t.length)),l=c[o++]}while(void 0!==l);else do{u=l[r],void 0!==u&&(e.push(l.time),t.push(u)),l=c[o++]}while(void 0!==l)}class xh{constructor(e,t,r,o){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==o?o:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,o=t[r],l=t[r-1];e:{t:{let u;n:{i:if(!(e<o)){for(let h=r+2;;){if(void 0===o){if(e<l)break i;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===h)break;if(l=o,o=t[++r],e<o)break t}u=t.length;break n}if(e>=l)break e;{const h=t[1];e<h&&(r=2,l=h);for(let p=r-2;;){if(void 0===l)return this._cachedIndex=0,this.copySampleValue_(0);if(r===p)break;if(o=l,l=t[--r-1],e>=l)break t}u=r,r=0}}for(;r<u;){const h=r+u>>>1;e<t[h]?u=h:r=h+1}if(o=t[r],l=t[r-1],void 0===l)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===o)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,l,o)}return this.interpolate_(r,l,e,o)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,o=this.valueSize,l=e*o;for(let u=0;u!==o;++u)t[u]=r[l+u];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Ax extends xh{constructor(e,t,r,o){super(e,t,r,o),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,r){const o=this.parameterPositions;let l=e-2,u=e+1,h=o[l],p=o[u];if(void 0===h)switch(this.getSettings_().endingStart){case 2401:l=e,h=2*t-r;break;case 2402:l=o.length-2,h=t+o[l]-o[l+1];break;default:l=e,h=r}if(void 0===p)switch(this.getSettings_().endingEnd){case 2401:u=e,p=2*r-t;break;case 2402:u=1,p=r+o[1]-o[0];break;default:u=e-1,p=t}const m=.5*(r-t),v=this.valueSize;this._weightPrev=m/(t-h),this._weightNext=m/(p-r),this._offsetPrev=l*v,this._offsetNext=u*v}interpolate_(e,t,r,o){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=e*h,m=p-h,v=this._offsetPrev,y=this._offsetNext,M=this._weightPrev,S=this._weightNext,A=(r-t)/(o-t),N=A*A,R=N*A,T=-M*R+2*M*N-M*A,B=(1+M)*R+(-1.5-2*M)*N+(-.5+M)*A+1,V=(-1-S)*R+(1.5+S)*N+.5*A,F=S*R-S*N;for(let ne=0;ne!==h;++ne)l[ne]=T*u[v+ne]+B*u[m+ne]+V*u[p+ne]+F*u[y+ne];return l}}class mc extends xh{constructor(e,t,r,o){super(e,t,r,o)}interpolate_(e,t,r,o){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=e*h,m=p-h,v=(r-t)/(o-t),y=1-v;for(let M=0;M!==h;++M)l[M]=u[m+M]*y+u[p+M]*v;return l}}class n_ extends xh{constructor(e,t,r,o){super(e,t,r,o)}interpolate_(e){return this.copySampleValue_(e-1)}}class Pa{constructor(e,t,r,o){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=cu(t,this.TimeBufferType),this.values=cu(r,this.ValueBufferType),this.setInterpolation(o||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:cu(e.times,Array),values:cu(e.values,Array)};const o=e.getInterpolation();o!==e.DefaultInterpolation&&(r.interpolation=o)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new n_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new mc(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Ax(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case ko:t=this.InterpolantFactoryMethodDiscrete;break;case Hs:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ko;case this.InterpolantFactoryMethodLinear:return Hs;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let r=0,o=t.length;r!==o;++r)t[r]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let r=0,o=t.length;r!==o;++r)t[r]*=e}return this}trim(e,t){const r=this.times,o=r.length;let l=0,u=o-1;for(;l!==o&&r[l]<e;)++l;for(;-1!==u&&r[u]>t;)--u;if(++u,0!==l||u!==o){l>=u&&(u=Math.max(u,1),l=u-1);const h=this.getValueSize();this.times=r.slice(l,u),this.values=this.values.slice(l*h,u*h)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,o=this.values,l=r.length;0===l&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let u=null;for(let h=0;h!==l;h++){const p=r[h];if("number"==typeof p&&isNaN(p)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,h,p),e=!1;break}if(null!==u&&u>p){console.error("THREE.KeyframeTrack: Out of order keys.",this,h,p,u),e=!1;break}u=p}if(void 0!==o&&function hp(c){return ArrayBuffer.isView(c)&&!(c instanceof DataView)}(o))for(let h=0,p=o.length;h!==p;++h){const m=o[h];if(isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,h,m),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),o=2302===this.getInterpolation(),l=e.length-1;let u=1;for(let h=1;h<l;++h){let p=!1;const m=e[h];if(m!==e[h+1]&&(1!==h||m!==e[0]))if(o)p=!0;else{const y=h*r,M=y-r,S=y+r;for(let A=0;A!==r;++A){const N=t[y+A];if(N!==t[M+A]||N!==t[S+A]){p=!0;break}}}if(p){if(h!==u){e[u]=e[h];const y=h*r,M=u*r;for(let S=0;S!==r;++S)t[M+S]=t[y+S]}++u}}if(l>0){e[u]=e[l];for(let h=l*r,p=u*r,m=0;m!==r;++m)t[p+m]=t[h+m];++u}return u!==e.length?(this.times=e.slice(0,u),this.values=t.slice(0,u*r)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),o=new(0,this.constructor)(this.name,e,t);return o.createInterpolant=this.createInterpolant,o}}Pa.prototype.TimeBufferType=Float32Array,Pa.prototype.ValueBufferType=Float32Array,Pa.prototype.DefaultInterpolation=Hs;class yd extends Pa{constructor(e,t,r){super(e,t,r)}}yd.prototype.ValueTypeName="bool",yd.prototype.ValueBufferType=Array,yd.prototype.DefaultInterpolation=ko,yd.prototype.InterpolantFactoryMethodLinear=void 0,yd.prototype.InterpolantFactoryMethodSmooth=void 0;class Mg extends Pa{}Mg.prototype.ValueTypeName="color";class uu extends Pa{}uu.prototype.ValueTypeName="number";class i_ extends xh{constructor(e,t,r,o){super(e,t,r,o)}interpolate_(e,t,r,o){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=(r-t)/(o-t);let m=e*h;for(let v=m+h;m!==v;m+=4)Ki.slerpFlat(l,0,u,m-h,u,m,p);return l}}class Dl extends Pa{InterpolantFactoryMethodLinear(e){return new i_(this.times,this.values,this.getValueSize(),e)}}Dl.prototype.ValueTypeName="quaternion",Dl.prototype.InterpolantFactoryMethodSmooth=void 0;class _d extends Pa{constructor(e,t,r){super(e,t,r)}}_d.prototype.ValueTypeName="string",_d.prototype.ValueBufferType=Array,_d.prototype.DefaultInterpolation=ko,_d.prototype.InterpolantFactoryMethodLinear=void 0,_d.prototype.InterpolantFactoryMethodSmooth=void 0;class Md extends Pa{}Md.prototype.ValueTypeName="vector";class du{constructor(e="",t=-1,r=[],o=2500){this.name=e,this.tracks=r,this.duration=t,this.blendMode=o,this.uuid=ss(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,o=1/(e.fps||1);for(let u=0,h=r.length;u!==h;++u)t.push(fp(r[u]).scale(o));const l=new this(e.name,e.duration,t,e.blendMode);return l.uuid=e.uuid,l}static toJSON(e){const t=[],r=e.tracks,o={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let l=0,u=r.length;l!==u;++l)t.push(Pa.toJSON(r[l]));return o}static CreateFromMorphTargetSequence(e,t,r,o){const l=t.length,u=[];for(let h=0;h<l;h++){let p=[],m=[];p.push((h+l-1)%l,h,(h+1)%l),m.push(0,1,0);const v=Qy(p);p=_g(p,1,v),m=_g(m,1,v),!o&&0===p[0]&&(p.push(l),m.push(m[0])),u.push(new uu(".morphTargetInfluences["+t[h].name+"]",p,m).scale(1/r))}return new this(e,-1,u)}static findByName(e,t){let r=e;Array.isArray(e)||(r=e.geometry&&e.geometry.animations||e.animations);for(let o=0;o<r.length;o++)if(r[o].name===t)return r[o];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const o={},l=/^([\w-]*?)([\d]+)$/;for(let h=0,p=e.length;h<p;h++){const m=e[h],v=m.name.match(l);if(v&&v.length>1){const y=v[1];let M=o[y];M||(o[y]=M=[]),M.push(m)}}const u=[];for(const h in o)u.push(this.CreateFromMorphTargetSequence(h,o[h],t,r));return u}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(y,M,S,A,N){if(0!==S.length){const R=[],T=[];Mh(S,R,T,A),0!==R.length&&N.push(new y(M,R,T))}},o=[],l=e.name||"default",u=e.fps||30,h=e.blendMode;let p=e.length||-1;const m=e.hierarchy||[];for(let y=0;y<m.length;y++){const M=m[y].keys;if(M&&0!==M.length)if(M[0].morphTargets){const S={};let A;for(A=0;A<M.length;A++)if(M[A].morphTargets)for(let N=0;N<M[A].morphTargets.length;N++)S[M[A].morphTargets[N]]=-1;for(const N in S){const R=[],T=[];for(let B=0;B!==M[A].morphTargets.length;++B){const V=M[A];R.push(V.time),T.push(V.morphTarget===N?1:0)}o.push(new uu(".morphTargetInfluence["+N+"]",R,T))}p=S.length*u}else{const S=".bones["+t[y].name+"]";r(Md,S+".position",M,"pos",o),r(Dl,S+".quaternion",M,"rot",o),r(Md,S+".scale",M,"scl",o)}}return 0===o.length?null:new this(l,p,o,h)}resetDuration(){let t=0;for(let r=0,o=this.tracks.length;r!==o;++r){const l=this.tracks[r];t=Math.max(t,l.times[l.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function fp(c){if(void 0===c.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function Dx(c){switch(c.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return uu;case"vector":case"vector2":case"vector3":case"vector4":return Md;case"color":return Mg;case"quaternion":return Dl;case"bool":case"boolean":return yd;case"string":return _d}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+c)}(c.type);if(void 0===c.times){const t=[],r=[];Mh(c.keys,t,r,"value"),c.times=t,c.values=r}return void 0!==e.parse?e.parse(c):new e(c.name,c.times,c.values,c.interpolation)}const Il={enabled:!1,files:{},add:function(c,e){!1!==this.enabled&&(this.files[c]=e)},get:function(c){if(!1!==this.enabled)return this.files[c]},remove:function(c){delete this.files[c]},clear:function(){this.files={}}};class xg{constructor(e,t,r){const o=this;let p,l=!1,u=0,h=0;const m=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(v){h++,!1===l&&void 0!==o.onStart&&o.onStart(v,u,h),l=!0},this.itemEnd=function(v){u++,void 0!==o.onProgress&&o.onProgress(v,u,h),u===h&&(l=!1,void 0!==o.onLoad&&o.onLoad())},this.itemError=function(v){void 0!==o.onError&&o.onError(v)},this.resolveURL=function(v){return p?p(v):v},this.setURLModifier=function(v){return p=v,this},this.addHandler=function(v,y){return m.push(v,y),this},this.removeHandler=function(v){const y=m.indexOf(v);return-1!==y&&m.splice(y,2),this},this.getHandler=function(v){for(let y=0,M=m.length;y<M;y+=2){const S=m[y],A=m[y+1];if(S.global&&(S.lastIndex=0),S.test(v))return A}return null}}}const Ix=new xg;let Eh=(()=>{class c{constructor(t){this.manager=void 0!==t?t:Ix,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,r){const o=this;return new Promise(function(l,u){o.load(t,l,r,u)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return c.DEFAULT_MATERIAL_NAME="__DEFAULT",c})();const Ko={};class Rx extends Error{constructor(e,t){super(e),this.response=t}}class sl extends Eh{constructor(e){super(e)}load(e,t,r,o){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=Il.get(e);if(void 0!==l)return this.manager.itemStart(e),setTimeout(()=>{t&&t(l),this.manager.itemEnd(e)},0),l;if(void 0!==Ko[e])return void Ko[e].push({onLoad:t,onProgress:r,onError:o});Ko[e]=[],Ko[e].push({onLoad:t,onProgress:r,onError:o});const u=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),h=this.mimeType,p=this.responseType;fetch(u).then(m=>{if(200===m.status||0===m.status){if(0===m.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===m.body||void 0===m.body.getReader)return m;const v=Ko[e],y=m.body.getReader(),M=m.headers.get("X-File-Size")||m.headers.get("Content-Length"),S=M?parseInt(M):0,A=0!==S;let N=0;const R=new ReadableStream({start(T){!function B(){y.read().then(({done:V,value:F})=>{if(V)T.close();else{N+=F.byteLength;const ne=new ProgressEvent("progress",{lengthComputable:A,loaded:N,total:S});for(let Q=0,te=v.length;Q<te;Q++){const se=v[Q];se.onProgress&&se.onProgress(ne)}T.enqueue(F),B()}},V=>{T.error(V)})}()}});return new Response(R)}throw new Rx(`fetch for "${m.url}" responded with ${m.status}: ${m.statusText}`,m)}).then(m=>{switch(p){case"arraybuffer":return m.arrayBuffer();case"blob":return m.blob();case"document":return m.text().then(v=>(new DOMParser).parseFromString(v,h));case"json":return m.json();default:if(void 0===h)return m.text();{const y=/charset="?([^;"\s]*)"?/i.exec(h),M=y&&y[1]?y[1].toLowerCase():void 0,S=new TextDecoder(M);return m.arrayBuffer().then(A=>S.decode(A))}}}).then(m=>{Il.add(e,m);const v=Ko[e];delete Ko[e];for(let y=0,M=v.length;y<M;y++){const S=v[y];S.onLoad&&S.onLoad(m)}}).catch(m=>{const v=Ko[e];if(void 0===v)throw this.manager.itemError(e),m;delete Ko[e];for(let y=0,M=v.length;y<M;y++){const S=v[y];S.onError&&S.onError(m)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class pp extends Eh{constructor(e){super(e)}load(e,t,r,o){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,u=Il.get(e);if(void 0!==u)return l.manager.itemStart(e),setTimeout(function(){t&&t(u),l.manager.itemEnd(e)},0),u;const h=Ic("img");function p(){v(),Il.add(e,this),t&&t(this),l.manager.itemEnd(e)}function m(y){v(),o&&o(y),l.manager.itemError(e),l.manager.itemEnd(e)}function v(){h.removeEventListener("load",p,!1),h.removeEventListener("error",m,!1)}return h.addEventListener("load",p,!1),h.addEventListener("error",m,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(h.crossOrigin=this.crossOrigin),l.manager.itemStart(e),h.src=e,h}}class Eg extends Eh{constructor(e){super(e)}load(e,t,r,o){const l=new Ii,u=new pp(this.manager);return u.setCrossOrigin(this.crossOrigin),u.setPath(this.path),u.load(e,function(h){l.image=h,l.needsUpdate=!0,void 0!==t&&t(l)},r,o),l}}class bh extends ms{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new kt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}const Sg=new In,Sh=new ee,r_=new ee;class wg{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Je(512,512),this.map=null,this.mapPass=null,this.matrix=new In,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Xp,this._frameExtents=new Je(1,1),this._viewportCount=1,this._viewports=[new dn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;Sh.setFromMatrixPosition(e.matrixWorld),t.position.copy(Sh),r_.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(r_),t.updateMatrixWorld(),Sg.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Sg),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(Sg)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Px extends wg{constructor(){super(new ys(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=2*xo*e.angle*this.focus,o=this.mapSize.width/this.mapSize.height,l=e.distance||t.far;(r!==t.fov||o!==t.aspect||l!==t.far)&&(t.fov=r,t.aspect=o,t.far=l,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class s_ extends bh{constructor(e,t,r=0,o=Math.PI/3,l=0,u=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ms.DEFAULT_UP),this.updateMatrix(),this.target=new ms,this.distance=r,this.angle=o,this.penumbra=l,this.decay=u,this.map=null,this.shadow=new Px}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const o_=new In,wh=new ee,Cg=new ee;class a_ extends wg{constructor(){super(new ys(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Je(4,2),this._viewportCount=6,this._viewports=[new dn(2,1,1,1),new dn(0,1,1,1),new dn(3,1,1,1),new dn(1,1,1,1),new dn(3,0,1,1),new dn(1,0,1,1)],this._cubeDirections=[new ee(1,0,0),new ee(-1,0,0),new ee(0,0,1),new ee(0,0,-1),new ee(0,1,0),new ee(0,-1,0)],this._cubeUps=[new ee(0,1,0),new ee(0,1,0),new ee(0,1,0),new ee(0,1,0),new ee(0,0,1),new ee(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,o=this.matrix,l=e.distance||r.far;l!==r.far&&(r.far=l,r.updateProjectionMatrix()),wh.setFromMatrixPosition(e.matrixWorld),r.position.copy(wh),Cg.copy(r.position),Cg.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(Cg),r.updateMatrixWorld(),o.makeTranslation(-wh.x,-wh.y,-wh.z),o_.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o_)}}class Ch extends bh{constructor(e,t,r=0,o=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=o,this.shadow=new a_}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Nx extends wg{constructor(){super(new nc(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class l_ extends bh{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ms.DEFAULT_UP),this.updateMatrix(),this.target=new ms,this.shadow=new Nx}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Tg extends bh{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Zo{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let r=0,o=e.length;r<o;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Ed extends Eh{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,o){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,u=Il.get(e);if(void 0!==u)return l.manager.itemStart(e),u.then?void u.then(m=>{t&&t(m),l.manager.itemEnd(e)}).catch(m=>{o&&o(m)}):(setTimeout(function(){t&&t(u),l.manager.itemEnd(e)},0),u);const h={};h.credentials="anonymous"===this.crossOrigin?"same-origin":"include",h.headers=this.requestHeader;const p=fetch(e,h).then(function(m){return m.blob()}).then(function(m){return createImageBitmap(m,Object.assign(l.options,{colorSpaceConversion:"none"}))}).then(function(m){return Il.add(e,m),t&&t(m),l.manager.itemEnd(e),m}).catch(function(m){o&&o(m),Il.remove(e),l.manager.itemError(e),l.manager.itemEnd(e)});Il.add(e,p),l.manager.itemStart(e)}}const Dh="\\[\\]\\.:\\/",Jb=new RegExp("["+Dh+"]","g"),m_="[^"+Dh+"]",kx="[^"+Dh.replace("\\.","")+"]",v_=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",m_)+/(WCOD+)?/.source.replace("WCOD",kx)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",m_)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",m_)+"$"),Hx=["material","materials","bones","map"];class zx{constructor(e,t,r){const o=r||Er.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,o)}getValue(e,t){this.bind();const o=this._bindings[this._targetGroup.nCachedObjects_];void 0!==o&&o.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let o=this._targetGroup.nCachedObjects_,l=r.length;o!==l;++o)r[o].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}let Er=(()=>{class c{constructor(t,r,o){this.path=r,this.parsedPath=o||c.parseTrackName(r),this.node=c.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,r,o){return t&&t.isAnimationObjectGroup?new c.Composite(t,r,o):new c(t,r,o)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Jb,"")}static parseTrackName(t){const r=v_.exec(t);if(null===r)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const o={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]},l=o.nodeName&&o.nodeName.lastIndexOf(".");if(void 0!==l&&-1!==l){const u=o.nodeName.substring(l+1);-1!==Hx.indexOf(u)&&(o.nodeName=o.nodeName.substring(0,l),o.objectName=u)}if(null===o.propertyName||0===o.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return o}static findNode(t,r){if(void 0===r||""===r||"."===r||-1===r||r===t.name||r===t.uuid)return t;if(t.skeleton){const o=t.skeleton.getBoneByName(r);if(void 0!==o)return o}if(t.children){const o=function(u){for(let h=0;h<u.length;h++){const p=u[h];if(p.name===r||p.uuid===r)return p;const m=o(p.children);if(m)return m}return null},l=o(t.children);if(l)return l}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,r){t[r]=this.targetObject[this.propertyName]}_getValue_array(t,r){const o=this.resolvedProperty;for(let l=0,u=o.length;l!==u;++l)t[r++]=o[l]}_getValue_arrayElement(t,r){t[r]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,r){this.resolvedProperty.toArray(t,r)}_setValue_direct(t,r){this.targetObject[this.propertyName]=t[r]}_setValue_direct_setNeedsUpdate(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,r){const o=this.resolvedProperty;for(let l=0,u=o.length;l!==u;++l)o[l]=t[r++]}_setValue_array_setNeedsUpdate(t,r){const o=this.resolvedProperty;for(let l=0,u=o.length;l!==u;++l)o[l]=t[r++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,r){const o=this.resolvedProperty;for(let l=0,u=o.length;l!==u;++l)o[l]=t[r++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,r){this.resolvedProperty[this.propertyIndex]=t[r]}_setValue_arrayElement_setNeedsUpdate(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,r){this.resolvedProperty.fromArray(t,r)}_setValue_fromArray_setNeedsUpdate(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,r){this.bind(),this.getValue(t,r)}_setValue_unbound(t,r){this.bind(),this.setValue(t,r)}bind(){let t=this.node;const r=this.parsedPath,o=r.objectName,l=r.propertyName;let u=r.propertyIndex;if(t||(t=c.findNode(this.rootNode,r.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(o){let v=r.objectIndex;switch(o){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let y=0;y<t.length;y++)if(t[y].name===v){v=y;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[o])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[o]}if(void 0!==v){if(void 0===t[v])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[v]}}const h=t[l];if(void 0===h)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+r.nodeName+"."+l+" but it wasn't found.",t);let p=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?p=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(p=this.Versioning.MatrixWorldNeedsUpdate);let m=this.BindingType.Direct;if(void 0!==u){if("morphTargetInfluences"===l){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[u]&&(u=t.morphTargetDictionary[u])}m=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=u}else void 0!==h.fromArray&&void 0!==h.toArray?(m=this.BindingType.HasFromToArray,this.resolvedProperty=h):Array.isArray(h)?(m=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=l;this.getValue=this.GetterByBindingType[m],this.setValue=this.SetterByBindingTypeAndVersioning[m][p]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return c.Composite=zx,c})();Er.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Er.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Er.prototype.GetterByBindingType=[Er.prototype._getValue_direct,Er.prototype._getValue_array,Er.prototype._getValue_arrayElement,Er.prototype._getValue_toArray],Er.prototype.SetterByBindingTypeAndVersioning=[[Er.prototype._setValue_direct,Er.prototype._setValue_direct_setNeedsUpdate,Er.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Er.prototype._setValue_array,Er.prototype._setValue_array_setNeedsUpdate,Er.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Er.prototype._setValue_arrayElement,Er.prototype._setValue_arrayElement_setNeedsUpdate,Er.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Er.prototype._setValue_fromArray,Er.prototype._setValue_fromArray_setNeedsUpdate,Er.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class vp{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Gi(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class uS extends rs{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}function wd(c,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),c;if(2===e||1===e){let t=c.getIndex();if(null===t){const u=[],h=c.getAttribute("position");if(void 0===h)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),c;for(let p=0;p<h.count;p++)u.push(p);c.setIndex(u),t=c.getIndex()}const r=t.count-2,o=[];if(2===e)for(let u=1;u<=r;u++)o.push(t.getX(0)),o.push(t.getX(u)),o.push(t.getX(u+1));else for(let u=0;u<r;u++)u%2==0?(o.push(t.getX(u)),o.push(t.getX(u+1)),o.push(t.getX(u+2))):(o.push(t.getX(u+2)),o.push(t.getX(u+1)),o.push(t.getX(u)));o.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const l=c.clone();return l.setIndex(o),l.clearGroups(),l}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),c}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"170"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="170");class O_ extends Eh{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new eE(t)}),this.register(function(t){return new tE(t)}),this.register(function(t){return new Ug(t)}),this.register(function(t){return new sE(t)}),this.register(function(t){return new L_(t)}),this.register(function(t){return new Fg(t)}),this.register(function(t){return new Nh(t)}),this.register(function(t){return new wp(t)}),this.register(function(t){return new Cp(t)}),this.register(function(t){return new Qx(t)}),this.register(function(t){return new mS(t)}),this.register(function(t){return new nE(t)}),this.register(function(t){return new rE(t)}),this.register(function(t){return new iE(t)}),this.register(function(t){return new Sp(t)}),this.register(function(t){return new oE(t)}),this.register(function(t){return new aE(t)})}load(e,t,r,o){const l=this;let u;if(""!==this.resourcePath)u=this.resourcePath;else if(""!==this.path){const m=Zo.extractUrlBase(e);u=Zo.resolveURL(m,this.path)}else u=Zo.extractUrlBase(e);this.manager.itemStart(e);const h=function(m){o?o(m):console.error(m),l.manager.itemError(e),l.manager.itemEnd(e)},p=new sl(this.manager);p.setPath(this.path),p.setResponseType("arraybuffer"),p.setRequestHeader(this.requestHeader),p.setWithCredentials(this.withCredentials),p.load(e,function(m){try{l.parse(m,u,function(v){t(v),l.manager.itemEnd(e)},h)}catch(v){h(v)}},r,h)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,o){let l;const u={},h={},p=new TextDecoder;if("string"==typeof e)l=JSON.parse(e);else if(e instanceof ArrayBuffer)if(p.decode(new Uint8Array(e,0,4))===kg){try{u[Ci.KHR_BINARY_GLTF]=new Cd(e)}catch(y){return void(o&&o(y))}l=JSON.parse(u[Ci.KHR_BINARY_GLTF].content)}else l=JSON.parse(p.decode(e));else l=e;if(void 0===l.asset||l.asset.version[0]<2)return void(o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const m=new fE(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});m.fileLoader.setRequestHeader(this.requestHeader);for(let v=0;v<this.pluginCallbacks.length;v++){const y=this.pluginCallbacks[v](m);y.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),h[y.name]=y,u[y.name]=!0}if(l.extensionsUsed)for(let v=0;v<l.extensionsUsed.length;++v){const y=l.extensionsUsed[v],M=l.extensionsRequired||[];switch(y){case Ci.KHR_MATERIALS_UNLIT:u[y]=new Jx;break;case Ci.KHR_DRACO_MESH_COMPRESSION:u[y]=new lE(l,this.dracoLoader);break;case Ci.KHR_TEXTURE_TRANSFORM:u[y]=new Bg;break;case Ci.KHR_MESH_QUANTIZATION:u[y]=new cE;break;default:M.indexOf(y)>=0&&void 0===h[y]&&console.warn('THREE.GLTFLoader: Unknown extension "'+y+'".')}}m.setExtensions(u),m.setPlugins(h),m.parse(r,o)}parseAsync(e,t){const r=this;return new Promise(function(o,l){r.parse(e,t,o,l)})}}function Zx(){let c={};return{get:function(e){return c[e]},add:function(e,t){c[e]=t},remove:function(e){delete c[e]},removeAll:function(){c={}}}}const Ci={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Sp{constructor(e){this.parser=e,this.name=Ci.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,o=t.length;r<o;r++){const l=t[r];l.extensions&&l.extensions[this.name]&&void 0!==l.extensions[this.name].light&&e._addNodeRef(this.cache,l.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let o=t.cache.get(r);if(o)return o;const l=t.json,p=((l.extensions&&l.extensions[this.name]||{}).lights||[])[e];let m;const v=new kt(16777215);void 0!==p.color&&v.setRGB(p.color[0],p.color[1],p.color[2],Ai);const y=void 0!==p.range?p.range:0;switch(p.type){case"directional":m=new l_(v),m.target.position.set(0,0,-1),m.add(m.target);break;case"point":m=new Ch(v),m.distance=y;break;case"spot":m=new s_(v),m.distance=y,p.spot=p.spot||{},p.spot.innerConeAngle=void 0!==p.spot.innerConeAngle?p.spot.innerConeAngle:0,p.spot.outerConeAngle=void 0!==p.spot.outerConeAngle?p.spot.outerConeAngle:Math.PI/4,m.angle=p.spot.outerConeAngle,m.penumbra=1-p.spot.innerConeAngle/p.spot.outerConeAngle,m.target.position.set(0,0,-1),m.add(m.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+p.type)}return m.position.set(0,0,0),m.decay=2,Oa(m,p),void 0!==p.intensity&&(m.intensity=p.intensity),m.name=t.createUniqueName(p.name||"light_"+e),o=Promise.resolve(m),t.cache.add(r,o),o}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,r=this.parser,l=r.json.nodes[e],h=(l.extensions&&l.extensions[this.name]||{}).light;return void 0===h?null:this._loadLight(h).then(function(p){return r._getNodeRef(t.cache,h,p)})}}class Jx{constructor(){this.name=Ci.KHR_MATERIALS_UNLIT}getMaterialType(){return jo}extendParams(e,t,r){const o=[];e.color=new kt(1,1,1),e.opacity=1;const l=t.pbrMetallicRoughness;if(l){if(Array.isArray(l.baseColorFactor)){const u=l.baseColorFactor;e.color.setRGB(u[0],u[1],u[2],Ai),e.opacity=u[3]}void 0!==l.baseColorTexture&&o.push(r.assignTexture(e,"map",l.baseColorTexture,Mr))}return Promise.all(o)}}class Qx{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=o.extensions[this.name].emissiveStrength;return void 0!==l&&(t.emissiveIntensity=l),Promise.resolve()}}class eE{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[],u=o.extensions[this.name];if(void 0!==u.clearcoatFactor&&(t.clearcoat=u.clearcoatFactor),void 0!==u.clearcoatTexture&&l.push(r.assignTexture(t,"clearcoatMap",u.clearcoatTexture)),void 0!==u.clearcoatRoughnessFactor&&(t.clearcoatRoughness=u.clearcoatRoughnessFactor),void 0!==u.clearcoatRoughnessTexture&&l.push(r.assignTexture(t,"clearcoatRoughnessMap",u.clearcoatRoughnessTexture)),void 0!==u.clearcoatNormalTexture&&(l.push(r.assignTexture(t,"clearcoatNormalMap",u.clearcoatNormalTexture)),void 0!==u.clearcoatNormalTexture.scale)){const h=u.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Je(h,h)}return Promise.all(l)}}class tE{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_DISPERSION}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=o.extensions[this.name];return t.dispersion=void 0!==l.dispersion?l.dispersion:0,Promise.resolve()}}class nE{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[],u=o.extensions[this.name];return void 0!==u.iridescenceFactor&&(t.iridescence=u.iridescenceFactor),void 0!==u.iridescenceTexture&&l.push(r.assignTexture(t,"iridescenceMap",u.iridescenceTexture)),void 0!==u.iridescenceIor&&(t.iridescenceIOR=u.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==u.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=u.iridescenceThicknessMinimum),void 0!==u.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=u.iridescenceThicknessMaximum),void 0!==u.iridescenceThicknessTexture&&l.push(r.assignTexture(t,"iridescenceThicknessMap",u.iridescenceThicknessTexture)),Promise.all(l)}}class Fg{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[];t.sheenColor=new kt(0,0,0),t.sheenRoughness=0,t.sheen=1;const u=o.extensions[this.name];if(void 0!==u.sheenColorFactor){const h=u.sheenColorFactor;t.sheenColor.setRGB(h[0],h[1],h[2],Ai)}return void 0!==u.sheenRoughnessFactor&&(t.sheenRoughness=u.sheenRoughnessFactor),void 0!==u.sheenColorTexture&&l.push(r.assignTexture(t,"sheenColorMap",u.sheenColorTexture,Mr)),void 0!==u.sheenRoughnessTexture&&l.push(r.assignTexture(t,"sheenRoughnessMap",u.sheenRoughnessTexture)),Promise.all(l)}}class Nh{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[],u=o.extensions[this.name];return void 0!==u.transmissionFactor&&(t.transmission=u.transmissionFactor),void 0!==u.transmissionTexture&&l.push(r.assignTexture(t,"transmissionMap",u.transmissionTexture)),Promise.all(l)}}class wp{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[],u=o.extensions[this.name];t.thickness=void 0!==u.thicknessFactor?u.thicknessFactor:0,void 0!==u.thicknessTexture&&l.push(r.assignTexture(t,"thicknessMap",u.thicknessTexture)),t.attenuationDistance=u.attenuationDistance||1/0;const h=u.attenuationColor||[1,1,1];return t.attenuationColor=(new kt).setRGB(h[0],h[1],h[2],Ai),Promise.all(l)}}class Cp{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=o.extensions[this.name];return t.ior=void 0!==l.ior?l.ior:1.5,Promise.resolve()}}class mS{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[],u=o.extensions[this.name];t.specularIntensity=void 0!==u.specularFactor?u.specularFactor:1,void 0!==u.specularTexture&&l.push(r.assignTexture(t,"specularIntensityMap",u.specularTexture));const h=u.specularColorFactor||[1,1,1];return t.specularColor=(new kt).setRGB(h[0],h[1],h[2],Ai),void 0!==u.specularColorTexture&&l.push(r.assignTexture(t,"specularColorMap",u.specularColorTexture,Mr)),Promise.all(l)}}class iE{constructor(e){this.parser=e,this.name=Ci.EXT_MATERIALS_BUMP}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[],u=o.extensions[this.name];return t.bumpScale=void 0!==u.bumpFactor?u.bumpFactor:1,void 0!==u.bumpTexture&&l.push(r.assignTexture(t,"bumpMap",u.bumpTexture)),Promise.all(l)}}class rE{constructor(e){this.parser=e,this.name=Ci.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?Ra:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const l=[],u=o.extensions[this.name];return void 0!==u.anisotropyStrength&&(t.anisotropy=u.anisotropyStrength),void 0!==u.anisotropyRotation&&(t.anisotropyRotation=u.anisotropyRotation),void 0!==u.anisotropyTexture&&l.push(r.assignTexture(t,"anisotropyMap",u.anisotropyTexture)),Promise.all(l)}}class Ug{constructor(e){this.parser=e,this.name=Ci.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,o=r.textures[e];if(!o.extensions||!o.extensions[this.name])return null;const l=o.extensions[this.name],u=t.options.ktx2Loader;if(!u){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,l.source,u)}}class sE{constructor(e){this.parser=e,this.name=Ci.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,o=r.json,l=o.textures[e];if(!l.extensions||!l.extensions[t])return null;const u=l.extensions[t],h=o.images[u.source];let p=r.textureLoader;if(h.uri){const m=r.options.manager.getHandler(h.uri);null!==m&&(p=m)}return this.detectSupport().then(function(m){if(m)return r.loadTextureImage(e,u.source,p);if(o.extensionsRequired&&o.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class L_{constructor(e){this.parser=e,this.name=Ci.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,o=r.json,l=o.textures[e];if(!l.extensions||!l.extensions[t])return null;const u=l.extensions[t],h=o.images[u.source];let p=r.textureLoader;if(h.uri){const m=r.options.manager.getHandler(h.uri);null!==m&&(p=m)}return this.detectSupport().then(function(m){if(m)return r.loadTextureImage(e,u.source,p);if(o.extensionsRequired&&o.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class oE{constructor(e){this.name=Ci.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const o=r.extensions[this.name],l=this.parser.getDependency("buffer",o.buffer),u=this.parser.options.meshoptDecoder;if(!u||!u.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return l.then(function(h){const v=o.count,y=o.byteStride,M=new Uint8Array(h,o.byteOffset||0,o.byteLength||0);return u.decodeGltfBufferAsync?u.decodeGltfBufferAsync(v,y,M,o.mode,o.filter).then(function(S){return S.buffer}):u.ready.then(function(){const S=new ArrayBuffer(v*y);return u.decodeGltfBuffer(new Uint8Array(S),v,y,M,o.mode,o.filter),S})})}return null}}class aE{constructor(e){this.name=Ci.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;const o=t.meshes[r.mesh];for(const m of o.primitives)if(m.mode!==Jo.TRIANGLES&&m.mode!==Jo.TRIANGLE_STRIP&&m.mode!==Jo.TRIANGLE_FAN&&void 0!==m.mode)return null;const u=r.extensions[this.name].attributes,h=[],p={};for(const m in u)h.push(this.parser.getDependency("accessor",u[m]).then(v=>(p[m]=v,p[m])));return h.length<1?null:(h.push(this.parser.createNodeMesh(e)),Promise.all(h).then(m=>{const v=m.pop(),y=v.isGroup?v.children:[v],M=m[0].count,S=[];for(const A of y){const N=new In,R=new ee,T=new Ki,B=new ee(1,1,1),V=new ch(A.geometry,A.material,M);for(let F=0;F<M;F++)p.TRANSLATION&&R.fromBufferAttribute(p.TRANSLATION,F),p.ROTATION&&T.fromBufferAttribute(p.ROTATION,F),p.SCALE&&B.fromBufferAttribute(p.SCALE,F),V.setMatrixAt(F,N.compose(R,T,B));for(const F in p)if("_COLOR_0"===F){const ne=p[F];V.instanceColor=new ud(ne.array,ne.itemSize,ne.normalized)}else"TRANSLATION"!==F&&"ROTATION"!==F&&"SCALE"!==F&&A.geometry.setAttribute(F,p[F]);ms.prototype.copy.call(V,A),this.parser.assignFinalMaterial(V),S.push(V)}return v.isGroup?(v.clear(),v.add(...S),v):S[0]}))}}const kg="glTF";class Cd{constructor(e){this.name=Ci.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==kg)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const o=this.header.length-12,l=new DataView(e,12);let u=0;for(;u<o;){const h=l.getUint32(u,!0);u+=4;const p=l.getUint32(u,!0);if(u+=4,1313821514===p){const m=new Uint8Array(e,12+u,h);this.content=r.decode(m)}else if(5130562===p){const m=12+u;this.body=e.slice(m,m+h)}u+=h}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class lE{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ci.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,o=this.dracoLoader,l=e.extensions[this.name].bufferView,u=e.extensions[this.name].attributes,h={},p={},m={};for(const v in u){const y=Lh[v]||v.toLowerCase();h[y]=u[v]}for(const v in e.attributes){const y=Lh[v]||v.toLowerCase();if(void 0!==u[v]){const M=r.accessors[e.attributes[v]];m[y]=al[M.componentType].name,p[y]=!0===M.normalized}}return t.getDependency("bufferView",l).then(function(v){return new Promise(function(y,M){o.decodeDracoFile(v,function(S){for(const A in S.attributes){const R=p[A];void 0!==R&&(S.attributes[A].normalized=R)}y(S)},h,m,Ai,M)})})}}class Bg{constructor(){this.name=Ci.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class cE{constructor(){this.name=Ci.KHR_MESH_QUANTIZATION}}class Tp extends xh{constructor(e,t,r,o){super(e,t,r,o)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,o=this.valueSize,l=e*o*3+o;for(let u=0;u!==o;u++)t[u]=r[l+u];return t}interpolate_(e,t,r,o){const l=this.resultBuffer,u=this.sampleValues,h=this.valueSize,p=2*h,m=3*h,v=o-t,y=(r-t)/v,M=y*y,S=M*y,A=e*m,N=A-m,R=-2*S+3*M,T=S-M,B=1-R,V=T-M+y;for(let F=0;F!==h;F++)l[F]=B*u[N+F+h]+V*(u[N+F+p]*v)+R*u[A+F+h]+T*(u[A+F]*v);return l}}const U_=new Ki;class k_ extends Tp{interpolate_(e,t,r,o){const l=super.interpolate_(e,t,r,o);return U_.fromArray(l).normalize().toArray(l),l}}const Jo={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},al={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Vg={9728:_i,9729:oe,9984:1004,9985:1007,9986:Oe,9987:Lt},yu={33071:vr,33648:1002,10497:ws},_u={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Lh={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Na={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},uE={CUBICSPLINE:void 0,LINEAR:Hs,STEP:ko};function Mc(c,e,t){for(const r in t.extensions)void 0===c[r]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function Oa(c,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(c.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function dE(c,e){if(c.updateMorphTargets(),void 0!==e.weights)for(let t=0,r=e.weights.length;t<r;t++)c.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(c.morphTargetInfluences.length===t.length){c.morphTargetDictionary={};for(let r=0,o=t.length;r<o;r++)c.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function H_(c){let e;const t=c.extensions&&c.extensions[Ci.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+Fh(t.attributes):c.indices+":"+Fh(c.attributes)+":"+c.mode,void 0!==c.targets)for(let r=0,o=c.targets.length;r<o;r++)e+=":"+Fh(c.targets[r]);return e}function Fh(c){let e="";const t=Object.keys(c).sort();for(let r=0,o=t.length;r<o;r++)e+=t[r]+":"+c[t[r]]+";";return e}function Ap(c){switch(c){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const hE=new In;class fE{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Zx,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,o=-1,l=!1,u=-1;if(typeof navigator<"u"){const h=navigator.userAgent;r=!0===/^((?!chrome|android).)*safari/i.test(h);const p=h.match(/Version\/(\d+)/);o=r&&p?parseInt(p[1],10):-1,l=h.indexOf("Firefox")>-1,u=l?h.match(/Firefox\/([0-9]+)\./)[1]:-1}this.textureLoader=typeof createImageBitmap>"u"||r&&o<17||l&&u<98?new Eg(this.options.manager):new Ed(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new sl(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,o=this.json,l=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(u){return u._markDefs&&u._markDefs()}),Promise.all(this._invokeAll(function(u){return u.beforeRoot&&u.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(u){const h={scene:u[0][o.scene||0],scenes:u[0],animations:u[1],cameras:u[2],asset:o.asset,parser:r,userData:{}};return Mc(l,h,o),Oa(h,o),Promise.all(r._invokeAll(function(p){return p.afterRoot&&p.afterRoot(h)})).then(function(){for(const p of h.scenes)p.updateMatrixWorld();e(h)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let o=0,l=t.length;o<l;o++){const u=t[o].joints;for(let h=0,p=u.length;h<p;h++)e[u[h]].isBone=!0}for(let o=0,l=e.length;o<l;o++){const u=e[o];void 0!==u.mesh&&(this._addNodeRef(this.meshCache,u.mesh),void 0!==u.skin&&(r[u.mesh].isSkinnedMesh=!0)),void 0!==u.camera&&this._addNodeRef(this.cameraCache,u.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const o=r.clone(),l=(u,h)=>{const p=this.associations.get(u);null!=p&&this.associations.set(h,p);for(const[m,v]of u.children.entries())l(v,h.children[m])};return l(r,o),o.name+="_instance_"+e.uses[t]++,o}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const o=e(t[r]);if(o)return o}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let o=0;o<t.length;o++){const l=e(t[o]);l&&r.push(l)}return r}getDependency(e,t){const r=e+":"+t;let o=this.cache.get(r);if(!o){switch(e){case"scene":o=this.loadScene(t);break;case"node":o=this._invokeOne(function(l){return l.loadNode&&l.loadNode(t)});break;case"mesh":o=this._invokeOne(function(l){return l.loadMesh&&l.loadMesh(t)});break;case"accessor":o=this.loadAccessor(t);break;case"bufferView":o=this._invokeOne(function(l){return l.loadBufferView&&l.loadBufferView(t)});break;case"buffer":o=this.loadBuffer(t);break;case"material":o=this._invokeOne(function(l){return l.loadMaterial&&l.loadMaterial(t)});break;case"texture":o=this._invokeOne(function(l){return l.loadTexture&&l.loadTexture(t)});break;case"skin":o=this.loadSkin(t);break;case"animation":o=this._invokeOne(function(l){return l.loadAnimation&&l.loadAnimation(t)});break;case"camera":o=this.loadCamera(t);break;default:if(o=this._invokeOne(function(l){return l!=this&&l.getDependency&&l.getDependency(e,t)}),!o)throw new Error("Unknown type: "+e)}this.cache.add(r,o)}return o}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(l,u){return r.getDependency(e,u)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Ci.KHR_BINARY_GLTF].body);const o=this.options;return new Promise(function(l,u){r.load(Zo.resolveURL(t.uri,o.path),l,void 0,function(){u(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(r){const l=t.byteOffset||0;return r.slice(l,l+(t.byteLength||0))})}loadAccessor(e){const t=this,r=this.json,o=this.json.accessors[e];if(void 0===o.bufferView&&void 0===o.sparse){const u=_u[o.type],p=!0===o.normalized,m=new(0,al[o.componentType])(o.count*u);return Promise.resolve(new xr(m,u,p))}const l=[];return l.push(void 0!==o.bufferView?this.getDependency("bufferView",o.bufferView):null),void 0!==o.sparse&&(l.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),l.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(l).then(function(u){const h=u[0],p=_u[o.type],m=al[o.componentType],v=m.BYTES_PER_ELEMENT,M=o.byteOffset||0,S=void 0!==o.bufferView?r.bufferViews[o.bufferView].byteStride:void 0,A=!0===o.normalized;let N,R;if(S&&S!==v*p){const T=Math.floor(M/S),B="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+T+":"+o.count;let V=t.cache.get(B);V||(N=new m(h,T*S,o.count*S/v),V=new ac(N,S/v),t.cache.add(B,V)),R=new Sl(V,p,M%S/v,A)}else N=null===h?new m(o.count*p):new m(h,M,o.count*p),R=new xr(N,p,A);if(void 0!==o.sparse){const F=o.sparse.values.byteOffset||0,ne=new(0,al[o.sparse.indices.componentType])(u[1],o.sparse.indices.byteOffset||0,o.sparse.count*_u.SCALAR),Q=new m(u[2],F,o.sparse.count*p);null!==h&&(R=new xr(R.array.slice(),R.itemSize,R.normalized)),R.normalized=!1;for(let te=0,se=ne.length;te<se;te++){const X=ne[te];if(R.setX(X,Q[te*p]),p>=2&&R.setY(X,Q[te*p+1]),p>=3&&R.setZ(X,Q[te*p+2]),p>=4&&R.setW(X,Q[te*p+3]),p>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}R.normalized=A}return R})}loadTexture(e){const t=this.json,l=t.textures[e].source,u=t.images[l];let h=this.textureLoader;if(u.uri){const p=this.options.manager.getHandler(u.uri);null!==p&&(h=p)}return this.loadTextureImage(e,l,h)}loadTextureImage(e,t,r){const o=this,l=this.json,u=l.textures[e],h=l.images[t],p=(h.uri||h.bufferView)+":"+u.sampler;if(this.textureCache[p])return this.textureCache[p];const m=this.loadImageSource(t,r).then(function(v){v.flipY=!1,v.name=u.name||h.name||"",""===v.name&&"string"==typeof h.uri&&!1===h.uri.startsWith("data:image/")&&(v.name=h.uri);const M=(l.samplers||{})[u.sampler]||{};return v.magFilter=Vg[M.magFilter]||oe,v.minFilter=Vg[M.minFilter]||Lt,v.wrapS=yu[M.wrapS]||ws,v.wrapT=yu[M.wrapT]||ws,v.generateMipmaps=!v.isCompressedTexture&&v.minFilter!==_i&&v.minFilter!==oe,o.associations.set(v,{textures:e}),v}).catch(function(){return null});return this.textureCache[p]=m,m}loadImageSource(e,t){const o=this.json,l=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(y=>y.clone());const u=o.images[e],h=self.URL||self.webkitURL;let p=u.uri||"",m=!1;if(void 0!==u.bufferView)p=this.getDependency("bufferView",u.bufferView).then(function(y){m=!0;const M=new Blob([y],{type:u.mimeType});return p=h.createObjectURL(M),p});else if(void 0===u.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const v=Promise.resolve(p).then(function(y){return new Promise(function(M,S){let A=M;!0===t.isImageBitmapLoader&&(A=function(N){const R=new Ii(N);R.needsUpdate=!0,M(R)}),t.load(Zo.resolveURL(y,l.path),A,void 0,S)})}).then(function(y){return!0===m&&h.revokeObjectURL(p),Oa(y,u),y.userData.mimeType=u.mimeType||function z_(c){return c.search(/\.jpe?g($|\?)/i)>0||0===c.search(/^data\:image\/jpeg/)?"image/jpeg":c.search(/\.webp($|\?)/i)>0||0===c.search(/^data\:image\/webp/)?"image/webp":c.search(/\.ktx2($|\?)/i)>0||0===c.search(/^data\:image\/ktx2/)?"image/ktx2":"image/png"}(u.uri),y}).catch(function(y){throw console.error("THREE.GLTFLoader: Couldn't load texture",p),y});return this.sourceCache[e]=v,v}assignTexture(e,t,r,o){const l=this;return this.getDependency("texture",r.index).then(function(u){if(!u)return null;if(void 0!==r.texCoord&&r.texCoord>0&&((u=u.clone()).channel=r.texCoord),l.extensions[Ci.KHR_TEXTURE_TRANSFORM]){const h=void 0!==r.extensions?r.extensions[Ci.KHR_TEXTURE_TRANSFORM]:void 0;if(h){const p=l.associations.get(u);u=l.extensions[Ci.KHR_TEXTURE_TRANSFORM].extendTexture(u,h),l.associations.set(u,p)}}return void 0!==o&&(u.colorSpace=o),e[t]=u,u})}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const o=void 0===t.attributes.tangent,l=void 0!==t.attributes.color,u=void 0===t.attributes.normal;if(e.isPoints){const h="PointsMaterial:"+r.uuid;let p=this.cache.get(h);p||(p=new Gf,Wo.prototype.copy.call(p,r),p.color.copy(r.color),p.map=r.map,p.sizeAttenuation=!1,this.cache.add(h,p)),r=p}else if(e.isLine){const h="LineBasicMaterial:"+r.uuid;let p=this.cache.get(h);p||(p=new Do,Wo.prototype.copy.call(p,r),p.color.copy(r.color),p.map=r.map,this.cache.add(h,p)),r=p}if(o||l||u){let h="ClonedMaterial:"+r.uuid+":";o&&(h+="derivative-tangents:"),l&&(h+="vertex-colors:"),u&&(h+="flat-shading:");let p=this.cache.get(h);p||(p=r.clone(),l&&(p.vertexColors=!0),u&&(p.flatShading=!0),o&&(p.normalScale&&(p.normalScale.y*=-1),p.clearcoatNormalScale&&(p.clearcoatNormalScale.y*=-1)),this.cache.add(h,p),this.associations.set(p,this.associations.get(r))),r=p}e.material=r}getMaterialType(){return _a}loadMaterial(e){const t=this,o=this.extensions,l=this.json.materials[e];let u;const h={},m=[];if((l.extensions||{})[Ci.KHR_MATERIALS_UNLIT]){const y=o[Ci.KHR_MATERIALS_UNLIT];u=y.getMaterialType(),m.push(y.extendParams(h,l,t))}else{const y=l.pbrMetallicRoughness||{};if(h.color=new kt(1,1,1),h.opacity=1,Array.isArray(y.baseColorFactor)){const M=y.baseColorFactor;h.color.setRGB(M[0],M[1],M[2],Ai),h.opacity=M[3]}void 0!==y.baseColorTexture&&m.push(t.assignTexture(h,"map",y.baseColorTexture,Mr)),h.metalness=void 0!==y.metallicFactor?y.metallicFactor:1,h.roughness=void 0!==y.roughnessFactor?y.roughnessFactor:1,void 0!==y.metallicRoughnessTexture&&(m.push(t.assignTexture(h,"metalnessMap",y.metallicRoughnessTexture)),m.push(t.assignTexture(h,"roughnessMap",y.metallicRoughnessTexture))),u=this._invokeOne(function(M){return M.getMaterialType&&M.getMaterialType(e)}),m.push(Promise.all(this._invokeAll(function(M){return M.extendMaterialParams&&M.extendMaterialParams(e,h)})))}!0===l.doubleSided&&(h.side=2);const v=l.alphaMode||"OPAQUE";if("BLEND"===v?(h.transparent=!0,h.depthWrite=!1):(h.transparent=!1,"MASK"===v&&(h.alphaTest=void 0!==l.alphaCutoff?l.alphaCutoff:.5)),void 0!==l.normalTexture&&u!==jo&&(m.push(t.assignTexture(h,"normalMap",l.normalTexture)),h.normalScale=new Je(1,1),void 0!==l.normalTexture.scale)){const y=l.normalTexture.scale;h.normalScale.set(y,y)}if(void 0!==l.occlusionTexture&&u!==jo&&(m.push(t.assignTexture(h,"aoMap",l.occlusionTexture)),void 0!==l.occlusionTexture.strength&&(h.aoMapIntensity=l.occlusionTexture.strength)),void 0!==l.emissiveFactor&&u!==jo){const y=l.emissiveFactor;h.emissive=(new kt).setRGB(y[0],y[1],y[2],Ai)}return void 0!==l.emissiveTexture&&u!==jo&&m.push(t.assignTexture(h,"emissiveMap",l.emissiveTexture,Mr)),Promise.all(m).then(function(){const y=new u(h);return l.name&&(y.name=l.name),Oa(y,l),t.associations.set(y,{materials:e}),l.extensions&&Mc(o,y,l),y})}createUniqueName(e){const t=Er.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,r=this.extensions,o=this.primitiveCache;function l(h){return r[Ci.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(h,t).then(function(p){return G_(p,h,t)})}const u=[];for(let h=0,p=e.length;h<p;h++){const m=e[h],v=H_(m),y=o[v];if(y)u.push(y.promise);else{let M;M=m.extensions&&m.extensions[Ci.KHR_DRACO_MESH_COMPRESSION]?l(m):G_(new si,m,t),o[v]={primitive:m,promise:M},u.push(M)}}return Promise.all(u)}loadMesh(e){const t=this,o=this.extensions,l=this.json.meshes[e],u=l.primitives,h=[];for(let p=0,m=u.length;p<m;p++){const v=void 0===u[p].material?(void 0===(c=this.cache).DefaultMaterial&&(c.DefaultMaterial=new _a({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),c.DefaultMaterial):this.getDependency("material",u[p].material);h.push(v)}var c;return h.push(t.loadGeometries(u)),Promise.all(h).then(function(p){const m=p.slice(0,p.length-1),v=p[p.length-1],y=[];for(let S=0,A=v.length;S<A;S++){const N=v[S],R=u[S];let T;const B=m[S];if(R.mode===Jo.TRIANGLES||R.mode===Jo.TRIANGLE_STRIP||R.mode===Jo.TRIANGLE_FAN||void 0===R.mode)T=!0===l.isSkinnedMesh?new ru(N,B):new Rs(N,B),!0===T.isSkinnedMesh&&T.normalizeSkinWeights(),R.mode===Jo.TRIANGLE_STRIP?T.geometry=wd(T.geometry,1):R.mode===Jo.TRIANGLE_FAN&&(T.geometry=wd(T.geometry,2));else if(R.mode===Jo.LINES)T=new zf(N,B);else if(R.mode===Jo.LINE_STRIP)T=new hc(N,B);else if(R.mode===Jo.LINE_LOOP)T=new hh(N,B);else{if(R.mode!==Jo.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+R.mode);T=new Iy(N,B)}Object.keys(T.geometry.morphAttributes).length>0&&dE(T,l),T.name=t.createUniqueName(l.name||"mesh_"+e),Oa(T,l),R.extensions&&Mc(o,T,R),t.assignFinalMaterial(T),y.push(T)}for(let S=0,A=y.length;S<A;S++)t.associations.set(y[S],{meshes:e,primitives:S});if(1===y.length)return l.extensions&&Mc(o,y[0],l),y[0];const M=new Jc;l.extensions&&Mc(o,M,l),t.associations.set(M,{meshes:e});for(let S=0,A=y.length;S<A;S++)M.add(y[S]);return M})}loadCamera(e){let t;const r=this.json.cameras[e],o=r[r.type];if(o)return"perspective"===r.type?t=new ys(Ou_radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):"orthographic"===r.type&&(t=new nc(-o.xmag,o.xmag,o.ymag,-o.ymag,o.znear,o.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),Oa(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],r=[];for(let o=0,l=t.joints.length;o<l;o++)r.push(this._loadNodeShallow(t.joints[o]));return r.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(r).then(function(o){const l=o.pop(),u=o,h=[],p=[];for(let m=0,v=u.length;m<v;m++){const y=u[m];if(y){h.push(y);const M=new In;null!==l&&M.fromArray(l.array,16*m),p.push(M)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[m])}return new Uf(h,p)})}loadAnimation(e){const r=this,o=this.json.animations[e],l=o.name?o.name:"animation_"+e,u=[],h=[],p=[],m=[],v=[];for(let y=0,M=o.channels.length;y<M;y++){const S=o.channels[y],A=o.samplers[S.sampler],N=S.target,T=void 0!==o.parameters?o.parameters[A.input]:A.input,B=void 0!==o.parameters?o.parameters[A.output]:A.output;void 0!==N.node&&(u.push(this.getDependency("node",N.node)),h.push(this.getDependency("accessor",T)),p.push(this.getDependency("accessor",B)),m.push(A),v.push(N))}return Promise.all([Promise.all(u),Promise.all(h),Promise.all(p),Promise.all(m),Promise.all(v)]).then(function(y){const M=y[0],S=y[1],A=y[2],N=y[3],R=y[4],T=[];for(let B=0,V=M.length;B<V;B++){const F=M[B],ne=S[B],Q=A[B],te=N[B],se=R[B];if(void 0===F)continue;F.updateMatrix&&F.updateMatrix();const X=r._createAnimationTracks(F,ne,Q,te,se);if(X)for(let j=0;j<X.length;j++)T.push(X[j])}return new du(l,void 0,T)})}createNodeMesh(e){const r=this,o=this.json.nodes[e];return void 0===o.mesh?null:r.getDependency("mesh",o.mesh).then(function(l){const u=r._getNodeRef(r.meshCache,o.mesh,l);return void 0!==o.weights&&u.traverse(function(h){if(h.isMesh)for(let p=0,m=o.weights.length;p<m;p++)h.morphTargetInfluences[p]=o.weights[p]}),u})}loadNode(e){const r=this,o=this.json.nodes[e],l=r._loadNodeShallow(e),u=[],h=o.children||[];for(let m=0,v=h.length;m<v;m++)u.push(r.getDependency("node",h[m]));const p=void 0===o.skin?Promise.resolve(null):r.getDependency("skin",o.skin);return Promise.all([l,Promise.all(u),p]).then(function(m){const v=m[0],y=m[1],M=m[2];null!==M&&v.traverse(function(S){S.isSkinnedMesh&&S.bind(M,hE)});for(let S=0,A=y.length;S<A;S++)v.add(y[S]);return v})}_loadNodeShallow(e){const r=this.extensions,o=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const l=this.json.nodes[e],u=l.name?o.createUniqueName(l.name):"",h=[],p=o._invokeOne(function(m){return m.createNodeMesh&&m.createNodeMesh(e)});return p&&h.push(p),void 0!==l.camera&&h.push(o.getDependency("camera",l.camera).then(function(m){return o._getNodeRef(o.cameraCache,l.camera,m)})),o._invokeAll(function(m){return m.createNodeAttachment&&m.createNodeAttachment(e)}).forEach(function(m){h.push(m)}),this.nodeCache[e]=Promise.all(h).then(function(m){let v;if(v=!0===l.isBone?new su:m.length>1?new Jc:1===m.length?m[0]:new ms,v!==m[0])for(let y=0,M=m.length;y<M;y++)v.add(m[y]);if(l.name&&(v.userData.name=l.name,v.name=u),Oa(v,l),l.extensions&&Mc(r,v,l),void 0!==l.matrix){const y=new In;y.fromArray(l.matrix),v.applyMatrix4(y)}else void 0!==l.translation&&v.position.fromArray(l.translation),void 0!==l.rotation&&v.quaternion.fromArray(l.rotation),void 0!==l.scale&&v.scale.fromArray(l.scale);return o.associations.has(v)||o.associations.set(v,{}),o.associations.get(v).nodes=e,v}),this.nodeCache[e]}loadScene(e){const t=this.extensions,r=this.json.scenes[e],o=this,l=new Jc;r.name&&(l.name=o.createUniqueName(r.name)),Oa(l,r),r.extensions&&Mc(t,l,r);const u=r.nodes||[],h=[];for(let p=0,m=u.length;p<m;p++)h.push(o.getDependency("node",u[p]));return Promise.all(h).then(function(p){for(let v=0,y=p.length;v<y;v++)l.add(p[v]);return o.associations=(v=>{const y=new Map;for(const[M,S]of o.associations)(M instanceof Wo||M instanceof Ii)&&y.set(M,S);return v.traverse(M=>{const S=o.associations.get(M);null!=S&&y.set(M,S)}),y})(l),l})}_createAnimationTracks(e,t,r,o,l){const u=[],h=e.name?e.name:e.uuid,p=[];let m;switch(Na[l.path]===Na.weights?e.traverse(function(M){M.morphTargetInfluences&&p.push(M.name?M.name:M.uuid)}):p.push(h),Na[l.path]){case Na.weights:m=uu;break;case Na.rotation:m=Dl;break;case Na.position:case Na.scale:m=Md;break;default:m=1===r.itemSize?uu:Md}const v=void 0!==o.interpolation?uE[o.interpolation]:Hs,y=this._getArrayFromAccessor(r);for(let M=0,S=p.length;M<S;M++){const A=new m(p[M]+"."+Na[l.path],t.array,y,v);"CUBICSPLINE"===o.interpolation&&this._createCubicSplineTrackInterpolant(A),u.push(A)}return u}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const r=Ap(t.constructor),o=new Float32Array(t.length);for(let l=0,u=t.length;l<u;l++)o[l]=t[l]*r;t=o}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(r){return new(this instanceof Dl?k_:Tp)(this.times,this.values,this.getValueSize()/3,r)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function G_(c,e,t){const r=e.attributes,o=[];function l(u,h){return t.getDependency("accessor",u).then(function(p){c.setAttribute(h,p)})}for(const u in r){const h=Lh[u]||u.toLowerCase();h in c.attributes||o.push(l(r[u],h))}if(void 0!==e.indices&&!c.index){const u=t.getDependency("accessor",e.indices).then(function(h){c.setIndex(h)});o.push(u)}return fi.workingColorSpace!==Ai&&"COLOR_0"in r&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${fi.workingColorSpace}" not supported.`),Oa(c,e),function pE(c,e,t){const r=e.attributes,o=new Ks;if(void 0===r.POSITION)return;{const h=t.json.accessors[r.POSITION],p=h.min,m=h.max;if(void 0===p||void 0===m)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(o.set(new ee(p[0],p[1],p[2]),new ee(m[0],m[1],m[2])),h.normalized){const v=Ap(al[h.componentType]);o.min.multiplyScalar(v),o.max.multiplyScalar(v)}}const l=e.targets;if(void 0!==l){const h=new ee,p=new ee;for(let m=0,v=l.length;m<v;m++){const y=l[m];if(void 0!==y.POSITION){const M=t.json.accessors[y.POSITION],S=M.min,A=M.max;if(void 0!==S&&void 0!==A){if(p.setX(Math.max(Math.abs(S[0]),Math.abs(A[0]))),p.setY(Math.max(Math.abs(S[1]),Math.abs(A[1]))),p.setZ(Math.max(Math.abs(S[2]),Math.abs(A[2]))),M.normalized){const N=Ap(al[M.componentType]);p.multiplyScalar(N)}h.max(p)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(h)}c.boundingBox=o;const u=new Br;o.getCenter(u.center),u.radius=o.min.distanceTo(o.max)/2,c.boundingSphere=u}(c,e,t),Promise.all(o).then(function(){return void 0!==e.targets?function V_(c,e,t){let r=!1,o=!1,l=!1;for(let m=0,v=e.length;m<v;m++){const y=e[m];if(void 0!==y.POSITION&&(r=!0),void 0!==y.NORMAL&&(o=!0),void 0!==y.COLOR_0&&(l=!0),r&&o&&l)break}if(!r&&!o&&!l)return Promise.resolve(c);const u=[],h=[],p=[];for(let m=0,v=e.length;m<v;m++){const y=e[m];if(r){const M=void 0!==y.POSITION?t.getDependency("accessor",y.POSITION):c.attributes.position;u.push(M)}if(o){const M=void 0!==y.NORMAL?t.getDependency("accessor",y.NORMAL):c.attributes.normal;h.push(M)}if(l){const M=void 0!==y.COLOR_0?t.getDependency("accessor",y.COLOR_0):c.attributes.color;p.push(M)}}return Promise.all([Promise.all(u),Promise.all(h),Promise.all(p)]).then(function(m){const y=m[1],M=m[2];return r&&(c.morphAttributes.position=m[0]),o&&(c.morphAttributes.normal=y),l&&(c.morphAttributes.color=M),c.morphTargetsRelative=!0,c})}(c,e.targets,t):c})}const Mu={type:"change"},Dp={type:"start"},zg={type:"end"},Ip=new Oc,W_=new Yo,j_=Math.cos(70*Ou_DEG2RAD),Os=new ee,mo=2*Math.PI,Gg=1e-6;class $_ extends uS{constructor(e,t=null){super(e,t),this.state=-1,this.enabled=!0,this.target=new ee,this.cursor=new ee,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new ee,this._lastQuaternion=new Ki,this._lastTargetPosition=new ee,this._quat=(new Ki).setFromUnitVectors(e.up,new ee(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new vp,this._sphericalDelta=new vp,this._scale=1,this._panOffset=new ee,this._rotateStart=new Je,this._rotateEnd=new Je,this._rotateDelta=new Je,this._panStart=new Je,this._panEnd=new Je,this._panDelta=new Je,this._dollyStart=new Je,this._dollyEnd=new Je,this._dollyDelta=new Je,this._dollyDirection=new ee,this._mouse=new Je,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=X_.bind(this),this._onPointerDown=mE.bind(this),this._onPointerUp=Wg.bind(this),this._onContextMenu=Es.bind(this),this._onMouseWheel=jg.bind(this),this._onKeyDown=ls.bind(this),this._onTouchStart=Y_.bind(this),this._onTouchMove=yE.bind(this),this._onMouseDown=gE.bind(this),this._onMouseMove=vE.bind(this),this._interceptControlDown=Uh.bind(this),this._interceptControlUp=Td.bind(this),null!==this.domElement&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){null!==this._domElementKeyEvents&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Mu),this.update(),this.state=-1}update(e=null){const t=this.object.position;Os.copy(t).sub(this.target),Os.applyQuaternion(this._quat),this._spherical.setFromVector3(Os),this.autoRotate&&-1===this.state&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let r=this.minAzimuthAngle,o=this.maxAzimuthAngle;isFinite(r)&&isFinite(o)&&(r<-Math.PI?r+=mo:r>Math.PI&&(r-=mo),o<-Math.PI?o+=mo:o>Math.PI&&(o-=mo),this._spherical.theta=r<=o?Math.max(r,Math.min(o,this._spherical.theta)):this._spherical.theta>(r+o)/2?Math.max(r,this._spherical.theta):Math.min(o,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),!0===this.enableDamping?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let l=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const u=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),l=u!=this._spherical.radius}if(Os.setFromSpherical(this._spherical),Os.applyQuaternion(this._quatInverse),t.copy(this.target).add(Os),this.object.lookAt(this.target),!0===this.enableDamping?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let u=null;if(this.object.isPerspectiveCamera){const h=Os.length();u=this._clampDistance(h*this._scale);const p=h-u;this.object.position.addScaledVector(this._dollyDirection,p),this.object.updateMatrixWorld(),l=!!p}else if(this.object.isOrthographicCamera){const h=new ee(this._mouse.x,this._mouse.y,0);h.unproject(this.object);const p=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),l=p!==this.object.zoom;const m=new ee(this._mouse.x,this._mouse.y,0);m.unproject(this.object),this.object.position.sub(m).add(h),this.object.updateMatrixWorld(),u=Os.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;null!==u&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(u).add(this.object.position):(Ip.origin.copy(this.object.position),Ip.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(Ip.direction))<j_?this.object.lookAt(this.target):(W_.setFromNormalAndCoplanarPoint(this.object.up,this.target),Ip.intersectPlane(W_,this.target))))}else if(this.object.isOrthographicCamera){const u=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),u!==this.object.zoom&&(this.object.updateProjectionMatrix(),l=!0)}return this._scale=1,this._performCursorZoom=!1,!!(l||this._lastPosition.distanceToSquared(this.object.position)>Gg||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Gg||this._lastTargetPosition.distanceToSquared(this.target)>Gg)&&(this.dispatchEvent(Mu),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0)}_getAutoRotationAngle(e){return null!==e?mo/60*this.autoRotateSpeed*e:mo/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(.01*e);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){Os.setFromMatrixColumn(t,0),Os.multiplyScalar(-e),this._panOffset.add(Os)}_panUp(e,t){!0===this.screenSpacePanning?Os.setFromMatrixColumn(t,1):(Os.setFromMatrixColumn(t,0),Os.crossVectors(this.object.up,Os)),Os.multiplyScalar(e),this._panOffset.add(Os)}_pan(e,t){const r=this.domElement;if(this.object.isPerspectiveCamera){Os.copy(this.object.position).sub(this.target);let l=Os.length();l*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*l/r.clientHeight,this.object.matrix),this._panUp(2*t*l/r.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/r.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/r.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const r=this.domElement.getBoundingClientRect(),l=t-r.top,h=r.height;this._mouse.x=(e-r.left)/r.width*2-1,this._mouse.y=-l/h*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(mo*this._rotateDelta.x/t.clientHeight),this._rotateUp(mo*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(mo*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(-mo*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(mo*this.rotateSpeed/this.domElement.clientHeight):this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(-mo*this.rotateSpeed/this.domElement.clientHeight):this._pan(-this.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(1===this._pointers.length)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e);this._rotateStart.set(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}}_handleTouchStartPan(e){if(1===this._pointers.length)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e);this._panStart.set(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),r=e.pageX-t.x,o=e.pageY-t.y,l=Math.sqrt(r*r+o*o);this._dollyStart.set(0,l)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(1==this._pointers.length)this._rotateEnd.set(e.pageX,e.pageY);else{const r=this._getSecondPointerPosition(e);this._rotateEnd.set(.5*(e.pageX+r.x),.5*(e.pageY+r.y))}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(mo*this._rotateDelta.x/t.clientHeight),this._rotateUp(mo*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(1===this._pointers.length)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e);this._panEnd.set(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),r=e.pageX-t.x,o=e.pageY-t.y,l=Math.sqrt(r*r+o*o);this._dollyEnd.set(0,l),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd),this._updateZoomParameters(.5*(e.pageX+t.x),.5*(e.pageY+t.y))}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return void this._pointers.splice(t,1)}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];void 0===t&&(t=new Je,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){return this._pointerPositions[e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0]]}_customWheelEvent(e){const r={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(e.deltaMode){case 1:r.deltaY*=16;break;case 2:r.deltaY*=100}return e.ctrlKey&&!this._controlActive&&(r.deltaY*=10),r}}function mE(c){!1!==this.enabled&&(0===this._pointers.length&&(this.domElement.setPointerCapture(c.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(c)&&(this._addPointer(c),"touch"===c.pointerType?this._onTouchStart(c):this._onMouseDown(c)))}function X_(c){!1!==this.enabled&&("touch"===c.pointerType?this._onTouchMove(c):this._onMouseMove(c))}function Wg(c){switch(this._removePointer(c),this._pointers.length){case 0:this.domElement.releasePointerCapture(c.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(zg),this.state=-1;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y})}}function gE(c){let e;switch(c.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case 1:if(!1===this.enableZoom)return;this._handleMouseDownDolly(c),this.state=1;break;case 0:if(c.ctrlKey||c.metaKey||c.shiftKey){if(!1===this.enablePan)return;this._handleMouseDownPan(c),this.state=2}else{if(!1===this.enableRotate)return;this._handleMouseDownRotate(c),this.state=0}break;case 2:if(c.ctrlKey||c.metaKey||c.shiftKey){if(!1===this.enableRotate)return;this._handleMouseDownRotate(c),this.state=0}else{if(!1===this.enablePan)return;this._handleMouseDownPan(c),this.state=2}break;default:this.state=-1}-1!==this.state&&this.dispatchEvent(Dp)}function vE(c){switch(this.state){case 0:if(!1===this.enableRotate)return;this._handleMouseMoveRotate(c);break;case 1:if(!1===this.enableZoom)return;this._handleMouseMoveDolly(c);break;case 2:if(!1===this.enablePan)return;this._handleMouseMovePan(c)}}function jg(c){!1===this.enabled||!1===this.enableZoom||-1!==this.state||(c.preventDefault(),this.dispatchEvent(Dp),this._handleMouseWheel(this._customWheelEvent(c)),this.dispatchEvent(zg))}function ls(c){!1===this.enabled||!1===this.enablePan||this._handleKeyDown(c)}function Y_(c){switch(this._trackPointer(c),this._pointers.length){case 1:switch(this.touches.ONE){case 0:if(!1===this.enableRotate)return;this._handleTouchStartRotate(c),this.state=3;break;case 1:if(!1===this.enablePan)return;this._handleTouchStartPan(c),this.state=4;break;default:this.state=-1}break;case 2:switch(this.touches.TWO){case 2:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchStartDollyPan(c),this.state=5;break;case 3:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchStartDollyRotate(c),this.state=6;break;default:this.state=-1}break;default:this.state=-1}-1!==this.state&&this.dispatchEvent(Dp)}function yE(c){switch(this._trackPointer(c),this.state){case 3:if(!1===this.enableRotate)return;this._handleTouchMoveRotate(c),this.update();break;case 4:if(!1===this.enablePan)return;this._handleTouchMovePan(c),this.update();break;case 5:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchMoveDollyPan(c),this.update();break;case 6:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchMoveDollyRotate(c),this.update();break;default:this.state=-1}}function Es(c){!1!==this.enabled&&c.preventDefault()}function Uh(c){"Control"===c.key&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function Td(c){"Control"===c.key&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const xc=new ee,Ll=new ee,Ad=new ee;class q_{modify(e,t,r=!0){function u(T,B,V){xc.set(M[3*V],M[3*V+1],M[3*V+2]).normalize();const F={splitGroup:[],currentGroup:[V]};for(const ne of T)ne!==V&&(Ll.set(M[3*ne],M[3*ne+1],M[3*ne+2]).normalize(),Ll.dot(xc)<B?F.splitGroup.push(ne):F.currentGroup.push(ne));return F}function h(T,B,V=null){if(0===T.length)return;const F=[];for(const Q of T)F.push(u(T,B,Q));let ne=F[0];for(const Q of F)Q.currentGroup.length>ne.currentGroup.length&&(ne=Q);null!=V&&A.push({original:V,indexes:ne.currentGroup}),ne.splitGroup.length&&h(ne.splitGroup,B,V||ne.currentGroup[0])}let p=!1,m=null;e.attributes.normal&&(p=!0,e=e.clone(),!0===r&&null!==e.index&&(m=e.attributes.normal.array),e.deleteAttribute("normal")),null==e.index&&(e=function N_(c,e=1e-4){e=Math.max(e,Number.EPSILON);const t={},r=c.getIndex(),o=c.getAttribute("position"),l=r?r.count:o.count;let u=0;const h=Object.keys(c.attributes),p={},m={},v=[],y=["getX","getY","getZ","getW"],M=["setX","setY","setZ","setW"];for(let B=0,V=h.length;B<V;B++){const F=h[B],ne=c.attributes[F];p[F]=new ne.constructor(new ne.array.constructor(ne.count*ne.itemSize),ne.itemSize,ne.normalized);const Q=c.morphAttributes[F];Q&&(m[F]||(m[F]=[]),Q.forEach((te,se)=>{const X=new te.array.constructor(te.count*te.itemSize);m[F][se]=new te.constructor(X,te.itemSize,te.normalized)}))}const S=.5*e,A=Math.log10(1/e),N=Math.pow(10,A),R=S*N;for(let B=0;B<l;B++){const V=r?r.getX(B):B;let F="";for(let ne=0,Q=h.length;ne<Q;ne++){const se=c.getAttribute(h[ne]),X=se.itemSize;for(let j=0;j<X;j++)F+=~~(se[y[j]](V)*N+R)+","}if(F in t)v.push(t[F]);else{for(let ne=0,Q=h.length;ne<Q;ne++){const te=h[ne],se=c.getAttribute(te),X=c.morphAttributes[te],j=se.itemSize,fe=p[te],Re=m[te];for(let Ce=0;Ce<j;Ce++){const Fe=y[Ce],st=M[Ce];if(fe[st](u,se[Fe](V)),X)for(let Be=0,bt=X.length;Be<bt;Be++)Re[Be][st](u,X[Be][Fe](V))}}t[F]=u,v.push(u),u++}}const T=c.clone();for(const B in c.attributes){const V=p[B];if(T.setAttribute(B,new V.constructor(V.array.slice(0,u*V.itemSize),V.itemSize,V.normalized)),B in m)for(let F=0;F<m[B].length;F++){const ne=m[B][F];T.morphAttributes[B][F]=new ne.constructor(ne.array.slice(0,u*ne.itemSize),ne.itemSize,ne.normalized)}}return T.setIndex(v),T}(e));const v=e.index.array,y=e.getAttribute("position").array;let M,S;(function o(){M=new Float32Array(3*v.length);for(let T=0;T<v.length;T+=3){let B=v[T];xc.set(y[3*B],y[3*B+1],y[3*B+2]),B=v[T+1],Ll.set(y[3*B],y[3*B+1],y[3*B+2]),B=v[T+2],Ad.set(y[3*B],y[3*B+1],y[3*B+2]),Ad.sub(Ll),xc.sub(Ll);const V=Ad.cross(xc).normalize();for(let F=0;F<3;F++)M[3*(T+F)]=V.x,M[3*(T+F)+1]=V.y,M[3*(T+F)+2]=V.z}})(),function l(){S=Array(y.length/3);for(let T=0;T<v.length;T++){const B=v[T];null==S[B]&&(S[B]=[]),S[B].push(T)}}();const A=[];for(const T of S)h(T,Math.cos(t)-.001);const N={};for(const T of Object.keys(e.attributes)){const B=e.attributes[T],V=new B.array.constructor((v.length+A.length)*B.itemSize);V.set(B.array),N[T]=new xr(V,B.itemSize,B.normalized)}const R=new Uint32Array(v.length);R.set(v);for(let T=0;T<A.length;T++){const B=A[T],V=v[B.original];for(const F of Object.values(N))for(let ne=0;ne<F.itemSize;ne++)F.array[(v.length+T)*F.itemSize+ne]=F.array[V*F.itemSize+ne];for(const F of B.indexes)R[F]=v.length+T}(e=new si).setIndex(new xr(R,1));for(const T of Object.keys(N))e.setAttribute(T,N[T]);if(p&&(e.computeVertexNormals(),null!==m)){const T=new Array(m.length/3).fill(!1);for(const B of A)T[B.original]=!0;for(let B=0;B<T.length;B++)if(!1===T[B])for(let V=0;V<3;V++)e.attributes.normal.array[3*B+V]=m[3*B+V]}return e}}let K_=(()=>{class c{scene;camera;renderer;model;controls;directionalLight;lightDirection;arrowHelperX;arrowHelperY;arrowHelperZ;textMesh;floor;constructor(){this.scene=new ih,this.camera=new ys(50,window.innerWidth/window.innerHeight,.001,1e4),this.renderer=new Fm({alpha:!0,antialias:!0,logarithmicDepthBuffer:!0,powerPreference:"high-performance"}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.camera.position.z=2,this.camera.position.x=20,this.camera.rotation.y=30,this.scene.position.z=-7;const t=new Tg(16777215,2);this.scene.add(t),this.directionalLight=new l_(16777215,4),this.directionalLight.position.set(40,15,25),this.directionalLight.castShadow=!0,this.directionalLight.shadow.mapSize.width=2048,this.directionalLight.shadow.mapSize.height=2048,this.directionalLight.shadow.radius=1,this.directionalLight.shadow.camera.near=.5,this.directionalLight.shadow.camera.far=500,this.directionalLight.shadow.camera.left=-50,this.directionalLight.shadow.camera.right=50,this.directionalLight.shadow.camera.top=50,this.directionalLight.shadow.camera.bottom=-50,this.directionalLight.shadow.bias=-1e-4,this.scene.add(this.directionalLight);const r=new Ch(16777215,2);r.position.set(10,10,10),this.scene.add(r);const o=new Ch(16777215,2);o.position.set(-10,10,10),this.scene.add(o);const l=new Kf(80,32),u=new _a({color:"white"}),h=new Rs(l,u);h.rotation.x=-Math.PI/2,h.position.y=-9,h.receiveShadow=!0,this.scene.add(h)}init(t){t.nativeElement.appendChild(this.renderer.domElement),this.controls=new $_(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.2,t.nativeElement.appendChild(this.renderer.domElement),(new O_).load("./assets/tadiranLogo5.glb",o=>{this.model=o.scene;const u=(new Eg).load("./assets/mv2.avif"),h=new _a({color:"#2e8ae7",metalness:.4,roughness:.2,side:2});new dp({map:u,reflectivity:.9,side:2}),this.model.traverse(S=>{if(S.isMesh){const A=S;A.geometry=(new q_).modify(A.geometry,.5,!0),A.geometry.computeVertexNormals(),A.castShadow=!0,A.receiveShadow=!0,A.geometry.computeVertexNormals(),A.material=h}}),this.lightDirection=(new ee).subVectors(this.directionalLight.position,this.model.position).normalize();const y=new ee(1,0,0),M=(new Ki).setFromUnitVectors(y,this.lightDirection);this.model.setRotationFromQuaternion(M),this.scene.add(this.model),this.animate()})}changeFloorTexture(t){(new Eg).load(t,o=>{this.floor&&(this.floor.material.map=o,this.floor.material.needsUpdate=!0)})}animate(){if(requestAnimationFrame(()=>this.animate()),this.model){const t=new ee(0,1,0).applyQuaternion(this.model.quaternion);this.model.rotateOnWorldAxis(t,.001)}this.controls&&this.controls.update(),this.renderer.render(this.scene,this.camera)}static \u0275fac=function(r){return new(r||c)};static \u0275prov=ie.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();const Z_=["background"],Rp=(c,e)=>e.name;function $g(c,e){if(1&c&&(ie.TgZ(0,"li"),ie._uU(1),ie.qZA()),2&c){const t=e.$implicit;ie.xp6(1),ie.Oqu(t)}}function J_(c,e){if(1&c&&(ie.TgZ(0,"div",12)(1,"ul"),ie.SjG(2,$g,2,1,"li",null,ie.ikw),ie.qZA()()),2&c){const t=ie.oxw();ie.xp6(2),ie.wJu(t.message)}}function Pp(c,e){if(1&c&&(ie.TgZ(0,"li",13)(1,"a",14),ie._uU(2),ie.qZA()()),2&c){const t=e.$implicit;ie.xp6(1),ie.s9C("href",t.url,ie.LSH),ie.xp6(1),ie.Oqu(t.name)}}let Ec=(()=>{class c{uploadService;threeService;background;selectedFiles;message=[];fileInfos;constructor(t,r){this.uploadService=t,this.threeService=r}ngOnInit(){this.threeService.init(this.background),this.fileInfos=this.uploadService.getFiles()}selectFiles(t){this.message=[],this.selectedFiles=t.target.files}upload(t){t&&this.uploadService.upload(t).subscribe({next:r=>{r instanceof be.Zn&&(this.message.push(t.name+": Successful!"),this.fileInfos=this.uploadService.getFiles())},error:r=>{let o=t.name+": Failed!";r.error&&r.error.message&&(o+=" "+r.error.message),this.message.push(o),this.fileInfos=this.uploadService.getFiles()}})}uploadFiles(){if(this.message=[],this.selectedFiles){for(let t=0;t<this.selectedFiles.length;t++)this.upload(this.selectedFiles[t]);this.selectedFiles=void 0}}static \u0275fac=function(r){return new(r||c)(ie.Y36(ht),ie.Y36(K_))};static \u0275cmp=ie.Xpm({type:c,selectors:[["app-upload-files"]],viewQuery:function(r,o){if(1&r&&ie.Gf(Z_,7),2&r){let l;ie.iGM(l=ie.CRH())&&(o.background=l.first)}},decls:17,vars:4,consts:[[1,"background"],["background",""],[1,"row"],[1,"col-8"],[1,"btn","btn-default","p-0"],["type","file","multiple","",3,"change"],[1,"col-4"],[1,"btn","btn-success","btn-sm",3,"disabled","click"],["class","alert alert-secondary my-3","role","alert"],[1,"card","mt-3"],[1,"card-header"],[1,"list-group","list-group-flush"],["role","alert",1,"alert","alert-secondary","my-3"],[1,"list-group-item"],[3,"href"],["class","list-group-item"]],template:function(r,o){1&r&&(ie._UZ(0,"div",0,1),ie.TgZ(2,"div",2)(3,"div",3)(4,"label",4)(5,"input",5),ie.NdJ("change",function(u){return o.selectFiles(u)}),ie.qZA()()(),ie.TgZ(6,"div",6)(7,"button",7),ie.NdJ("click",function(){return o.uploadFiles()}),ie._uU(8," Upload "),ie.qZA()()(),ie.YNc(9,J_,4,0,"div",8),ie.TgZ(10,"div",9)(11,"div",10),ie._uU(12,"List of Files"),ie.qZA(),ie.TgZ(13,"ul",11),ie.SjG(14,Pp,3,2,"li",15,Rp),ie.ALo(16,"async"),ie.qZA()()),2&r&&(ie.xp6(7),ie.Q6J("disabled",!o.selectedFiles),ie.xp6(2),ie.um2(9,o.message.length?9:-1),ie.xp6(5),ie.wJu(ie.lcZ(16,2,o.fileInfos)))},dependencies:[xe.Ov],styles:["ul[_ngcontent-%COMP%]{margin-bottom:0}.alert[_ngcontent-%COMP%]{padding-left:0}.background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:-100;background:linear-gradient(0deg,rgb(164,164,164),rgb(255,255,255))}"]})}return c})();const _E=[{path:"login2",loadChildren:()=>Z.e(77).then(Z.bind(Z,8077)).then(c=>c.Login2Module)},{path:"",redirectTo:"login2",pathMatch:"full"},{path:"uploadfiles",component:Ec,pathMatch:"full"}];let Ea=(()=>{class c{static \u0275fac=function(r){return new(r||c)};static \u0275mod=ie.oAB({type:c,bootstrap:[Pe]});static \u0275inj=ie.cJS({providers:[Pe,Ec],imports:[ze.Bz.forRoot(_E),E.b2,be.JF,it.u5,xe.ez,ze.Bz]})}return c})();(0,ie.G48)(),E.q6().bootstrapModule(Ea).catch(c=>console.error(c))},5619:(mn,Ke,Z)=>{Z.d(Ke,{X:()=>ie});var E=Z(8645);class ie extends E.x{constructor(Pe){super(),this._value=Pe}get value(){return this.getValue()}_subscribe(Pe){const be=super._subscribe(Pe);return!be.closed&&Pe.next(this._value),be}getValue(){const{hasError:Pe,thrownError:be,_value:xe}=this;if(Pe)throw be;return this._throwIfClosed(),xe}next(Pe){super.next(this._value=Pe)}}},5592:(mn,Ke,Z)=>{Z.d(Ke,{y:()=>ht});var E=Z(305),ie=Z(7394),ze=Z(4850),Pe=Z(8407),be=Z(2653),xe=Z(4674),it=Z(1441);let ht=(()=>{class ot{constructor(rt){rt&&(this._subscribe=rt)}lift(rt){const St=new ot;return St.source=this,St.operator=rt,St}subscribe(rt,St,Ln){const $t=function Ie(ot){return ot&&ot instanceof E.Lv||function et(ot){return ot&&(0,xe.m)(ot.next)&&(0,xe.m)(ot.error)&&(0,xe.m)(ot.complete)}(ot)&&(0,ie.Nn)(ot)}(rt)?rt:new E.Hp(rt,St,Ln);return(0,it.x)(()=>{const{operator:_n,source:mi}=this;$t.add(_n?_n.call($t,mi):mi?this._subscribe($t):this._trySubscribe($t))}),$t}_trySubscribe(rt){try{return this._subscribe(rt)}catch(St){rt.error(St)}}forEach(rt,St){return new(St=pt(St))((Ln,$t)=>{const _n=new E.Hp({next:mi=>{try{rt(mi)}catch(ui){$t(ui),_n.unsubscribe()}},error:$t,complete:Ln});this.subscribe(_n)})}_subscribe(rt){var St;return null===(St=this.source)||void 0===St?void 0:St.subscribe(rt)}[ze.L](){return this}pipe(...rt){return(0,Pe.U)(rt)(this)}toPromise(rt){return new(rt=pt(rt))((St,Ln)=>{let $t;this.subscribe(_n=>$t=_n,_n=>Ln(_n),()=>St($t))})}}return ot.create=jt=>new ot(jt),ot})();function pt(ot){var jt;return null!==(jt=ot??be.config.Promise)&&void 0!==jt?jt:Promise}},8645:(mn,Ke,Z)=>{Z.d(Ke,{x:()=>it});var E=Z(5592),ie=Z(7394);const Pe=(0,Z(2306).d)(pt=>function(){pt(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var be=Z(9039),xe=Z(1441);let it=(()=>{class pt extends E.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Ie){const ot=new ht(this,this);return ot.operator=Ie,ot}_throwIfClosed(){if(this.closed)throw new Pe}next(Ie){(0,xe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const ot of this.currentObservers)ot.next(Ie)}})}error(Ie){(0,xe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Ie;const{observers:ot}=this;for(;ot.length;)ot.shift().error(Ie)}})}complete(){(0,xe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Ie}=this;for(;Ie.length;)Ie.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Ie;return(null===(Ie=this.observers)||void 0===Ie?void 0:Ie.length)>0}_trySubscribe(Ie){return this._throwIfClosed(),super._trySubscribe(Ie)}_subscribe(Ie){return this._throwIfClosed(),this._checkFinalizedStatuses(Ie),this._innerSubscribe(Ie)}_innerSubscribe(Ie){const{hasError:ot,isStopped:jt,observers:rt}=this;return ot||jt?ie.Lc:(this.currentObservers=null,rt.push(Ie),new ie.w0(()=>{this.currentObservers=null,(0,be.P)(rt,Ie)}))}_checkFinalizedStatuses(Ie){const{hasError:ot,thrownError:jt,isStopped:rt}=this;ot?Ie.error(jt):rt&&Ie.complete()}asObservable(){const Ie=new E.y;return Ie.source=this,Ie}}return pt.create=(et,Ie)=>new ht(et,Ie),pt})();class ht extends it{constructor(et,Ie){super(),this.destination=et,this.source=Ie}next(et){var Ie,ot;null===(ot=null===(Ie=this.destination)||void 0===Ie?void 0:Ie.next)||void 0===ot||ot.call(Ie,et)}error(et){var Ie,ot;null===(ot=null===(Ie=this.destination)||void 0===Ie?void 0:Ie.error)||void 0===ot||ot.call(Ie,et)}complete(){var et,Ie;null===(Ie=null===(et=this.destination)||void 0===et?void 0:et.complete)||void 0===Ie||Ie.call(et)}_subscribe(et){var Ie,ot;return null!==(ot=null===(Ie=this.source)||void 0===Ie?void 0:Ie.subscribe(et))&&void 0!==ot?ot:ie.Lc}}},305:(mn,Ke,Z)=>{Z.d(Ke,{Hp:()=>Ln,Lv:()=>ot});var E=Z(4674),ie=Z(7394),ze=Z(2653),Pe=Z(3894),be=Z(2420);const xe=pt("C",void 0,void 0);function pt(yt,Ye,mt){return{kind:yt,value:Ye,error:mt}}var et=Z(7599),Ie=Z(1441);class ot extends ie.w0{constructor(Ye){super(),this.isStopped=!1,Ye?(this.destination=Ye,(0,ie.Nn)(Ye)&&Ye.add(this)):this.destination=ui}static create(Ye,mt,en){return new Ln(Ye,mt,en)}next(Ye){this.isStopped?mi(function ht(yt){return pt("N",yt,void 0)}(Ye),this):this._next(Ye)}error(Ye){this.isStopped?mi(function it(yt){return pt("E",void 0,yt)}(Ye),this):(this.isStopped=!0,this._error(Ye))}complete(){this.isStopped?mi(xe,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Ye){this.destination.next(Ye)}_error(Ye){try{this.destination.error(Ye)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const jt=Function.prototype.bind;function rt(yt,Ye){return jt.call(yt,Ye)}class St{constructor(Ye){this.partialObserver=Ye}next(Ye){const{partialObserver:mt}=this;if(mt.next)try{mt.next(Ye)}catch(en){$t(en)}}error(Ye){const{partialObserver:mt}=this;if(mt.error)try{mt.error(Ye)}catch(en){$t(en)}else $t(Ye)}complete(){const{partialObserver:Ye}=this;if(Ye.complete)try{Ye.complete()}catch(mt){$t(mt)}}}class Ln extends ot{constructor(Ye,mt,en){let wt;if(super(),(0,E.m)(Ye)||!Ye)wt={next:Ye??void 0,error:mt??void 0,complete:en??void 0};else{let xt;this&&ze.config.useDeprecatedNextContext?(xt=Object.create(Ye),xt.unsubscribe=()=>this.unsubscribe(),wt={next:Ye.next&&rt(Ye.next,xt),error:Ye.error&&rt(Ye.error,xt),complete:Ye.complete&&rt(Ye.complete,xt)}):wt=Ye}this.destination=new St(wt)}}function $t(yt){ze.config.useDeprecatedSynchronousErrorHandling?(0,Ie.O)(yt):(0,Pe.h)(yt)}function mi(yt,Ye){const{onStoppedNotification:mt}=ze.config;mt&&et.z.setTimeout(()=>mt(yt,Ye))}const ui={closed:!0,next:be.Z,error:function _n(yt){throw yt},complete:be.Z}},7394:(mn,Ke,Z)=>{Z.d(Ke,{Lc:()=>xe,w0:()=>be,Nn:()=>it});var E=Z(4674);const ze=(0,Z(2306).d)(pt=>function(Ie){pt(this),this.message=Ie?`${Ie.length} errors occurred during unsubscription:\n${Ie.map((ot,jt)=>`${jt+1}) ${ot.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Ie});var Pe=Z(9039);class be{constructor(et){this.initialTeardown=et,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let et;if(!this.closed){this.closed=!0;const{_parentage:Ie}=this;if(Ie)if(this._parentage=null,Array.isArray(Ie))for(const rt of Ie)rt.remove(this);else Ie.remove(this);const{initialTeardown:ot}=this;if((0,E.m)(ot))try{ot()}catch(rt){et=rt instanceof ze?rt.errors:[rt]}const{_finalizers:jt}=this;if(jt){this._finalizers=null;for(const rt of jt)try{ht(rt)}catch(St){et=et??[],St instanceof ze?et=[...et,...St.errors]:et.push(St)}}if(et)throw new ze(et)}}add(et){var Ie;if(et&&et!==this)if(this.closed)ht(et);else{if(et instanceof be){if(et.closed||et._hasParent(this))return;et._addParent(this)}(this._finalizers=null!==(Ie=this._finalizers)&&void 0!==Ie?Ie:[]).push(et)}}_hasParent(et){const{_parentage:Ie}=this;return Ie===et||Array.isArray(Ie)&&Ie.includes(et)}_addParent(et){const{_parentage:Ie}=this;this._parentage=Array.isArray(Ie)?(Ie.push(et),Ie):Ie?[Ie,et]:et}_removeParent(et){const{_parentage:Ie}=this;Ie===et?this._parentage=null:Array.isArray(Ie)&&(0,Pe.P)(Ie,et)}remove(et){const{_finalizers:Ie}=this;Ie&&(0,Pe.P)(Ie,et),et instanceof be&&et._removeParent(this)}}be.EMPTY=(()=>{const pt=new be;return pt.closed=!0,pt})();const xe=be.EMPTY;function it(pt){return pt instanceof be||pt&&"closed"in pt&&(0,E.m)(pt.remove)&&(0,E.m)(pt.add)&&(0,E.m)(pt.unsubscribe)}function ht(pt){(0,E.m)(pt)?pt():pt.unsubscribe()}},2653:(mn,Ke,Z)=>{Z.d(Ke,{config:()=>E});const E={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},2572:(mn,Ke,Z)=>{Z.d(Ke,{a:()=>et});var E=Z(5592),ie=Z(7453),ze=Z(7715),Pe=Z(2737),be=Z(7400),xe=Z(9940),it=Z(2714),ht=Z(8251),pt=Z(7103);function et(...jt){const rt=(0,xe.yG)(jt),St=(0,xe.jO)(jt),{args:Ln,keys:$t}=(0,ie.D)(jt);if(0===Ln.length)return(0,ze.D)([],rt);const _n=new E.y(function Ie(jt,rt,St=Pe.y){return Ln=>{ot(rt,()=>{const{length:$t}=jt,_n=new Array($t);let mi=$t,ui=$t;for(let yt=0;yt<$t;yt++)ot(rt,()=>{const Ye=(0,ze.D)(jt[yt],rt);let mt=!1;Ye.subscribe((0,ht.x)(Ln,en=>{_n[yt]=en,mt||(mt=!0,ui--),ui||Ln.next(St(_n.slice()))},()=>{--mi||Ln.complete()}))},Ln)},Ln)}}(Ln,rt,$t?mi=>(0,it.n)($t,mi):Pe.y));return St?_n.pipe((0,be.Z)(St)):_n}function ot(jt,rt,St){jt?(0,pt.f)(St,jt,rt):rt()}},5211:(mn,Ke,Z)=>{Z.d(Ke,{z:()=>be});var E=Z(7537),ze=Z(9940),Pe=Z(7715);function be(...xe){return function ie(){return(0,E.J)(1)}()((0,Pe.D)(xe,(0,ze.yG)(xe)))}},4911:(mn,Ke,Z)=>{Z.d(Ke,{P:()=>ze});var E=Z(5592),ie=Z(4829);function ze(Pe){return new E.y(be=>{(0,ie.Xf)(Pe()).subscribe(be)})}},6232:(mn,Ke,Z)=>{Z.d(Ke,{E:()=>ie});const ie=new(Z(5592).y)(be=>be.complete())},9315:(mn,Ke,Z)=>{Z.d(Ke,{D:()=>ht});var E=Z(5592),ie=Z(7453),ze=Z(4829),Pe=Z(9940),be=Z(8251),xe=Z(7400),it=Z(2714);function ht(...pt){const et=(0,Pe.jO)(pt),{args:Ie,keys:ot}=(0,ie.D)(pt),jt=new E.y(rt=>{const{length:St}=Ie;if(!St)return void rt.complete();const Ln=new Array(St);let $t=St,_n=St;for(let mi=0;mi<St;mi++){let ui=!1;(0,ze.Xf)(Ie[mi]).subscribe((0,be.x)(rt,yt=>{ui||(ui=!0,_n--),Ln[mi]=yt},()=>$t--,void 0,()=>{(!$t||!ui)&&(_n||rt.next(ot?(0,it.n)(ot,Ln):Ln),rt.complete())}))}});return et?jt.pipe((0,xe.Z)(et)):jt}},7715:(mn,Ke,Z)=>{Z.d(Ke,{D:()=>en});var E=Z(4829),ie=Z(7103),ze=Z(9360),Pe=Z(8251);function be(wt,xt=0){return(0,ze.e)((wn,tn)=>{wn.subscribe((0,Pe.x)(tn,ir=>(0,ie.f)(tn,wt,()=>tn.next(ir),xt),()=>(0,ie.f)(tn,wt,()=>tn.complete(),xt),ir=>(0,ie.f)(tn,wt,()=>tn.error(ir),xt)))})}function xe(wt,xt=0){return(0,ze.e)((wn,tn)=>{tn.add(wt.schedule(()=>wn.subscribe(tn),xt))})}var pt=Z(5592),Ie=Z(4971),ot=Z(4674);function rt(wt,xt){if(!wt)throw new Error("Iterable cannot be null");return new pt.y(wn=>{(0,ie.f)(wn,xt,()=>{const tn=wt[Symbol.asyncIterator]();(0,ie.f)(wn,xt,()=>{tn.next().then(ir=>{ir.done?wn.complete():wn.next(ir.value)})},0,!0)})})}var St=Z(8382),Ln=Z(4026),$t=Z(4266),_n=Z(3664),mi=Z(5726),ui=Z(9853),yt=Z(541);function en(wt,xt){return xt?function mt(wt,xt){if(null!=wt){if((0,St.c)(wt))return function it(wt,xt){return(0,E.Xf)(wt).pipe(xe(xt),be(xt))}(wt,xt);if((0,$t.z)(wt))return function et(wt,xt){return new pt.y(wn=>{let tn=0;return xt.schedule(function(){tn===wt.length?wn.complete():(wn.next(wt[tn++]),wn.closed||this.schedule())})})}(wt,xt);if((0,Ln.t)(wt))return function ht(wt,xt){return(0,E.Xf)(wt).pipe(xe(xt),be(xt))}(wt,xt);if((0,mi.D)(wt))return rt(wt,xt);if((0,_n.T)(wt))return function jt(wt,xt){return new pt.y(wn=>{let tn;return(0,ie.f)(wn,xt,()=>{tn=wt[Ie.h](),(0,ie.f)(wn,xt,()=>{let ir,or;try{({value:ir,done:or}=tn.next())}catch(Lr){return void wn.error(Lr)}or?wn.complete():wn.next(ir)},0,!0)}),()=>(0,ot.m)(tn?.return)&&tn.return()})}(wt,xt);if((0,yt.L)(wt))return function Ye(wt,xt){return rt((0,yt.Q)(wt),xt)}(wt,xt)}throw(0,ui.z)(wt)}(wt,xt):(0,E.Xf)(wt)}},4829:(mn,Ke,Z)=>{Z.d(Ke,{Xf:()=>jt});var E=Z(7582),ie=Z(4266),ze=Z(4026),Pe=Z(5592),be=Z(8382),xe=Z(5726),it=Z(9853),ht=Z(3664),pt=Z(541),et=Z(4674),Ie=Z(3894),ot=Z(4850);function jt(yt){if(yt instanceof Pe.y)return yt;if(null!=yt){if((0,be.c)(yt))return function rt(yt){return new Pe.y(Ye=>{const mt=yt[ot.L]();if((0,et.m)(mt.subscribe))return mt.subscribe(Ye);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(yt);if((0,ie.z)(yt))return function St(yt){return new Pe.y(Ye=>{for(let mt=0;mt<yt.length&&!Ye.closed;mt++)Ye.next(yt[mt]);Ye.complete()})}(yt);if((0,ze.t)(yt))return function Ln(yt){return new Pe.y(Ye=>{yt.then(mt=>{Ye.closed||(Ye.next(mt),Ye.complete())},mt=>Ye.error(mt)).then(null,Ie.h)})}(yt);if((0,xe.D)(yt))return _n(yt);if((0,ht.T)(yt))return function $t(yt){return new Pe.y(Ye=>{for(const mt of yt)if(Ye.next(mt),Ye.closed)return;Ye.complete()})}(yt);if((0,pt.L)(yt))return function mi(yt){return _n((0,pt.Q)(yt))}(yt)}throw(0,it.z)(yt)}function _n(yt){return new Pe.y(Ye=>{(function ui(yt,Ye){var mt,en,wt,xt;return(0,E.mG)(this,void 0,void 0,function*(){try{for(mt=(0,E.KL)(yt);!(en=yield mt.next()).done;)if(Ye.next(en.value),Ye.closed)return}catch(wn){wt={error:wn}}finally{try{en&&!en.done&&(xt=mt.return)&&(yield xt.call(mt))}finally{if(wt)throw wt.error}}Ye.complete()})})(yt,Ye).catch(mt=>Ye.error(mt))})}},2096:(mn,Ke,Z)=>{Z.d(Ke,{of:()=>ze});var E=Z(9940),ie=Z(7715);function ze(...Pe){const be=(0,E.yG)(Pe);return(0,ie.D)(Pe,be)}},8504:(mn,Ke,Z)=>{Z.d(Ke,{_:()=>ze});var E=Z(5592),ie=Z(4674);function ze(Pe,be){const xe=(0,ie.m)(Pe)?Pe:()=>Pe,it=ht=>ht.error(xe());return new E.y(be?ht=>be.schedule(it,0,ht):it)}},8251:(mn,Ke,Z)=>{Z.d(Ke,{x:()=>ie});var E=Z(305);function ie(Pe,be,xe,it,ht){return new ze(Pe,be,xe,it,ht)}class ze extends E.Lv{constructor(be,xe,it,ht,pt,et){super(be),this.onFinalize=pt,this.shouldUnsubscribe=et,this._next=xe?function(Ie){try{xe(Ie)}catch(ot){be.error(ot)}}:super._next,this._error=ht?function(Ie){try{ht(Ie)}catch(ot){be.error(ot)}finally{this.unsubscribe()}}:super._error,this._complete=it?function(){try{it()}catch(Ie){be.error(Ie)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var be;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:xe}=this;super.unsubscribe(),!xe&&(null===(be=this.onFinalize)||void 0===be||be.call(this))}}}},6306:(mn,Ke,Z)=>{Z.d(Ke,{K:()=>Pe});var E=Z(4829),ie=Z(8251),ze=Z(9360);function Pe(be){return(0,ze.e)((xe,it)=>{let et,ht=null,pt=!1;ht=xe.subscribe((0,ie.x)(it,void 0,void 0,Ie=>{et=(0,E.Xf)(be(Ie,Pe(be)(xe))),ht?(ht.unsubscribe(),ht=null,et.subscribe(it)):pt=!0})),pt&&(ht.unsubscribe(),ht=null,et.subscribe(it))})}},6328:(mn,Ke,Z)=>{Z.d(Ke,{b:()=>ze});var E=Z(1631),ie=Z(4674);function ze(Pe,be){return(0,ie.m)(be)?(0,E.z)(Pe,be,1):(0,E.z)(Pe,1)}},2181:(mn,Ke,Z)=>{Z.d(Ke,{h:()=>ze});var E=Z(9360),ie=Z(8251);function ze(Pe,be){return(0,E.e)((xe,it)=>{let ht=0;xe.subscribe((0,ie.x)(it,pt=>Pe.call(be,pt,ht++)&&it.next(pt)))})}},4716:(mn,Ke,Z)=>{Z.d(Ke,{x:()=>ie});var E=Z(9360);function ie(ze){return(0,E.e)((Pe,be)=>{try{Pe.subscribe(be)}finally{be.add(ze)}})}},7398:(mn,Ke,Z)=>{Z.d(Ke,{U:()=>ze});var E=Z(9360),ie=Z(8251);function ze(Pe,be){return(0,E.e)((xe,it)=>{let ht=0;xe.subscribe((0,ie.x)(it,pt=>{it.next(Pe.call(be,pt,ht++))}))})}},7537:(mn,Ke,Z)=>{Z.d(Ke,{J:()=>ze});var E=Z(1631),ie=Z(2737);function ze(Pe=1/0){return(0,E.z)(ie.y,Pe)}},1631:(mn,Ke,Z)=>{Z.d(Ke,{z:()=>ht});var E=Z(7398),ie=Z(4829),ze=Z(9360),Pe=Z(7103),be=Z(8251),it=Z(4674);function ht(pt,et,Ie=1/0){return(0,it.m)(et)?ht((ot,jt)=>(0,E.U)((rt,St)=>et(ot,rt,jt,St))((0,ie.Xf)(pt(ot,jt))),Ie):("number"==typeof et&&(Ie=et),(0,ze.e)((ot,jt)=>function xe(pt,et,Ie,ot,jt,rt,St,Ln){const $t=[];let _n=0,mi=0,ui=!1;const yt=()=>{ui&&!$t.length&&!_n&&et.complete()},Ye=en=>_n<ot?mt(en):$t.push(en),mt=en=>{rt&&et.next(en),_n++;let wt=!1;(0,ie.Xf)(Ie(en,mi++)).subscribe((0,be.x)(et,xt=>{jt?.(xt),rt?Ye(xt):et.next(xt)},()=>{wt=!0},void 0,()=>{if(wt)try{for(_n--;$t.length&&_n<ot;){const xt=$t.shift();St?(0,Pe.f)(et,St,()=>mt(xt)):mt(xt)}yt()}catch(xt){et.error(xt)}}))};return pt.subscribe((0,be.x)(et,Ye,()=>{ui=!0,yt()})),()=>{Ln?.()}}(ot,jt,pt,Ie)))}},7921:(mn,Ke,Z)=>{Z.d(Ke,{O:()=>Pe});var E=Z(5211),ie=Z(9940),ze=Z(9360);function Pe(...be){const xe=(0,ie.yG)(be);return(0,ze.e)((it,ht)=>{(xe?(0,E.z)(be,it,xe):(0,E.z)(be,it)).subscribe(ht)})}},4664:(mn,Ke,Z)=>{Z.d(Ke,{w:()=>Pe});var E=Z(4829),ie=Z(9360),ze=Z(8251);function Pe(be,xe){return(0,ie.e)((it,ht)=>{let pt=null,et=0,Ie=!1;const ot=()=>Ie&&!pt&&ht.complete();it.subscribe((0,ze.x)(ht,jt=>{pt?.unsubscribe();let rt=0;const St=et++;(0,E.Xf)(be(jt,St)).subscribe(pt=(0,ze.x)(ht,Ln=>ht.next(xe?xe(jt,Ln,St,rt++):Ln),()=>{pt=null,ot()}))},()=>{Ie=!0,ot()}))})}},8180:(mn,Ke,Z)=>{Z.d(Ke,{q:()=>Pe});var E=Z(6232),ie=Z(9360),ze=Z(8251);function Pe(be){return be<=0?()=>E.E:(0,ie.e)((xe,it)=>{let ht=0;xe.subscribe((0,ze.x)(it,pt=>{++ht<=be&&(it.next(pt),be<=ht&&it.complete())}))})}},9773:(mn,Ke,Z)=>{Z.d(Ke,{R:()=>be});var E=Z(9360),ie=Z(8251),ze=Z(4829),Pe=Z(2420);function be(xe){return(0,E.e)((it,ht)=>{(0,ze.Xf)(xe).subscribe((0,ie.x)(ht,()=>ht.complete(),Pe.Z)),!ht.closed&&it.subscribe(ht)})}},9397:(mn,Ke,Z)=>{Z.d(Ke,{b:()=>be});var E=Z(4674),ie=Z(9360),ze=Z(8251),Pe=Z(2737);function be(xe,it,ht){const pt=(0,E.m)(xe)||it||ht?{next:xe,error:it,complete:ht}:xe;return pt?(0,ie.e)((et,Ie)=>{var ot;null===(ot=pt.subscribe)||void 0===ot||ot.call(pt);let jt=!0;et.subscribe((0,ze.x)(Ie,rt=>{var St;null===(St=pt.next)||void 0===St||St.call(pt,rt),Ie.next(rt)},()=>{var rt;jt=!1,null===(rt=pt.complete)||void 0===rt||rt.call(pt),Ie.complete()},rt=>{var St;jt=!1,null===(St=pt.error)||void 0===St||St.call(pt,rt),Ie.error(rt)},()=>{var rt,St;jt&&(null===(rt=pt.unsubscribe)||void 0===rt||rt.call(pt)),null===(St=pt.finalize)||void 0===St||St.call(pt)}))}):Pe.y}},7599:(mn,Ke,Z)=>{Z.d(Ke,{z:()=>E});const E={setTimeout(ie,ze,...Pe){const{delegate:be}=E;return be?.setTimeout?be.setTimeout(ie,ze,...Pe):setTimeout(ie,ze,...Pe)},clearTimeout(ie){const{delegate:ze}=E;return(ze?.clearTimeout||clearTimeout)(ie)},delegate:void 0}},4971:(mn,Ke,Z)=>{Z.d(Ke,{h:()=>ie});const ie=function E(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},4850:(mn,Ke,Z)=>{Z.d(Ke,{L:()=>E});const E="function"==typeof Symbol&&Symbol.observable||"@@observable"},9940:(mn,Ke,Z)=>{Z.d(Ke,{_6:()=>xe,jO:()=>Pe,yG:()=>be});var E=Z(4674),ie=Z(671);function ze(it){return it[it.length-1]}function Pe(it){return(0,E.m)(ze(it))?it.pop():void 0}function be(it){return(0,ie.K)(ze(it))?it.pop():void 0}function xe(it,ht){return"number"==typeof ze(it)?it.pop():ht}},7453:(mn,Ke,Z)=>{Z.d(Ke,{D:()=>be});const{isArray:E}=Array,{getPrototypeOf:ie,prototype:ze,keys:Pe}=Object;function be(it){if(1===it.length){const ht=it[0];if(E(ht))return{args:ht,keys:null};if(function xe(it){return it&&"object"==typeof it&&ie(it)===ze}(ht)){const pt=Pe(ht);return{args:pt.map(et=>ht[et]),keys:pt}}}return{args:it,keys:null}}},9039:(mn,Ke,Z)=>{function E(ie,ze){if(ie){const Pe=ie.indexOf(ze);0<=Pe&&ie.splice(Pe,1)}}Z.d(Ke,{P:()=>E})},2306:(mn,Ke,Z)=>{function E(ie){const Pe=ie(be=>{Error.call(be),be.stack=(new Error).stack});return Pe.prototype=Object.create(Error.prototype),Pe.prototype.constructor=Pe,Pe}Z.d(Ke,{d:()=>E})},2714:(mn,Ke,Z)=>{function E(ie,ze){return ie.reduce((Pe,be,xe)=>(Pe[be]=ze[xe],Pe),{})}Z.d(Ke,{n:()=>E})},1441:(mn,Ke,Z)=>{Z.d(Ke,{O:()=>Pe,x:()=>ze});var E=Z(2653);let ie=null;function ze(be){if(E.config.useDeprecatedSynchronousErrorHandling){const xe=!ie;if(xe&&(ie={errorThrown:!1,error:null}),be(),xe){const{errorThrown:it,error:ht}=ie;if(ie=null,it)throw ht}}else be()}function Pe(be){E.config.useDeprecatedSynchronousErrorHandling&&ie&&(ie.errorThrown=!0,ie.error=be)}},7103:(mn,Ke,Z)=>{function E(ie,ze,Pe,be=0,xe=!1){const it=ze.schedule(function(){Pe(),xe?ie.add(this.schedule(null,be)):this.unsubscribe()},be);if(ie.add(it),!xe)return it}Z.d(Ke,{f:()=>E})},2737:(mn,Ke,Z)=>{function E(ie){return ie}Z.d(Ke,{y:()=>E})},4266:(mn,Ke,Z)=>{Z.d(Ke,{z:()=>E});const E=ie=>ie&&"number"==typeof ie.length&&"function"!=typeof ie},5726:(mn,Ke,Z)=>{Z.d(Ke,{D:()=>ie});var E=Z(4674);function ie(ze){return Symbol.asyncIterator&&(0,E.m)(ze?.[Symbol.asyncIterator])}},4674:(mn,Ke,Z)=>{function E(ie){return"function"==typeof ie}Z.d(Ke,{m:()=>E})},8382:(mn,Ke,Z)=>{Z.d(Ke,{c:()=>ze});var E=Z(4850),ie=Z(4674);function ze(Pe){return(0,ie.m)(Pe[E.L])}},3664:(mn,Ke,Z)=>{Z.d(Ke,{T:()=>ze});var E=Z(4971),ie=Z(4674);function ze(Pe){return(0,ie.m)(Pe?.[E.h])}},4026:(mn,Ke,Z)=>{Z.d(Ke,{t:()=>ie});var E=Z(4674);function ie(ze){return(0,E.m)(ze?.then)}},541:(mn,Ke,Z)=>{Z.d(Ke,{L:()=>Pe,Q:()=>ze});var E=Z(7582),ie=Z(4674);function ze(be){return(0,E.FC)(this,arguments,function*(){const it=be.getReader();try{for(;;){const{value:ht,done:pt}=yield(0,E.qq)(it.read());if(pt)return yield(0,E.qq)(void 0);yield yield(0,E.qq)(ht)}}finally{it.releaseLock()}})}function Pe(be){return(0,ie.m)(be?.getReader)}},671:(mn,Ke,Z)=>{Z.d(Ke,{K:()=>ie});var E=Z(4674);function ie(ze){return ze&&(0,E.m)(ze.schedule)}},9360:(mn,Ke,Z)=>{Z.d(Ke,{A:()=>ie,e:()=>ze});var E=Z(4674);function ie(Pe){return(0,E.m)(Pe?.lift)}function ze(Pe){return be=>{if(ie(be))return be.lift(function(xe){try{return Pe(xe,this)}catch(it){this.error(it)}});throw new TypeError("Unable to lift unknown Observable type")}}},7400:(mn,Ke,Z)=>{Z.d(Ke,{Z:()=>Pe});var E=Z(7398);const{isArray:ie}=Array;function Pe(be){return(0,E.U)(xe=>function ze(be,xe){return ie(xe)?be(...xe):be(xe)}(be,xe))}},2420:(mn,Ke,Z)=>{function E(){}Z.d(Ke,{Z:()=>E})},8407:(mn,Ke,Z)=>{Z.d(Ke,{U:()=>ze,z:()=>ie});var E=Z(2737);function ie(...Pe){return ze(Pe)}function ze(Pe){return 0===Pe.length?E.y:1===Pe.length?Pe[0]:function(xe){return Pe.reduce((it,ht)=>ht(it),xe)}}},3894:(mn,Ke,Z)=>{Z.d(Ke,{h:()=>ze});var E=Z(2653),ie=Z(7599);function ze(Pe){ie.z.setTimeout(()=>{const{onUnhandledError:be}=E.config;if(!be)throw Pe;be(Pe)})}},9853:(mn,Ke,Z)=>{function E(ie){return new TypeError(`You provided ${null!==ie&&"object"==typeof ie?"an invalid object":`'${ie}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}Z.d(Ke,{z:()=>E})},6814:(mn,Ke,Z)=>{Z.d(Ke,{Do:()=>Ln,EM:()=>Sc,HT:()=>Pe,JF:()=>hl,K0:()=>xe,Mx:()=>he,NF:()=>so,O5:()=>qi,Ov:()=>vo,PC:()=>ia,PM:()=>Mr,RF:()=>er,S$:()=>jt,V_:()=>ht,Ye:()=>$t,b0:()=>St,bD:()=>dl,ez:()=>ro,mk:()=>We,n9:()=>Cs,q:()=>ze,sg:()=>Ui,w_:()=>be});var E=Z(9212);let ie=null;function ze(){return ie}function Pe(C){ie||(ie=C)}class be{}const xe=new E.OlP("DocumentToken");let it=(()=>{class C{historyGo(O){throw new Error("Not implemented")}static{this.\u0275fac=function(z){return new(z||C)}}static{this.\u0275prov=E.Yz7({token:C,factory:()=>(0,E.f3M)(pt),providedIn:"platform"})}}return C})();const ht=new E.OlP("Location Initialized");let pt=(()=>{class C extends it{constructor(){super(),this._doc=(0,E.f3M)(xe),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ze().getBaseHref(this._doc)}onPopState(O){const z=ze().getGlobalEventTarget(this._doc,"window");return z.addEventListener("popstate",O,!1),()=>z.removeEventListener("popstate",O)}onHashChange(O){const z=ze().getGlobalEventTarget(this._doc,"window");return z.addEventListener("hashchange",O,!1),()=>z.removeEventListener("hashchange",O)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(O){this._location.pathname=O}pushState(O,z,le){this._history.pushState(O,z,le)}replaceState(O,z,le){this._history.replaceState(O,z,le)}forward(){this._history.forward()}back(){this._history.back()}historyGo(O=0){this._history.go(O)}getState(){return this._history.state}static{this.\u0275fac=function(z){return new(z||C)}}static{this.\u0275prov=E.Yz7({token:C,factory:()=>new C,providedIn:"platform"})}}return C})();function et(C,W){if(0==C.length)return W;if(0==W.length)return C;let O=0;return C.endsWith("/")&&O++,W.startsWith("/")&&O++,2==O?C+W.substring(1):1==O?C+W:C+"/"+W}function Ie(C){const W=C.match(/#|\?|$/),O=W&&W.index||C.length;return C.slice(0,O-("/"===C[O-1]?1:0))+C.slice(O)}function ot(C){return C&&"?"!==C[0]?"?"+C:C}let jt=(()=>{class C{historyGo(O){throw new Error("Not implemented")}static{this.\u0275fac=function(z){return new(z||C)}}static{this.\u0275prov=E.Yz7({token:C,factory:()=>(0,E.f3M)(St),providedIn:"root"})}}return C})();const rt=new E.OlP("appBaseHref");let St=(()=>{class C extends jt{constructor(O,z){super(),this._platformLocation=O,this._removeListenerFns=[],this._baseHref=z??this._platformLocation.getBaseHrefFromDOM()??(0,E.f3M)(xe).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(O){this._removeListenerFns.push(this._platformLocation.onPopState(O),this._platformLocation.onHashChange(O))}getBaseHref(){return this._baseHref}prepareExternalUrl(O){return et(this._baseHref,O)}path(O=!1){const z=this._platformLocation.pathname+ot(this._platformLocation.search),le=this._platformLocation.hash;return le&&O?`${z}${le}`:z}pushState(O,z,le,Te){const Ze=this.prepareExternalUrl(le+ot(Te));this._platformLocation.pushState(O,z,Ze)}replaceState(O,z,le,Te){const Ze=this.prepareExternalUrl(le+ot(Te));this._platformLocation.replaceState(O,z,Ze)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(O=0){this._platformLocation.historyGo?.(O)}static{this.\u0275fac=function(z){return new(z||C)(E.LFG(it),E.LFG(rt,8))}}static{this.\u0275prov=E.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"})}}return C})(),Ln=(()=>{class C extends jt{constructor(O,z){super(),this._platformLocation=O,this._baseHref="",this._removeListenerFns=[],null!=z&&(this._baseHref=z)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(O){this._removeListenerFns.push(this._platformLocation.onPopState(O),this._platformLocation.onHashChange(O))}getBaseHref(){return this._baseHref}path(O=!1){let z=this._platformLocation.hash;return null==z&&(z="#"),z.length>0?z.substring(1):z}prepareExternalUrl(O){const z=et(this._baseHref,O);return z.length>0?"#"+z:z}pushState(O,z,le,Te){let Ze=this.prepareExternalUrl(le+ot(Te));0==Ze.length&&(Ze=this._platformLocation.pathname),this._platformLocation.pushState(O,z,Ze)}replaceState(O,z,le,Te){let Ze=this.prepareExternalUrl(le+ot(Te));0==Ze.length&&(Ze=this._platformLocation.pathname),this._platformLocation.replaceState(O,z,Ze)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(O=0){this._platformLocation.historyGo?.(O)}static{this.\u0275fac=function(z){return new(z||C)(E.LFG(it),E.LFG(rt,8))}}static{this.\u0275prov=E.Yz7({token:C,factory:C.\u0275fac})}}return C})(),$t=(()=>{class C{constructor(O){this._subject=new E.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=O;const z=this._locationStrategy.getBaseHref();this._basePath=function yt(C){if(new RegExp("^(https?:)?//").test(C)){const[,O]=C.split(/\/\/[^\/]+/);return O}return C}(Ie(ui(z))),this._locationStrategy.onPopState(le=>{this._subject.emit({url:this.path(!0),pop:!0,state:le.state,type:le.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(O=!1){return this.normalize(this._locationStrategy.path(O))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(O,z=""){return this.path()==this.normalize(O+ot(z))}normalize(O){return C.stripTrailingSlash(function mi(C,W){if(!C||!W.startsWith(C))return W;const O=W.substring(C.length);return""===O||["/",";","?","#"].includes(O[0])?O:W}(this._basePath,ui(O)))}prepareExternalUrl(O){return O&&"/"!==O[0]&&(O="/"+O),this._locationStrategy.prepareExternalUrl(O)}go(O,z="",le=null){this._locationStrategy.pushState(le,"",O,z),this._notifyUrlChangeListeners(this.prepareExternalUrl(O+ot(z)),le)}replaceState(O,z="",le=null){this._locationStrategy.replaceState(le,"",O,z),this._notifyUrlChangeListeners(this.prepareExternalUrl(O+ot(z)),le)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(O=0){this._locationStrategy.historyGo?.(O)}onUrlChange(O){return this._urlChangeListeners.push(O),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(z=>{this._notifyUrlChangeListeners(z.url,z.state)})),()=>{const z=this._urlChangeListeners.indexOf(O);this._urlChangeListeners.splice(z,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(O="",z){this._urlChangeListeners.forEach(le=>le(O,z))}subscribe(O,z,le){return this._subject.subscribe({next:O,error:z,complete:le})}static{this.normalizeQueryParams=ot}static{this.joinWithSlash=et}static{this.stripTrailingSlash=Ie}static{this.\u0275fac=function(z){return new(z||C)(E.LFG(jt))}}static{this.\u0275prov=E.Yz7({token:C,factory:()=>function _n(){return new $t((0,E.LFG)(jt))}(),providedIn:"root"})}}return C})();function ui(C){return C.replace(/\/index.html$/,"")}function he(C,W){W=encodeURIComponent(W);for(const O of C.split(";")){const z=O.indexOf("="),[le,Te]=-1==z?[O,""]:[O.slice(0,z),O.slice(z+1)];if(le.trim()===W)return decodeURIComponent(Te)}return null}const Le=/\s+/,at=[];let We=(()=>{class C{constructor(O,z,le,Te){this._iterableDiffers=O,this._keyValueDiffers=z,this._ngEl=le,this._renderer=Te,this.initialClasses=at,this.stateMap=new Map}set klass(O){this.initialClasses=null!=O?O.trim().split(Le):at}set ngClass(O){this.rawClass="string"==typeof O?O.trim().split(Le):O}ngDoCheck(){for(const z of this.initialClasses)this._updateState(z,!0);const O=this.rawClass;if(Array.isArray(O)||O instanceof Set)for(const z of O)this._updateState(z,!0);else if(null!=O)for(const z of Object.keys(O))this._updateState(z,!!O[z]);this._applyStateDiff()}_updateState(O,z){const le=this.stateMap.get(O);void 0!==le?(le.enabled!==z&&(le.changed=!0,le.enabled=z),le.touched=!0):this.stateMap.set(O,{enabled:z,changed:!0,touched:!0})}_applyStateDiff(){for(const O of this.stateMap){const z=O[0],le=O[1];le.changed?(this._toggleClass(z,le.enabled),le.changed=!1):le.touched||(le.enabled&&this._toggleClass(z,!1),this.stateMap.delete(z)),le.touched=!1}}_toggleClass(O,z){(O=O.trim()).length>0&&O.split(Le).forEach(le=>{z?this._renderer.addClass(this._ngEl.nativeElement,le):this._renderer.removeClass(this._ngEl.nativeElement,le)})}static{this.\u0275fac=function(z){return new(z||C)(E.Y36(E.ZZ4),E.Y36(E.aQg),E.Y36(E.SBq),E.Y36(E.Qsj))}}static{this.\u0275dir=E.lG2({type:C,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}}return C})();class Bt{constructor(W,O,z,le){this.$implicit=W,this.ngForOf=O,this.index=z,this.count=le}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ui=(()=>{class C{set ngForOf(O){this._ngForOf=O,this._ngForOfDirty=!0}set ngForTrackBy(O){this._trackByFn=O}get ngForTrackBy(){return this._trackByFn}constructor(O,z,le){this._viewContainer=O,this._template=z,this._differs=le,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(O){O&&(this._template=O)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const O=this._ngForOf;!this._differ&&O&&(this._differ=this._differs.find(O).create(this.ngForTrackBy))}if(this._differ){const O=this._differ.diff(this._ngForOf);O&&this._applyChanges(O)}}_applyChanges(O){const z=this._viewContainer;O.forEachOperation((le,Te,Ze)=>{if(null==le.previousIndex)z.createEmbeddedView(this._template,new Bt(le.item,this._ngForOf,-1,-1),null===Ze?void 0:Ze);else if(null==Ze)z.remove(null===Te?void 0:Te);else if(null!==Te){const qt=z.get(Te);z.move(qt,Ze),wi(qt,le)}});for(let le=0,Te=z.length;le<Te;le++){const qt=z.get(le).context;qt.index=le,qt.count=Te,qt.ngForOf=this._ngForOf}O.forEachIdentityChange(le=>{wi(z.get(le.currentIndex),le)})}static ngTemplateContextGuard(O,z){return!0}static{this.\u0275fac=function(z){return new(z||C)(E.Y36(E.s_b),E.Y36(E.Rgc),E.Y36(E.ZZ4))}}static{this.\u0275dir=E.lG2({type:C,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return C})();function wi(C,W){C.context.$implicit=W.item}let qi=(()=>{class C{constructor(O,z){this._viewContainer=O,this._context=new Ur,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=z}set ngIf(O){this._context.$implicit=this._context.ngIf=O,this._updateView()}set ngIfThen(O){an("ngIfThen",O),this._thenTemplateRef=O,this._thenViewRef=null,this._updateView()}set ngIfElse(O){an("ngIfElse",O),this._elseTemplateRef=O,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(O,z){return!0}static{this.\u0275fac=function(z){return new(z||C)(E.Y36(E.s_b),E.Y36(E.Rgc))}}static{this.\u0275dir=E.lG2({type:C,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return C})();class Ur{constructor(){this.$implicit=null,this.ngIf=null}}function an(C,W){if(W&&!W.createEmbeddedView)throw new Error(`${C} must be a TemplateRef, but received '${(0,E.AaK)(W)}'.`)}class ti{constructor(W,O){this._viewContainerRef=W,this._templateRef=O,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(W){W&&!this._created?this.create():!W&&this._created&&this.destroy()}}let er=(()=>{class C{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(O){this._ngSwitch=O,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(O){this._defaultViews.push(O)}_matchCase(O){const z=O===this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||z,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),z}_updateDefaultCases(O){if(this._defaultViews.length>0&&O!==this._defaultUsed){this._defaultUsed=O;for(const z of this._defaultViews)z.enforceState(O)}}static{this.\u0275fac=function(z){return new(z||C)}}static{this.\u0275dir=E.lG2({type:C,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0})}}return C})(),Cs=(()=>{class C{constructor(O,z,le){this.ngSwitch=le,le._addCase(),this._view=new ti(O,z)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}static{this.\u0275fac=function(z){return new(z||C)(E.Y36(E.s_b),E.Y36(E.Rgc),E.Y36(er,9))}}static{this.\u0275dir=E.lG2({type:C,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0})}}return C})(),ia=(()=>{class C{constructor(O,z,le){this._ngEl=O,this._differs=z,this._renderer=le,this._ngStyle=null,this._differ=null}set ngStyle(O){this._ngStyle=O,!this._differ&&O&&(this._differ=this._differs.find(O).create())}ngDoCheck(){if(this._differ){const O=this._differ.diff(this._ngStyle);O&&this._applyChanges(O)}}_setStyle(O,z){const[le,Te]=O.split("."),Ze=-1===le.indexOf("-")?void 0:E.JOm.DashCase;null!=z?this._renderer.setStyle(this._ngEl.nativeElement,le,Te?`${z}${Te}`:z,Ze):this._renderer.removeStyle(this._ngEl.nativeElement,le,Ze)}_applyChanges(O){O.forEachRemovedItem(z=>this._setStyle(z.key,null)),O.forEachAddedItem(z=>this._setStyle(z.key,z.currentValue)),O.forEachChangedItem(z=>this._setStyle(z.key,z.currentValue))}static{this.\u0275fac=function(z){return new(z||C)(E.Y36(E.SBq),E.Y36(E.aQg),E.Y36(E.Qsj))}}static{this.\u0275dir=E.lG2({type:C,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}}return C})();class ra{createSubscription(W,O){return(0,E.rg0)(()=>W.subscribe({next:O,error:z=>{throw z}}))}dispose(W){(0,E.rg0)(()=>W.unsubscribe())}}class Ua{createSubscription(W,O){return W.then(O,z=>{throw z})}dispose(W){}}const ka=new Ua,Ba=new ra;let vo=(()=>{class C{constructor(O){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=O}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(O){return this._obj?O!==this._obj?(this._dispose(),this.transform(O)):this._latestValue:(O&&this._subscribe(O),this._latestValue)}_subscribe(O){this._obj=O,this._strategy=this._selectStrategy(O),this._subscription=this._strategy.createSubscription(O,z=>this._updateLatestValue(O,z))}_selectStrategy(O){if((0,E.QGY)(O))return ka;if((0,E.F4k)(O))return Ba;throw function Jr(C,W){return new E.vHH(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(O,z){O===this._obj&&(this._latestValue=z,this._ref.markForCheck())}static{this.\u0275fac=function(z){return new(z||C)(E.Y36(E.sBO,16))}}static{this.\u0275pipe=E.Yjl({name:"async",type:C,pure:!1,standalone:!0})}}return C})(),ro=(()=>{class C{static{this.\u0275fac=function(z){return new(z||C)}}static{this.\u0275mod=E.oAB({type:C})}static{this.\u0275inj=E.cJS({})}}return C})();const dl="browser",Au="server";function so(C){return C===dl}function Mr(C){return C===Au}let Sc=(()=>{class C{static{this.\u0275prov=(0,E.Yz7)({token:C,providedIn:"root",factory:()=>new _o((0,E.LFG)(xe),window)})}}return C})();class _o{constructor(W,O){this.document=W,this.window=O,this.offset=()=>[0,0]}setOffset(W){this.offset=Array.isArray(W)?()=>W:W}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(W){this.supportsScrolling()&&this.window.scrollTo(W[0],W[1])}scrollToAnchor(W){if(!this.supportsScrolling())return;const O=function Du(C,W){const O=C.getElementById(W)||C.getElementsByName(W)[0];if(O)return O;if("function"==typeof C.createTreeWalker&&C.body&&"function"==typeof C.body.attachShadow){const z=C.createTreeWalker(C.body,NodeFilter.SHOW_ELEMENT);let le=z.currentNode;for(;le;){const Te=le.shadowRoot;if(Te){const Ze=Te.getElementById(W)||Te.querySelector(`[name="${W}"]`);if(Ze)return Ze}le=z.nextNode()}}return null}(this.document,W);O&&(this.scrollToElement(O),O.focus())}setHistoryScrollRestoration(W){this.supportsScrolling()&&(this.window.history.scrollRestoration=W)}scrollToElement(W){const O=W.getBoundingClientRect(),z=O.left+this.window.pageXOffset,le=O.top+this.window.pageYOffset,Te=this.offset();this.window.scrollTo(z-Te[0],le-Te[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class hl{}},9862:(mn,Ke,Z)=>{Z.d(Ke,{JF:()=>Mi,WM:()=>rt,Zn:()=>Ir,aW:()=>or,eN:()=>Ne}),Z(5861);var ie=Z(9212),ze=Z(2096),Pe=Z(5592),be=Z(7715),xe=Z(6328),it=Z(2181),ht=Z(7398),pt=Z(4716),et=Z(4664),Ie=Z(6814);class ot{}class jt{}class rt{constructor(ue){this.normalizedNames=new Map,this.lazyUpdate=null,ue?"string"==typeof ue?this.lazyInit=()=>{this.headers=new Map,ue.split("\n").forEach(he=>{const Le=he.indexOf(":");if(Le>0){const at=he.slice(0,Le),We=at.toLowerCase(),Tt=he.slice(Le+1).trim();this.maybeSetNormalizedName(at,We),this.headers.has(We)?this.headers.get(We).push(Tt):this.headers.set(We,[Tt])}})}:typeof Headers<"u"&&ue instanceof Headers?(this.headers=new Map,ue.forEach((he,Le)=>{this.setHeaderEntries(Le,he)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(ue).forEach(([he,Le])=>{this.setHeaderEntries(he,Le)})}:this.headers=new Map}has(ue){return this.init(),this.headers.has(ue.toLowerCase())}get(ue){this.init();const he=this.headers.get(ue.toLowerCase());return he&&he.length>0?he[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(ue){return this.init(),this.headers.get(ue.toLowerCase())||null}append(ue,he){return this.clone({name:ue,value:he,op:"a"})}set(ue,he){return this.clone({name:ue,value:he,op:"s"})}delete(ue,he){return this.clone({name:ue,value:he,op:"d"})}maybeSetNormalizedName(ue,he){this.normalizedNames.has(he)||this.normalizedNames.set(he,ue)}init(){this.lazyInit&&(this.lazyInit instanceof rt?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(ue=>this.applyUpdate(ue)),this.lazyUpdate=null))}copyFrom(ue){ue.init(),Array.from(ue.headers.keys()).forEach(he=>{this.headers.set(he,ue.headers.get(he)),this.normalizedNames.set(he,ue.normalizedNames.get(he))})}clone(ue){const he=new rt;return he.lazyInit=this.lazyInit&&this.lazyInit instanceof rt?this.lazyInit:this,he.lazyUpdate=(this.lazyUpdate||[]).concat([ue]),he}applyUpdate(ue){const he=ue.name.toLowerCase();switch(ue.op){case"a":case"s":let Le=ue.value;if("string"==typeof Le&&(Le=[Le]),0===Le.length)return;this.maybeSetNormalizedName(ue.name,he);const at=("a"===ue.op?this.headers.get(he):void 0)||[];at.push(...Le),this.headers.set(he,at);break;case"d":const We=ue.value;if(We){let Tt=this.headers.get(he);if(!Tt)return;Tt=Tt.filter(Vn=>-1===We.indexOf(Vn)),0===Tt.length?(this.headers.delete(he),this.normalizedNames.delete(he)):this.headers.set(he,Tt)}else this.headers.delete(he),this.normalizedNames.delete(he)}}setHeaderEntries(ue,he){const Le=(Array.isArray(he)?he:[he]).map(We=>We.toString()),at=ue.toLowerCase();this.headers.set(at,Le),this.maybeSetNormalizedName(ue,at)}forEach(ue){this.init(),Array.from(this.normalizedNames.keys()).forEach(he=>ue(this.normalizedNames.get(he),this.headers.get(he)))}}class Ln{encodeKey(ue){return ui(ue)}encodeValue(ue){return ui(ue)}decodeKey(ue){return decodeURIComponent(ue)}decodeValue(ue){return decodeURIComponent(ue)}}const _n=/%(\d[a-f0-9])/gi,mi={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function ui(ve){return encodeURIComponent(ve).replace(_n,(ue,he)=>mi[he]??ue)}function yt(ve){return`${ve}`}class Ye{constructor(ue={}){if(this.updates=null,this.cloneFrom=null,this.encoder=ue.encoder||new Ln,ue.fromString){if(ue.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function $t(ve,ue){const he=new Map;return ve.length>0&&ve.replace(/^\?/,"").split("&").forEach(at=>{const We=at.indexOf("="),[Tt,Vn]=-1==We?[ue.decodeKey(at),""]:[ue.decodeKey(at.slice(0,We)),ue.decodeValue(at.slice(We+1))],Bt=he.get(Tt)||[];Bt.push(Vn),he.set(Tt,Bt)}),he}(ue.fromString,this.encoder)}else ue.fromObject?(this.map=new Map,Object.keys(ue.fromObject).forEach(he=>{const Le=ue.fromObject[he],at=Array.isArray(Le)?Le.map(yt):[yt(Le)];this.map.set(he,at)})):this.map=null}has(ue){return this.init(),this.map.has(ue)}get(ue){this.init();const he=this.map.get(ue);return he?he[0]:null}getAll(ue){return this.init(),this.map.get(ue)||null}keys(){return this.init(),Array.from(this.map.keys())}append(ue,he){return this.clone({param:ue,value:he,op:"a"})}appendAll(ue){const he=[];return Object.keys(ue).forEach(Le=>{const at=ue[Le];Array.isArray(at)?at.forEach(We=>{he.push({param:Le,value:We,op:"a"})}):he.push({param:Le,value:at,op:"a"})}),this.clone(he)}set(ue,he){return this.clone({param:ue,value:he,op:"s"})}delete(ue,he){return this.clone({param:ue,value:he,op:"d"})}toString(){return this.init(),this.keys().map(ue=>{const he=this.encoder.encodeKey(ue);return this.map.get(ue).map(Le=>he+"="+this.encoder.encodeValue(Le)).join("&")}).filter(ue=>""!==ue).join("&")}clone(ue){const he=new Ye({encoder:this.encoder});return he.cloneFrom=this.cloneFrom||this,he.updates=(this.updates||[]).concat(ue),he}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(ue=>this.map.set(ue,this.cloneFrom.map.get(ue))),this.updates.forEach(ue=>{switch(ue.op){case"a":case"s":const he=("a"===ue.op?this.map.get(ue.param):void 0)||[];he.push(yt(ue.value)),this.map.set(ue.param,he);break;case"d":if(void 0===ue.value){this.map.delete(ue.param);break}{let Le=this.map.get(ue.param)||[];const at=Le.indexOf(yt(ue.value));-1!==at&&Le.splice(at,1),Le.length>0?this.map.set(ue.param,Le):this.map.delete(ue.param)}}}),this.cloneFrom=this.updates=null)}}class en{constructor(){this.map=new Map}set(ue,he){return this.map.set(ue,he),this}get(ue){return this.map.has(ue)||this.map.set(ue,ue.defaultValue()),this.map.get(ue)}delete(ue){return this.map.delete(ue),this}has(ue){return this.map.has(ue)}keys(){return this.map.keys()}}function xt(ve){return typeof ArrayBuffer<"u"&&ve instanceof ArrayBuffer}function wn(ve){return typeof Blob<"u"&&ve instanceof Blob}function tn(ve){return typeof FormData<"u"&&ve instanceof FormData}class or{constructor(ue,he,Le,at){let We;if(this.url=he,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=ue.toUpperCase(),function wt(ve){switch(ve){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||at?(this.body=void 0!==Le?Le:null,We=at):We=Le,We&&(this.reportProgress=!!We.reportProgress,this.withCredentials=!!We.withCredentials,We.responseType&&(this.responseType=We.responseType),We.headers&&(this.headers=We.headers),We.context&&(this.context=We.context),We.params&&(this.params=We.params),this.transferCache=We.transferCache),this.headers||(this.headers=new rt),this.context||(this.context=new en),this.params){const Tt=this.params.toString();if(0===Tt.length)this.urlWithParams=he;else{const Vn=he.indexOf("?");this.urlWithParams=he+(-1===Vn?"?":Vn<he.length-1?"&":"")+Tt}}else this.params=new Ye,this.urlWithParams=he}serializeBody(){return null===this.body?null:xt(this.body)||wn(this.body)||tn(this.body)||function ir(ve){return typeof URLSearchParams<"u"&&ve instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Ye?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||tn(this.body)?null:wn(this.body)?this.body.type||null:xt(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ye?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(ue={}){const he=ue.method||this.method,Le=ue.url||this.url,at=ue.responseType||this.responseType,We=void 0!==ue.body?ue.body:this.body,Tt=void 0!==ue.withCredentials?ue.withCredentials:this.withCredentials,Vn=void 0!==ue.reportProgress?ue.reportProgress:this.reportProgress;let Bt=ue.headers||this.headers,Ui=ue.params||this.params;const wi=ue.context??this.context;return void 0!==ue.setHeaders&&(Bt=Object.keys(ue.setHeaders).reduce((Fn,qi)=>Fn.set(qi,ue.setHeaders[qi]),Bt)),ue.setParams&&(Ui=Object.keys(ue.setParams).reduce((Fn,qi)=>Fn.set(qi,ue.setParams[qi]),Ui)),new or(he,Le,We,{params:Ui,headers:Bt,context:wi,reportProgress:Vn,responseType:at,withCredentials:Tt})}}var Lr=function(ve){return ve[ve.Sent=0]="Sent",ve[ve.UploadProgress=1]="UploadProgress",ve[ve.ResponseHeader=2]="ResponseHeader",ve[ve.DownloadProgress=3]="DownloadProgress",ve[ve.Response=4]="Response",ve[ve.User=5]="User",ve}(Lr||{});class bs{constructor(ue,he=200,Le="OK"){this.headers=ue.headers||new rt,this.status=void 0!==ue.status?ue.status:he,this.statusText=ue.statusText||Le,this.url=ue.url||null,this.ok=this.status>=200&&this.status<300}}class Dr extends bs{constructor(ue={}){super(ue),this.type=Lr.ResponseHeader}clone(ue={}){return new Dr({headers:ue.headers||this.headers,status:void 0!==ue.status?ue.status:this.status,statusText:ue.statusText||this.statusText,url:ue.url||this.url||void 0})}}class Ir extends bs{constructor(ue={}){super(ue),this.type=Lr.Response,this.body=void 0!==ue.body?ue.body:null}clone(ue={}){return new Ir({body:void 0!==ue.body?ue.body:this.body,headers:ue.headers||this.headers,status:void 0!==ue.status?ue.status:this.status,statusText:ue.statusText||this.statusText,url:ue.url||this.url||void 0})}}class zi extends bs{constructor(ue){super(ue,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${ue.url||"(unknown url)"}`:`Http failure response for ${ue.url||"(unknown url)"}: ${ue.status} ${ue.statusText}`,this.error=ue.error||null}}function De(ve,ue){return{body:ue,headers:ve.headers,context:ve.context,observe:ve.observe,params:ve.params,reportProgress:ve.reportProgress,responseType:ve.responseType,withCredentials:ve.withCredentials,transferCache:ve.transferCache}}let Ne=(()=>{class ve{constructor(he){this.handler=he}request(he,Le,at={}){let We;if(he instanceof or)We=he;else{let Bt,Ui;Bt=at.headers instanceof rt?at.headers:new rt(at.headers),at.params&&(Ui=at.params instanceof Ye?at.params:new Ye({fromObject:at.params})),We=new or(he,Le,void 0!==at.body?at.body:null,{headers:Bt,context:at.context,params:Ui,reportProgress:at.reportProgress,responseType:at.responseType||"json",withCredentials:at.withCredentials,transferCache:at.transferCache})}const Tt=(0,ze.of)(We).pipe((0,xe.b)(Bt=>this.handler.handle(Bt)));if(he instanceof or||"events"===at.observe)return Tt;const Vn=Tt.pipe((0,it.h)(Bt=>Bt instanceof Ir));switch(at.observe||"body"){case"body":switch(We.responseType){case"arraybuffer":return Vn.pipe((0,ht.U)(Bt=>{if(null!==Bt.body&&!(Bt.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return Bt.body}));case"blob":return Vn.pipe((0,ht.U)(Bt=>{if(null!==Bt.body&&!(Bt.body instanceof Blob))throw new Error("Response is not a Blob.");return Bt.body}));case"text":return Vn.pipe((0,ht.U)(Bt=>{if(null!==Bt.body&&"string"!=typeof Bt.body)throw new Error("Response is not a string.");return Bt.body}));default:return Vn.pipe((0,ht.U)(Bt=>Bt.body))}case"response":return Vn;default:throw new Error(`Unreachable: unhandled observe type ${at.observe}}`)}}delete(he,Le={}){return this.request("DELETE",he,Le)}get(he,Le={}){return this.request("GET",he,Le)}head(he,Le={}){return this.request("HEAD",he,Le)}jsonp(he,Le){return this.request("JSONP",he,{params:(new Ye).append(Le,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(he,Le={}){return this.request("OPTIONS",he,Le)}patch(he,Le,at={}){return this.request("PATCH",he,De(at,Le))}post(he,Le,at={}){return this.request("POST",he,De(at,Le))}put(he,Le,at={}){return this.request("PUT",he,De(at,Le))}static{this.\u0275fac=function(Le){return new(Le||ve)(ie.LFG(ot))}}static{this.\u0275prov=ie.Yz7({token:ve,factory:ve.\u0275fac})}}return ve})();function En(ve,ue){return ue(ve)}function zt(ve,ue){return(he,Le)=>ue.intercept(he,{handle:at=>ve(at,Le)})}const Zn=new ie.OlP(""),yi=new ie.OlP(""),Hr=new ie.OlP(""),Qi=new ie.OlP("");function Mn(){let ve=null;return(ue,he)=>{null===ve&&(ve=((0,ie.f3M)(Zn,{optional:!0})??[]).reduceRight(zt,En));const Le=(0,ie.f3M)(ie.I6F),at=Le.add();return ve(ue,he).pipe((0,pt.x)(()=>Le.remove(at)))}}let us=(()=>{class ve extends ot{constructor(he,Le){super(),this.backend=he,this.injector=Le,this.chain=null,this.pendingTasks=(0,ie.f3M)(ie.I6F);const at=(0,ie.f3M)(Qi,{optional:!0});this.backend=at??he}handle(he){if(null===this.chain){const at=Array.from(new Set([...this.injector.get(yi),...this.injector.get(Hr,[])]));this.chain=at.reduceRight((We,Tt)=>function $i(ve,ue,he){return(Le,at)=>(0,ie.r_H)(he,()=>ue(Le,We=>ve(We,at)))}(We,Tt,this.injector),En)}const Le=this.pendingTasks.add();return this.chain(he,at=>this.backend.handle(at)).pipe((0,pt.x)(()=>this.pendingTasks.remove(Le)))}static{this.\u0275fac=function(Le){return new(Le||ve)(ie.LFG(jt),ie.LFG(ie.lqb))}}static{this.\u0275prov=ie.Yz7({token:ve,factory:ve.\u0275fac})}}return ve})();const bi=/^\)\]\}',?\n/;let ta=(()=>{class ve{constructor(he){this.xhrFactory=he}handle(he){if("JSONP"===he.method)throw new ie.vHH(-2800,!1);const Le=this.xhrFactory;return(Le.\u0275loadImpl?(0,be.D)(Le.\u0275loadImpl()):(0,ze.of)(null)).pipe((0,et.w)(()=>new Pe.y(We=>{const Tt=Le.build();if(Tt.open(he.method,he.urlWithParams),he.withCredentials&&(Tt.withCredentials=!0),he.headers.forEach((Jn,ti)=>Tt.setRequestHeader(Jn,ti.join(","))),he.headers.has("Accept")||Tt.setRequestHeader("Accept","application/json, text/plain, */*"),!he.headers.has("Content-Type")){const Jn=he.detectContentTypeHeader();null!==Jn&&Tt.setRequestHeader("Content-Type",Jn)}if(he.responseType){const Jn=he.responseType.toLowerCase();Tt.responseType="json"!==Jn?Jn:"text"}const Vn=he.serializeBody();let Bt=null;const Ui=()=>{if(null!==Bt)return Bt;const Jn=Tt.statusText||"OK",ti=new rt(Tt.getAllResponseHeaders()),er=function Li(ve){return"responseURL"in ve&&ve.responseURL?ve.responseURL:/^X-Request-URL:/m.test(ve.getAllResponseHeaders())?ve.getResponseHeader("X-Request-URL"):null}(Tt)||he.url;return Bt=new Dr({headers:ti,status:Tt.status,statusText:Jn,url:er}),Bt},wi=()=>{let{headers:Jn,status:ti,statusText:er,url:Cs}=Ui(),ur=null;204!==ti&&(ur=typeof Tt.response>"u"?Tt.responseText:Tt.response),0===ti&&(ti=ur?200:0);let Ys=ti>=200&&ti<300;if("json"===he.responseType&&"string"==typeof ur){const Fa=ur;ur=ur.replace(bi,"");try{ur=""!==ur?JSON.parse(ur):null}catch(Vs){ur=Fa,Ys&&(Ys=!1,ur={error:Vs,text:ur})}}Ys?(We.next(new Ir({body:ur,headers:Jn,status:ti,statusText:er,url:Cs||void 0})),We.complete()):We.error(new zi({error:ur,headers:Jn,status:ti,statusText:er,url:Cs||void 0}))},Fn=Jn=>{const{url:ti}=Ui(),er=new zi({error:Jn,status:Tt.status||0,statusText:Tt.statusText||"Unknown Error",url:ti||void 0});We.error(er)};let qi=!1;const Ur=Jn=>{qi||(We.next(Ui()),qi=!0);let ti={type:Lr.DownloadProgress,loaded:Jn.loaded};Jn.lengthComputable&&(ti.total=Jn.total),"text"===he.responseType&&Tt.responseText&&(ti.partialText=Tt.responseText),We.next(ti)},an=Jn=>{let ti={type:Lr.UploadProgress,loaded:Jn.loaded};Jn.lengthComputable&&(ti.total=Jn.total),We.next(ti)};return Tt.addEventListener("load",wi),Tt.addEventListener("error",Fn),Tt.addEventListener("timeout",Fn),Tt.addEventListener("abort",Fn),he.reportProgress&&(Tt.addEventListener("progress",Ur),null!==Vn&&Tt.upload&&Tt.upload.addEventListener("progress",an)),Tt.send(Vn),We.next({type:Lr.Sent}),()=>{Tt.removeEventListener("error",Fn),Tt.removeEventListener("abort",Fn),Tt.removeEventListener("load",wi),Tt.removeEventListener("timeout",Fn),he.reportProgress&&(Tt.removeEventListener("progress",Ur),null!==Vn&&Tt.upload&&Tt.upload.removeEventListener("progress",an)),Tt.readyState!==Tt.DONE&&Tt.abort()}})))}static{this.\u0275fac=function(Le){return new(Le||ve)(ie.LFG(Ie.JF))}}static{this.\u0275prov=ie.Yz7({token:ve,factory:ve.\u0275fac})}}return ve})();const Wn=new ie.OlP("XSRF_ENABLED"),Yi=new ie.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),Pn=new ie.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class Zr{}let ns=(()=>{class ve{constructor(he,Le,at){this.doc=he,this.platform=Le,this.cookieName=at,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const he=this.doc.cookie||"";return he!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,Ie.Mx)(he,this.cookieName),this.lastCookieString=he),this.lastToken}static{this.\u0275fac=function(Le){return new(Le||ve)(ie.LFG(Ie.K0),ie.LFG(ie.Lbi),ie.LFG(Yi))}}static{this.\u0275prov=ie.Yz7({token:ve,factory:ve.\u0275fac})}}return ve})();function ws(ve,ue){const he=ve.url.toLowerCase();if(!(0,ie.f3M)(Wn)||"GET"===ve.method||"HEAD"===ve.method||he.startsWith("http://")||he.startsWith("https://"))return ue(ve);const Le=(0,ie.f3M)(Zr).getToken(),at=(0,ie.f3M)(Pn);return null!=Le&&!ve.headers.has(at)&&(ve=ve.clone({headers:ve.headers.set(at,Le)})),ue(ve)}var Gr=function(ve){return ve[ve.Interceptors=0]="Interceptors",ve[ve.LegacyInterceptors=1]="LegacyInterceptors",ve[ve.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",ve[ve.NoXsrfProtection=3]="NoXsrfProtection",ve[ve.JsonpSupport=4]="JsonpSupport",ve[ve.RequestsMadeViaParent=5]="RequestsMadeViaParent",ve[ve.Fetch=6]="Fetch",ve}(Gr||{});function _i(ve,ue){return{\u0275kind:ve,\u0275providers:ue}}function ar(...ve){const ue=[Ne,ta,us,{provide:ot,useExisting:us},{provide:jt,useExisting:ta},{provide:yi,useValue:ws,multi:!0},{provide:Wn,useValue:!0},{provide:Zr,useClass:ns}];for(const he of ve)ue.push(...he.\u0275providers);return(0,ie.MR2)(ue)}const Oe=new ie.OlP("LEGACY_INTERCEPTOR_FN");let Mi=(()=>{class ve{static{this.\u0275fac=function(Le){return new(Le||ve)}}static{this.\u0275mod=ie.oAB({type:ve})}static{this.\u0275inj=ie.cJS({providers:[ar(_i(Gr.LegacyInterceptors,[{provide:Oe,useFactory:Mn},{provide:yi,useExisting:Oe,multi:!0}]))]})}}return ve})()},9212:(mn,Ke,Z)=>{Z.d(Ke,{QbO:()=>bb,tb:()=>ZE,AFp:()=>cM,ip1:()=>uC,hGG:()=>XD,z2F:()=>Fp,Ojb:()=>Sb,sBO:()=>ap,Sil:()=>tD,_Vd:()=>cd,EJc:()=>FD,Xts:()=>Gc,SBq:()=>su,lqb:()=>el,qLn:()=>Cl,vpe:()=>rl,XFs:()=>We,OlP:()=>an,zs3:()=>ga,ZZ4:()=>hd,aQg:()=>Zm,soG:()=>h0,YKP:()=>hw,h0i:()=>Hh,R0b:()=>xs,FiY:()=>af,Lbi:()=>Nv,g9A:()=>uM,Qsj:()=>sx,FYo:()=>Wm,JOm:()=>Qu,q3G:()=>Zc,tp0:()=>lf,Rgc:()=>Qg,dDg:()=>CD,eoX:()=>cC,GfV:()=>tC,s_b:()=>Na,ifc:()=>is,T8G:()=>Mg,VuI:()=>yI,MMx:()=>pw,Lck:()=>qT,eFA:()=>_C,G48:()=>HD,Gpc:()=>Ss,f3M:()=>Hn,$WT:()=>oo,MR2:()=>Qp,_c5:()=>$D,qFp:()=>MI,r_H:()=>tM,rg0:()=>lh,c2e:()=>nC,zSh:()=>nm,wAp:()=>xu,I6F:()=>XE,vHH:()=>It,lri:()=>aC,rWj:()=>lC,JZr:()=>Qs,EiD:()=>xy,mCW:()=>If,qzn:()=>oc,JVY:()=>VM,pB0:()=>fy,eBb:()=>hy,L6k:()=>HM,LAX:()=>zM,cg1:()=>ks,kuF:()=>Kr,kL8:()=>ba,dqk:()=>Fn,Z0I:()=>br,eJc:()=>tc,QGY:()=>wE,F4k:()=>DS,RDi:()=>xb,AaK:()=>Xi,z3N:()=>El,qOj:()=>bg,Xq5:()=>c_,TTD:()=>Di,_Bn:()=>dw,jDz:()=>mw,xp6:()=>Ry,uIk:()=>u_,Tol:()=>Rg,ekj:()=>vp,um2:()=>j_,Suo:()=>Lw,Xpm:()=>Ru,lG2:()=>Tc,Yz7:()=>gi,cJS:()=>Xs,oAB:()=>Mo,Yjl:()=>Ga,Y36:()=>Al,_UZ:()=>Ht,qZA:()=>gn,TgZ:()=>nt,EpF:()=>ye,n5z:()=>Wp,Ikx:()=>Wt,LFG:()=>dr,$8M:()=>jp,$Z:()=>Xf,NdJ:()=>CE,CRH:()=>Fw,oxw:()=>OS,ALo:()=>Dw,lcZ:()=>Iw,Hsn:()=>FS,F$t:()=>LS,Q6J:()=>x_,s9C:()=>TE,VKq:()=>bw,iGM:()=>Nw,wJu:()=>X_,SjG:()=>$_,x6l:()=>lr,ikw:()=>mo,KtG:()=>Da,CHM:()=>qh,LSH:()=>Nm,P3R:()=>Ey,Udp:()=>Rh,YNc:()=>Mu,_uU:()=>ew,Oqu:()=>DE,hij:()=>r0,Gf:()=>Ow});let ie=null,Pe=1;function xe(n){const i=ie;return ie=n,i}function jt(n){if((!mt(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==Pe)){if(!n.producerMustRecompute(n)&&!mi(n))return n.dirty=!1,void(n.lastCleanEpoch=Pe);n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=Pe}}function mi(n){en(n);for(let i=0;i<n.producerNode.length;i++){const s=n.producerNode[i],a=n.producerLastReadVersion[i];if(a!==s.version||(jt(s),a!==s.version))return!0}return!1}function Ye(n,i){if(function wt(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),en(n),1===n.liveConsumerNode.length)for(let a=0;a<n.producerNode.length;a++)Ye(n.producerNode[a],n.producerIndexOfThis[a]);const s=n.liveConsumerNode.length-1;if(n.liveConsumerNode[i]=n.liveConsumerNode[s],n.liveConsumerIndexOfThis[i]=n.liveConsumerIndexOfThis[s],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,i<n.liveConsumerNode.length){const a=n.liveConsumerIndexOfThis[i],d=n.liveConsumerNode[i];en(d),d.producerIndexOfThis[a]=i}}function mt(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function en(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let bs=null;var Zn=Z(8645),yi=Z(7394),Hr=Z(5619),Qi=Z(7398);function Mn(n){for(let i in n)if(n[i]===Mn)return i;throw Error("Could not find renamed property on target object.")}function mr(n,i){for(const s in i)i.hasOwnProperty(s)&&!n.hasOwnProperty(s)&&(n[s]=i[s])}function Xi(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Xi).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const i=n.toString();if(null==i)return""+i;const s=i.indexOf("\n");return-1===s?i:i.substring(0,s)}function us(n,i){return null==n||""===n?null===i?"":i:null==i||""===i?n:n+" "+i}const zr=Mn({__forward_ref__:Mn});function Ss(n){return n.__forward_ref__=Ss,n.toString=function(){return Xi(this())},n}function nn(n){return ii(n)?n():n}function ii(n){return"function"==typeof n&&n.hasOwnProperty(zr)&&n.__forward_ref__===Ss}function Gn(n){return n&&!!n.\u0275providers}const Qs="https://g.co/ng/security#xss";class It extends Error{constructor(i,s){super(Kr(i,s)),this.code=i}}function Kr(n,i){return`NG0${Math.abs(n)}${i?": "+i:""}`}const gr=Mn({\u0275cmp:Mn}),bi=Mn({\u0275dir:Mn}),Li=Mn({\u0275pipe:Mn}),ta=Mn({\u0275mod:Mn}),Wn=Mn({\u0275fac:Mn}),eo=Mn({__NG_ELEMENT_ID__:Mn}),Yi=Mn({__NG_ENV_ID__:Mn});function sn(n){return"string"==typeof n?n:null==n?"":String(n)}function _i(n,i){throw new It(-201,!1)}function Ti(n,i){null==n&&function Jt(n,i,s,a){throw new Error(`ASSERTION ERROR: ${n}`+(null==a?"":` [Expected=> ${s} ${a} ${i} <=Actual]`))}(i,n,null,"!=")}function gi(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Xs(n){return{providers:n.providers||[],imports:n.imports||[]}}function Ls(n){return na(n,ue)||na(n,Le)}function br(n){return null!==Ls(n)}function na(n,i){return n.hasOwnProperty(i)?n[i]:null}function ve(n){return n&&(n.hasOwnProperty(he)||n.hasOwnProperty(at))?n[he]:null}const ue=Mn({\u0275prov:Mn}),he=Mn({\u0275inj:Mn}),Le=Mn({ngInjectableDef:Mn}),at=Mn({ngInjectorDef:Mn});var We=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(We||{});let Tt;function Vn(){return Tt}function Bt(n){const i=Tt;return Tt=n,i}function Ui(n,i,s){const a=Ls(n);return a&&"root"==a.providedIn?void 0===a.value?a.value=a.factory():a.value:s&We.Optional?null:void 0!==i?i:void _i(Xi(n))}const Fn=globalThis;class an{constructor(i,s){this._desc=i,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof s?this.__NG_ELEMENT_ID__=s:void 0!==s&&(this.\u0275prov=gi({token:this,providedIn:s.providedIn||"root",factory:s.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Fo={},Jr="__NG_DI_FLAG__",ra="ngTempTokenPath",ka=/\n/gm,vo="__source";let yo;function hs(n){const i=yo;return yo=n,i}function Ha(n,i=We.Default){if(void 0===yo)throw new It(-203,!1);return null===yo?Ui(n,void 0,i):yo.get(n,i&We.Optional?null:void 0,i)}function dr(n,i=We.Default){return(Vn()||Ha)(nn(n),i)}function Hn(n,i=We.Default){return dr(n,no(i))}function no(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Uo(n){const i=[];for(let s=0;s<n.length;s++){const a=nn(n[s]);if(Array.isArray(a)){if(0===a.length)throw new It(900,!1);let d,f=We.Default;for(let g=0;g<a.length;g++){const _=a[g],w=ko(_);"number"==typeof w?-1===w?d=_.token:f|=w:d=_}i.push(dr(d,f))}else i.push(dr(a))}return i}function oa(n,i){return n[Jr]=i,n.prototype[Jr]=i,n}function ko(n){return n[Jr]}function Wr(n){return{toString:n}.toString()}var zs=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(zs||{}),is=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(is||{});const Ts={},hi=[];function aa(n,i,s){let a=n.length;for(;;){const d=n.indexOf(i,s);if(-1===d)return d;if(0===d||n.charCodeAt(d-1)<=32){const f=i.length;if(d+f===a||n.charCodeAt(d+f)<=32)return d}s=d+1}}function io(n,i,s){let a=0;for(;a<s.length;){const d=s[a];if("number"==typeof d){if(0!==d)break;a++;const f=s[a++],g=s[a++],_=s[a++];n.setAttribute(i,g,_,f)}else{const f=d,g=s[++a];bc(f)?n.setProperty(i,f,g):n.setAttribute(i,f,g),a++}}return a}function Ta(n){return 3===n||4===n||6===n}function bc(n){return 64===n.charCodeAt(0)}function ro(n,i){if(null!==i&&0!==i.length)if(null===n||0===n.length)n=i.slice();else{let s=-1;for(let a=0;a<i.length;a++){const d=i[a];"number"==typeof d?s=d:0===s||dl(n,s,d,null,-1===s||2===s?i[++a]:null)}}return n}function dl(n,i,s,a,d){let f=0,g=n.length;if(-1===i)g=-1;else for(;f<n.length;){const _=n[f++];if("number"==typeof _){if(_===i){g=-1;break}if(_>i){g=f-1;break}}}for(;f<n.length;){const _=n[f];if("number"==typeof _)break;if(_===s){if(null===a)return void(null!==d&&(n[f+1]=d));if(a===n[f+1])return void(n[f+2]=d)}f++,null!==a&&f++,null!==d&&f++}-1!==g&&(n.splice(g,0,i),f=g+1),n.splice(f++,0,s),null!==a&&n.splice(f++,0,a),null!==d&&n.splice(f++,0,d)}const Au="ng-template";function As(n,i,s){let a=0,d=!0;for(;a<n.length;){let f=n[a++];if("string"==typeof f&&d){const g=n[a++];if(s&&"class"===f&&-1!==aa(g.toLowerCase(),i,0))return!0}else{if(1===f){for(;a<n.length&&"string"==typeof(f=n[a++]);)if(f.toLowerCase()===i)return!0;return!1}"number"==typeof f&&(d=!1)}}return!1}function Bl(n){return 4===n.type&&n.value!==Au}function so(n,i,s){return i===(4!==n.type||s?n.value:Au)}function Mr(n,i,s){let a=4;const d=n.attrs||[],f=function _o(n){for(let i=0;i<n.length;i++)if(Ta(n[i]))return i;return n.length}(d);let g=!1;for(let _=0;_<i.length;_++){const w=i[_];if("number"!=typeof w){if(!g)if(4&a){if(a=2|1&a,""!==w&&!so(n,w,s)||""===w&&1===i.length){if(Ai(a))return!1;g=!0}}else{const L=8&a?w:i[++_];if(8&a&&null!==n.attrs){if(!As(n.attrs,L,s)){if(Ai(a))return!1;g=!0}continue}const K=za(8&a?"class":w,d,Bl(n),s);if(-1===K){if(Ai(a))return!1;g=!0;continue}if(""!==L){let de;de=K>f?"":d[K+1].toLowerCase();const ge=8&a?de:null;if(ge&&-1!==aa(ge,L,0)||2&a&&L!==de){if(Ai(a))return!1;g=!0}}}}else{if(!g&&!Ai(a)&&!Ai(w))return!1;if(g&&Ai(w))continue;g=!1,a=w|1&a}}return Ai(a)||g}function Ai(n){return 0==(1&n)}function za(n,i,s,a){if(null===i)return-1;let d=0;if(a||!s){let f=!1;for(;d<i.length;){const g=i[d];if(g===n)return d;if(3===g||6===g)f=!0;else{if(1===g||2===g){let _=i[++d];for(;"string"==typeof _;)_=i[++d];continue}if(4===g)break;if(0===g){d+=4;continue}}d+=f?1:2}return-1}return function Du(n,i){let s=n.indexOf(4);if(s>-1)for(s++;s<n.length;){const a=n[s];if("number"==typeof a)return-1;if(a===i)return s;s++}return-1}(i,n)}function ki(n,i,s=!1){for(let a=0;a<i.length;a++)if(Mr(n,i[a],s))return!0;return!1}function Gh(n,i){e:for(let s=0;s<i.length;s++){const a=i[s];if(n.length===a.length){for(let d=0;d<n.length;d++)if(n[d]!==a[d])continue e;return!0}}return!1}function hl(n,i){return n?":not("+i.trim()+")":i}function Id(n){let i=n[0],s=1,a=2,d="",f=!1;for(;s<n.length;){let g=n[s];if("string"==typeof g)if(2&a){const _=n[++s];d+="["+g+(_.length>0?'="'+_+'"':"")+"]"}else 8&a?d+="."+g:4&a&&(d+=" "+g);else""!==d&&!Ai(g)&&(i+=hl(f,d),d=""),a=g,f=f||!Ai(a);s++}return""!==d&&(i+=hl(f,d)),i}function Ru(n){return Wr(()=>{const i=Ac(n),s={...i,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===zs.OnPush,directiveDefs:null,pipeDefs:null,dependencies:i.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||is.Emulated,styles:n.styles||hi,_:null,schemas:n.schemas||null,tView:null,id:""};Nu(s);const a=n.dependencies;return s.directiveDefs=Vo(a,!1),s.pipeDefs=Vo(a,!0),s.id=function fl(n){let i=0;const s=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const d of s)i=Math.imul(31,i)+d.charCodeAt(0)<<0;return i+=2147483648,"c"+i}(s),s})}function Cc(n){return ri(n)||jr(n)}function Pu(n){return null!==n}function Mo(n){return Wr(()=>({type:n.type,bootstrap:n.bootstrap||hi,declarations:n.declarations||hi,imports:n.imports||hi,exports:n.exports||hi,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function qs(n,i){if(null==n)return Ts;const s={};for(const a in n)if(n.hasOwnProperty(a)){let d=n[a],f=d;Array.isArray(d)&&(f=d[1],d=d[0]),s[d]=a,i&&(i[d]=f)}return s}function Tc(n){return Wr(()=>{const i=Ac(n);return Nu(i),i})}function Ga(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function ri(n){return n[gr]||null}function jr(n){return n[bi]||null}function $r(n){return n[Li]||null}function oo(n){const i=ri(n)||jr(n)||$r(n);return null!==i&&i.standalone}function Rr(n,i){const s=n[ta]||null;if(!s&&!0===i)throw new Error(`Type ${Xi(n)} does not have '\u0275mod' property.`);return s}function Ac(n){const i={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:i,inputTransforms:null,inputConfig:n.inputs||Ts,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||hi,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:qs(n.inputs,i),outputs:qs(n.outputs),debugInfo:null}}function Nu(n){n.features?.forEach(i=>i(n))}function Vo(n,i){if(!n)return null;const s=i?$r:Cc;return()=>("function"==typeof n?n():n).map(a=>s(a)).filter(Pu)}const Sr=0,Mt=1,un=2,U=3,H=4,P=5,Y=6,pe=7,dt=8,Cn=9,rr=10,Tn=11,rs=12,Pr=13,ja=14,tr=15,xo=16,ss=17,Gi=18,$a=19,Dc=20,la=21,ca=22,Eo=23,Un=25,Vl=1,fs=7,pl=9,kr=10;var Ya=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n[n.HasChildViewsToRefresh=4]="HasChildViewsToRefresh",n}(Ya||{});function Qr(n){return Array.isArray(n)&&"object"==typeof n[Vl]}function os(n){return Array.isArray(n)&&!0===n[Vl]}function zl(n){return 0!=(4&n.flags)}function qa(n){return n.componentOffset>-1}function Gl(n){return 1==(1&n.flags)}function hr(n){return!!n.template}function qn(n){return 0!=(512&n[un])}function xi(n,i){return n.hasOwnProperty(Wn)?n[Wn]:null}class vi{constructor(i,s,a){this.previousValue=i,this.currentValue=s,this.firstChange=a}isFirstChange(){return this.firstChange}}function Di(){return di}function di(n){return n.type.prototype.ngOnChanges&&(n.setInput=dn),Ii}function Ii(){const n=Ds(this),i=n?.current;if(i){const s=n.previous;if(s===Ts)n.previous=i;else for(let a in i)s[a]=i[a];n.current=null,this.ngOnChanges(i)}}function dn(n,i,s,a){const d=this.declaredInputs[s],f=Ds(n)||function Gs(n,i){return n[Nr]=i}(n,{previous:Ts,current:null}),g=f.current||(f.current={}),_=f.previous,w=_[d];g[d]=new vi(w&&w.currentValue,i,_===Ts),n[a]=i}Di.ngInherit=!0;const Nr="__ngSimpleChanges__";function Ds(n){return n[Nr]||null}const Is=function(n,i,s){};let Ka=!1;function Ri(n){for(;Array.isArray(n);)n=n[Sr];return n}function bo(n,i){return Ri(i[n])}function Xr(n,i){return Ri(i[n.index])}function da(n,i){return n.data[i]}function Zi(n,i){const s=i[n];return Qr(s)?s:s[Sr]}function gl(n){return 128==(128&n[un])}function co(n,i){return null==i?null:n[i]}function Za(n){n[ss]=0}function Fu(n){1024&n[un]||(n[un]|=1024,gl(n)&&Br(n))}function Pc(n){return 9216&n[un]||n[Eo]?.dirty}function Nc(n){Pc(n)?Br(n):64&n[un]&&(function $h(){return Ka}()?(n[un]|=1024,Br(n)):n[rr].changeDetectionScheduler?.notify())}function Br(n){n[rr].changeDetectionScheduler?.notify();let i=n[U];for(;null!==i&&!(os(i)&&i[un]&Ya.HasChildViewsToRefresh||Qr(i)&&8192&i[un]);){if(os(i))i[un]|=Ya.HasChildViewsToRefresh;else if(i[un]|=8192,!gl(i))break;i=i[U]}}function uo(n,i){if(256==(256&n[un]))throw new It(911,!1);null===n[la]&&(n[la]=[]),n[la].push(i)}const On={lFrame:we(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function In(){return On.bindingsEnabled}function So(){return null!==On.skipHydrationRootTNode}function He(){return On.lFrame.lView}function Pi(){return On.lFrame.tView}function qh(n){return On.lFrame.contextLView=n,n[dt]}function Da(n){return On.lFrame.contextLView=null,n}function nr(){let n=Kh();for(;null!==n&&64===n.type;)n=n.parent;return n}function Kh(){return On.lFrame.currentTNode}function Fs(n,i){const s=On.lFrame;s.currentTNode=n,s.isParent=i}function zo(){return On.lFrame.isParent}function Yl(){On.lFrame.isParent=!1}function Us(){const n=On.lFrame;let i=n.bindingRootIndex;return-1===i&&(i=n.bindingRootIndex=n.tView.bindingStartIndex),i}function Go(){return On.lFrame.bindingIndex++}function Ja(n){const i=On.lFrame,s=i.bindingIndex;return i.bindingIndex=i.bindingIndex+n,s}function ms(n,i){const s=On.lFrame;s.bindingIndex=s.bindingRootIndex=n,pa(i)}function pa(n){On.lFrame.currentDirectiveIndex=n}function D(){return On.lFrame.currentQueryIndex}function b(n){On.lFrame.currentQueryIndex=n}function I(n){const i=n[Mt];return 2===i.type?i.declTNode:1===i.type?n[P]:null}function k(n,i,s){if(s&We.SkipSelf){let d=i,f=n;for(;!(d=d.parent,null!==d||s&We.Host||(d=I(f),null===d||(f=f[ja],10&d.type))););if(null===d)return!1;i=d,n=f}const a=On.lFrame=ae();return a.currentTNode=i,a.lView=n,!0}function $(n){const i=ae(),s=n[Mt];On.lFrame=i,i.currentTNode=s.firstChild,i.lView=n,i.tView=s,i.contextLView=n,i.bindingIndex=s.bindingStartIndex,i.inI18n=!1}function ae(){const n=On.lFrame,i=null===n?null:n.child;return null===i?we(n):i}function we(n){const i={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=i),i}function Ee(){const n=On.lFrame;return On.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Ft=Ee;function $n(){const n=Ee();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Si(){return On.lFrame.selectedIndex}function gs(n){On.lFrame.selectedIndex=n}function Wi(){const n=On.lFrame;return da(n.tView,n.selectedIndex)}let jo=!0;function ma(){return jo}function ql(n){jo=n}function Kl(n,i){for(let s=i.directiveStart,a=i.directiveEnd;s<a;s++){const f=n.data[s].type.prototype,{ngAfterContentInit:g,ngAfterContentChecked:_,ngAfterViewInit:w,ngAfterViewChecked:L,ngOnDestroy:G}=f;g&&(n.contentHooks??=[]).push(-s,g),_&&((n.contentHooks??=[]).push(s,_),(n.contentCheckHooks??=[]).push(s,_)),w&&(n.viewHooks??=[]).push(-s,w),L&&((n.viewHooks??=[]).push(s,L),(n.viewCheckHooks??=[]).push(s,L)),null!=G&&(n.destroyHooks??=[]).push(s,G)}}function Gp(n,i,s){xr(n,i,3,s)}function Yr(n,i,s,a){(3&n[un])===s&&xr(n,i,s,a)}function Bu(n,i){let s=n[un];(3&s)===i&&(s&=16383,s+=1,n[un]=s)}function xr(n,i,s,a){const f=a??-1,g=i.length-1;let _=0;for(let w=void 0!==a?65535&n[ss]:0;w<g;w++)if("number"==typeof i[w+1]){if(_=i[w],null!=a&&_>=a)break}else i[w]<0&&(n[ss]+=65536),(_<f||-1==f)&&(lb(n,s,i,w),n[ss]=(4294901760&n[ss])+w+2),w++}function E0(n,i){Is(4,n,i);const s=xe(null);try{i.call(n)}finally{xe(s),Is(5,n,i)}}function lb(n,i,s,a){const d=s[a]<0,f=s[a+1],_=n[d?-s[a]:s[a]];d?n[un]>>14<n[ss]>>16&&(3&n[un])===i&&(n[un]+=16384,E0(_,f)):E0(_,f)}const Od=-1;class Jh{constructor(i,s,a){this.factory=i,this.resolving=!1,this.canSeeViewProviders=s,this.injectImpl=a}}function Ld(n){return n!==Od}function Qa(n){return 32767&n}function _l(n,i){let s=function $o(n){return n>>16}(n),a=i;for(;s>0;)a=a[ja],s--;return a}let vs=!0;function si(n){const i=vs;return vs=n,i}const Zl=255,Fd=5;let cv=0;const Xo={};function Bc(n,i){const s=kd(n,i);if(-1!==s)return s;const a=i[Mt];a.firstCreatePass&&(n.injectorIndex=i.length,Ud(a.data,n),Ud(i,null),Ud(a.blueprint,null));const d=Bd(n,i),f=n.injectorIndex;if(Ld(d)){const g=Qa(d),_=_l(d,i),w=_[Mt].data;for(let L=0;L<8;L++)i[f+L]=_[g+L]|w[g+L]}return i[f+8]=d,f}function Ud(n,i){n.push(0,0,0,0,0,0,0,0,i)}function kd(n,i){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===i[n.injectorIndex+8]?-1:n.injectorIndex}function Bd(n,i){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let s=0,a=null,d=i;for(;null!==d;){if(a=zc(d),null===a)return Od;if(s++,d=d[ja],-1!==a.injectorIndex)return a.injectorIndex|s<<16}return Od}function Vu(n,i,s){!function Qh(n,i,s){let a;"string"==typeof s?a=s.charCodeAt(0)||0:s.hasOwnProperty(eo)&&(a=s[eo]),null==a&&(a=s[eo]=cv++);const d=a&Zl;i.data[n+(d>>Fd)]|=1<<d}(n,i,s)}function uv(n,i,s){if(s&We.Optional||void 0!==n)return n;_i()}function Vd(n,i,s,a){if(s&We.Optional&&void 0===a&&(a=null),!(s&(We.Self|We.Host))){const d=n[Cn],f=Bt(void 0);try{return d?d.get(i,a,s&We.Optional):Ui(i,a,s&We.Optional)}finally{Bt(f)}}return uv(a,0,s)}function Vc(n,i,s,a=We.Default,d){if(null!==n){if(2048&i[un]&&!(a&We.Self)){const g=function Hu(n,i,s,a,d){let f=n,g=i;for(;null!==f&&null!==g&&2048&g[un]&&!(512&g[un]);){const _=Hc(f,g,s,a|We.Self,Xo);if(_!==Xo)return _;let w=f.parent;if(!w){const L=g[Dc];if(L){const G=L.get(s,Xo,a);if(G!==Xo)return G}w=zc(g),g=g[ja]}f=w}return d}(n,i,s,a,Xo);if(g!==Xo)return g}const f=Hc(n,i,s,a,Xo);if(f!==Xo)return f}return Vd(i,s,a,d)}function Hc(n,i,s,a,d){const f=function S0(n){if("string"==typeof n)return n.charCodeAt(0)||0;const i=n.hasOwnProperty(eo)?n[eo]:void 0;return"number"==typeof i?i>=0?i&Zl:fv:i}(s);if("function"==typeof f){if(!k(i,n,a))return a&We.Host?uv(d,0,a):Vd(i,s,a,d);try{let g;if(g=f(a),null!=g||a&We.Optional)return g;_i()}finally{Ft()}}else if("number"==typeof f){let g=null,_=kd(n,i),w=Od,L=a&We.Host?i[tr][P]:null;for((-1===_||a&We.SkipSelf)&&(w=-1===_?Bd(n,i):i[_+8],w!==Od&&hv(a,!1)?(g=i[Mt],_=Qa(w),i=_l(w,i)):_=-1);-1!==_;){const G=i[Mt];if(dv(f,_,G.data)){const K=fo(_,i,s,g,a,L);if(K!==Xo)return K}w=i[_+8],w!==Od&&hv(a,i[Mt].data[_+8]===L)&&dv(f,_,i)?(g=G,_=Qa(w),i=_l(w,i)):_=-1}}return d}function fo(n,i,s,a,d,f){const g=i[Mt],_=g.data[n+8],G=ef(_,g,s,null==a?qa(_)&&vs:a!=g&&0!=(3&_.type),d&We.Host&&f===_);return null!==G?Jl(i,g,G,_):Xo}function ef(n,i,s,a,d){const f=n.providerIndexes,g=i.data,_=1048575&f,w=n.directiveStart,G=f>>20,de=d?_+G:n.directiveEnd;for(let ge=a?_:_+G;ge<de;ge++){const Ue=g[ge];if(ge<w&&s===Ue||ge>=w&&Ue.type===s)return ge}if(d){const ge=g[w];if(ge&&hr(ge)&&ge.type===s)return w}return null}function Jl(n,i,s,a){let d=n[s];const f=i.data;if(function ov(n){return n instanceof Jh}(d)){const g=d;g.resolving&&function ws(n,i){const s=i?`. Dependency path: ${i.join(" > ")} > ${n}`:"";throw new It(-200,`Circular dependency in DI detected for ${n}${s}`)}(function Pn(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():sn(n)}(f[s]));const _=si(g.canSeeViewProviders);g.resolving=!0;const L=g.injectImpl?Bt(g.injectImpl):null;k(n,a,We.Default);try{d=n[s]=g.factory(void 0,f,n,a),i.firstCreatePass&&s>=a.directiveStart&&function wo(n,i,s){const{ngOnChanges:a,ngOnInit:d,ngDoCheck:f}=i.type.prototype;if(a){const g=di(i);(s.preOrderHooks??=[]).push(n,g),(s.preOrderCheckHooks??=[]).push(n,g)}d&&(s.preOrderHooks??=[]).push(0-n,d),f&&((s.preOrderHooks??=[]).push(n,f),(s.preOrderCheckHooks??=[]).push(n,f))}(s,f[s],i)}finally{null!==L&&Bt(L),si(_),g.resolving=!1,Ft()}}return d}function dv(n,i,s){return!!(s[i+(n>>Fd)]&1<<n)}function hv(n,i){return!(n&We.Self||n&We.Host&&i)}class wr{constructor(i,s){this._tNode=i,this._lView=s}get(i,s,a){return Vc(this._tNode,this._lView,i,no(a),s)}}function fv(){return new wr(nr(),He())}function Wp(n){return Wr(()=>{const i=n.prototype.constructor,s=i[Wn]||ys(i),a=Object.prototype;let d=Object.getPrototypeOf(n.prototype).constructor;for(;d&&d!==a;){const f=d[Wn]||ys(d);if(f&&f!==s)return f;d=Object.getPrototypeOf(d)}return f=>new f})}function ys(n){return ii(n)?()=>{const i=ys(nn(n));return i&&i()}:xi(n)}function zc(n){const i=n[Mt],s=i.type;return 2===s?i.declTNode:1===s?n[P]:null}function jp(n){return function Rs(n,i){if("class"===i)return n.classes;if("style"===i)return n.styles;const s=n.attrs;if(s){const a=s.length;let d=0;for(;d<a;){const f=s[d];if(Ta(f))break;if(0===f)d+=2;else if("number"==typeof f)for(d++;d<a&&"string"==typeof s[d];)d++;else{if(f===i)return s[d+1];d+=2}}}return null}(nr(),n)}const zu="__parameters__";function Yo(n,i,s){return Wr(()=>{const a=function $p(n){return function(...s){if(n){const a=n(...s);for(const d in a)this[d]=a[d]}}}(i);function d(...f){if(this instanceof d)return a.apply(this,f),this;const g=new d(...f);return _.annotation=g,_;function _(w,L,G){const K=w.hasOwnProperty(zu)?w[zu]:Object.defineProperty(w,zu,{value:[]})[zu];for(;K.length<=G;)K.push(null);return(K[G]=K[G]||[]).push(g),w}}return s&&(d.prototype=Object.create(s.prototype)),d.prototype.ngMetadataName=n,d.annotationCls=d,d})}function ju(n,i){n.forEach(s=>Array.isArray(s)?ju(s,i):i(s))}function mv(n,i,s){i>=n.length?n.push(s):n.splice(i,0,s)}function rf(n,i){return i>=n.length-1?n.pop():n.splice(i,1)[0]}function zd(n,i){const s=[];for(let a=0;a<n;a++)s.push(i);return s}function qo(n,i,s){let a=$u(n,i);return a>=0?n[1|a]=s:(a=~a,function gv(n,i,s,a){let d=n.length;if(d==i)n.push(s,a);else if(1===d)n.push(a,n[0]),n[0]=s;else{for(d--,n.push(n[d-1],n[d]);d>i;)n[d]=n[d-2],d--;n[i]=s,n[i+1]=a}}(n,a,i,s)),a}function qp(n,i){const s=$u(n,i);if(s>=0)return n[1|s]}function $u(n,i){return function vv(n,i,s){let a=0,d=n.length>>s;for(;d!==a;){const f=a+(d-a>>1),g=n[f<<s];if(i===g)return f<<s;g>i?d=f:a=f+1}return~(d<<s)}(n,i,1)}const af=oa(Yo("Optional"),8),lf=oa(Yo("SkipSelf"),4),Gc=new an("ENVIRONMENT_INITIALIZER"),xv=new an("INJECTOR",-1),Jp=new an("INJECTOR_DEF_TYPES");class uf{get(i,s=Fo){if(s===Fo){const a=new Error(`NullInjectorError: No provider for ${Xi(i)}!`);throw a.name="NullInjectorError",a}return s}}function Qp(n){return{\u0275providers:n}}function $0(...n){return{\u0275providers:Ev(0,n),\u0275fromNgModule:!0}}function Ev(n,...i){const s=[],a=new Set;let d;const f=g=>{s.push(g)};return ju(i,g=>{const _=g;df(_,f,[],a)&&(d||=[],d.push(_))}),void 0!==d&&bv(d,f),s}function bv(n,i){for(let s=0;s<n.length;s++){const{ngModule:a,providers:d}=n[s];em(d,f=>{i(f,a)})}}function df(n,i,s,a){if(!(n=nn(n)))return!1;let d=null,f=ve(n);const g=!f&&ri(n);if(f||g){if(g&&!g.standalone)return!1;d=n}else{const w=n.ngModule;if(f=ve(w),!f)return!1;d=w}const _=a.has(d);if(g){if(_)return!1;if(a.add(d),g.dependencies){const w="function"==typeof g.dependencies?g.dependencies():g.dependencies;for(const L of w)df(L,i,s,a)}}else{if(!f)return!1;{if(null!=f.imports&&!_){let L;a.add(d);try{ju(f.imports,G=>{df(G,i,s,a)&&(L||=[],L.push(G))})}finally{}void 0!==L&&bv(L,i)}if(!_){const L=xi(d)||(()=>new d);i({provide:d,useFactory:L,deps:hi},d),i({provide:Jp,useValue:d,multi:!0},d),i({provide:Gc,useValue:()=>dr(d),multi:!0},d)}const w=f.providers;if(null!=w&&!_){const L=n;em(w,G=>{i(G,L)})}}}return d!==n&&void 0!==n.providers}function em(n,i){for(let s of n)Gn(s)&&(s=s.\u0275providers),Array.isArray(s)?em(s,i):i(s)}const X0=Mn({provide:String,useValue:Mn});function tm(n){return null!==n&&"object"==typeof n&&X0 in n}function Wc(n){return"function"==typeof n}const nm=new an("Set Injector scope."),hf={},q0={};let im;function ff(){return void 0===im&&(im=new uf),im}class el{}class Yu extends el{get destroyed(){return this._destroyed}constructor(i,s,a,d){super(),this.parent=s,this.source=a,this.scopes=d,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,sm(i,g=>this.processProvider(g)),this.records.set(xv,qu(void 0,this)),d.has("environment")&&this.records.set(el,qu(void 0,this));const f=this.records.get(nm);null!=f&&"string"==typeof f.value&&this.scopes.add(f.value),this.injectorDefTypes=new Set(this.get(Jp,hi,We.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const s of this._ngOnDestroyHooks)s.ngOnDestroy();const i=this._onDestroyHooks;this._onDestroyHooks=[];for(const s of i)s()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(i){return this.assertNotDestroyed(),this._onDestroyHooks.push(i),()=>this.removeOnDestroy(i)}runInContext(i){this.assertNotDestroyed();const s=hs(this),a=Bt(void 0);try{return i()}finally{hs(s),Bt(a)}}get(i,s=Fo,a=We.Default){if(this.assertNotDestroyed(),i.hasOwnProperty(Yi))return i[Yi](this);a=no(a);const f=hs(this),g=Bt(void 0);try{if(!(a&We.SkipSelf)){let w=this.records.get(i);if(void 0===w){const L=function eM(n){return"function"==typeof n||"object"==typeof n&&n instanceof an}(i)&&Ls(i);w=L&&this.injectableDefInScope(L)?qu(rm(i),hf):null,this.records.set(i,w)}if(null!=w)return this.hydrate(i,w)}return(a&We.Self?ff():this.parent).get(i,s=a&We.Optional&&s===Fo?null:s)}catch(_){if("NullInjectorError"===_.name){if((_[ra]=_[ra]||[]).unshift(Xi(i)),f)throw _;return function Hs(n,i,s,a){const d=n[ra];throw i[vo]&&d.unshift(i[vo]),n.message=function Bo(n,i,s,a=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let d=Xi(i);if(Array.isArray(i))d=i.map(Xi).join(" -> ");else if("object"==typeof i){let f=[];for(let g in i)if(i.hasOwnProperty(g)){let _=i[g];f.push(g+":"+("string"==typeof _?JSON.stringify(_):Xi(_)))}d=`{${f.join(", ")}}`}return`${s}${a?"("+a+")":""}[${d}]: ${n.replace(ka,"\n  ")}`}("\n"+n.message,d,s,a),n.ngTokenPath=d,n[ra]=null,n}(_,i,"R3InjectorError",this.source)}throw _}finally{Bt(g),hs(f)}}resolveInjectorInitializers(){const i=hs(this),s=Bt(void 0);try{const d=this.get(Gc,hi,We.Self);for(const f of d)f()}finally{hs(i),Bt(s)}}toString(){const i=[],s=this.records;for(const a of s.keys())i.push(Xi(a));return`R3Injector[${i.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new It(205,!1)}processProvider(i){let s=Wc(i=nn(i))?i:nn(i&&i.provide);const a=function Z0(n){return tm(n)?qu(void 0,n.useValue):qu(Cv(n),hf)}(i);if(Wc(i)||!0!==i.multi)this.records.get(s);else{let d=this.records.get(s);d||(d=qu(void 0,hf,!0),d.factory=()=>Uo(d.multi),this.records.set(s,d)),s=i,d.multi.push(i)}this.records.set(s,a)}hydrate(i,s){return s.value===hf&&(s.value=q0,s.value=s.factory()),"object"==typeof s.value&&s.value&&function Q0(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(s.value)&&this._ngOnDestroyHooks.add(s.value),s.value}injectableDefInScope(i){if(!i.providedIn)return!1;const s=nn(i.providedIn);return"string"==typeof s?"any"===s||this.scopes.has(s):this.injectorDefTypes.has(s)}removeOnDestroy(i){const s=this._onDestroyHooks.indexOf(i);-1!==s&&this._onDestroyHooks.splice(s,1)}}function rm(n){const i=Ls(n),s=null!==i?i.factory:xi(n);if(null!==s)return s;if(n instanceof an)throw new It(204,!1);if(n instanceof Function)return function K0(n){const i=n.length;if(i>0)throw zd(i,"?"),new It(204,!1);const s=function Ca(n){return n&&(n[ue]||n[Le])||null}(n);return null!==s?()=>s.factory(n):()=>new n}(n);throw new It(204,!1)}function Cv(n,i,s){let a;if(Wc(n)){const d=nn(n);return xi(d)||rm(d)}if(tm(n))a=()=>nn(n.useValue);else if(function wv(n){return!(!n||!n.useFactory)}(n))a=()=>n.useFactory(...Uo(n.deps||[]));else if(function Sv(n){return!(!n||!n.useExisting)}(n))a=()=>dr(nn(n.useExisting));else{const d=nn(n&&(n.useClass||n.provide));if(!function J0(n){return!!n.deps}(n))return xi(d)||rm(d);a=()=>new d(...Uo(n.deps))}return a}function qu(n,i,s=!1){return{factory:n,value:i,multi:s?[]:void 0}}function sm(n,i){for(const s of n)Array.isArray(s)?sm(s,i):s&&Gn(s)?sm(s.\u0275providers,i):i(s)}function tM(n,i){n instanceof Yu&&n.assertNotDestroyed();const a=hs(n),d=Bt(void 0);try{return i()}finally{hs(a),Bt(d)}}function Iv(n,i=null,s=null,a){const d=Rv(n,i,s,a);return d.resolveInjectorInitializers(),d}function Rv(n,i=null,s=null,a,d=new Set){const f=[s||hi,$0(n)];return a=a||("object"==typeof n?void 0:Xi(n)),new Yu(f,i||ff(),a||null,d)}let lm,ga=(()=>{class n{static{this.THROW_IF_NOT_FOUND=Fo}static{this.NULL=new uf}static create(s,a){if(Array.isArray(s))return Iv({name:""},a,s,"");{const d=s.name??"";return Iv({name:d},s.parent,s.providers,d)}}static{this.\u0275prov=gi({token:n,providedIn:"any",factory:()=>dr(xv)})}static{this.__NG_ELEMENT_ID__=-1}}return n})();function tc(n){return!!Rr(n)}function xb(n){lm=n}const cM=new an("AppId",{providedIn:"root",factory:()=>Eb}),Eb="ng",uM=new an("Platform Initializer"),Nv=new an("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),bb=new an("AnimationModuleType"),Sb=new an("CSP nonce",{providedIn:"root",factory:()=>function jc(){if(void 0!==lm)return lm;if(typeof document<"u")return document;throw new It(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function va(n){return n instanceof Function?n():n}function Ju(n){return 128==(128&n.flags)}var Qu=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Qu||{});const sc=new Map;let kv=0;const vm="__ngContext__";function Zs(n,i){Qr(i)?(n[vm]=i[$a],function vM(n){sc.set(n[$a],n)}(i)):n[vm]=i}let xf;function Ef(n,i){return xf(n,i)}function ed(n){const i=n[U];return os(i)?i[U]:i}function _s(n){return Yd(n[rs])}function Ms(n){return Yd(n[H])}function Yd(n){for(;null!==n&&!os(n);)n=n[H];return n}function nd(n,i,s,a,d){if(null!=a){let f,g=!1;os(a)?f=a:Qr(a)&&(g=!0,a=a[Sr]);const _=Ri(a);0===n&&null!==s?null==d?Jv(i,s,_):Yc(i,s,_,d||null,!0):1===n&&null!==s?Yc(i,s,_,d||null,!0):2===n?function Af(n,i,s){const a=Cf(n,i);a&&function AM(n,i,s,a){n.removeChild(i,s,a)}(n,a,i,s)}(i,_,g):3===n&&i.destroyNode(_),null!=f&&function RM(n,i,s,a,d){const f=s[fs];f!==Ri(s)&&nd(i,n,a,f,d);for(let _=kr;_<s.length;_++){const w=s[_];Zd(w[Mt],w,n,i,a,f)}}(i,n,f,s,d)}}function Sf(n,i,s){return n.createElement(i,s)}function Kv(n,i){const s=n[pl],a=s.indexOf(i);s.splice(a,1)}function qd(n,i){if(n.length<=kr)return;const s=kr+i,a=n[s];if(a){const d=a[xo];null!==d&&d!==n&&Kv(d,a),i>0&&(n[s-1][H]=a[H]);const f=rf(n,kr+i);!function MM(n,i){Zd(n,i,i[Tn],2,null,null),i[Sr]=null,i[P]=null}(a[Mt],a);const g=f[Gi];null!==g&&g.detachView(f[Mt]),a[U]=null,a[H]=null,a[un]&=-129}return a}function wf(n,i){if(!(256&i[un])){const s=i[Tn];s.destroyNode&&Zd(n,i,s,3,null,null),function bM(n){let i=n[rs];if(!i)return xm(n[Mt],n);for(;i;){let s=null;if(Qr(i))s=i[rs];else{const a=i[kr];a&&(s=a)}if(!s){for(;i&&!i[H]&&i!==n;)Qr(i)&&xm(i[Mt],i),i=i[U];null===i&&(i=n),Qr(i)&&xm(i[Mt],i),s=i&&i[H]}i=s}}(i)}}function xm(n,i){if(!(256&i[un])){i[un]&=-129,i[un]|=256,i[Eo]&&function ui(n){if(en(n),mt(n))for(let i=0;i<n.producerNode.length;i++)Ye(n.producerNode[i],n.producerIndexOfThis[i]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}(i[Eo]),function TM(n,i){let s;if(null!=n&&null!=(s=n.destroyHooks))for(let a=0;a<s.length;a+=2){const d=i[s[a]];if(!(d instanceof Jh)){const f=s[a+1];if(Array.isArray(f))for(let g=0;g<f.length;g+=2){const _=d[f[g]],w=f[g+1];Is(4,_,w);try{w.call(_)}finally{Is(5,_,w)}}else{Is(4,d,f);try{f.call(d)}finally{Is(5,d,f)}}}}}(n,i),function CM(n,i){const s=n.cleanup,a=i[pe];if(null!==s)for(let f=0;f<s.length-1;f+=2)if("string"==typeof s[f]){const g=s[f+3];g>=0?a[g]():a[-g].unsubscribe(),f+=2}else s[f].call(a[s[f+1]]);null!==a&&(i[pe]=null);const d=i[la];if(null!==d){i[la]=null;for(let f=0;f<d.length;f++)(0,d[f])()}}(n,i),1===i[Mt].type&&i[Tn].destroy();const s=i[xo];if(null!==s&&os(i[U])){s!==i[U]&&Kv(s,i);const a=i[Gi];null!==a&&a.detachView(n)}!function yf(n){sc.delete(n[$a])}(i)}}function Em(n,i,s){return function Zv(n,i,s){let a=i;for(;null!==a&&40&a.type;)a=(i=a).parent;if(null===a)return s[Sr];{const{componentOffset:d}=a;if(d>-1){const{encapsulation:f}=n.data[a.directiveStart+d];if(f===is.None||f===is.Emulated)return null}return Xr(a,s)}}(n,i.parent,s)}function Yc(n,i,s,a,d){n.insertBefore(i,s,a,d)}function Jv(n,i,s){n.appendChild(i,s)}function Qv(n,i,s,a,d){null!==a?Yc(n,i,s,a,d):Jv(n,i,s)}function Cf(n,i){return n.parentNode(i)}function ey(n,i,s){return ny(n,i,s)}let bm,qc,Jd,ny=function ty(n,i,s){return 40&n.type?Xr(n,s):null};function Tf(n,i,s,a){const d=Em(n,a,i),f=i[Tn],_=ey(a.parent||i[P],a,i);if(null!=d)if(Array.isArray(s))for(let w=0;w<s.length;w++)Qv(f,d,s[w],_,!1);else Qv(f,d,s,_,!1);void 0!==bm&&bm(f,a,i,s,d)}function Kd(n,i){if(null!==i){const s=i.type;if(3&s)return Xr(i,n);if(4&s)return Sm(-1,n[i.index]);if(8&s){const a=i.child;if(null!==a)return Kd(n,a);{const d=n[i.index];return os(d)?Sm(-1,d):Ri(d)}}if(32&s)return Ef(i,n)()||Ri(n[i.index]);{const a=ry(n,i);return null!==a?Array.isArray(a)?a[0]:Kd(ed(n[tr]),a):Kd(n,i.next)}}return null}function ry(n,i){return null!==i?n[tr][P].projection[i.projection]:null}function Sm(n,i){const s=kr+n+1;if(s<i.length){const a=i[s],d=a[Mt].firstChild;if(null!==d)return Kd(a,d)}return i[fs]}function wm(n,i,s,a,d,f,g){for(;null!=s;){const _=a[s.index],w=s.type;if(g&&0===i&&(_&&Zs(Ri(_),a),s.flags|=2),32!=(32&s.flags))if(8&w)wm(n,i,s.child,a,d,f,!1),nd(i,n,d,_,f);else if(32&w){const L=Ef(s,a);let G;for(;G=L();)nd(i,n,d,G,f);nd(i,n,d,_,f)}else 16&w?oy(n,i,a,s,d,f):nd(i,n,d,_,f);s=g?s.projectionNext:s.next}}function Zd(n,i,s,a,d,f){wm(s,a,n.firstChild,i,d,f,!1)}function oy(n,i,s,a,d,f){const g=s[tr],w=g[P].projection[a.projection];if(Array.isArray(w))for(let L=0;L<w.length;L++)nd(i,n,d,w[L],f);else{let L=w;const G=g[U];Ju(a)&&(L.flags|=128),wm(n,i,L,G,d,f,!0)}}function Tm(n,i,s){""===s?n.removeAttribute(i,"class"):n.setAttribute(i,"class",s)}function ay(n,i,s){const{mergedAttrs:a,classes:d,styles:f}=s;null!==a&&io(n,i,a),null!==d&&Tm(n,i,d),null!==f&&function Cm(n,i,s){n.setAttribute(i,"style",s)}(n,i,f)}function id(n){return function Df(){if(void 0===qc&&(qc=null,Fn.trustedTypes))try{qc=Fn.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return qc}()?.createHTML(n)||n}function cy(n){return function Am(){if(void 0===Jd&&(Jd=null,Fn.trustedTypes))try{Jd=Fn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Jd}()?.createScriptURL(n)||n}class Kc{constructor(i){this.changingThisBreaksApplicationSecurity=i}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Qs})`}}class UM extends Kc{getTypeName(){return"HTML"}}class kM extends Kc{getTypeName(){return"Style"}}class eh extends Kc{getTypeName(){return"Script"}}class uy extends Kc{getTypeName(){return"URL"}}class dy extends Kc{getTypeName(){return"ResourceURL"}}function El(n){return n instanceof Kc?n.changingThisBreaksApplicationSecurity:n}function oc(n,i){const s=function BM(n){return n instanceof Kc&&n.getTypeName()||null}(n);if(null!=s&&s!==i){if("ResourceURL"===s&&"URL"===i)return!0;throw new Error(`Required a safe ${i}, got a ${s} (see ${Qs})`)}return s===i}function VM(n){return new UM(n)}function HM(n){return new kM(n)}function hy(n){return new eh(n)}function zM(n){return new uy(n)}function fy(n){return new dy(n)}class GM{constructor(i){this.inertDocumentHelper=i}getInertBodyElement(i){i="<body><remove></remove>"+i;try{const s=(new window.DOMParser).parseFromString(id(i),"text/html").body;return null===s?this.inertDocumentHelper.getInertBodyElement(i):(s.removeChild(s.firstChild),s)}catch{return null}}}class WM{constructor(i){this.defaultDoc=i,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(i){const s=this.inertDocument.createElement("template");return s.innerHTML=id(i),s}}const $M=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function If(n){return(n=String(n)).match($M)?n:"unsafe:"+n}function bl(n){const i={};for(const s of n.split(","))i[s]=!0;return i}function th(...n){const i={};for(const s of n)for(const a in s)s.hasOwnProperty(a)&&(i[a]=!0);return i}const my=bl("area,br,col,hr,img,wbr"),gy=bl("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),vy=bl("rp,rt"),Dm=th(my,th(gy,bl("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),th(vy,bl("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),th(vy,gy)),Im=bl("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),yy=th(Im,bl("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),bl("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),qM=bl("script,style,template");class _y{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(i){let s=i.firstChild,a=!0;for(;s;)if(s.nodeType===Node.ELEMENT_NODE?a=this.startElement(s):s.nodeType===Node.TEXT_NODE?this.chars(s.nodeValue):this.sanitizedSomething=!0,a&&s.firstChild)s=s.firstChild;else for(;s;){s.nodeType===Node.ELEMENT_NODE&&this.endElement(s);let d=this.checkClobberedElement(s,s.nextSibling);if(d){s=d;break}s=this.checkClobberedElement(s,s.parentNode)}return this.buf.join("")}startElement(i){const s=i.nodeName.toLowerCase();if(!Dm.hasOwnProperty(s))return this.sanitizedSomething=!0,!qM.hasOwnProperty(s);this.buf.push("<"),this.buf.push(s);const a=i.attributes;for(let d=0;d<a.length;d++){const f=a.item(d),g=f.name,_=g.toLowerCase();if(!yy.hasOwnProperty(_)){this.sanitizedSomething=!0;continue}let w=f.value;Im[_]&&(w=If(w)),this.buf.push(" ",g,'="',Rm(w),'"')}return this.buf.push(">"),!0}endElement(i){const s=i.nodeName.toLowerCase();Dm.hasOwnProperty(s)&&!my.hasOwnProperty(s)&&(this.buf.push("</"),this.buf.push(s),this.buf.push(">"))}chars(i){this.buf.push(Rm(i))}checkClobberedElement(i,s){if(s&&(i.compareDocumentPosition(s)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${i.outerHTML}`);return s}}const KM=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,My=/([^\#-~ |!])/g;function Rm(n){return n.replace(/&/g,"&amp;").replace(KM,function(i){return"&#"+(1024*(i.charCodeAt(0)-55296)+(i.charCodeAt(1)-56320)+65536)+";"}).replace(My,function(i){return"&#"+i.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Rf;function xy(n,i){let s=null;try{Rf=Rf||function py(n){const i=new WM(n);return function jM(){try{return!!(new window.DOMParser).parseFromString(id(""),"text/html")}catch{return!1}}()?new GM(i):i}(n);let a=i?String(i):"";s=Rf.getInertBodyElement(a);let d=5,f=a;do{if(0===d)throw new Error("Failed to sanitize html because the input is unstable");d--,a=f,f=s.innerHTML,s=Rf.getInertBodyElement(a)}while(a!==f);return id((new _y).sanitizeChildren(Pm(s)||s))}finally{if(s){const a=Pm(s)||s;for(;a.firstChild;)a.removeChild(a.firstChild)}}}function Pm(n){return"content"in n&&function ZM(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var Zc=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Zc||{});function Nm(n){const i=Qc();return i?i.sanitize(Zc.URL,n)||"":oc(n,"URL")?El(n):If(sn(n))}function Pf(n){const i=Qc();if(i)return cy(i.sanitize(Zc.RESOURCE_URL,n)||"");if(oc(n,"ResourceURL"))return cy(El(n));throw new It(904,!1)}function Ey(n,i,s){return function nx(n,i){return"src"===i&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===i&&("base"===n||"link"===n)?Pf:Nm}(i,s)(n)}function Qc(){const n=He();return n&&n[rr].sanitizer}class ix{}let iu=(n,i,s)=>null;function od(n,i,s=!1){return iu(n,i,s)}class Ty{}class Bm{}class zm{resolveComponentFactory(i){throw function rx(n){const i=Error(`No component factory found for ${Xi(n)}.`);return i.ngComponent=n,i}(i)}}let cd=(()=>{class n{static{this.NULL=new zm}}return n})();function Gm(){return ru(nr(),He())}function ru(n,i){return new su(Xr(n,i))}let su=(()=>{class n{constructor(s){this.nativeElement=s}static{this.__NG_ELEMENT_ID__=Gm}}return n})();function wl(n){return n instanceof su?n.nativeElement:n}class Wm{}let sx=(()=>{class n{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>function Uf(){const n=He(),s=Zi(nr().index,n);return(Qr(s)?s:n)[Tn]}()}}return n})(),ud=(()=>{class n{static{this.\u0275prov=gi({token:n,providedIn:"root",factory:()=>null})}}return n})();const lc={};function lh(n){const i=xe(null);try{return n()}finally{xe(i)}}function ch(n){return!!Xm(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function Xm(n){return null!==n&&("function"==typeof n||"object"==typeof n)}class Ay{constructor(){}supports(i){return ch(i)}create(i){return new ux(i)}}const Ao=(n,i)=>i;class ux{constructor(i){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=i||Ao}forEachItem(i){let s;for(s=this._itHead;null!==s;s=s._next)i(s)}forEachOperation(i){let s=this._itHead,a=this._removalsHead,d=0,f=null;for(;s||a;){const g=!a||s&&s.currentIndex<dd(a,d,f)?s:a,_=dd(g,d,f),w=g.currentIndex;if(g===a)d--,a=a._nextRemoved;else if(s=s._next,null==g.previousIndex)d++;else{f||(f=[]);const L=_-d,G=w-d;if(L!=G){for(let de=0;de<L;de++){const ge=de<f.length?f[de]:f[de]=0,Ue=ge+de;G<=Ue&&Ue<L&&(f[de]=ge+1)}f[g.previousIndex]=G-L}}_!==w&&i(g,_,w)}}forEachPreviousItem(i){let s;for(s=this._previousItHead;null!==s;s=s._nextPrevious)i(s)}forEachAddedItem(i){let s;for(s=this._additionsHead;null!==s;s=s._nextAdded)i(s)}forEachMovedItem(i){let s;for(s=this._movesHead;null!==s;s=s._nextMoved)i(s)}forEachRemovedItem(i){let s;for(s=this._removalsHead;null!==s;s=s._nextRemoved)i(s)}forEachIdentityChange(i){let s;for(s=this._identityChangesHead;null!==s;s=s._nextIdentityChange)i(s)}diff(i){if(null==i&&(i=[]),!ch(i))throw new It(900,!1);return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let d,f,g,s=this._itHead,a=!1;if(Array.isArray(i)){this.length=i.length;for(let _=0;_<this.length;_++)f=i[_],g=this._trackByFn(_,f),null!==s&&Object.is(s.trackById,g)?(a&&(s=this._verifyReinsertion(s,f,g,_)),Object.is(s.item,f)||this._addIdentityChange(s,f)):(s=this._mismatch(s,f,g,_),a=!0),s=s._next}else d=0,function cx(n,i){if(Array.isArray(n))for(let s=0;s<n.length;s++)i(n[s]);else{const s=n[Symbol.iterator]();let a;for(;!(a=s.next()).done;)i(a.value)}}(i,_=>{g=this._trackByFn(d,_),null!==s&&Object.is(s.trackById,g)?(a&&(s=this._verifyReinsertion(s,_,g,d)),Object.is(s.item,_)||this._addIdentityChange(s,_)):(s=this._mismatch(s,_,g,d),a=!0),s=s._next,d++}),this.length=d;return this._truncate(s),this.collection=i,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let i;for(i=this._previousItHead=this._itHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._additionsHead;null!==i;i=i._nextAdded)i.previousIndex=i.currentIndex;for(this._additionsHead=this._additionsTail=null,i=this._movesHead;null!==i;i=i._nextMoved)i.previousIndex=i.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(i,s,a,d){let f;return null===i?f=this._itTail:(f=i._prev,this._remove(i)),null!==(i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(a,null))?(Object.is(i.item,s)||this._addIdentityChange(i,s),this._reinsertAfter(i,f,d)):null!==(i=null===this._linkedRecords?null:this._linkedRecords.get(a,d))?(Object.is(i.item,s)||this._addIdentityChange(i,s),this._moveAfter(i,f,d)):i=this._addAfter(new Ym(s,a),f,d),i}_verifyReinsertion(i,s,a,d){let f=null===this._unlinkedRecords?null:this._unlinkedRecords.get(a,null);return null!==f?i=this._reinsertAfter(f,i._prev,d):i.currentIndex!=d&&(i.currentIndex=d,this._addToMoves(i,d)),i}_truncate(i){for(;null!==i;){const s=i._next;this._addToRemovals(this._unlink(i)),i=s}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(i,s,a){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(i);const d=i._prevRemoved,f=i._nextRemoved;return null===d?this._removalsHead=f:d._nextRemoved=f,null===f?this._removalsTail=d:f._prevRemoved=d,this._insertAfter(i,s,a),this._addToMoves(i,a),i}_moveAfter(i,s,a){return this._unlink(i),this._insertAfter(i,s,a),this._addToMoves(i,a),i}_addAfter(i,s,a){return this._insertAfter(i,s,a),this._additionsTail=null===this._additionsTail?this._additionsHead=i:this._additionsTail._nextAdded=i,i}_insertAfter(i,s,a){const d=null===s?this._itHead:s._next;return i._next=d,i._prev=s,null===d?this._itTail=i:d._prev=i,null===s?this._itHead=i:s._next=i,null===this._linkedRecords&&(this._linkedRecords=new cc),this._linkedRecords.put(i),i.currentIndex=a,i}_remove(i){return this._addToRemovals(this._unlink(i))}_unlink(i){null!==this._linkedRecords&&this._linkedRecords.remove(i);const s=i._prev,a=i._next;return null===s?this._itHead=a:s._next=a,null===a?this._itTail=s:a._prev=s,i}_addToMoves(i,s){return i.previousIndex===s||(this._movesTail=null===this._movesTail?this._movesHead=i:this._movesTail._nextMoved=i),i}_addToRemovals(i){return null===this._unlinkedRecords&&(this._unlinkedRecords=new cc),this._unlinkedRecords.put(i),i.currentIndex=null,i._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=i,i._prevRemoved=null):(i._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=i),i}_addIdentityChange(i,s){return i.item=s,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=i:this._identityChangesTail._nextIdentityChange=i,i}}class Ym{constructor(i,s){this.item=i,this.trackById=s,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Bf{constructor(){this._head=null,this._tail=null}add(i){null===this._head?(this._head=this._tail=i,i._nextDup=null,i._prevDup=null):(this._tail._nextDup=i,i._prevDup=this._tail,i._nextDup=null,this._tail=i)}get(i,s){let a;for(a=this._head;null!==a;a=a._nextDup)if((null===s||s<=a.currentIndex)&&Object.is(a.trackById,i))return a;return null}remove(i){const s=i._prevDup,a=i._nextDup;return null===s?this._head=a:s._nextDup=a,null===a?this._tail=s:a._prevDup=s,null===this._head}}class cc{constructor(){this.map=new Map}put(i){const s=i.trackById;let a=this.map.get(s);a||(a=new Bf,this.map.set(s,a)),a.add(i)}get(i,s){const d=this.map.get(i);return d?d.get(i,s):null}remove(i){const s=i.trackById;return this.map.get(s).remove(i)&&this.map.delete(s),i}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function dd(n,i,s){const a=n.previousIndex;if(null===a)return a;let d=0;return s&&a<s.length&&(d=s[a]),a+i+d}class qm{constructor(){}supports(i){return i instanceof Map||Xm(i)}create(){return new dx}}class dx{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(i){let s;for(s=this._mapHead;null!==s;s=s._next)i(s)}forEachPreviousItem(i){let s;for(s=this._previousMapHead;null!==s;s=s._nextPrevious)i(s)}forEachChangedItem(i){let s;for(s=this._changesHead;null!==s;s=s._nextChanged)i(s)}forEachAddedItem(i){let s;for(s=this._additionsHead;null!==s;s=s._nextAdded)i(s)}forEachRemovedItem(i){let s;for(s=this._removalsHead;null!==s;s=s._nextRemoved)i(s)}diff(i){if(i){if(!(i instanceof Map||Xm(i)))throw new It(900,!1)}else i=new Map;return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let s=this._mapHead;if(this._appendAfter=null,this._forEach(i,(a,d)=>{if(s&&s.key===d)this._maybeAddToChanges(s,a),this._appendAfter=s,s=s._next;else{const f=this._getOrCreateRecordForKey(d,a);s=this._insertBeforeOrAppend(s,f)}}),s){s._prev&&(s._prev._next=null),this._removalsHead=s;for(let a=s;null!==a;a=a._nextRemoved)a===this._mapHead&&(this._mapHead=null),this._records.delete(a.key),a._nextRemoved=a._next,a.previousValue=a.currentValue,a.currentValue=null,a._prev=null,a._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(i,s){if(i){const a=i._prev;return s._next=i,s._prev=a,i._prev=s,a&&(a._next=s),i===this._mapHead&&(this._mapHead=s),this._appendAfter=i,i}return this._appendAfter?(this._appendAfter._next=s,s._prev=this._appendAfter):this._mapHead=s,this._appendAfter=s,null}_getOrCreateRecordForKey(i,s){if(this._records.has(i)){const d=this._records.get(i);this._maybeAddToChanges(d,s);const f=d._prev,g=d._next;return f&&(f._next=g),g&&(g._prev=f),d._next=null,d._prev=null,d}const a=new Km(i);return this._records.set(i,a),a.currentValue=s,this._addToAdditions(a),a}_reset(){if(this.isDirty){let i;for(this._previousMapHead=this._mapHead,i=this._previousMapHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._changesHead;null!==i;i=i._nextChanged)i.previousValue=i.currentValue;for(i=this._additionsHead;null!=i;i=i._nextAdded)i.previousValue=i.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(i,s){Object.is(s,i.currentValue)||(i.previousValue=i.currentValue,i.currentValue=s,this._addToChanges(i))}_addToAdditions(i){null===this._additionsHead?this._additionsHead=this._additionsTail=i:(this._additionsTail._nextAdded=i,this._additionsTail=i)}_addToChanges(i){null===this._changesHead?this._changesHead=this._changesTail=i:(this._changesTail._nextChanged=i,this._changesTail=i)}_forEach(i,s){i instanceof Map?i.forEach(s):Object.keys(i).forEach(a=>s(i[a],a))}}class Km{constructor(i){this.key=i,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function js(){return new hd([new Ay])}let hd=(()=>{class n{static{this.\u0275prov=gi({token:n,providedIn:"root",factory:js})}constructor(s){this.factories=s}static create(s,a){if(null!=a){const d=a.factories.slice();s=s.concat(d)}return new n(s)}static extend(s){return{provide:n,useFactory:a=>n.create(s,a||js()),deps:[[n,new lf,new af]]}}find(s){const a=this.factories.find(d=>d.supports(s));if(null!=a)return a;throw new It(901,!1)}}return n})();function uc(){return new Zm([new qm])}let Zm=(()=>{class n{static{this.\u0275prov=gi({token:n,providedIn:"root",factory:uc})}constructor(s){this.factories=s}static create(s,a){if(a){const d=a.factories.slice();s=s.concat(d)}return new n(s)}static extend(s){return{provide:n,useFactory:a=>n.create(s,a||uc()),deps:[[n,new lf,new af]]}}find(s){const a=this.factories.find(d=>d.supports(s));if(a)return a;throw new It(901,!1)}}return n})();function dc(n,i,s,a,d=!1){for(;null!==s;){const f=i[s.index];null!==f&&a.push(Ri(f)),os(f)&&uh(f,a);const g=s.type;if(8&g)dc(n,i,s.child,a);else if(32&g){const _=Ef(s,i);let w;for(;w=_();)a.push(w)}else if(16&g){const _=ry(i,s);if(Array.isArray(_))a.push(..._);else{const w=ed(i[tr]);dc(w[Mt],w,_,a,!0)}}s=d?s.projectionNext:s.next}return a}function uh(n,i){for(let s=kr;s<n.length;s++){const a=n[s],d=a[Mt].firstChild;null!==d&&dc(a[Mt],a,d,i)}n[fs]!==n[Sr]&&i.push(n[fs])}let Jm=[];const Dy={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Br(n.lView)},consumerOnSignalRead(){this.lView[Eo]=this}};function Hf(n){return n.ngOriginalError}class Cl{constructor(){this._console=console}handleError(i){const s=this._findOriginalError(i);this._console.error("ERROR",i),s&&this._console.error("ORIGINAL ERROR",s)}_findOriginalError(i){let s=i&&Hf(i);for(;s&&Hf(s);)s=Hf(s);return s||null}}const zf=new an("",{providedIn:"root",factory:()=>Hn(Cl).handleError.bind(void 0)}),tg=new an("",{providedIn:"root",factory:()=>!1}),Qn={};function Ry(n){$f(Pi(),He(),Si()+n,!1)}function $f(n,i,s,a){if(!a)if(3==(3&i[un])){const f=n.preOrderCheckHooks;null!==f&&Gp(i,f,s)}else{const f=n.preOrderHooks;null!==f&&Yr(i,f,0,s)}gs(s)}function Al(n,i=We.Default){const s=He();return null===s?dr(n,i):Vc(nr(),s,nn(n),i)}function Xf(){throw new Error("invalid")}function fd(n,i,s,a,d,f,g,_,w,L,G){const K=i.blueprint.slice();return K[Sr]=d,K[un]=204|a,(null!==L||n&&2048&n[un])&&(K[un]|=2048),Za(K),K[U]=K[ja]=n,K[dt]=s,K[rr]=g||n&&n[rr],K[Tn]=_||n&&n[Tn],K[Cn]=w||n&&n[Cn]||null,K[P]=f,K[$a]=function Bv(){return kv++}(),K[Y]=G,K[Dc]=L,K[tr]=2==i.type?n[tr]:K,K}function pd(n,i,s,a,d){let f=n.data[i];if(null===f)f=function Yf(n,i,s,a,d){const f=Kh(),g=zo(),w=n.data[i]=function ky(n,i,s,a,d,f){let g=i?i.injectorIndex:-1,_=0;return So()&&(_|=128),{type:s,index:a,insertBeforeIndex:null,injectorIndex:g,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:_,providerIndexes:0,value:d,attrs:f,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:i,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,g?f:f&&f.parent,s,i,a,d);return null===n.firstChild&&(n.firstChild=w),null!==f&&(g?null==f.child&&null!==w.parent&&(f.child=w):null===f.next&&(f.next=w,w.prev=f)),w}(n,i,s,a,d),function kc(){return On.lFrame.inI18n}()&&(f.flags|=32);else if(64&f.type){f.type=s,f.value=a,f.attrs=d;const g=function Fc(){const n=On.lFrame,i=n.currentTNode;return n.isParent?i:i.parent}();f.injectorIndex=null===g?-1:g.injectorIndex}return Fs(f,!0),f}function fh(n,i,s,a){if(0===s)return-1;const d=i.length;for(let f=0;f<s;f++)i.push(a),n.blueprint.push(a),n.data.push(null);return d}function Py(n,i,s,a,d){const f=Si(),g=2&a;try{gs(-1),g&&i.length>Un&&$f(n,i,Un,!1),Is(g?2:0,d),s(a,d)}finally{gs(f),Is(g?3:1,d)}}function sg(n,i,s){if(zl(i)){const a=xe(null);try{const f=i.directiveEnd;for(let g=i.directiveStart;g<f;g++){const _=n.data[g];_.contentQueries&&_.contentQueries(1,s[g],g)}}finally{xe(a)}}}function ou(n,i,s){In()&&(function Qf(n,i,s,a){const d=s.directiveStart,f=s.directiveEnd;qa(s)&&function _x(n,i,s){const a=Xr(i,n),d=Ny(s);let g=16;s.signals?g=4096:s.onPush&&(g=64);const _=np(n,fd(n,d,null,g,a,i,null,n[rr].rendererFactory.createRenderer(a,s),null,null,null));n[i.index]=_}(i,s,n.data[d+s.componentOffset]),n.firstCreatePass||Bc(s,i),Zs(a,i);const g=s.initialInputs;for(let _=d;_<f;_++){const w=n.data[_],L=Jl(i,n,_,s);Zs(L,i),null!==g&&Mx(0,_-d,L,w,0,g),hr(w)&&(Zi(s.index,i)[dt]=Jl(i,n,_,s))}}(n,i,s,Xr(s,i)),64==(64&s.flags)&&ep(n,i,s))}function og(n,i,s=Xr){const a=i.localNames;if(null!==a){let d=i.index+1;for(let f=0;f<a.length;f+=2){const g=a[f+1],_=-1===g?s(i,n):n[g];n[d++]=_}}}function Ny(n){const i=n.tView;return null===i||i.incompleteFirstPass?n.tView=ag(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):i}function ag(n,i,s,a,d,f,g,_,w,L,G){const K=Un+a,de=K+d,ge=function px(n,i){const s=[];for(let a=0;a<i;a++)s.push(a<n?null:Qn);return s}(K,de),Ue="function"==typeof L?L():L;return ge[Mt]={type:n,blueprint:ge,template:s,queries:null,viewQuery:_,declTNode:i,data:ge.slice().fill(null,K),bindingStartIndex:K,expandoStartIndex:de,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof f?f():f,pipeRegistry:"function"==typeof g?g():g,firstChild:null,schemas:w,consts:Ue,incompleteFirstPass:!1,ssrId:G}}let Ly=n=>null;function lg(n,i,s,a){for(let d in n)if(n.hasOwnProperty(d)){s=null===s?{}:s;const f=n[d];null===a?mh(s,i,d,f):a.hasOwnProperty(d)&&mh(s,i,a[d],f)}return s}function mh(n,i,s,a){n.hasOwnProperty(s)?n[s].push(i,a):n[s]=[i,a]}function Js(n,i,s,a,d,f,g,_){const w=Xr(i,s);let G,L=i.inputs;!_&&null!=L&&(G=L[a])?(Or(n,s,G,a,d),qa(i)&&function cg(n,i){const s=Zi(i,n);16&s[un]||(s[un]|=64)}(s,i.index)):3&i.type&&(a=function qf(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(a),d=null!=g?g(d,i.value||"",a):d,f.setProperty(w,a,d))}function gh(n,i,s,a){if(In()){const d=null===a?null:{"":-1},f=function vx(n,i){const s=n.directiveRegistry;let a=null,d=null;if(s)for(let f=0;f<s.length;f++){const g=s[f];if(ki(i,g.selectors,!1))if(a||(a=[]),hr(g))if(null!==g.findHostDirectiveDefs){const _=[];d=d||new Map,g.findHostDirectiveDefs(g,_,d),a.unshift(..._,g),pc(n,i,_.length)}else a.unshift(g),pc(n,i,0);else d=d||new Map,g.findHostDirectiveDefs?.(g,a,d),a.push(g)}return null===a?null:[a,d]}(n,s);let g,_;null===f?g=_=null:[g,_]=f,null!==g&&fc(n,i,s,g,d,_),d&&function yx(n,i,s){if(i){const a=n.localNames=[];for(let d=0;d<i.length;d+=2){const f=s[i[d+1]];if(null==f)throw new It(-301,!1);a.push(i[d],f)}}}(s,a,d)}s.mergedAttrs=ro(s.mergedAttrs,s.attrs)}function fc(n,i,s,a,d,f){for(let L=0;L<a.length;L++)Vu(Bc(s,i),n,a[L].type);!function au(n,i,s){n.flags|=1,n.directiveStart=i,n.directiveEnd=i+s,n.providerIndexes=i}(s,n.data.length,a.length);for(let L=0;L<a.length;L++){const G=a[L];G.providersResolver&&G.providersResolver(G)}let g=!1,_=!1,w=fh(n,i,a.length,null);for(let L=0;L<a.length;L++){const G=a[L];s.mergedAttrs=ro(s.mergedAttrs,G.hostAttrs),vh(n,s,i,w,G),By(w,G,d),null!==G.contentQueries&&(s.flags|=4),(null!==G.hostBindings||null!==G.hostAttrs||0!==G.hostVars)&&(s.flags|=64);const K=G.type.prototype;!g&&(K.ngOnChanges||K.ngOnInit||K.ngDoCheck)&&((n.preOrderHooks??=[]).push(s.index),g=!0),!_&&(K.ngOnChanges||K.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(s.index),_=!0),w++}!function gx(n,i,s){const d=i.directiveEnd,f=n.data,g=i.attrs,_=[];let w=null,L=null;for(let G=i.directiveStart;G<d;G++){const K=f[G],de=s?s.get(K):null,Ue=de?de.outputs:null;w=lg(K.inputs,G,w,de?de.inputs:null),L=lg(K.outputs,G,L,Ue);const ut=null===w||null===g||Bl(i)?null:xx(w,G,g);_.push(ut)}null!==w&&(w.hasOwnProperty("class")&&(i.flags|=8),w.hasOwnProperty("style")&&(i.flags|=16)),i.initialInputs=_,i.inputs=w,i.outputs=L}(n,s,f)}function ep(n,i,s){const a=s.directiveStart,d=s.directiveEnd,f=s.index,g=function fa(){return On.lFrame.currentDirectiveIndex}();try{gs(f);for(let _=a;_<d;_++){const w=n.data[_],L=i[_];pa(_),(null!==w.hostBindings||0!==w.hostVars||null!==w.hostAttrs)&&tp(w,L)}}finally{gs(-1),pa(g)}}function tp(n,i){null!==n.hostBindings&&n.hostBindings(1,i)}function pc(n,i,s){i.componentOffset=s,(n.components??=[]).push(i.index)}function By(n,i,s){if(s){if(i.exportAs)for(let a=0;a<i.exportAs.length;a++)s[i.exportAs[a]]=n;hr(i)&&(s[""]=n)}}function vh(n,i,s,a,d){n.data[a]=d;const f=d.factory||(d.factory=xi(d.type)),g=new Jh(f,hr(d),Al);n.blueprint[a]=g,s[a]=g,function ug(n,i,s,a,d){const f=d.hostBindings;if(f){let g=n.hostBindingOpCodes;null===g&&(g=n.hostBindingOpCodes=[]);const _=~i.index;(function Jf(n){let i=n.length;for(;i>0;){const s=n[--i];if("number"==typeof s&&s<0)return s}return 0})(g)!=_&&g.push(_),g.push(s,a,f)}}(n,i,a,fh(n,s,d.hostVars,Qn),d)}function nl(n,i,s,a,d,f){const g=Xr(n,i);!function dg(n,i,s,a,d,f,g){if(null==f)n.removeAttribute(i,d,s);else{const _=null==g?sn(f):g(f,a||"",d);n.setAttribute(i,d,_,s)}}(i[Tn],g,f,n.value,s,a,d)}function Mx(n,i,s,a,d,f){const g=f[i];if(null!==g)for(let _=0;_<g.length;)Vy(a,s,g[_++],g[_++],g[_++])}function Vy(n,i,s,a,d){const f=xe(null);try{const g=n.inputTransforms;null!==g&&g.hasOwnProperty(a)&&(d=g[a].call(i,d)),null!==n.setInput?n.setInput(i,d,s,a):i[a]=d}finally{xe(f)}}function xx(n,i,s){let a=null,d=0;for(;d<s.length;){const f=s[d];if(0!==f)if(5!==f){if("number"==typeof f)break;if(n.hasOwnProperty(f)){null===a&&(a=[]);const g=n[f];for(let _=0;_<g.length;_+=2)if(g[_]===i){a.push(f,g[_+1],s[d+1]);break}}d+=2}else d+=2;else d+=4}return a}function Hy(n,i,s,a){return[n,!0,0,i,null,a,null,s,null,null]}function zy(n,i){const s=n.contentQueries;if(null!==s){const a=xe(null);try{for(let d=0;d<s.length;d+=2){const g=s[d+1];if(-1!==g){const _=n.data[g];b(s[d]),_.contentQueries(2,i[g],g)}}}finally{xe(a)}}}function np(n,i){return n[rs]?n[Pr][H]=i:n[rs]=i,n[Pr]=i,i}function hg(n,i,s){b(0);const a=xe(null);try{i(n,s)}finally{xe(a)}}function ip(n){return n[pe]||(n[pe]=[])}function Gy(n){return n.cleanup||(n.cleanup=[])}function rp(n,i){const s=n[Cn],a=s?s.get(Cl,null):null;a&&a.handleError(i)}function Or(n,i,s,a,d){for(let f=0;f<s.length;){const g=s[f++],_=s[f++];Vy(n.data[g],i[g],a,_,d)}}function yh(n,i,s,a){const d=i[un];if(256==(256&d))return;i[rr].inlineEffectRunner?.flush(),$(i);let g=null,_=null;(function Ex(n){return 2!==n.type})(n)&&(_=function dh(n){return n[Eo]??function Vf(n){const i=Jm.pop()??Object.create(Dy);return i.lView=n,i}(n)}(i),g=function $t(n){return n&&(n.nextProducerIndex=0),xe(n)}(_));try{Za(i),function ku(n){return On.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==s&&Py(n,i,s,2,a);const w=3==(3&d);if(w){const K=n.preOrderCheckHooks;null!==K&&Gp(i,K,null)}else{const K=n.preOrderHooks;null!==K&&Yr(i,K,0,null),Bu(i,0)}if(function jy(n){for(let i=_s(n);null!==i;i=Ms(i)){if(!(i[un]&Ya.HasTransplantedViews))continue;const s=i[pl];for(let a=0;a<s.length;a++){Fu(s[a])}}}(i),fg(i,0),null!==n.contentQueries&&zy(n,i),w){const K=n.contentCheckHooks;null!==K&&Gp(i,K)}else{const K=n.contentHooks;null!==K&&Yr(i,K,1),Bu(i,1)}!function rg(n,i){const s=n.hostBindingOpCodes;if(null!==s)try{for(let a=0;a<s.length;a++){const d=s[a];if(d<0)gs(~d);else{const f=d,g=s[++a],_=s[++a];ms(g,f),_(2,i[f])}}}finally{gs(-1)}}(n,i);const L=n.components;null!==L&&il(i,L,0);const G=n.viewQuery;if(null!==G&&hg(2,G,a),w){const K=n.viewCheckHooks;null!==K&&Gp(i,K)}else{const K=n.viewHooks;null!==K&&Yr(i,K,2),Bu(i,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),i[ca]){for(const K of i[ca])K();i[ca]=null}i[un]&=-73}catch(w){throw Br(i),w}finally{null!==_&&(function _n(n,i){if(xe(i),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(mt(n))for(let s=n.nextProducerIndex;s<n.producerNode.length;s++)Ye(n.producerNode[s],n.producerIndexOfThis[s]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}(_,g),function Qm(n){n.lView[Eo]!==n&&(n.lView=null,Jm.push(n))}(_)),$n()}}function fg(n,i){for(let s=_s(n);null!==s;s=Ms(s)){s[un]&=~Ya.HasChildViewsToRefresh;for(let a=kr;a<s.length;a++)op(s[a],i)}}function _h(n,i,s){op(Zi(i,n),s)}function op(n,i){gl(n)&&pg(n,i)}function pg(n,i){const a=n[Mt],d=n[un],f=n[Eo];let g=!!(0===i&&16&d);if(g||=!!(64&d&&0===i),g||=!!(1024&d),g||=!(!f?.dirty||!mi(f)),f&&(f.dirty=!1),n[un]&=-9217,g)yh(a,n,a.template,n[dt]);else if(8192&d){fg(n,1);const _=a.components;null!==_&&il(n,_,1)}}function il(n,i,s){for(let a=0;a<i.length;a++)_h(n,i[a],s)}function gd(n){for(n[rr].changeDetectionScheduler?.notify();n;){n[un]|=64;const i=ed(n);if(qn(n)&&!i)return n;n=i}return null}class vd{get rootNodes(){const i=this._lView,s=i[Mt];return dc(s,i,s.firstChild,[])}constructor(i,s,a=!0){this._lView=i,this._cdRefInjectingView=s,this.notifyErrorHandler=a,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[dt]}set context(i){this._lView[dt]=i}get destroyed(){return 256==(256&this._lView[un])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const i=this._lView[U];if(os(i)){const s=i[8],a=s?s.indexOf(this):-1;a>-1&&(qd(i,a),rf(s,a))}this._attachedToViewContainer=!1}wf(this._lView[Mt],this._lView)}onDestroy(i){uo(this._lView,i)}markForCheck(){gd(this._cdRefInjectingView||this._lView)}detach(){this._lView[un]&=-129}reattach(){Nc(this._lView),this._lView[un]|=128}detectChanges(){this._lView[un]|=1024,function md(n,i=!0){const s=n[rr],a=s.rendererFactory,d=s.afterRenderEventManager;a.begin?.(),d?.begin();try{!function sp(n){pg(n,0);let i=0;for(;Pc(n);){if(100===i)throw new It(103,!1);i++,pg(n,1)}}(n)}catch(g){throw i&&rp(n,g),g}finally{a.end?.(),s.inlineEffectRunner?.flush(),d?.end()}}(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new It(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function EM(n,i){Zd(n,i,i[Tn],2,null,null)}(this._lView[Mt],this._lView)}attachToAppRef(i){if(this._attachedToViewContainer)throw new It(902,!1);this._appRef=i,Nc(this._lView)}}let ap=(()=>{class n{static{this.__NG_ELEMENT_ID__=bx}}return n})();function bx(n){return function Sx(n,i,s){if(qa(n)&&!s){const a=Zi(n.index,i);return new vd(a,a)}return 47&n.type?new vd(i[tr],i):null}(nr(),He(),16==(16&n))}let cp=(()=>{class n{static{this.__NG_ELEMENT_ID__=gg}static{this.__NG_ENV_ID__=s=>s}}return n})();class up extends cp{constructor(i){super(),this._lView=i}onDestroy(i){return uo(this._lView,i),()=>function Uu(n,i){if(null===n[la])return;const s=n[la].indexOf(i);-1!==s&&n[la].splice(s,1)}(this._lView,i)}}function gg(){return new up(He())}const Zy=new Set;function _a(n){Zy.has(n)||(Zy.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function dp(n){return i=>{setTimeout(n,void 0,i)}}const rl=class Ra extends Zn.x{constructor(i=!1){super(),this.__isAsync=i}emit(i){super.next(i)}subscribe(i,s,a){let d=i,f=s||(()=>null),g=a;if(i&&"object"==typeof i){const w=i;d=w.next?.bind(w),f=w.error?.bind(w),g=w.complete?.bind(w)}this.__isAsync&&(f=dp(f),d&&(d=dp(d)),g&&(g=dp(g)));const _=super.subscribe({next:d,error:f,complete:g});return i instanceof yi.w0&&i.add(_),_}};function Jy(...n){}class xs{constructor({enableLongStackTrace:i=!1,shouldCoalesceEventChangeDetection:s=!1,shouldCoalesceRunChangeDetection:a=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new rl(!1),this.onMicrotaskEmpty=new rl(!1),this.onStable=new rl(!1),this.onError=new rl(!1),typeof Zone>"u")throw new It(908,!1);Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!a&&s,d.shouldCoalesceRunChangeDetection=a,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function Tx(){const n="function"==typeof Fn.requestAnimationFrame;let i=Fn[n?"requestAnimationFrame":"setTimeout"],s=Fn[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&i&&s){const a=i[Zone.__symbol__("OriginalDelegate")];a&&(i=a);const d=s[Zone.__symbol__("OriginalDelegate")];d&&(s=d)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:s}}().nativeRequestAnimationFrame,function _g(n){const i=()=>{!function Qy(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Fn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Mh(n),n.isCheckStableRunning=!0,hp(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Mh(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(s,a,d,f,g,_)=>{if(function xh(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(_))return s.invokeTask(d,f,g,_);try{return e_(n),s.invokeTask(d,f,g,_)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===f.type||n.shouldCoalesceRunChangeDetection)&&i(),t_(n)}},onInvoke:(s,a,d,f,g,_,w)=>{try{return e_(n),s.invoke(d,f,g,_,w)}finally{n.shouldCoalesceRunChangeDetection&&i(),t_(n)}},onHasTask:(s,a,d,f)=>{s.hasTask(d,f),a===d&&("microTask"==f.change?(n._hasPendingMicrotasks=f.microTask,Mh(n),hp(n)):"macroTask"==f.change&&(n.hasPendingMacrotasks=f.macroTask))},onHandleError:(s,a,d,f)=>(s.handleError(d,f),n.runOutsideAngular(()=>n.onError.emit(f)),!1)})}(d)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!xs.isInAngularZone())throw new It(909,!1)}static assertNotInAngularZone(){if(xs.isInAngularZone())throw new It(909,!1)}run(i,s,a){return this._inner.run(i,s,a)}runTask(i,s,a,d){const f=this._inner,g=f.scheduleEventTask("NgZoneEvent: "+d,i,cu,Jy,Jy);try{return f.runTask(g,s,a)}finally{f.cancelTask(g)}}runGuarded(i,s,a){return this._inner.runGuarded(i,s,a)}runOutsideAngular(i){return this._outer.run(i)}}const cu={};function hp(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Mh(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function e_(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function t_(n){n._nesting--,hp(n)}class Xb{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new rl,this.onMicrotaskEmpty=new rl,this.onStable=new rl,this.onError=new rl}run(i,s,a){return i.apply(s,a)}runGuarded(i,s,a){return i.apply(s,a)}runOutsideAngular(i){return i()}runTask(i,s,a,d){return i.apply(s,a)}}var mc=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(mc||{});const n_={destroy(){}};function Mg(n,i){!i&&function om(n){if(!Vn()&&!function Va(){return yo}())throw new It(-203,!1)}();const s=i?.injector??Hn(ga);if(!function $c(n){return"browser"===(n??Hn(ga)).get(Nv)}(s))return n_;_a("NgAfterNextRender");const a=s.get(Dl),d=a.handler??=new i_,f=i?.phase??mc.MixedReadWrite,g=()=>{d.unregister(w),_()},_=s.get(cp).onDestroy(g),w=new uu(s,f,()=>{g(),n()});return d.register(w),{destroy:g}}class uu{constructor(i,s,a){this.phase=s,this.callbackFn=a,this.zone=i.get(xs),this.errorHandler=i.get(Cl,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(i){this.errorHandler?.handleError(i)}}}class i_{constructor(){this.executingCallbacks=!1,this.buckets={[mc.EarlyRead]:new Set,[mc.Write]:new Set,[mc.MixedReadWrite]:new Set,[mc.Read]:new Set},this.deferredCallbacks=new Set}validateBegin(){if(this.executingCallbacks)throw new It(102,!1)}register(i){(this.executingCallbacks?this.deferredCallbacks:this.buckets[i.phase]).add(i)}unregister(i){this.buckets[i.phase].delete(i),this.deferredCallbacks.delete(i)}execute(){this.executingCallbacks=!0;for(const i of Object.values(this.buckets))for(const s of i)s.invoke();this.executingCallbacks=!1;for(const i of this.deferredCallbacks)this.buckets[i.phase].add(i);this.deferredCallbacks.clear()}destroy(){for(const i of Object.values(this.buckets))i.clear();this.deferredCallbacks.clear()}}let Dl=(()=>{class n{constructor(){this.renderDepth=0,this.handler=null,this.internalCallbacks=[]}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth){for(const s of this.internalCallbacks)s();this.internalCallbacks.length=0,this.handler?.execute()}}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static{this.\u0275prov=gi({token:n,providedIn:"root",factory:()=>new n})}}return n})();function _d(n,i){const s=Zi(i,n),a=s[Mt];!function Md(n,i){for(let s=i.length;s<n.blueprint.length;s++)i.push(n.blueprint[s])}(a,s);const d=s[Sr];null!==d&&null===s[Y]&&(s[Y]=od(d,s[Cn])),du(a,s,s[dt])}function du(n,i,s){$(i);try{const a=n.viewQuery;null!==a&&hg(1,a,s);const d=n.template;null!==d&&Py(n,i,d,1,s),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&zy(n,i),n.staticViewQueries&&hg(2,n.viewQuery,s);const f=n.components;null!==f&&function Dx(n,i){for(let s=0;s<i.length;s++)_d(n,i[s])}(i,f)}catch(a){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),a}finally{i[un]&=-5,$n()}}function fp(n,i,s){let a=s?n.styles:null,d=s?n.classes:null,f=0;if(null!==i)for(let g=0;g<i.length;g++){const _=i[g];"number"==typeof _?f=_:1==f?d=us(d,_):2==f&&(a=us(a,_+": "+i[++g]+";"))}s?n.styles=a:n.stylesWithoutHost=a,s?n.classes=d:n.classesWithoutHost=d}class Il extends cd{constructor(i){super(),this.ngModule=i}resolveComponentFactory(i){const s=ri(i);return new Ko(s,this.ngModule)}}function xg(n){const i=[];for(let s in n)n.hasOwnProperty(s)&&i.push({propName:n[s],templateName:s});return i}class Eh{constructor(i,s){this.injector=i,this.parentInjector=s}get(i,s,a){a=no(a);const d=this.injector.get(i,lc,a);return d!==lc||s===lc?d:this.parentInjector.get(i,s,a)}}class Ko extends Bm{get inputs(){const i=this.componentDef,s=i.inputTransforms,a=xg(i.inputs);if(null!==s)for(const d of a)s.hasOwnProperty(d.propName)&&(d.transform=s[d.propName]);return a}get outputs(){return xg(this.componentDef.outputs)}constructor(i,s){super(),this.componentDef=i,this.ngModule=s,this.componentType=i.type,this.selector=function wc(n){return n.map(Id).join(",")}(i.selectors),this.ngContentSelectors=i.ngContentSelectors?i.ngContentSelectors:[],this.isBoundToModule=!!s}create(i,s,a,d){let f=(d=d||this.ngModule)instanceof el?d:d?.injector;f&&null!==this.componentDef.getStandaloneInjector&&(f=this.componentDef.getStandaloneInjector(f)||f);const g=f?new Eh(i,f):i,_=g.get(Wm,null);if(null===_)throw new It(407,!1);const K={rendererFactory:_,sanitizer:g.get(ud,null),inlineEffectRunner:null,afterRenderEventManager:g.get(Dl,null),changeDetectionScheduler:g.get(ix,null)},de=_.createRenderer(null,this.componentDef),ge=this.componentDef.selectors[0][0]||"div",Ue=a?function ph(n,i,s,a){const f=a.get(tg,!1)||s===is.ShadowDom,g=n.selectRootElement(i,f);return function Oy(n){Ly(n)}(g),g}(de,a,this.componentDef.encapsulation,g):Sf(de,ge,function Ix(n){const i=n.toLowerCase();return"svg"===i?"svg":"math"===i?"math":null}(ge));let ut=512;this.componentDef.signals?ut|=4096:this.componentDef.onPush||(ut|=16);let Nt=null;null!==Ue&&(Nt=od(Ue,g,!0));const cn=ag(0,null,null,1,0,null,null,null,null,null,null),lt=fd(null,cn,null,ut,null,null,K,de,g,null,Nt);let ci,Hi;$(lt);try{const Ji=this.componentDef;let No,M0=null;Ji.findHostDirectiveDefs?(No=[],M0=new Map,Ji.findHostDirectiveDefs(Ji,No,M0),No.push(Ji)):No=[Ji];const xI=function sl(n,i){const s=n[Mt],a=Un;return n[a]=i,pd(s,a,2,"#host",null)}(lt,Ue),EI=function Yb(n,i,s,a,d,f,g){const _=d[Mt];!function qb(n,i,s,a){for(const d of n)i.mergedAttrs=ro(i.mergedAttrs,d.hostAttrs);null!==i.mergedAttrs&&(fp(i,i.mergedAttrs,!0),null!==s&&ay(a,s,i))}(a,n,i,g);let w=null;null!==i&&(w=od(i,d[Cn]));const L=f.rendererFactory.createRenderer(i,s);let G=16;s.signals?G=4096:s.onPush&&(G=64);const K=fd(d,Ny(s),null,G,d[n.index],n,f,L,null,null,w);return _.firstCreatePass&&pc(_,n,a.length-1),np(d,K),d[n.index]=K}(xI,Ue,Ji,No,lt,K,de);Hi=da(cn,Un),Ue&&function Kb(n,i,s,a){if(a)io(n,s,["ng-version","17.0.8"]);else{const{attrs:d,classes:f}=function Iu(n){const i=[],s=[];let a=1,d=2;for(;a<n.length;){let f=n[a];if("string"==typeof f)2===d?""!==f&&i.push(f,n[++a]):8===d&&s.push(f);else{if(!Ai(d))break;d=f}a++}return{attrs:i,classes:s}}(i.selectors[0]);d&&io(n,s,d),f&&f.length>0&&Tm(n,s,f.join(" "))}}(de,Ji,Ue,a),void 0!==s&&function Zb(n,i,s){const a=n.projection=[];for(let d=0;d<i.length;d++){const f=s[d];a.push(null!=f?Array.from(f):null)}}(Hi,this.ngContentSelectors,s),ci=function pp(n,i,s,a,d,f){const g=nr(),_=d[Mt],w=Xr(g,d);fc(_,d,g,s,null,a);for(let G=0;G<s.length;G++)Zs(Jl(d,_,g.directiveStart+G,g),d);ep(_,d,g),w&&Zs(w,d);const L=Jl(d,_,g.directiveStart+g.componentOffset,g);if(n[dt]=d[dt]=L,null!==f)for(const G of f)G(L,i);return sg(_,g,n),L}(EI,Ji,No,M0,lt,[Eg]),du(cn,lt,null)}finally{$n()}return new Rx(this.componentType,ci,ru(Hi,lt),lt,Hi)}}class Rx extends Ty{constructor(i,s,a,d,f){super(),this.location=a,this._rootLView=d,this._tNode=f,this.previousInputValues=null,this.instance=s,this.hostView=this.changeDetectorRef=new vd(d,void 0,!1),this.componentType=i}setInput(i,s){const a=this._tNode.inputs;let d;if(null!==a&&(d=a[i])){if(this.previousInputValues??=new Map,this.previousInputValues.has(i)&&Object.is(this.previousInputValues.get(i),s))return;const f=this._rootLView;Or(f[Mt],f,d,i,s),this.previousInputValues.set(i,s),gd(Zi(this._tNode.index,f))}}get injector(){return new wr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(i){this.hostView.onDestroy(i)}}function Eg(){const n=nr();Kl(He()[Mt],n)}function bg(n){let i=function bh(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),s=!0;const a=[n];for(;i;){let d;if(hr(n))d=i.\u0275cmp||i.\u0275dir;else{if(i.\u0275cmp)throw new It(903,!1);d=i.\u0275dir}if(d){if(s){a.push(d);const g=n;g.inputs=Sh(n.inputs),g.inputTransforms=Sh(n.inputTransforms),g.declaredInputs=Sh(n.declaredInputs),g.outputs=Sh(n.outputs);const _=d.hostBindings;_&&Px(n,_);const w=d.viewQuery,L=d.contentQueries;if(w&&r_(n,w),L&&wg(n,L),mr(n.inputs,d.inputs),mr(n.declaredInputs,d.declaredInputs),mr(n.outputs,d.outputs),null!==d.inputTransforms&&(null===g.inputTransforms&&(g.inputTransforms={}),mr(g.inputTransforms,d.inputTransforms)),hr(d)&&d.data.animation){const G=n.data;G.animation=(G.animation||[]).concat(d.data.animation)}}const f=d.features;if(f)for(let g=0;g<f.length;g++){const _=f[g];_&&_.ngInherit&&_(n),_===bg&&(s=!1)}}i=Object.getPrototypeOf(i)}!function Sg(n){let i=0,s=null;for(let a=n.length-1;a>=0;a--){const d=n[a];d.hostVars=i+=d.hostVars,d.hostAttrs=ro(d.hostAttrs,s=ro(s,d.hostAttrs))}}(a)}function Sh(n){return n===Ts?{}:n===hi?[]:n}function r_(n,i){const s=n.viewQuery;n.viewQuery=s?(a,d)=>{i(a,d),s(a,d)}:i}function wg(n,i){const s=n.contentQueries;n.contentQueries=s?(a,d,f)=>{i(a,d,f),s(a,d,f)}:i}function Px(n,i){const s=n.hostBindings;n.hostBindings=s?(a,d)=>{i(a,d),s(a,d)}:i}function c_(n){const i=n.inputConfig,s={};for(const a in i)if(i.hasOwnProperty(a)){const d=i[a];Array.isArray(d)&&d[2]&&(s[a]=d[2])}n.inputTransforms=s}function es(n,i,s){return!Object.is(n[i],s)&&(n[i]=s,!0)}function u_(n,i,s,a){const d=He();return es(d,Go(),i)&&(Pi(),nl(Wi(),d,n,i,s,a)),u_}function hu(n,i,s,a){return es(n,Go(),s)?i+sn(s)+a:Qn}function Ig(n,i){return n<<17|i<<2}function Io(n){return n>>17&32767}function Pl(n){return 2|n}function bd(n){return(131068&n)>>2}function p_(n,i){return-131069&n|i<<2}function Dh(n){return 1|n}function g_(n,i,s,a,d){const f=n[s+1],g=null===i;let _=a?Io(f):bd(f),w=!1;for(;0!==_&&(!1===w||g);){const G=n[_+1];Vx(n[_],i)&&(w=!0,n[_+1]=a?Dh(G):Pl(G)),_=a?Io(G):bd(G)}w&&(n[s+1]=a?Pl(f):Dh(f))}function Vx(n,i){return null===n||null==i||(Array.isArray(n)?n[1]:n)===i||!(!Array.isArray(n)||"string"!=typeof i)&&$u(n,i)>=0}const Ns={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function v_(n){return n.substring(Ns.key,Ns.keyEnd)}function Er(n,i){const s=Ns.textEnd;return s===i?-1:(i=Ns.keyEnd=function M_(n,i,s){for(;i<s&&n.charCodeAt(i)>32;)i++;return i}(n,Ns.key=i,s),Ih(n,i,s))}function Ih(n,i,s){for(;i<s&&n.charCodeAt(i)<=32;)i++;return i}function x_(n,i,s){const a=He();return es(a,Go(),i)&&Js(Pi(),Wi(),a,n,i,a[Tn],s,!1),x_}function gp(n,i,s,a,d){const g=d?"class":"style";Or(n,s,i.inputs[g],g,a)}function Rh(n,i,s){return xa(n,i,s,!1),Rh}function vp(n,i){return xa(n,i,null,!0),vp}function Rg(n){!function Ro(n,i,s,a){const d=Pi(),f=Ja(2);d.firstUpdatePass&&Pg(d,null,f,a);const g=He();if(s!==Qn&&es(g,f,s)){const _=d.data[Si()];if(Ph(_,a)&&!Xx(d,f)){let w=a?_.classesWithoutHost:_.stylesWithoutHost;null!==w&&(s=us(w,s||"")),gp(d,_,g,s,a)}else!function C_(n,i,s,a,d,f,g,_){d===Qn&&(d=hi);let w=0,L=0,G=0<d.length?d[0]:null,K=0<f.length?f[0]:null;for(;null!==G||null!==K;){const de=w<d.length?d[w+1]:void 0,ge=L<f.length?f[L+1]:void 0;let ut,Ue=null;G===K?(w+=2,L+=2,de!==ge&&(Ue=K,ut=ge)):null===K||null!==G&&G<K?(w+=2,Ue=G):(L+=2,Ue=K,ut=ge),null!==Ue&&Yx(n,i,s,a,Ue,ut,g,_),G=w<d.length?d[w]:null,K=L<f.length?f[L]:null}}(d,_,g,g[Tn],g[f+1],g[f+1]=function nS(n,i,s){if(null==s||""===s)return hi;const a=[],d=El(s);if(Array.isArray(d))for(let f=0;f<d.length;f++)n(a,d[f],!0);else if("object"==typeof d)for(const f in d)d.hasOwnProperty(f)&&n(a,f,d[f]);else"string"==typeof d&&i(a,d);return a}(n,i,s),a,f)}}(w_,Ol,n,!0)}function Ol(n,i){for(let s=function zx(n){return function __(n){Ns.key=0,Ns.keyEnd=0,Ns.value=0,Ns.valueEnd=0,Ns.textEnd=n.length}(n),Er(n,Ih(n,0,Ns.textEnd))}(i);s>=0;s=Er(i,s))qo(n,v_(i),!0)}function xa(n,i,s,a){const d=He(),f=Pi(),g=Ja(2);f.firstUpdatePass&&Pg(f,n,g,a),i!==Qn&&es(d,g,i)&&Yx(f,f.data[Si()],d,d[Tn],n,d[g+1]=function T_(n,i){return null==n||""===n||("string"==typeof i?n+=i:"object"==typeof n&&(n=Xi(El(n)))),n}(i,s),a,g)}function Xx(n,i){return i>=n.expandoStartIndex}function Pg(n,i,s,a){const d=n.data;if(null===d[s+1]){const f=d[Si()],g=Xx(n,s);Ph(f,a)&&null===i&&!g&&(i=!1),i=function tS(n,i,s,a){const d=function x(n){const i=On.lFrame.currentDirectiveIndex;return-1===i?null:n[i]}(n);let f=a?i.residualClasses:i.residualStyles;if(null===d)0===(a?i.classBindings:i.styleBindings)&&(s=Sd(s=b_(null,n,i,s,a),i.attrs,a),f=null);else{const g=i.directiveStylingLast;if(-1===g||n[g]!==d)if(s=b_(d,n,i,s,a),null===f){let w=function _c(n,i,s){const a=s?i.classBindings:i.styleBindings;if(0!==bd(a))return n[Io(a)]}(n,i,a);void 0!==w&&Array.isArray(w)&&(w=b_(null,n,i,w[1],a),w=Sd(w,i.attrs,a),function yp(n,i,s,a){n[Io(s?i.classBindings:i.styleBindings)]=a}(n,i,a,w))}else f=function Ng(n,i,s){let a;const d=i.directiveEnd;for(let f=1+i.directiveStylingLast;f<d;f++)a=Sd(a,n[f].hostAttrs,s);return Sd(a,i.attrs,s)}(n,i,a)}return void 0!==f&&(a?i.residualClasses=f:i.residualStyles=f),s}(d,f,i,a),function kx(n,i,s,a,d,f){let g=f?i.classBindings:i.styleBindings,_=Io(g),w=bd(g);n[a]=s;let G,L=!1;if(Array.isArray(s)?(G=s[1],(null===G||$u(s,G)>0)&&(L=!0)):G=s,d)if(0!==w){const de=Io(n[_+1]);n[a+1]=Ig(de,_),0!==de&&(n[de+1]=p_(n[de+1],a)),n[_+1]=function Fx(n,i){return 131071&n|i<<17}(n[_+1],a)}else n[a+1]=Ig(_,0),0!==_&&(n[_+1]=p_(n[_+1],a)),_=a;else n[a+1]=Ig(w,0),0===_?_=a:n[w+1]=p_(n[w+1],a),w=a;L&&(n[a+1]=Pl(n[a+1])),g_(n,G,a,!0),g_(n,G,a,!1),function Bx(n,i,s,a,d){const f=d?n.residualClasses:n.residualStyles;null!=f&&"string"==typeof i&&$u(f,i)>=0&&(s[a+1]=Dh(s[a+1]))}(i,G,n,a,f),g=Ig(_,w),f?i.classBindings=g:i.styleBindings=g}(d,f,i,s,g,a)}}function b_(n,i,s,a,d){let f=null;const g=s.directiveEnd;let _=s.directiveStylingLast;for(-1===_?_=s.directiveStart:_++;_<g&&(f=i[_],a=Sd(a,f.hostAttrs,d),f!==n);)_++;return null!==n&&(s.directiveStylingLast=_),a}function Sd(n,i,s){const a=s?1:2;let d=-1;if(null!==i)for(let f=0;f<i.length;f++){const g=i[f];"number"==typeof g?d=g:d===a&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),qo(n,g,!!s||i[++f]))}return void 0===n?null:n}function w_(n,i,s){const a=String(i);""!==a&&!a.includes(" ")&&qo(n,a,s)}function Yx(n,i,s,a,d,f,g,_){if(!(3&i.type))return;const w=n.data,L=w[_+1],G=function Ux(n){return 1==(1&n)}(L)?qx(w,i,s,d,bd(L),g):void 0;Og(G)||(Og(f)||function f_(n){return 2==(2&n)}(L)&&(f=qx(w,null,s,d,_,g)),function PM(n,i,s,a,d){if(i)d?n.addClass(s,a):n.removeClass(s,a);else{let f=-1===a.indexOf("-")?void 0:Qu.DashCase;null==d?n.removeStyle(s,a,f):("string"==typeof d&&d.endsWith("!important")&&(d=d.slice(0,-10),f|=Qu.Important),n.setStyle(s,a,d,f))}}(a,g,bo(Si(),s),d,f))}function qx(n,i,s,a,d,f){const g=null===i;let _;for(;d>0;){const w=n[d],L=Array.isArray(w),G=L?w[1]:w,K=null===G;let de=s[d+1];de===Qn&&(de=K?hi:void 0);let ge=K?qp(de,a):G===a?de:void 0;if(L&&!Og(ge)&&(ge=qp(w,a)),Og(ge)&&(_=ge,g))return _;const Ue=n[d+1];d=g?Io(Ue):bd(Ue)}if(null!==i){let w=f?i.residualClasses:i.residualStyles;null!=w&&(_=qp(w,a))}return _}function Og(n){return void 0!==n}function Ph(n,i){return 0!=(n.flags&(i?8:16))}let kg=(n,i)=>null;function Cd(n,i){return kg(n,i)}class lE{destroy(i){}updateValue(i,s){}swap(i,s){const a=Math.min(i,s),d=Math.max(i,s),f=this.detach(d);if(d-a>1){const g=this.detach(a);this.attach(a,f),this.attach(d,g)}else this.attach(a,f)}move(i,s){this.attach(s,this.detach(i))}}function Bg(n,i,s,a,d){return n===s&&Object.is(i,a)?1:Object.is(d(n,i),d(s,a))?-1:0}function Tp(n,i,s,a){return!(void 0===i||!i.has(a)||(n.attach(s,i.get(a)),i.delete(a),0))}function U_(n,i,s,a,d){if(Tp(n,i,a,s(a,d)))n.updateValue(a,d);else{const f=n.create(a,d);n.attach(a,f)}}function k_(n,i,s,a){const d=new Set;for(let f=i;f<=s;f++)d.add(a(f,n.at(f)));return d}class Jo{constructor(){this.kvMap=new Map,this._vMap=void 0}has(i){return this.kvMap.has(i)}delete(i){if(!this.has(i))return!1;const s=this.kvMap.get(i);return void 0!==this._vMap&&this._vMap.has(s)?(this.kvMap.set(i,this._vMap.get(s)),this._vMap.delete(s)):this.kvMap.delete(i),!0}get(i){return this.kvMap.get(i)}set(i,s){if(this.kvMap.has(i)){let a=this.kvMap.get(i);void 0===this._vMap&&(this._vMap=new Map);const d=this._vMap;for(;d.has(a);)a=d.get(a);d.set(a,s)}else this.kvMap.set(i,s)}forEach(i){for(let[s,a]of this.kvMap)if(i(a,s),void 0!==this._vMap){const d=this._vMap;for(;d.has(a);)a=d.get(a),i(a,s)}}}function al(n,i,s,a){const d=i.tView,_=fd(n,d,s,4096&n[un]?4096:16,null,i,null,null,null,a?.injector??null,a?.dehydratedView??null);_[xo]=n[i.index];const L=n[Gi];return null!==L&&(_[Gi]=L.createEmbeddedView(d)),du(d,_,s),_}function Vg(n,i){const s=kr+i;if(s<n.length)return n[s]}function yu(n,i){return!i||null===i.firstChild||Ju(n)}function _u(n,i,s,a=!0){const d=i[Mt];if(function SM(n,i,s,a){const d=kr+a,f=s.length;a>0&&(s[d-1][H]=i),a<f-kr?(i[H]=s[d],mv(s,kr+a,i)):(s.push(i),i[H]=null),i[U]=s;const g=i[xo];null!==g&&s!==g&&function wM(n,i){const s=n[pl];i[tr]!==i[U][U][tr]&&(n[un]|=Ya.HasTransplantedViews),null===s?n[pl]=[i]:s.push(i)}(g,i);const _=i[Gi];null!==_&&_.insertView(n),Nc(i),i[un]|=128}(d,i,n,s),a){const g=Sm(s,n),_=i[Tn],w=Cf(_,n[fs]);null!==w&&function xM(n,i,s,a,d,f){a[Sr]=d,a[P]=i,Zd(n,a,s,1,d,f)}(d,n[P],_,i,w,g)}const f=i[Y];null!==f&&null!==f.firstChild&&(f.firstChild=null)}function Lh(n,i){const s=qd(n,i);return void 0!==s&&wf(s[Mt],s),s}let Na=(()=>{class n{static{this.__NG_ELEMENT_ID__=uE}}return n})();function uE(){return V_(nr(),He())}const Hg=Na,B_=class extends Hg{constructor(i,s,a){super(),this._lContainer=i,this._hostTNode=s,this._hostLView=a}get element(){return ru(this._hostTNode,this._hostLView)}get injector(){return new wr(this._hostTNode,this._hostLView)}get parentInjector(){const i=Bd(this._hostTNode,this._hostLView);if(Ld(i)){const s=_l(i,this._hostLView),a=Qa(i);return new wr(s[Mt].data[a+8],s)}return new wr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(i){const s=Mc(this._lContainer);return null!==s&&s[i]||null}get length(){return this._lContainer.length-kr}createEmbeddedView(i,s,a){let d,f;"number"==typeof a?d=a:null!=a&&(d=a.index,f=a.injector);const g=Cd(this._lContainer,i.ssrId),_=i.createEmbeddedViewImpl(s||{},f,g);return this.insertImpl(_,d,yu(this._hostTNode,g)),_}createComponent(i,s,a,d,f){const g=i&&!function Hd(n){return"function"==typeof n}(i);let _;if(g)_=s;else{const Ue=s||{};_=Ue.index,a=Ue.injector,d=Ue.projectableNodes,f=Ue.environmentInjector||Ue.ngModuleRef}const w=g?i:new Ko(ri(i)),L=a||this.parentInjector;if(!f&&null==w.ngModule){const ut=(g?L:this.parentInjector).get(el,null);ut&&(f=ut)}const G=ri(w.componentType??{}),K=Cd(this._lContainer,G?.id??null),ge=w.create(L,d,K?.firstChild??null,f);return this.insertImpl(ge.hostView,_,yu(this._hostTNode,K)),ge}insert(i,s){return this.insertImpl(i,s,!0)}insertImpl(i,s,a){const d=i._lView;if(function Xl(n){return os(n[U])}(d)){const _=this.indexOf(i);if(-1!==_)this.detach(_);else{const w=d[U],L=new B_(w,w[P],w[U]);L.detach(L.indexOf(i))}}const f=this._adjustIndex(s),g=this._lContainer;return _u(g,d,f,a),i.attachToViewContainerRef(),mv(Oa(g),f,i),i}move(i,s){return this.insert(i,s)}indexOf(i){const s=Mc(this._lContainer);return null!==s?s.indexOf(i):-1}remove(i){const s=this._adjustIndex(i,-1),a=qd(this._lContainer,s);a&&(rf(Oa(this._lContainer),s),wf(a[Mt],a))}detach(i){const s=this._adjustIndex(i,-1),a=qd(this._lContainer,s);return a&&null!=rf(Oa(this._lContainer),s)?new vd(a):null}_adjustIndex(i,s=0){return i??this.length+s}};function Mc(n){return n[8]}function Oa(n){return n[8]||(n[8]=[])}function V_(n,i){let s;const a=i[n.index];return os(a)?s=a:(s=Hy(a,i,null,n),i[n.index]=s,np(i,s)),H_(s,i,n,a),new B_(s,n,i)}let H_=function z_(n,i,s,a){if(n[fs])return;let d;d=8&s.type?Ri(a):function dE(n,i){const s=n[Tn],a=s.createComment(""),d=Xr(i,n);return Yc(s,Cf(s,d),a,function DM(n,i){return n.nextSibling(i)}(s,d),!1),a}(i,s),n[fs]=d},Fh=(n,i,s)=>!1;function Mu(n,i,s,a,d,f,g,_){const w=He(),L=Pi(),G=n+Un,K=L.firstCreatePass?function G_(n,i,s,a,d,f,g,_,w){const L=i.consts,G=pd(i,n,4,g||null,co(L,_));gh(i,s,G,co(L,w)),Kl(i,G);const K=G.tView=ag(2,G,a,d,f,i.directiveRegistry,i.pipeRegistry,null,i.schemas,L,null);return null!==i.queries&&(i.queries.template(i,G),K.queries=i.queries.embeddedTView(G)),G}(G,L,w,i,s,a,d,f,g):L.data[G];Fs(K,!1);const de=Dp(L,w,K,n);ma()&&Tf(L,w,de,K),Zs(de,w);const ge=Hy(de,w,de,K);return w[G]=ge,np(w,ge),function Ap(n,i,s){return Fh(n,i,s)}(ge,K,w),Gl(K)&&ou(L,w,K),null!=g&&og(w,K,_),Mu}let Dp=function zg(n,i,s,a){return ql(!0),i[Tn].createComment("")};function j_(n,i,s){_a("NgControlFlow");const a=He(),d=Go(),f=Wg(a,Un+n);if(es(a,d,i)){const _=xe(null);try{if(Lh(f,0),-1!==i){const w=jg(a[Mt],Un+i),L=Cd(f,w.tView.ssrId);_u(f,al(a,w,s,{dehydratedView:L}),0,yu(w,L))}}finally{xe(_)}}else{const _=Vg(f,0);void 0!==_&&(_[dt]=s)}}class Os{constructor(i,s,a){this.lContainer=i,this.$implicit=s,this.$index=a}get $count(){return this.lContainer.length-kr}}function mo(n){return n}function lr(n,i){return i}class Gg{constructor(i,s,a){this.hasEmptyBlock=i,this.trackByFn=s,this.liveCollection=a}}function $_(n,i,s,a,d,f,g,_,w,L,G){_a("NgControlFlow");const K=void 0!==w,de=He(),ge=_?g.bind(de[tr][dt]):g,Ue=new Gg(K,ge);de[Un+n]=Ue,Mu(n+1,i,s,a,d,f),K&&Mu(n+2,w,L,G)}class mE extends lE{constructor(i,s,a){super(),this.lContainer=i,this.hostLView=s,this.templateTNode=a,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-kr}at(i){return this.getLView(i)[dt].$implicit}attach(i,s){const a=s[Y];this.needsIndexUpdate||=i!==this.length,_u(this.lContainer,s,i,yu(this.templateTNode,a))}detach(i){return this.needsIndexUpdate||=i!==this.length-1,function gE(n,i){return qd(n,i)}(this.lContainer,i)}create(i,s){const a=Cd(this.lContainer,this.templateTNode.tView.ssrId);return al(this.hostLView,this.templateTNode,new Os(this.lContainer,s,i),{dehydratedView:a})}destroy(i){wf(i[Mt],i)}updateValue(i,s){this.getLView(i)[dt].$implicit=s}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let i=0;i<this.length;i++)this.getLView(i)[dt].$index=i}getLView(i){return function vE(n,i){return Vg(n,i)}(this.lContainer,i)}}function X_(n){const i=xe(null),s=Si();try{const a=He(),d=a[Mt],f=a[s];if(void 0===f.liveCollection){const _=s+1,w=Wg(a,_),L=jg(d,_);f.liveCollection=new mE(w,a,L)}else f.liveCollection.reset();const g=f.liveCollection;if(function cE(n,i,s){let a,d,f=0,g=n.length-1;if(Array.isArray(i)){let _=i.length-1;for(;f<=g&&f<=_;){const w=n.at(f),L=i[f],G=Bg(f,w,f,L,s);if(0!==G){G<0&&n.updateValue(f,L),f++;continue}const K=n.at(g),de=i[_],ge=Bg(g,K,_,de,s);if(0!==ge){ge<0&&n.updateValue(g,de),g--,_--;continue}const Ue=s(f,w),ut=s(g,K),Nt=s(f,L);if(Object.is(Nt,ut)){const cn=s(_,de);Object.is(cn,Ue)?(n.swap(f,g),n.updateValue(g,de),_--,g--):n.move(g,f),n.updateValue(f,L),f++}else if(a??=new Jo,d??=k_(n,f,g,s),Tp(n,a,f,Nt))n.updateValue(f,L),f++,g++;else if(d.has(Nt))a.set(Ue,n.detach(f)),g--;else{const cn=n.create(f,i[f]);n.attach(f,cn),f++,g++}}for(;f<=_;)U_(n,a,s,f,i[f]),f++}else if(null!=i){const _=i[Symbol.iterator]();let w=_.next();for(;!w.done&&f<=g;){const L=n.at(f),G=w.value,K=Bg(f,L,f,G,s);if(0!==K)K<0&&n.updateValue(f,G),f++,w=_.next();else{a??=new Jo,d??=k_(n,f,g,s);const de=s(f,G);if(Tp(n,a,f,de))n.updateValue(f,G),f++,g++,w=_.next();else if(d.has(de)){const ge=s(f,L);a.set(ge,n.detach(f)),g--}else n.attach(f,n.create(f,G)),f++,g++,w=_.next()}}for(;!w.done;)U_(n,a,s,n.length,w.value),w=_.next()}for(;f<=g;)n.destroy(n.detach(g--));a?.forEach(_=>{n.destroy(_)})}(g,n,f.trackByFn),g.updateIndexes(),f.hasEmptyBlock){const _=Go(),w=0===g.length;if(es(a,_,w)){const L=s+2,G=Wg(a,L);if(w){const K=jg(d,L),de=Cd(G,K.tView.ssrId);_u(G,al(a,K,void 0,{dehydratedView:de}),0,yu(K,de))}else Lh(G,0)}}}finally{xe(i)}}function Wg(n,i){return n[i]}function jg(n,i){return da(n,i)}function nt(n,i,s,a){const d=He(),f=Pi(),g=Un+n,_=d[Tn],w=f.firstCreatePass?function vt(n,i,s,a,d,f){const g=i.consts,w=pd(i,n,2,a,co(g,d));return gh(i,s,w,co(g,f)),null!==w.attrs&&fp(w,w.attrs,!1),null!==w.mergedAttrs&&fp(w,w.mergedAttrs,!0),null!==i.queries&&i.queries.elementStart(i,w),w}(g,f,d,i,s,a):f.data[g],L=rn(f,d,w,_,i,n);d[g]=L;const G=Gl(w);return Fs(w,!0),ay(_,L,w),32!=(32&w.flags)&&ma()&&Tf(f,d,L,w),0===function Pd(){return On.lFrame.elementDepthCount}()&&Zs(L,d),function Yh(){On.lFrame.elementDepthCount++}(),G&&(ou(f,d,w),sg(f,w,d)),null!==a&&og(d,w),nt}function gn(){let n=nr();zo()?Yl():(n=n.parent,Fs(n,!1));const i=n;(function ho(n){return On.skipHydrationRootTNode===n})(i)&&function Lc(){On.skipHydrationRootTNode=null}(),function Oc(){On.lFrame.elementDepthCount--}();const s=Pi();return s.firstCreatePass&&(Kl(s,n),zl(n)&&s.queries.elementEnd(n)),null!=i.classesWithoutHost&&function cb(n){return 0!=(8&n.flags)}(i)&&gp(s,i,He(),i.classesWithoutHost,!0),null!=i.stylesWithoutHost&&function vn(n){return 0!=(16&n.flags)}(i)&&gp(s,i,He(),i.stylesWithoutHost,!1),gn}function Ht(n,i,s,a){return nt(n,i,s,a),gn(),Ht}let rn=(n,i,s,a,d,f)=>(ql(!0),Sf(a,d,function Wo(){return On.lFrame.currentNamespace}()));function ye(){return He()}function Wt(n,i,s){const a=He();return es(a,Go(),i)&&Js(Pi(),Wi(),a,n,i,a[Tn],s,!0),Wt}const ct=void 0;var Zt=["en",[["a","p"],["AM","PM"],ct],[["AM","PM"],ct,ct],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ct,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ct,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ct,"{1} 'at' {0}",ct],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Qt(n){const s=Math.floor(Math.abs(n)),a=n.toString().replace(/^[^.]*\.?/,"").length;return 1===s&&0===a?1:5}];let ei={};function ks(n){const i=function Eu(n){return n.toLowerCase().replace(/_/g,"-")}(n);let s=ll(i);if(s)return s;const a=i.split("-")[0];if(s=ll(a),s)return s;if("en"===a)return Zt;throw new It(701,!1)}function ba(n){return ks(n)[xu.PluralCase]}function ll(n){return n in ei||(ei[n]=Fn.ng&&Fn.ng.common&&Fn.ng.common.locales&&Fn.ng.common.locales[n]),ei[n]}var xu=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(xu||{});const bu="en-US";let Yg=bu;function wE(n){return!!n&&"function"==typeof n.then}function DS(n){return!!n&&"function"==typeof n.subscribe}function CE(n,i,s,a){const d=He(),f=Pi(),g=nr();return function RS(n,i,s,a,d,f,g){const _=Gl(a),L=n.firstCreatePass&&Gy(n),G=i[dt],K=ip(i);let de=!0;if(3&a.type||g){const ut=Xr(a,i),Nt=g?g(ut):ut,cn=K.length,lt=g?Hi=>g(Ri(Hi[a.index])):a.index;let ci=null;if(!g&&_&&(ci=function IT(n,i,s,a){const d=n.cleanup;if(null!=d)for(let f=0;f<d.length-1;f+=2){const g=d[f];if(g===s&&d[f+1]===a){const _=i[pe],w=d[f+2];return _.length>w?_[w]:null}"string"==typeof g&&(f+=2)}return null}(n,i,d,a.index)),null!==ci)(ci.__ngLastListenerFn__||ci).__ngNextListenerFn__=f,ci.__ngLastListenerFn__=f,de=!1;else{f=NS(a,i,G,f,!1);const Hi=s.listen(Nt,d,f);K.push(f,Hi),L&&L.push(d,lt,cn,cn+1)}}else f=NS(a,i,G,f,!1);const ge=a.outputs;let Ue;if(de&&null!==ge&&(Ue=ge[d])){const ut=Ue.length;if(ut)for(let Nt=0;Nt<ut;Nt+=2){const Ji=i[Ue[Nt]][Ue[Nt+1]].subscribe(f),No=K.length;K.push(f,Ji),L&&L.push(d,a.index,No,-(No+1))}}}(f,d,d[Tn],g,n,i,a),CE}function PS(n,i,s,a){try{return Is(6,i,s),!1!==s(a)}catch(d){return rp(n,d),!1}finally{Is(7,i,s)}}function NS(n,i,s,a,d){return function f(g){if(g===Function)return a;gd(n.componentOffset>-1?Zi(n.index,i):i);let w=PS(i,s,a,g),L=f.__ngNextListenerFn__;for(;L;)w=PS(i,s,L,g)&&w,L=L.__ngNextListenerFn__;return d&&!1===w&&g.preventDefault(),w}}function OS(n=1){return function kn(n){return(On.lFrame.contextLView=function Vp(n,i){for(;n>0;)i=i[ja],n--;return i}(n,On.lFrame.contextLView))[dt]}(n)}function RT(n,i){let s=null;const a=function Sc(n){const i=n.attrs;if(null!=i){const s=i.indexOf(5);if(!(1&s))return i[s+1]}return null}(n);for(let d=0;d<i.length;d++){const f=i[d];if("*"!==f){if(null===a?ki(n,f,!0):Gh(a,f))return d}else s=d}return s}function LS(n){const i=He()[tr][P];if(!i.projection){const a=i.projection=zd(n?n.length:1,null),d=a.slice();let f=i.child;for(;null!==f;){const g=n?RT(f,n):0;null!==g&&(d[g]?d[g].projectionNext=f:a[g]=f,d[g]=f),f=f.next}}}function FS(n,i=0,s){const a=He(),d=Pi(),f=pd(d,Un+n,16,null,s||null);null===f.projection&&(f.projection=i),Yl(),(!a[Y]||So())&&32!=(32&f.flags)&&function IM(n,i,s){oy(i[Tn],0,i,s,Em(n,s,i),ey(s.parent||i[P],s,i))}(d,a,f)}function TE(n,i,s){return AE(n,"",i,"",s),TE}function AE(n,i,s,a,d){const f=He(),g=hu(f,i,s,a);return g!==Qn&&Js(Pi(),Wi(),f,n,g,f[Tn],d,!1),AE}function ew(n,i=""){const s=He(),a=Pi(),d=n+Un,f=a.firstCreatePass?pd(a,d,1,i,null):a.data[d],g=tw(a,s,f,i,n);s[d]=g,ma()&&Tf(a,s,g,f),Fs(f,!1)}let tw=(n,i,s,a,d)=>(ql(!0),function bf(n,i){return n.createText(i)}(i[Tn],a));function DE(n){return r0("",n,""),DE}function r0(n,i,s){const a=He(),d=hu(a,n,i,s);return d!==Qn&&function ya(n,i,s){const a=bo(i,n);!function qv(n,i,s){n.setValue(i,s)}(n[Tn],a,s)}(a,Si(),d),r0}function IE(n,i,s,a,d){if(n=nn(n),Array.isArray(n))for(let f=0;f<n.length;f++)IE(n[f],i,s,a,d);else{const f=Pi(),g=He(),_=nr();let w=Wc(n)?n:nn(n.provide);const L=Cv(n),G=1048575&_.providerIndexes,K=_.directiveStart,de=_.providerIndexes>>20;if(Wc(n)||!n.multi){const ge=new Jh(L,d,Al),Ue=PE(w,i,d?G:G+de,K);-1===Ue?(Vu(Bc(_,g),f,w),RE(f,n,i.length),i.push(w),_.directiveStart++,_.directiveEnd++,d&&(_.providerIndexes+=1048576),s.push(ge),g.push(ge)):(s[Ue]=ge,g[Ue]=ge)}else{const ge=PE(w,i,G+de,K),Ue=PE(w,i,G,G+de),Nt=Ue>=0&&s[Ue];if(d&&!Nt||!d&&!(ge>=0&&s[ge])){Vu(Bc(_,g),f,w);const cn=function YT(n,i,s,a,d){const f=new Jh(n,s,Al);return f.multi=[],f.index=i,f.componentProviders=0,uw(f,d,a&&!s),f}(d?XT:$T,s.length,d,a,L);!d&&Nt&&(s[Ue].providerFactory=cn),RE(f,n,i.length,0),i.push(w),_.directiveStart++,_.directiveEnd++,d&&(_.providerIndexes+=1048576),s.push(cn),g.push(cn)}else RE(f,n,ge>-1?ge:Ue,uw(s[d?Ue:ge],L,!d&&a));!d&&a&&Nt&&s[Ue].componentProviders++}}}function RE(n,i,s,a){const d=Wc(i),f=function Y0(n){return!!n.useClass}(i);if(d||f){const w=(f?nn(i.useClass):i).prototype.ngOnDestroy;if(w){const L=n.destroyHooks||(n.destroyHooks=[]);if(!d&&i.multi){const G=L.indexOf(s);-1===G?L.push(s,[a,w]):L[G+1].push(a,w)}else L.push(s,w)}}}function uw(n,i,s){return s&&n.componentProviders++,n.multi.push(i)-1}function PE(n,i,s,a){for(let d=s;d<a;d++)if(i[d]===n)return d;return-1}function $T(n,i,s,a){return NE(this.multi,[])}function XT(n,i,s,a){const d=this.multi;let f;if(this.providerFactory){const g=this.providerFactory.componentProviders,_=Jl(s,s[Mt],this.providerFactory.index,a);f=_.slice(0,g),NE(d,f);for(let w=g;w<_.length;w++)f.push(_[w])}else f=[],NE(d,f);return f}function NE(n,i){for(let s=0;s<n.length;s++)i.push((0,n[s])());return i}function dw(n,i=[]){return s=>{s.providersResolver=(a,d)=>function jT(n,i,s){const a=Pi();if(a.firstCreatePass){const d=hr(n);IE(s,a.data,a.blueprint,d,!0),IE(i,a.data,a.blueprint,d,!1)}}(a,d?d(n):n,i)}}class Hh{}class hw{}function qT(n,i){return new OE(n,i??null,[])}class OE extends Hh{constructor(i,s,a){super(),this._parent=s,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Il(this);const d=Rr(i);this._bootstrapComponents=va(d.bootstrap),this._r3Injector=Rv(i,s,[{provide:Hh,useValue:this},{provide:cd,useValue:this.componentFactoryResolver},...a],Xi(i),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(i)}get injector(){return this._r3Injector}destroy(){const i=this._r3Injector;!i.destroyed&&i.destroy(),this.destroyCbs.forEach(s=>s()),this.destroyCbs=null}onDestroy(i){this.destroyCbs.push(i)}}class LE extends hw{constructor(i){super(),this.moduleType=i}create(i){return new OE(this.moduleType,i,[])}}class fw extends Hh{constructor(i){super(),this.componentFactoryResolver=new Il(this),this.instance=null;const s=new Yu([...i.providers,{provide:Hh,useValue:this},{provide:cd,useValue:this.componentFactoryResolver}],i.parent||ff(),i.debugName,new Set(["environment"]));this.injector=s,i.runEnvironmentInitializers&&s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(i){this.injector.onDestroy(i)}}function pw(n,i,s=null){return new fw({providers:n,parent:i,debugName:s,runEnvironmentInitializers:!0}).injector}let ZT=(()=>{class n{constructor(s){this._injector=s,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(s){if(!s.standalone)return null;if(!this.cachedInjectors.has(s)){const a=Ev(0,s.type),d=a.length>0?pw([a],this._injector,`Standalone[${s.type.name}]`):null;this.cachedInjectors.set(s,d)}return this.cachedInjectors.get(s)}ngOnDestroy(){try{for(const s of this.cachedInjectors.values())null!==s&&s.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=gi({token:n,providedIn:"environment",factory:()=>new n(dr(el))})}}return n})();function mw(n){_a("NgStandalone"),n.getStandaloneInjector=i=>i.get(ZT).getOrCreateStandaloneInjector(n)}function bw(n,i,s,a){return Sw(He(),Us(),n,i,s,a)}function Sw(n,i,s,a,d,f){const g=i+s;return es(n,g,d)?function ol(n,i,s){return n[i]=s}(n,g+1,f?a.call(f,d):a(d)):function Zg(n,i){const s=n[i];return s===Qn?void 0:s}(n,g+1)}function Dw(n,i){const s=Pi();let a;const d=n+Un;s.firstCreatePass?(a=function vA(n,i){if(i)for(let s=i.length-1;s>=0;s--){const a=i[s];if(n===a.name)return a}}(i,s.pipeRegistry),s.data[d]=a,a.onDestroy&&(s.destroyHooks??=[]).push(d,a.onDestroy)):a=s.data[d];const f=a.factory||(a.factory=xi(a.type)),_=Bt(Al);try{const w=si(!1),L=f();return si(w),function PT(n,i,s,a){s>=n.data.length&&(n.data[s]=null,n.blueprint[s]=null),i[s]=a}(s,He(),d,L),L}finally{Bt(_)}}function Iw(n,i,s){const a=n+Un,d=He(),f=function lo(n,i){return n[i]}(d,a);return function Jg(n,i){return n[Mt].data[i].pure}(d,a)?Sw(d,Us(),i,f.transform,s,f):f.transform(s)}function EA(){return this._results[Symbol.iterator]()}class UE{get changes(){return this._changes??=new rl}constructor(i=!1){this._emitDistinctChangesOnly=i,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const s=UE.prototype;s[Symbol.iterator]||(s[Symbol.iterator]=EA)}get(i){return this._results[i]}map(i){return this._results.map(i)}filter(i){return this._results.filter(i)}find(i){return this._results.find(i)}reduce(i,s){return this._results.reduce(i,s)}forEach(i){this._results.forEach(i)}some(i){return this._results.some(i)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(i,s){this.dirty=!1;const a=function To(n){return n.flat(Number.POSITIVE_INFINITY)}(i);(this._changesDetected=!function D0(n,i,s){if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++){let d=n[a],f=i[a];if(s&&(d=s(d),f=s(f)),f!==d)return!1}return!0}(this._results,a,s))&&(this._results=a,this.length=a.length,this.last=a[this.length-1],this.first=a[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}let Qg=(()=>{class n{static{this.__NG_ELEMENT_ID__=wA}}return n})();const bA=Qg,SA=class extends bA{constructor(i,s,a){super(),this._declarationLView=i,this._declarationTContainer=s,this.elementRef=a}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(i,s){return this.createEmbeddedViewImpl(i,s)}createEmbeddedViewImpl(i,s,a){const d=al(this._declarationLView,this._declarationTContainer,i,{injector:s,dehydratedView:a});return new vd(d)}};function wA(){return a0(nr(),He())}function a0(n,i){return 4&n.type?new SA(i,n,ru(n,i)):null}class kE{constructor(i){this.queryList=i,this.matches=null}clone(){return new kE(this.queryList)}setDirty(){this.queryList.setDirty()}}class BE{constructor(i=[]){this.queries=i}createEmbeddedView(i){const s=i.queries;if(null!==s){const a=null!==i.contentQueries?i.contentQueries[0]:s.length,d=[];for(let f=0;f<a;f++){const g=s.getByIndex(f);d.push(this.queries[g.indexInDeclarationView].clone())}return new BE(d)}return null}insertView(i){this.dirtyQueriesWithMatches(i)}detachView(i){this.dirtyQueriesWithMatches(i)}dirtyQueriesWithMatches(i){for(let s=0;s<this.queries.length;s++)null!==Bw(i,s).matches&&this.queries[s].setDirty()}}class Rw{constructor(i,s,a=null){this.predicate=i,this.flags=s,this.read=a}}class VE{constructor(i=[]){this.queries=i}elementStart(i,s){for(let a=0;a<this.queries.length;a++)this.queries[a].elementStart(i,s)}elementEnd(i){for(let s=0;s<this.queries.length;s++)this.queries[s].elementEnd(i)}embeddedTView(i){let s=null;for(let a=0;a<this.length;a++){const d=null!==s?s.length:0,f=this.getByIndex(a).embeddedTView(i,d);f&&(f.indexInDeclarationView=a,null!==s?s.push(f):s=[f])}return null!==s?new VE(s):null}template(i,s){for(let a=0;a<this.queries.length;a++)this.queries[a].template(i,s)}getByIndex(i){return this.queries[i]}get length(){return this.queries.length}track(i){this.queries.push(i)}}class HE{constructor(i,s=-1){this.metadata=i,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=s}elementStart(i,s){this.isApplyingToNode(s)&&this.matchTNode(i,s)}elementEnd(i){this._declarationNodeIndex===i.index&&(this._appliesToNextNode=!1)}template(i,s){this.elementStart(i,s)}embeddedTView(i,s){return this.isApplyingToNode(i)?(this.crossesNgTemplate=!0,this.addMatch(-i.index,s),new HE(this.metadata)):null}isApplyingToNode(i){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const s=this._declarationNodeIndex;let a=i.parent;for(;null!==a&&8&a.type&&a.index!==s;)a=a.parent;return s===(null!==a?a.index:-1)}return this._appliesToNextNode}matchTNode(i,s){const a=this.metadata.predicate;if(Array.isArray(a))for(let d=0;d<a.length;d++){const f=a[d];this.matchTNodeWithReadOption(i,s,CA(s,f)),this.matchTNodeWithReadOption(i,s,ef(s,i,f,!1,!1))}else a===Qg?4&s.type&&this.matchTNodeWithReadOption(i,s,-1):this.matchTNodeWithReadOption(i,s,ef(s,i,a,!1,!1))}matchTNodeWithReadOption(i,s,a){if(null!==a){const d=this.metadata.read;if(null!==d)if(d===su||d===Na||d===Qg&&4&s.type)this.addMatch(s.index,-2);else{const f=ef(s,i,d,!1,!1);null!==f&&this.addMatch(s.index,f)}else this.addMatch(s.index,a)}}addMatch(i,s){null===this.matches?this.matches=[i,s]:this.matches.push(i,s)}}function CA(n,i){const s=n.localNames;if(null!==s)for(let a=0;a<s.length;a+=2)if(s[a]===i)return s[a+1];return null}function AA(n,i,s,a){return-1===s?function TA(n,i){return 11&n.type?ru(n,i):4&n.type?a0(n,i):null}(i,n):-2===s?function DA(n,i,s){return s===su?ru(i,n):s===Qg?a0(i,n):s===Na?V_(i,n):void 0}(n,i,a):Jl(n,n[Mt],s,i)}function Pw(n,i,s,a){const d=i[Gi].queries[a];if(null===d.matches){const f=n.data,g=s.matches,_=[];for(let w=0;w<g.length;w+=2){const L=g[w];_.push(L<0?null:AA(i,f[L],g[w+1],s.metadata.read))}d.matches=_}return d.matches}function zE(n,i,s,a){const d=n.queries.getByIndex(s),f=d.matches;if(null!==f){const g=Pw(n,i,d,s);for(let _=0;_<f.length;_+=2){const w=f[_];if(w>0)a.push(g[_/2]);else{const L=f[_+1],G=i[-w];for(let K=kr;K<G.length;K++){const de=G[K];de[xo]===de[U]&&zE(de[Mt],de,L,a)}if(null!==G[pl]){const K=G[pl];for(let de=0;de<K.length;de++){const ge=K[de];zE(ge[Mt],ge,L,a)}}}}}return a}function Nw(n){const i=He(),s=Pi(),a=D();b(a+1);const d=Bw(s,a);if(n.dirty&&function ml(n){return 4==(4&n[un])}(i)===(2==(2&d.metadata.flags))){if(null===d.matches)n.reset([]);else{const f=d.crossesNgTemplate?zE(s,i,a,[]):Pw(s,i,d,a);n.reset(f,wl),n.notifyOnChanges()}return!0}return!1}function Ow(n,i,s){const a=Pi();a.firstCreatePass&&(kw(a,new Rw(n,i,s),-1),2==(2&i)&&(a.staticViewQueries=!0)),Uw(a,He(),i)}function Lw(n,i,s,a){const d=Pi();if(d.firstCreatePass){const f=nr();kw(d,new Rw(i,s,a),f.index),function RA(n,i){const s=n.contentQueries||(n.contentQueries=[]);i!==(s.length?s[s.length-1]:-1)&&s.push(n.queries.length-1,i)}(d,n),2==(2&s)&&(d.staticContentQueries=!0)}Uw(d,He(),s)}function Fw(){return function IA(n,i){return n[Gi].queries[i].queryList}(He(),D())}function Uw(n,i,s){const a=new UE(4==(4&s));(function Uy(n,i,s,a){const d=ip(i);d.push(s),n.firstCreatePass&&Gy(n).push(a,d.length-1)})(n,i,a,a.destroy),null===i[Gi]&&(i[Gi]=new BE),i[Gi].queries.push(new kE(a))}function kw(n,i,s){null===n.queries&&(n.queries=new VE),n.queries.track(new HE(i,s))}function Bw(n,i){return n.queries.getByIndex(i)}class tC{constructor(i){this.full=i;const s=i.split(".");this.major=s[0],this.minor=s[1],this.patch=s.slice(2).join(".")}}let nC=(()=>{class n{log(s){console.log(s)}warn(s){console.warn(s)}static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275prov=gi({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();class eD{constructor(i,s){this.ngModuleFactory=i,this.componentFactories=s}}let tD=(()=>{class n{compileModuleSync(s){return new LE(s)}compileModuleAsync(s){return Promise.resolve(this.compileModuleSync(s))}compileModuleAndAllComponentsSync(s){const a=this.compileModuleSync(s),f=va(Rr(s).declarations).reduce((g,_)=>{const w=ri(_);return w&&g.push(new Ko(w)),g},[]);return new eD(a,f)}compileModuleAndAllComponentsAsync(s){return Promise.resolve(this.compileModuleAndAllComponentsSync(s))}clearCache(){}clearCacheFor(s){}getModuleId(s){}static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275prov=gi({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),XE=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Hr.X(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const s=this.taskId++;return this.pendingTasks.add(s),s}remove(s){this.pendingTasks.delete(s),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275prov=gi({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const aC=new an(""),lC=new an("");let qE,CD=(()=>{class n{constructor(s,a,d){this._ngZone=s,this.registry=a,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,qE||(function TD(n){qE=n}(d),d.addToWindow(a)),this._watchAngularEvents(),s.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{xs.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let s=this._callbacks.pop();clearTimeout(s.timeoutId),s.doneCb(this._didWork)}this._didWork=!1});else{let s=this.getPendingTasks();this._callbacks=this._callbacks.filter(a=>!a.updateCb||!a.updateCb(s)||(clearTimeout(a.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(s=>({source:s.source,creationLocation:s.creationLocation,data:s.data})):[]}addCallback(s,a,d){let f=-1;a&&a>0&&(f=setTimeout(()=>{this._callbacks=this._callbacks.filter(g=>g.timeoutId!==f),s(this._didWork,this.getPendingTasks())},a)),this._callbacks.push({doneCb:s,timeoutId:f,updateCb:d})}whenStable(s,a,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(s,a,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(s){this.registry.registerApplication(s,this)}unregisterApplication(s){this.registry.unregisterApplication(s)}findProviders(s,a,d){return[]}static{this.\u0275fac=function(a){return new(a||n)(dr(xs),dr(cC),dr(lC))}}static{this.\u0275prov=gi({token:n,factory:n.\u0275fac})}}return n})(),cC=(()=>{class n{constructor(){this._applications=new Map}registerApplication(s,a){this._applications.set(s,a)}unregisterApplication(s){this._applications.delete(s)}unregisterAllApplications(){this._applications.clear()}getTestability(s){return this._applications.get(s)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(s,a=!0){return qE?.findTestabilityInTree(this,s,a)??null}static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275prov=gi({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();const uC=new an("Application Initializer");let KE=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((s,a)=>{this.resolve=s,this.reject=a}),this.appInits=Hn(uC,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const s=[];for(const d of this.appInits){const f=d();if(wE(f))s.push(f);else if(DS(f)){const g=new Promise((_,w)=>{f.subscribe({complete:_,error:w})});s.push(g)}}const a=()=>{this.done=!0,this.resolve()};Promise.all(s).then(()=>{a()}).catch(d=>{this.reject(d)}),0===s.length&&a(),this.initialized=!0}static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275prov=gi({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const ZE=new an("appBootstrapListener");function fC(n,i){return Array.isArray(i)?i.reduce(fC,n):{...n,...i}}let Fp=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Hn(zf),this.componentTypes=[],this.components=[],this.isStable=Hn(XE).hasPendingTasks.pipe((0,Qi.U)(s=>!s)),this._injector=Hn(el)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(s,a){const d=s instanceof Bm;if(!this._injector.get(KE).done)throw!d&&oo(s),new It(405,!1);let g;g=d?s:this._injector.get(cd).resolveComponentFactory(s),this.componentTypes.push(g.componentType);const _=function DD(n){return n.isBoundToModule}(g)?void 0:this._injector.get(Hh),L=g.create(ga.NULL,[],a||g.selector,_),G=L.location.nativeElement,K=L.injector.get(aC,null);return K?.registerApplication(G),L.onDestroy(()=>{this.detachView(L.hostView),u0(this.components,L),K?.unregisterApplication(G)}),this._loadComponent(L),L}tick(){if(this._runningTick)throw new It(101,!1);try{this._runningTick=!0;for(let s of this._views)s.detectChanges()}catch(s){this.internalErrorHandler(s)}finally{this._runningTick=!1}}attachView(s){const a=s;this._views.push(a),a.attachToAppRef(this)}detachView(s){const a=s;u0(this._views,a),a.detachFromAppRef()}_loadComponent(s){this.attachView(s.hostView),this.tick(),this.components.push(s);const a=this._injector.get(ZE,[]);[...this._bootstrapListeners,...a].forEach(d=>d(s))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(s=>s()),this._views.slice().forEach(s=>s.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(s){return this._destroyListeners.push(s),()=>u0(this._destroyListeners,s)}destroy(){if(this._destroyed)throw new It(406,!1);const s=this._injector;s.destroy&&!s.destroyed&&s.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275prov=gi({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function u0(n,i){const s=n.indexOf(i);s>-1&&n.splice(s,1)}let RD=(()=>{class n{constructor(){this.zone=Hn(xs),this.applicationRef=Hn(Fp)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275prov=gi({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function PD(){const n=Hn(xs),i=Hn(Cl);return s=>n.runOutsideAngular(()=>i.handleError(s))}let OD=(()=>{class n{constructor(){this.subscription=new yi.w0,this.initialized=!1,this.zone=Hn(xs),this.pendingTasks=Hn(XE)}initialize(){if(this.initialized)return;this.initialized=!0;let s=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(s=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{xs.assertNotInAngularZone(),queueMicrotask(()=>{null!==s&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(s),s=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{xs.assertInAngularZone(),s??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275prov=gi({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const h0=new an("LocaleId",{providedIn:"root",factory:()=>Hn(h0,We.Optional|We.SkipSelf)||function LD(){return typeof $localize<"u"&&$localize.locale||bu}()}),FD=new an("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"}),JE=new an("PlatformDestroyListeners");let vC=(()=>{class n{constructor(s){this._injector=s,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(s,a){const d=function Ax(n="zone.js",i){return"noop"===n?new Xb:"zone.js"===n?new xs(i):n}(a?.ngZone,function gC(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:a?.ngZoneEventCoalescing,runCoalescing:a?.ngZoneRunCoalescing}));return d.run(()=>{const f=function KT(n,i,s){return new OE(n,i,s)}(s.moduleType,this.injector,function mC(n){return[{provide:xs,useFactory:n},{provide:Gc,multi:!0,useFactory:()=>{const i=Hn(RD,{optional:!0});return()=>i.initialize()}},{provide:Gc,multi:!0,useFactory:()=>{const i=Hn(OD);return()=>{i.initialize()}}},{provide:zf,useFactory:PD}]}(()=>d)),g=f.injector.get(Cl,null);return d.runOutsideAngular(()=>{const _=d.onError.subscribe({next:w=>{g.handleError(w)}});f.onDestroy(()=>{u0(this._modules,f),_.unsubscribe()})}),function hC(n,i,s){try{const a=s();return wE(a)?a.catch(d=>{throw i.runOutsideAngular(()=>n.handleError(d)),d}):a}catch(a){throw i.runOutsideAngular(()=>n.handleError(a)),a}}(g,d,()=>{const _=f.injector.get(KE);return _.runInitializers(),_.donePromise.then(()=>(function e0(n){Ti(n,"Expected localeId to be defined"),"string"==typeof n&&(Yg=n.toLowerCase().replace(/_/g,"-"))}(f.injector.get(h0,bu)||bu),this._moduleDoBootstrap(f),f))})})}bootstrapModule(s,a=[]){const d=fC({},a);return function AD(n,i,s){const a=new LE(s);return Promise.resolve(a)}(0,0,s).then(f=>this.bootstrapModuleFactory(f,d))}_moduleDoBootstrap(s){const a=s.injector.get(Fp);if(s._bootstrapComponents.length>0)s._bootstrapComponents.forEach(d=>a.bootstrap(d));else{if(!s.instance.ngDoBootstrap)throw new It(-403,!1);s.instance.ngDoBootstrap(a)}this._modules.push(s)}onDestroy(s){this._destroyListeners.push(s)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new It(404,!1);this._modules.slice().forEach(a=>a.destroy()),this._destroyListeners.forEach(a=>a());const s=this._injector.get(JE,null);s&&(s.forEach(a=>a()),s.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static{this.\u0275fac=function(a){return new(a||n)(dr(ga))}}static{this.\u0275prov=gi({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})(),Dd=null;const yC=new an("AllowMultipleToken");function _C(n,i,s=[]){const a=`Platform: ${i}`,d=new an(a);return(f=[])=>{let g=QE();if(!g||g.injector.get(yC,!1)){const _=[...s,...f,{provide:d,useValue:!0}];n?n(_):function kD(n){if(Dd&&!Dd.get(yC,!1))throw new It(400,!1);(function dC(){!function Ir(n){bs=n}(()=>{throw new It(600,!1)})})(),Dd=n;const i=n.get(vC);(function xC(n){n.get(uM,null)?.forEach(s=>s())})(n)}(function MC(n=[],i){return ga.create({name:i,providers:[{provide:nm,useValue:"platform"},{provide:JE,useValue:new Set([()=>Dd=null])},...n]})}(_,a))}return function BD(n){const i=QE();if(!i)throw new It(401,!1);return i}()}}function QE(){return Dd?.get(vC)??null}function HD(){}const $D=_C(null,"core",[]);let XD=(()=>{class n{constructor(s){}static{this.\u0275fac=function(a){return new(a||n)(dr(Fp))}}static{this.\u0275mod=Mo({type:n})}static{this.\u0275inj=Xs({})}}return n})();function yI(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function MI(n){const i=ri(n);if(!i)return null;const s=new Ko(i);return{get selector(){return s.selector},get type(){return s.componentType},get inputs(){return s.inputs},get outputs(){return s.outputs},get ngContentSelectors(){return s.ngContentSelectors},get isStandalone(){return i.standalone},get isSignal(){return i.signals}}}},6223:(mn,Ke,Z)=>{Z.d(Ke,{Fj:()=>rt,JJ:()=>mr,JL:()=>Xi,NI:()=>an,Q7:()=>hl,UX:()=>un,_Y:()=>Jr,cw:()=>Se,kI:()=>ui,sg:()=>Uo,u:()=>is,u5:()=>Mt});var E=Z(9212),ie=Z(6814),ze=Z(7715),Pe=Z(9315),be=Z(7398);let xe=(()=>{class U{constructor(P,Y){this._renderer=P,this._elementRef=Y,this.onChange=pe=>{},this.onTouched=()=>{}}setProperty(P,Y){this._renderer.setProperty(this._elementRef.nativeElement,P,Y)}registerOnTouched(P){this.onTouched=P}registerOnChange(P){this.onChange=P}setDisabledState(P){this.setProperty("disabled",P)}static{this.\u0275fac=function(Y){return new(Y||U)(E.Y36(E.Qsj),E.Y36(E.SBq))}}static{this.\u0275dir=E.lG2({type:U})}}return U})(),it=(()=>{class U extends xe{static{this.\u0275fac=(()=>{let P;return function(pe){return(P||(P=E.n5z(U)))(pe||U)}})()}static{this.\u0275dir=E.lG2({type:U,features:[E.qOj]})}}return U})();const ht=new E.OlP("NgValueAccessor"),Ie={provide:ht,useExisting:(0,E.Gpc)(()=>rt),multi:!0},jt=new E.OlP("CompositionEventMode");let rt=(()=>{class U extends xe{constructor(P,Y,pe){super(P,Y),this._compositionMode=pe,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function ot(){const U=(0,ie.q)()?(0,ie.q)().getUserAgent():"";return/android (\d+)/.test(U.toLowerCase())}())}writeValue(P){this.setProperty("value",P??"")}_handleInput(P){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(P)}_compositionStart(){this._composing=!0}_compositionEnd(P){this._composing=!1,this._compositionMode&&this.onChange(P)}static{this.\u0275fac=function(Y){return new(Y||U)(E.Y36(E.Qsj),E.Y36(E.SBq),E.Y36(jt,8))}}static{this.\u0275dir=E.lG2({type:U,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(Y,pe){1&Y&&E.NdJ("input",function(Cn){return pe._handleInput(Cn.target.value)})("blur",function(){return pe.onTouched()})("compositionstart",function(){return pe._compositionStart()})("compositionend",function(Cn){return pe._compositionEnd(Cn.target.value)})},features:[E._Bn([Ie]),E.qOj]})}}return U})();function St(U){return null==U||("string"==typeof U||Array.isArray(U))&&0===U.length}function Ln(U){return null!=U&&"number"==typeof U.length}const $t=new E.OlP("NgValidators"),_n=new E.OlP("NgAsyncValidators"),mi=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class ui{static min(H){return function yt(U){return H=>{if(St(H.value)||St(U))return null;const P=parseFloat(H.value);return!isNaN(P)&&P<U?{min:{min:U,actual:H.value}}:null}}(H)}static max(H){return function Ye(U){return H=>{if(St(H.value)||St(U))return null;const P=parseFloat(H.value);return!isNaN(P)&&P>U?{max:{max:U,actual:H.value}}:null}}(H)}static required(H){return mt(H)}static requiredTrue(H){return function en(U){return!0===U.value?null:{required:!0}}(H)}static email(H){return function wt(U){return St(U.value)||mi.test(U.value)?null:{email:!0}}(H)}static minLength(H){return function xt(U){return H=>St(H.value)||!Ln(H.value)?null:H.value.length<U?{minlength:{requiredLength:U,actualLength:H.value.length}}:null}(H)}static maxLength(H){return function wn(U){return H=>Ln(H.value)&&H.value.length>U?{maxlength:{requiredLength:U,actualLength:H.value.length}}:null}(H)}static pattern(H){return function tn(U){if(!U)return ir;let H,P;return"string"==typeof U?(P="","^"!==U.charAt(0)&&(P+="^"),P+=U,"$"!==U.charAt(U.length-1)&&(P+="$"),H=new RegExp(P)):(P=U.toString(),H=U),Y=>{if(St(Y.value))return null;const pe=Y.value;return H.test(pe)?null:{pattern:{requiredPattern:P,actualValue:pe}}}}(H)}static nullValidator(H){return null}static compose(H){return De(H)}static composeAsync(H){return $e(H)}}function mt(U){return St(U.value)?{required:!0}:null}function ir(U){return null}function or(U){return null!=U}function Lr(U){return(0,E.QGY)(U)?(0,ze.D)(U):U}function bs(U){let H={};return U.forEach(P=>{H=null!=P?{...H,...P}:H}),0===Object.keys(H).length?null:H}function Dr(U,H){return H.map(P=>P(U))}function zi(U){return U.map(H=>function Ir(U){return!U.validate}(H)?H:P=>H.validate(P))}function De(U){if(!U)return null;const H=U.filter(or);return 0==H.length?null:function(P){return bs(Dr(P,H))}}function Ne(U){return null!=U?De(zi(U)):null}function $e(U){if(!U)return null;const H=U.filter(or);return 0==H.length?null:function(P){const Y=Dr(P,H).map(Lr);return(0,Pe.D)(Y).pipe((0,be.U)(bs))}}function Ge(U){return null!=U?$e(zi(U)):null}function gt(U,H){return null===U?[H]:Array.isArray(U)?[...U,H]:[U,H]}function _t(U){return U._rawValidators}function xn(U){return U._rawAsyncValidators}function ni(U){return U?Array.isArray(U)?U:[U]:[]}function cr(U,H){return Array.isArray(U)?U.includes(H):U===H}function En(U,H){const P=ni(H);return ni(U).forEach(pe=>{cr(P,pe)||P.push(pe)}),P}function zt(U,H){return ni(H).filter(P=>!cr(U,P))}class $i{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(H){this._rawValidators=H||[],this._composedValidatorFn=Ne(this._rawValidators)}_setAsyncValidators(H){this._rawAsyncValidators=H||[],this._composedAsyncValidatorFn=Ge(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(H){this._onDestroyCallbacks.push(H)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(H=>H()),this._onDestroyCallbacks=[]}reset(H=void 0){this.control&&this.control.reset(H)}hasError(H,P){return!!this.control&&this.control.hasError(H,P)}getError(H,P){return this.control?this.control.getError(H,P):null}}class Zn extends $i{get formDirective(){return null}get path(){return null}}class yi extends $i{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Hr{constructor(H){this._cd=H}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let mr=(()=>{class U extends Hr{constructor(P){super(P)}static{this.\u0275fac=function(Y){return new(Y||U)(E.Y36(yi,2))}}static{this.\u0275dir=E.lG2({type:U,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(Y,pe){2&Y&&E.ekj("ng-untouched",pe.isUntouched)("ng-touched",pe.isTouched)("ng-pristine",pe.isPristine)("ng-dirty",pe.isDirty)("ng-valid",pe.isValid)("ng-invalid",pe.isInvalid)("ng-pending",pe.isPending)},features:[E.qOj]})}}return U})(),Xi=(()=>{class U extends Hr{constructor(P){super(P)}static{this.\u0275fac=function(Y){return new(Y||U)(E.Y36(Zn,10))}}static{this.\u0275dir=E.lG2({type:U,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(Y,pe){2&Y&&E.ekj("ng-untouched",pe.isUntouched)("ng-touched",pe.isTouched)("ng-pristine",pe.isPristine)("ng-dirty",pe.isDirty)("ng-valid",pe.isValid)("ng-invalid",pe.isInvalid)("ng-pending",pe.isPending)("ng-submitted",pe.isSubmitted)},features:[E.qOj]})}}return U})();const Yi="VALID",sn="INVALID",Pn="PENDING",Zr="DISABLED";function ns(U){return(_i(U)?U.validators:U)||null}function vr(U,H){return(_i(H)?H.asyncValidators:U)||null}function _i(U){return null!=U&&!Array.isArray(U)&&"object"==typeof U}class Oe{constructor(H,P){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(H),this._assignAsyncValidators(P)}get validator(){return this._composedValidatorFn}set validator(H){this._rawValidators=this._composedValidatorFn=H}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(H){this._rawAsyncValidators=this._composedAsyncValidatorFn=H}get parent(){return this._parent}get valid(){return this.status===Yi}get invalid(){return this.status===sn}get pending(){return this.status==Pn}get disabled(){return this.status===Zr}get enabled(){return this.status!==Zr}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(H){this._assignValidators(H)}setAsyncValidators(H){this._assignAsyncValidators(H)}addValidators(H){this.setValidators(En(H,this._rawValidators))}addAsyncValidators(H){this.setAsyncValidators(En(H,this._rawAsyncValidators))}removeValidators(H){this.setValidators(zt(H,this._rawValidators))}removeAsyncValidators(H){this.setAsyncValidators(zt(H,this._rawAsyncValidators))}hasValidator(H){return cr(this._rawValidators,H)}hasAsyncValidator(H){return cr(this._rawAsyncValidators,H)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(H={}){this.touched=!0,this._parent&&!H.onlySelf&&this._parent.markAsTouched(H)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(H=>H.markAllAsTouched())}markAsUntouched(H={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(P=>{P.markAsUntouched({onlySelf:!0})}),this._parent&&!H.onlySelf&&this._parent._updateTouched(H)}markAsDirty(H={}){this.pristine=!1,this._parent&&!H.onlySelf&&this._parent.markAsDirty(H)}markAsPristine(H={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(P=>{P.markAsPristine({onlySelf:!0})}),this._parent&&!H.onlySelf&&this._parent._updatePristine(H)}markAsPending(H={}){this.status=Pn,!1!==H.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!H.onlySelf&&this._parent.markAsPending(H)}disable(H={}){const P=this._parentMarkedDirty(H.onlySelf);this.status=Zr,this.errors=null,this._forEachChild(Y=>{Y.disable({...H,onlySelf:!0})}),this._updateValue(),!1!==H.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...H,skipPristineCheck:P}),this._onDisabledChange.forEach(Y=>Y(!0))}enable(H={}){const P=this._parentMarkedDirty(H.onlySelf);this.status=Yi,this._forEachChild(Y=>{Y.enable({...H,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:H.emitEvent}),this._updateAncestors({...H,skipPristineCheck:P}),this._onDisabledChange.forEach(Y=>Y(!1))}_updateAncestors(H){this._parent&&!H.onlySelf&&(this._parent.updateValueAndValidity(H),H.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(H){this._parent=H}getRawValue(){return this.value}updateValueAndValidity(H={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Yi||this.status===Pn)&&this._runAsyncValidator(H.emitEvent)),!1!==H.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!H.onlySelf&&this._parent.updateValueAndValidity(H)}_updateTreeValidity(H={emitEvent:!0}){this._forEachChild(P=>P._updateTreeValidity(H)),this.updateValueAndValidity({onlySelf:!0,emitEvent:H.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Zr:Yi}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(H){if(this.asyncValidator){this.status=Pn,this._hasOwnPendingAsyncValidator=!0;const P=Lr(this.asyncValidator(this));this._asyncValidationSubscription=P.subscribe(Y=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(Y,{emitEvent:H})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(H,P={}){this.errors=H,this._updateControlsErrors(!1!==P.emitEvent)}get(H){let P=H;return null==P||(Array.isArray(P)||(P=P.split(".")),0===P.length)?null:P.reduce((Y,pe)=>Y&&Y._find(pe),this)}getError(H,P){const Y=P?this.get(P):this;return Y&&Y.errors?Y.errors[H]:null}hasError(H,P){return!!this.getError(H,P)}get root(){let H=this;for(;H._parent;)H=H._parent;return H}_updateControlsErrors(H){this.status=this._calculateStatus(),H&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(H)}_initObservables(){this.valueChanges=new E.vpe,this.statusChanges=new E.vpe}_calculateStatus(){return this._allControlsDisabled()?Zr:this.errors?sn:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Pn)?Pn:this._anyControlsHaveStatus(sn)?sn:Yi}_anyControlsHaveStatus(H){return this._anyControls(P=>P.status===H)}_anyControlsDirty(){return this._anyControls(H=>H.dirty)}_anyControlsTouched(){return this._anyControls(H=>H.touched)}_updatePristine(H={}){this.pristine=!this._anyControlsDirty(),this._parent&&!H.onlySelf&&this._parent._updatePristine(H)}_updateTouched(H={}){this.touched=this._anyControlsTouched(),this._parent&&!H.onlySelf&&this._parent._updateTouched(H)}_registerOnCollectionChange(H){this._onCollectionChange=H}_setUpdateStrategy(H){_i(H)&&null!=H.updateOn&&(this._updateOn=H.updateOn)}_parentMarkedDirty(H){return!H&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(H){return null}_assignValidators(H){this._rawValidators=Array.isArray(H)?H.slice():H,this._composedValidatorFn=function ws(U){return Array.isArray(U)?Ne(U):U||null}(this._rawValidators)}_assignAsyncValidators(H){this._rawAsyncValidators=Array.isArray(H)?H.slice():H,this._composedAsyncValidatorFn=function Gr(U){return Array.isArray(U)?Ge(U):U||null}(this._rawAsyncValidators)}}class Se extends Oe{constructor(H,P,Y){super(ns(P),vr(Y,P)),this.controls=H,this._initObservables(),this._setUpdateStrategy(P),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(H,P){return this.controls[H]?this.controls[H]:(this.controls[H]=P,P.setParent(this),P._registerOnCollectionChange(this._onCollectionChange),P)}addControl(H,P,Y={}){this.registerControl(H,P),this.updateValueAndValidity({emitEvent:Y.emitEvent}),this._onCollectionChange()}removeControl(H,P={}){this.controls[H]&&this.controls[H]._registerOnCollectionChange(()=>{}),delete this.controls[H],this.updateValueAndValidity({emitEvent:P.emitEvent}),this._onCollectionChange()}setControl(H,P,Y={}){this.controls[H]&&this.controls[H]._registerOnCollectionChange(()=>{}),delete this.controls[H],P&&this.registerControl(H,P),this.updateValueAndValidity({emitEvent:Y.emitEvent}),this._onCollectionChange()}contains(H){return this.controls.hasOwnProperty(H)&&this.controls[H].enabled}setValue(H,P={}){(function ul(U,H,P){U._forEachChild((Y,pe)=>{if(void 0===P[pe])throw new E.vHH(1002,"")})})(this,0,H),Object.keys(H).forEach(Y=>{(function ar(U,H,P){const Y=U.controls;if(!(H?Object.keys(Y):Y).length)throw new E.vHH(1e3,"");if(!Y[P])throw new E.vHH(1001,"")})(this,!0,Y),this.controls[Y].setValue(H[Y],{onlySelf:!0,emitEvent:P.emitEvent})}),this.updateValueAndValidity(P)}patchValue(H,P={}){null!=H&&(Object.keys(H).forEach(Y=>{const pe=this.controls[Y];pe&&pe.patchValue(H[Y],{onlySelf:!0,emitEvent:P.emitEvent})}),this.updateValueAndValidity(P))}reset(H={},P={}){this._forEachChild((Y,pe)=>{Y.reset(H?H[pe]:null,{onlySelf:!0,emitEvent:P.emitEvent})}),this._updatePristine(P),this._updateTouched(P),this.updateValueAndValidity(P)}getRawValue(){return this._reduceChildren({},(H,P,Y)=>(H[Y]=P.getRawValue(),H))}_syncPendingControls(){let H=this._reduceChildren(!1,(P,Y)=>!!Y._syncPendingControls()||P);return H&&this.updateValueAndValidity({onlySelf:!0}),H}_forEachChild(H){Object.keys(this.controls).forEach(P=>{const Y=this.controls[P];Y&&H(Y,P)})}_setUpControls(){this._forEachChild(H=>{H.setParent(this),H._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(H){for(const[P,Y]of Object.entries(this.controls))if(this.contains(P)&&H(Y))return!0;return!1}_reduceValue(){return this._reduceChildren({},(P,Y,pe)=>((Y.enabled||this.disabled)&&(P[pe]=Y.value),P))}_reduceChildren(H,P){let Y=H;return this._forEachChild((pe,dt)=>{Y=P(Y,pe,dt)}),Y}_allControlsDisabled(){for(const H of Object.keys(this.controls))if(this.controls[H].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(H){return this.controls.hasOwnProperty(H)?this.controls[H]:null}}const Bn=new E.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>Mi}),Mi="always";function _r(U,H,P=Mi){to(U,H),H.valueAccessor.writeValue(U.value),(U.disabled||"always"===P)&&H.valueAccessor.setDisabledState?.(U.disabled),function Oo(U,H){H.valueAccessor.registerOnChange(P=>{U._pendingValue=P,U._pendingChange=!0,U._pendingDirty=!0,"change"===U.updateOn&&wa(U,H)})}(U,H),function Xs(U,H){const P=(Y,pe)=>{H.valueAccessor.writeValue(Y),pe&&H.viewToModelUpdate(Y)};U.registerOnChange(P),H._registerOnDestroy(()=>{U._unregisterOnChange(P)})}(U,H),function gi(U,H){H.valueAccessor.registerOnTouched(()=>{U._pendingTouched=!0,"blur"===U.updateOn&&U._pendingChange&&wa(U,H),"submit"!==U.updateOn&&U.markAsTouched()})}(U,H),function Fr(U,H){if(H.valueAccessor.setDisabledState){const P=Y=>{H.valueAccessor.setDisabledState(Y)};U.registerOnDisabledChange(P),H._registerOnDestroy(()=>{U._unregisterOnDisabledChange(P)})}}(U,H)}function Ti(U,H,P=!0){const Y=()=>{};H.valueAccessor&&(H.valueAccessor.registerOnChange(Y),H.valueAccessor.registerOnTouched(Y)),ds(U,H),U&&(H._invokeOnDestroyCallbacks(),U._registerOnCollectionChange(()=>{}))}function Jt(U,H){U.forEach(P=>{P.registerOnValidatorChange&&P.registerOnValidatorChange(H)})}function to(U,H){const P=_t(U);null!==H.validator?U.setValidators(gt(P,H.validator)):"function"==typeof P&&U.setValidators([P]);const Y=xn(U);null!==H.asyncValidator?U.setAsyncValidators(gt(Y,H.asyncValidator)):"function"==typeof Y&&U.setAsyncValidators([Y]);const pe=()=>U.updateValueAndValidity();Jt(H._rawValidators,pe),Jt(H._rawAsyncValidators,pe)}function ds(U,H){let P=!1;if(null!==U){if(null!==H.validator){const pe=_t(U);if(Array.isArray(pe)&&pe.length>0){const dt=pe.filter(Cn=>Cn!==H.validator);dt.length!==pe.length&&(P=!0,U.setValidators(dt))}}if(null!==H.asyncValidator){const pe=xn(U);if(Array.isArray(pe)&&pe.length>0){const dt=pe.filter(Cn=>Cn!==H.asyncValidator);dt.length!==pe.length&&(P=!0,U.setAsyncValidators(dt))}}}const Y=()=>{};return Jt(H._rawValidators,Y),Jt(H._rawAsyncValidators,Y),P}function wa(U,H){U._pendingDirty&&U.markAsDirty(),U.setValue(U._pendingValue,{emitModelToViewChange:!1}),H.viewToModelUpdate(U._pendingValue),U._pendingChange=!1}function qi(U,H){const P=U.indexOf(H);P>-1&&U.splice(P,1)}function Ur(U){return"object"==typeof U&&null!==U&&2===Object.keys(U).length&&"value"in U&&"disabled"in U}const an=class extends Oe{constructor(H=null,P,Y){super(ns(P),vr(Y,P)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(H),this._setUpdateStrategy(P),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),_i(P)&&(P.nonNullable||P.initialValueIsDefault)&&(this.defaultValue=Ur(H)?H.value:H)}setValue(H,P={}){this.value=this._pendingValue=H,this._onChange.length&&!1!==P.emitModelToViewChange&&this._onChange.forEach(Y=>Y(this.value,!1!==P.emitViewToModelChange)),this.updateValueAndValidity(P)}patchValue(H,P={}){this.setValue(H,P)}reset(H=this.defaultValue,P={}){this._applyFormState(H),this.markAsPristine(P),this.markAsUntouched(P),this.setValue(this.value,P),this._pendingChange=!1}_updateValue(){}_anyControls(H){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(H){this._onChange.push(H)}_unregisterOnChange(H){qi(this._onChange,H)}registerOnDisabledChange(H){this._onDisabledChange.push(H)}_unregisterOnDisabledChange(H){qi(this._onDisabledChange,H)}_forEachChild(H){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(H){Ur(H)?(this.value=this._pendingValue=H.value,H.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=H}};let Jr=(()=>{class U{static{this.\u0275fac=function(Y){return new(Y||U)}}static{this.\u0275dir=E.lG2({type:U,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return U})(),vo=(()=>{class U{static{this.\u0275fac=function(Y){return new(Y||U)}}static{this.\u0275mod=E.oAB({type:U})}static{this.\u0275inj=E.cJS({})}}return U})();const dr=new E.OlP("NgModelWithFormControlWarning"),no={provide:Zn,useExisting:(0,E.Gpc)(()=>Uo)};let Uo=(()=>{class U extends Zn{constructor(P,Y,pe){super(),this.callSetDisabledState=pe,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new E.vpe,this._setValidators(P),this._setAsyncValidators(Y)}ngOnChanges(P){this._checkFormPresent(),P.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(ds(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(P){const Y=this.form.get(P.path);return _r(Y,P,this.callSetDisabledState),Y.updateValueAndValidity({emitEvent:!1}),this.directives.push(P),Y}getControl(P){return this.form.get(P.path)}removeControl(P){Ti(P.control||null,P,!1),function Vn(U,H){const P=U.indexOf(H);P>-1&&U.splice(P,1)}(this.directives,P)}addFormGroup(P){this._setUpFormContainer(P)}removeFormGroup(P){this._cleanUpFormContainer(P)}getFormGroup(P){return this.form.get(P.path)}addFormArray(P){this._setUpFormContainer(P)}removeFormArray(P){this._cleanUpFormContainer(P)}getFormArray(P){return this.form.get(P.path)}updateModel(P,Y){this.form.get(P.path).setValue(Y)}onSubmit(P){return this.submitted=!0,function We(U,H){U._syncPendingControls(),H.forEach(P=>{const Y=P.control;"submit"===Y.updateOn&&Y._pendingChange&&(P.viewToModelUpdate(Y._pendingValue),Y._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(P),"dialog"===P?.target?.method}onReset(){this.resetForm()}resetForm(P=void 0){this.form.reset(P),this.submitted=!1}_updateDomValue(){this.directives.forEach(P=>{const Y=P.control,pe=this.form.get(P.path);Y!==pe&&(Ti(Y||null,P),(U=>U instanceof an)(pe)&&(_r(pe,P,this.callSetDisabledState),P.control=pe))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(P){const Y=this.form.get(P.path);(function Ls(U,H){to(U,H)})(Y,P),Y.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(P){if(this.form){const Y=this.form.get(P.path);Y&&function br(U,H){return ds(U,H)}(Y,P)&&Y.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){to(this.form,this),this._oldForm&&ds(this._oldForm,this)}_checkFormPresent(){}static{this.\u0275fac=function(Y){return new(Y||U)(E.Y36($t,10),E.Y36(_n,10),E.Y36(Bn,8))}}static{this.\u0275dir=E.lG2({type:U,selectors:[["","formGroup",""]],hostBindings:function(Y,pe){1&Y&&E.NdJ("submit",function(Cn){return pe.onSubmit(Cn)})("reset",function(){return pe.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[E._Bn([no]),E.qOj,E.TTD]})}}return U})();const zs={provide:yi,useExisting:(0,E.Gpc)(()=>is)};let is=(()=>{class U extends yi{set isDisabled(P){}static{this._ngModelWarningSentOnce=!1}constructor(P,Y,pe,dt,Cn){super(),this._ngModelWarningConfig=Cn,this._added=!1,this.name=null,this.update=new E.vpe,this._ngModelWarningSent=!1,this._parent=P,this._setValidators(Y),this._setAsyncValidators(pe),this.valueAccessor=function Tt(U,H){if(!H)return null;let P,Y,pe;return Array.isArray(H),H.forEach(dt=>{dt.constructor===rt?P=dt:function at(U){return Object.getPrototypeOf(U.constructor)===it}(dt)?Y=dt:pe=dt}),pe||Y||P||null}(0,dt)}ngOnChanges(P){this._added||this._setUpControl(),function Le(U,H){if(!U.hasOwnProperty("model"))return!1;const P=U.model;return!!P.isFirstChange()||!Object.is(H,P.currentValue)}(P,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(P){this.viewModel=P,this.update.emit(P)}get path(){return function yr(U,H){return[...H.path,U]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(Y){return new(Y||U)(E.Y36(Zn,13),E.Y36($t,10),E.Y36(_n,10),E.Y36(ht,10),E.Y36(dr,8))}}static{this.\u0275dir=E.lG2({type:U,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[E._Bn([zs]),E.qOj,E.TTD]})}}return U})(),Ai=(()=>{class U{constructor(){this._validator=ir}ngOnChanges(P){if(this.inputName in P){const Y=this.normalizeInput(P[this.inputName].currentValue);this._enabled=this.enabled(Y),this._validator=this._enabled?this.createValidator(Y):ir,this._onChange&&this._onChange()}}validate(P){return this._validator(P)}registerOnValidatorChange(P){this._onChange=P}enabled(P){return null!=P}static{this.\u0275fac=function(Y){return new(Y||U)}}static{this.\u0275dir=E.lG2({type:U,features:[E.TTD]})}}return U})();const Du={provide:$t,useExisting:(0,E.Gpc)(()=>hl),multi:!0};let hl=(()=>{class U extends Ai{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=E.VuI,this.createValidator=P=>mt}enabled(P){return P}static{this.\u0275fac=(()=>{let P;return function(pe){return(P||(P=E.n5z(U)))(pe||U)}})()}static{this.\u0275dir=E.lG2({type:U,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(Y,pe){2&Y&&E.uIk("required",pe._enabled?"":null)},inputs:{required:"required"},features:[E._Bn([Du]),E.qOj]})}}return U})(),$r=(()=>{class U{static{this.\u0275fac=function(Y){return new(Y||U)}}static{this.\u0275mod=E.oAB({type:U})}static{this.\u0275inj=E.cJS({imports:[vo]})}}return U})(),Mt=(()=>{class U{static withConfig(P){return{ngModule:U,providers:[{provide:Bn,useValue:P.callSetDisabledState??Mi}]}}static{this.\u0275fac=function(Y){return new(Y||U)}}static{this.\u0275mod=E.oAB({type:U})}static{this.\u0275inj=E.cJS({imports:[$r]})}}return U})(),un=(()=>{class U{static withConfig(P){return{ngModule:U,providers:[{provide:dr,useValue:P.warnOnNgModelWithFormControl??"always"},{provide:Bn,useValue:P.callSetDisabledState??Mi}]}}static{this.\u0275fac=function(Y){return new(Y||U)}}static{this.\u0275mod=E.oAB({type:U})}static{this.\u0275inj=E.cJS({imports:[$r]})}}return U})()},6593:(mn,Ke,Z)=>{Z.d(Ke,{Dx:()=>us,H7:()=>Yi,b2:()=>Hr,q6:()=>zt});var E=Z(9212),ie=Z(6814);class ze extends ie.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Pe extends ze{static makeCurrent(){(0,ie.HT)(new Pe)}onAndCancel(Se,oe,me){return Se.addEventListener(oe,me),()=>{Se.removeEventListener(oe,me)}}dispatchEvent(Se,oe){Se.dispatchEvent(oe)}remove(Se){Se.parentNode&&Se.parentNode.removeChild(Se)}createElement(Se,oe){return(oe=oe||this.getDefaultDocument()).createElement(Se)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(Se){return Se.nodeType===Node.ELEMENT_NODE}isShadowRoot(Se){return Se instanceof DocumentFragment}getGlobalEventTarget(Se,oe){return"window"===oe?window:"document"===oe?Se:"body"===oe?Se.body:null}getBaseHref(Se){const oe=function xe(){return be=be||document.querySelector("base"),be?be.getAttribute("href"):null}();return null==oe?null:function it(Oe){return new URL(Oe,document.baseURI).pathname}(oe)}resetBaseElement(){be=null}getUserAgent(){return window.navigator.userAgent}getCookie(Se){return(0,ie.Mx)(document.cookie,Se)}}let be=null,pt=(()=>{class Oe{build(){return new XMLHttpRequest}static{this.\u0275fac=function(me){return new(me||Oe)}}static{this.\u0275prov=E.Yz7({token:Oe,factory:Oe.\u0275fac})}}return Oe})();const et=new E.OlP("EventManagerPlugins");let Ie=(()=>{class Oe{constructor(oe,me){this._zone=me,this._eventNameToPlugin=new Map,oe.forEach(qe=>{qe.manager=this}),this._plugins=oe.slice().reverse()}addEventListener(oe,me,qe){return this._findPluginFor(me).addEventListener(oe,me,qe)}getZone(){return this._zone}_findPluginFor(oe){let me=this._eventNameToPlugin.get(oe);if(me)return me;if(me=this._plugins.find(Lt=>Lt.supports(oe)),!me)throw new E.vHH(5101,!1);return this._eventNameToPlugin.set(oe,me),me}static{this.\u0275fac=function(me){return new(me||Oe)(E.LFG(et),E.LFG(E.R0b))}}static{this.\u0275prov=E.Yz7({token:Oe,factory:Oe.\u0275fac})}}return Oe})();class ot{constructor(Se){this._doc=Se}}const jt="ng-app-id";let rt=(()=>{class Oe{constructor(oe,me,qe,Lt={}){this.doc=oe,this.appId=me,this.nonce=qe,this.platformId=Lt,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,ie.PM)(Lt),this.resetHostNodes()}addStyles(oe){for(const me of oe)1===this.changeUsageCount(me,1)&&this.onStyleAdded(me)}removeStyles(oe){for(const me of oe)this.changeUsageCount(me,-1)<=0&&this.onStyleRemoved(me)}ngOnDestroy(){const oe=this.styleNodesInDOM;oe&&(oe.forEach(me=>me.remove()),oe.clear());for(const me of this.getAllStyles())this.onStyleRemoved(me);this.resetHostNodes()}addHost(oe){this.hostNodes.add(oe);for(const me of this.getAllStyles())this.addStyleToHost(oe,me)}removeHost(oe){this.hostNodes.delete(oe)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(oe){for(const me of this.hostNodes)this.addStyleToHost(me,oe)}onStyleRemoved(oe){const me=this.styleRef;me.get(oe)?.elements?.forEach(qe=>qe.remove()),me.delete(oe)}collectServerRenderedStyles(){const oe=this.doc.head?.querySelectorAll(`style[${jt}="${this.appId}"]`);if(oe?.length){const me=new Map;return oe.forEach(qe=>{null!=qe.textContent&&me.set(qe.textContent,qe)}),me}return null}changeUsageCount(oe,me){const qe=this.styleRef;if(qe.has(oe)){const Lt=qe.get(oe);return Lt.usage+=me,Lt.usage}return qe.set(oe,{usage:me,elements:[]}),me}getStyleElement(oe,me){const qe=this.styleNodesInDOM,Lt=qe?.get(me);if(Lt?.parentNode===oe)return qe.delete(me),Lt.removeAttribute(jt),Lt;{const Nn=this.doc.createElement("style");return this.nonce&&Nn.setAttribute("nonce",this.nonce),Nn.textContent=me,this.platformIsServer&&Nn.setAttribute(jt,this.appId),oe.appendChild(Nn),Nn}}addStyleToHost(oe,me){const qe=this.getStyleElement(oe,me),Lt=this.styleRef,Nn=Lt.get(me)?.elements;Nn?Nn.push(qe):Lt.set(me,{elements:[qe],usage:1})}resetHostNodes(){const oe=this.hostNodes;oe.clear(),oe.add(this.doc.head)}static{this.\u0275fac=function(me){return new(me||Oe)(E.LFG(ie.K0),E.LFG(E.AFp),E.LFG(E.Ojb,8),E.LFG(E.Lbi))}}static{this.\u0275prov=E.Yz7({token:Oe,factory:Oe.\u0275fac})}}return Oe})();const St={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Ln=/%COMP%/g,yt=new E.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!0});function en(Oe,Se){return Se.map(oe=>oe.replace(Ln,Oe))}let wt=(()=>{class Oe{constructor(oe,me,qe,Lt,Nn,Bn,Mi,yr=null){this.eventManager=oe,this.sharedStylesHost=me,this.appId=qe,this.removeStylesOnCompDestroy=Lt,this.doc=Nn,this.platformId=Bn,this.ngZone=Mi,this.nonce=yr,this.rendererByCompId=new Map,this.platformIsServer=(0,ie.PM)(Bn),this.defaultRenderer=new xt(oe,Nn,Mi,this.platformIsServer)}createRenderer(oe,me){if(!oe||!me)return this.defaultRenderer;this.platformIsServer&&me.encapsulation===E.ifc.ShadowDom&&(me={...me,encapsulation:E.ifc.Emulated});const qe=this.getOrCreateRenderer(oe,me);return qe instanceof bs?qe.applyToHost(oe):qe instanceof Lr&&qe.applyStyles(),qe}getOrCreateRenderer(oe,me){const qe=this.rendererByCompId;let Lt=qe.get(me.id);if(!Lt){const Nn=this.doc,Bn=this.ngZone,Mi=this.eventManager,yr=this.sharedStylesHost,_r=this.removeStylesOnCompDestroy,Ti=this.platformIsServer;switch(me.encapsulation){case E.ifc.Emulated:Lt=new bs(Mi,yr,me,this.appId,_r,Nn,Bn,Ti);break;case E.ifc.ShadowDom:return new or(Mi,yr,oe,me,Nn,Bn,this.nonce,Ti);default:Lt=new Lr(Mi,yr,me,_r,Nn,Bn,Ti)}qe.set(me.id,Lt)}return Lt}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(me){return new(me||Oe)(E.LFG(Ie),E.LFG(rt),E.LFG(E.AFp),E.LFG(yt),E.LFG(ie.K0),E.LFG(E.Lbi),E.LFG(E.R0b),E.LFG(E.Ojb))}}static{this.\u0275prov=E.Yz7({token:Oe,factory:Oe.\u0275fac})}}return Oe})();class xt{constructor(Se,oe,me,qe){this.eventManager=Se,this.doc=oe,this.ngZone=me,this.platformIsServer=qe,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(Se,oe){return oe?this.doc.createElementNS(St[oe]||oe,Se):this.doc.createElement(Se)}createComment(Se){return this.doc.createComment(Se)}createText(Se){return this.doc.createTextNode(Se)}appendChild(Se,oe){(ir(Se)?Se.content:Se).appendChild(oe)}insertBefore(Se,oe,me){Se&&(ir(Se)?Se.content:Se).insertBefore(oe,me)}removeChild(Se,oe){Se&&Se.removeChild(oe)}selectRootElement(Se,oe){let me="string"==typeof Se?this.doc.querySelector(Se):Se;if(!me)throw new E.vHH(-5104,!1);return oe||(me.textContent=""),me}parentNode(Se){return Se.parentNode}nextSibling(Se){return Se.nextSibling}setAttribute(Se,oe,me,qe){if(qe){oe=qe+":"+oe;const Lt=St[qe];Lt?Se.setAttributeNS(Lt,oe,me):Se.setAttribute(oe,me)}else Se.setAttribute(oe,me)}removeAttribute(Se,oe,me){if(me){const qe=St[me];qe?Se.removeAttributeNS(qe,oe):Se.removeAttribute(`${me}:${oe}`)}else Se.removeAttribute(oe)}addClass(Se,oe){Se.classList.add(oe)}removeClass(Se,oe){Se.classList.remove(oe)}setStyle(Se,oe,me,qe){qe&(E.JOm.DashCase|E.JOm.Important)?Se.style.setProperty(oe,me,qe&E.JOm.Important?"important":""):Se.style[oe]=me}removeStyle(Se,oe,me){me&E.JOm.DashCase?Se.style.removeProperty(oe):Se.style[oe]=""}setProperty(Se,oe,me){null!=Se&&(Se[oe]=me)}setValue(Se,oe){Se.nodeValue=oe}listen(Se,oe,me){if("string"==typeof Se&&!(Se=(0,ie.q)().getGlobalEventTarget(this.doc,Se)))throw new Error(`Unsupported event target ${Se} for event ${oe}`);return this.eventManager.addEventListener(Se,oe,this.decoratePreventDefault(me))}decoratePreventDefault(Se){return oe=>{if("__ngUnwrap__"===oe)return Se;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>Se(oe)):Se(oe))&&oe.preventDefault()}}}function ir(Oe){return"TEMPLATE"===Oe.tagName&&void 0!==Oe.content}class or extends xt{constructor(Se,oe,me,qe,Lt,Nn,Bn,Mi){super(Se,Lt,Nn,Mi),this.sharedStylesHost=oe,this.hostEl=me,this.shadowRoot=me.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const yr=en(qe.id,qe.styles);for(const _r of yr){const Ti=document.createElement("style");Bn&&Ti.setAttribute("nonce",Bn),Ti.textContent=_r,this.shadowRoot.appendChild(Ti)}}nodeOrShadowRoot(Se){return Se===this.hostEl?this.shadowRoot:Se}appendChild(Se,oe){return super.appendChild(this.nodeOrShadowRoot(Se),oe)}insertBefore(Se,oe,me){return super.insertBefore(this.nodeOrShadowRoot(Se),oe,me)}removeChild(Se,oe){return super.removeChild(this.nodeOrShadowRoot(Se),oe)}parentNode(Se){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(Se)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Lr extends xt{constructor(Se,oe,me,qe,Lt,Nn,Bn,Mi){super(Se,Lt,Nn,Bn),this.sharedStylesHost=oe,this.removeStylesOnCompDestroy=qe,this.styles=Mi?en(Mi,me.styles):me.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class bs extends Lr{constructor(Se,oe,me,qe,Lt,Nn,Bn,Mi){const yr=qe+"-"+me.id;super(Se,oe,me,Lt,Nn,Bn,Mi,yr),this.contentAttr=function Ye(Oe){return"_ngcontent-%COMP%".replace(Ln,Oe)}(yr),this.hostAttr=function mt(Oe){return"_nghost-%COMP%".replace(Ln,Oe)}(yr)}applyToHost(Se){this.applyStyles(),this.setAttribute(Se,this.hostAttr,"")}createElement(Se,oe){const me=super.createElement(Se,oe);return super.setAttribute(me,this.contentAttr,""),me}}let Dr=(()=>{class Oe extends ot{constructor(oe){super(oe)}supports(oe){return!0}addEventListener(oe,me,qe){return oe.addEventListener(me,qe,!1),()=>this.removeEventListener(oe,me,qe)}removeEventListener(oe,me,qe){return oe.removeEventListener(me,qe)}static{this.\u0275fac=function(me){return new(me||Oe)(E.LFG(ie.K0))}}static{this.\u0275prov=E.Yz7({token:Oe,factory:Oe.\u0275fac})}}return Oe})();const Ir=["alt","control","meta","shift"],zi={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},De={alt:Oe=>Oe.altKey,control:Oe=>Oe.ctrlKey,meta:Oe=>Oe.metaKey,shift:Oe=>Oe.shiftKey};let Ne=(()=>{class Oe extends ot{constructor(oe){super(oe)}supports(oe){return null!=Oe.parseEventName(oe)}addEventListener(oe,me,qe){const Lt=Oe.parseEventName(me),Nn=Oe.eventCallback(Lt.fullKey,qe,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,ie.q)().onAndCancel(oe,Lt.domEventName,Nn))}static parseEventName(oe){const me=oe.toLowerCase().split("."),qe=me.shift();if(0===me.length||"keydown"!==qe&&"keyup"!==qe)return null;const Lt=Oe._normalizeKey(me.pop());let Nn="",Bn=me.indexOf("code");if(Bn>-1&&(me.splice(Bn,1),Nn="code."),Ir.forEach(yr=>{const _r=me.indexOf(yr);_r>-1&&(me.splice(_r,1),Nn+=yr+".")}),Nn+=Lt,0!=me.length||0===Lt.length)return null;const Mi={};return Mi.domEventName=qe,Mi.fullKey=Nn,Mi}static matchEventFullKeyCode(oe,me){let qe=zi[oe.key]||oe.key,Lt="";return me.indexOf("code.")>-1&&(qe=oe.code,Lt="code."),!(null==qe||!qe)&&(qe=qe.toLowerCase()," "===qe?qe="space":"."===qe&&(qe="dot"),Ir.forEach(Nn=>{Nn!==qe&&(0,De[Nn])(oe)&&(Lt+=Nn+".")}),Lt+=qe,Lt===me)}static eventCallback(oe,me,qe){return Lt=>{Oe.matchEventFullKeyCode(Lt,oe)&&qe.runGuarded(()=>me(Lt))}}static _normalizeKey(oe){return"esc"===oe?"escape":oe}static{this.\u0275fac=function(me){return new(me||Oe)(E.LFG(ie.K0))}}static{this.\u0275prov=E.Yz7({token:Oe,factory:Oe.\u0275fac})}}return Oe})();const zt=(0,E.eFA)(E._c5,"browser",[{provide:E.Lbi,useValue:ie.bD},{provide:E.g9A,useValue:function xn(){Pe.makeCurrent()},multi:!0},{provide:ie.K0,useFactory:function cr(){return(0,E.RDi)(document),document},deps:[]}]),$i=new E.OlP(""),Zn=[{provide:E.rWj,useClass:class ht{addToWindow(Se){E.dqk.getAngularTestability=(me,qe=!0)=>{const Lt=Se.findTestabilityInTree(me,qe);if(null==Lt)throw new E.vHH(5103,!1);return Lt},E.dqk.getAllAngularTestabilities=()=>Se.getAllTestabilities(),E.dqk.getAllAngularRootElements=()=>Se.getAllRootElements(),E.dqk.frameworkStabilizers||(E.dqk.frameworkStabilizers=[]),E.dqk.frameworkStabilizers.push(me=>{const qe=E.dqk.getAllAngularTestabilities();let Lt=qe.length,Nn=!1;const Bn=function(Mi){Nn=Nn||Mi,Lt--,0==Lt&&me(Nn)};qe.forEach(Mi=>{Mi.whenStable(Bn)})})}findTestabilityInTree(Se,oe,me){return null==oe?null:Se.getTestability(oe)??(me?(0,ie.q)().isShadowRoot(oe)?this.findTestabilityInTree(Se,oe.host,!0):this.findTestabilityInTree(Se,oe.parentElement,!0):null)}},deps:[]},{provide:E.lri,useClass:E.dDg,deps:[E.R0b,E.eoX,E.rWj]},{provide:E.dDg,useClass:E.dDg,deps:[E.R0b,E.eoX,E.rWj]}],yi=[{provide:E.zSh,useValue:"root"},{provide:E.qLn,useFactory:function ni(){return new E.qLn},deps:[]},{provide:et,useClass:Dr,multi:!0,deps:[ie.K0,E.R0b,E.Lbi]},{provide:et,useClass:Ne,multi:!0,deps:[ie.K0]},wt,rt,Ie,{provide:E.FYo,useExisting:wt},{provide:ie.JF,useClass:pt,deps:[]},[]];let Hr=(()=>{class Oe{constructor(oe){}static withServerTransition(oe){return{ngModule:Oe,providers:[{provide:E.AFp,useValue:oe.appId}]}}static{this.\u0275fac=function(me){return new(me||Oe)(E.LFG($i,12))}}static{this.\u0275mod=E.oAB({type:Oe})}static{this.\u0275inj=E.cJS({providers:[...yi,...Zn],imports:[ie.ez,E.hGG]})}}return Oe})(),us=(()=>{class Oe{constructor(oe){this._doc=oe}getTitle(){return this._doc.title}setTitle(oe){this._doc.title=oe||""}static{this.\u0275fac=function(me){return new(me||Oe)(E.LFG(ie.K0))}}static{this.\u0275prov=E.Yz7({token:Oe,factory:function(me){let qe=null;return qe=me?new me:function Xi(){return new us((0,E.LFG)(ie.K0))}(),qe},providedIn:"root"})}}return Oe})();typeof window<"u"&&window;let Yi=(()=>{class Oe{static{this.\u0275fac=function(me){return new(me||Oe)}}static{this.\u0275prov=E.Yz7({token:Oe,factory:function(me){let qe=null;return qe=me?new(me||Oe):E.LFG(Pn),qe},providedIn:"root"})}}return Oe})(),Pn=(()=>{class Oe extends Yi{constructor(oe){super(),this._doc=oe}sanitize(oe,me){if(null==me)return null;switch(oe){case E.q3G.NONE:return me;case E.q3G.HTML:return(0,E.qzn)(me,"HTML")?(0,E.z3N)(me):(0,E.EiD)(this._doc,String(me)).toString();case E.q3G.STYLE:return(0,E.qzn)(me,"Style")?(0,E.z3N)(me):me;case E.q3G.SCRIPT:if((0,E.qzn)(me,"Script"))return(0,E.z3N)(me);throw new E.vHH(5200,!1);case E.q3G.URL:return(0,E.qzn)(me,"URL")?(0,E.z3N)(me):(0,E.mCW)(String(me));case E.q3G.RESOURCE_URL:if((0,E.qzn)(me,"ResourceURL"))return(0,E.z3N)(me);throw new E.vHH(5201,!1);default:throw new E.vHH(5202,!1)}}bypassSecurityTrustHtml(oe){return(0,E.JVY)(oe)}bypassSecurityTrustStyle(oe){return(0,E.L6k)(oe)}bypassSecurityTrustScript(oe){return(0,E.eBb)(oe)}bypassSecurityTrustUrl(oe){return(0,E.LAX)(oe)}bypassSecurityTrustResourceUrl(oe){return(0,E.pB0)(oe)}static{this.\u0275fac=function(me){return new(me||Oe)(E.LFG(ie.K0))}}static{this.\u0275prov=E.Yz7({token:Oe,factory:function(me){let qe=null;return qe=me?new me:function sn(Oe){return new Pn(Oe.get(ie.K0))}(E.LFG(E.zs3)),qe},providedIn:"root"})}}return Oe})()},4581:(mn,Ke,Z)=>{Z.d(Ke,{gz:()=>Hs,F0:()=>Zi,Bz:()=>Yl,lC:()=>Ta});var E=Z(9212),ie=Z(5592),ze=Z(4674),be=Z(7715),xe=Z(2096),it=Z(5619),ht=Z(2572);const et=(0,Z(2306).d)(x=>function(){x(this),this.name="EmptyError",this.message="no elements in sequence"});var Ie=Z(5211),ot=Z(4911),jt=Z(8407),rt=Z(8504),St=Z(6232),Ln=Z(7394),$t=Z(9360),_n=Z(8251);function mi(){return(0,$t.e)((x,D)=>{let b=null;x._refCount++;const I=(0,_n.x)(D,void 0,void 0,void 0,()=>{if(!x||x._refCount<=0||0<--x._refCount)return void(b=null);const k=x._connection,$=b;b=null,k&&(!$||k===$)&&k.unsubscribe(),D.unsubscribe()});x.subscribe(I),I.closed||(b=x.connect())})}class ui extends ie.y{constructor(D,b){super(),this.source=D,this.subjectFactory=b,this._subject=null,this._refCount=0,this._connection=null,(0,$t.A)(D)&&(this.lift=D.lift)}_subscribe(D){return this.getSubject().subscribe(D)}getSubject(){const D=this._subject;return(!D||D.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:D}=this;this._subject=this._connection=null,D?.unsubscribe()}connect(){let D=this._connection;if(!D){D=this._connection=new Ln.w0;const b=this.getSubject();D.add(this.source.subscribe((0,_n.x)(b,void 0,()=>{this._teardown(),b.complete()},I=>{this._teardown(),b.error(I)},()=>this._teardown()))),D.closed&&(this._connection=null,D=Ln.w0.EMPTY)}return D}refCount(){return mi()(this)}}var yt=Z(8645),Ye=Z(6814),mt=Z(7398),en=Z(4664),wt=Z(8180),xt=Z(7921),wn=Z(2181),tn=Z(1631);function ir(x){return(0,$t.e)((D,b)=>{let I=!1;D.subscribe((0,_n.x)(b,k=>{I=!0,b.next(k)},()=>{I||b.next(x),b.complete()}))})}function or(x=Lr){return(0,$t.e)((D,b)=>{let I=!1;D.subscribe((0,_n.x)(b,k=>{I=!0,b.next(k)},()=>I?b.complete():b.error(x())))})}function Lr(){return new et}var bs=Z(2737);function Dr(x,D){const b=arguments.length>=2;return I=>I.pipe(x?(0,wn.h)((k,$)=>x(k,$,I)):bs.y,(0,wt.q)(1),b?ir(D):or(()=>new et))}var Ir=Z(6328),zi=Z(9397),De=Z(6306);function Ge(x){return x<=0?()=>St.E:(0,$t.e)((D,b)=>{let I=[];D.subscribe((0,_n.x)(b,k=>{I.push(k),x<I.length&&I.shift()},()=>{for(const k of I)b.next(k);b.complete()},void 0,()=>{I=null}))})}var xn=Z(4716),ni=Z(9773),cr=Z(7537),En=Z(6593);const zt="primary",$i=Symbol("RouteTitle");class Zn{constructor(D){this.params=D||{}}has(D){return Object.prototype.hasOwnProperty.call(this.params,D)}get(D){if(this.has(D)){const b=this.params[D];return Array.isArray(b)?b[0]:b}return null}getAll(D){if(this.has(D)){const b=this.params[D];return Array.isArray(b)?b:[b]}return[]}get keys(){return Object.keys(this.params)}}function yi(x){return new Zn(x)}function Hr(x,D,b){const I=b.path.split("/");if(I.length>x.length||"full"===b.pathMatch&&(D.hasChildren()||I.length<x.length))return null;const k={};for(let $=0;$<I.length;$++){const ae=I[$],we=x[$];if(ae.startsWith(":"))k[ae.substring(1)]=we;else if(ae!==we.path)return null}return{consumed:x.slice(0,I.length),posParams:k}}function Mn(x,D){const b=x?mr(x):void 0,I=D?mr(D):void 0;if(!b||!I||b.length!=I.length)return!1;let k;for(let $=0;$<b.length;$++)if(k=b[$],!Xi(x[k],D[k]))return!1;return!0}function mr(x){return[...Object.keys(x),...Object.getOwnPropertySymbols(x)]}function Xi(x,D){if(Array.isArray(x)&&Array.isArray(D)){if(x.length!==D.length)return!1;const b=[...x].sort(),I=[...D].sort();return b.every((k,$)=>I[$]===k)}return x===D}function us(x){return x.length>0?x[x.length-1]:null}function qr(x){return function Pe(x){return!!x&&(x instanceof ie.y||(0,ze.m)(x.lift)&&(0,ze.m)(x.subscribe))}(x)?x:(0,E.QGY)(x)?(0,be.D)(Promise.resolve(x)):(0,xe.of)(x)}const zr={exact:function Gn(x,D,b){if(!Wn(x.segments,D.segments)||!Kr(x.segments,D.segments,b)||x.numberOfChildren!==D.numberOfChildren)return!1;for(const I in D.children)if(!x.children[I]||!Gn(x.children[I],D.children[I],b))return!1;return!0},subset:Qs},Ss={exact:function ii(x,D){return Mn(x,D)},subset:function Ul(x,D){return Object.keys(D).length<=Object.keys(x).length&&Object.keys(D).every(b=>Xi(x[b],D[b]))},ignored:()=>!0};function nn(x,D,b){return zr[b.paths](x.root,D.root,b.matrixParams)&&Ss[b.queryParams](x.queryParams,D.queryParams)&&!("exact"===b.fragment&&x.fragment!==D.fragment)}function Qs(x,D,b){return It(x,D,D.segments,b)}function It(x,D,b,I){if(x.segments.length>b.length){const k=x.segments.slice(0,b.length);return!(!Wn(k,b)||D.hasChildren()||!Kr(k,b,I))}if(x.segments.length===b.length){if(!Wn(x.segments,b)||!Kr(x.segments,b,I))return!1;for(const k in D.children)if(!x.children[k]||!Qs(x.children[k],D.children[k],I))return!1;return!0}{const k=b.slice(0,x.segments.length),$=b.slice(x.segments.length);return!!(Wn(x.segments,k)&&Kr(x.segments,k,I)&&x.children[zt])&&It(x.children[zt],D,$,I)}}function Kr(x,D,b){return D.every((I,k)=>Ss[b](x[k].parameters,I.parameters))}class gr{constructor(D=new bi([],{}),b={},I=null){this.root=D,this.queryParams=b,this.fragment=I}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=yi(this.queryParams)),this._queryParamMap}toString(){return Pn.serialize(this)}}class bi{constructor(D,b){this.segments=D,this.children=b,this.parent=null,Object.values(b).forEach(I=>I.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Zr(this)}}class Li{constructor(D,b){this.path=D,this.parameters=b}get parameterMap(){return this._parameterMap||(this._parameterMap=yi(this.parameters)),this._parameterMap}toString(){return Oe(this)}}function Wn(x,D){return x.length===D.length&&x.every((b,I)=>b.path===D[I].path)}let Yi=(()=>{class x{static{this.\u0275fac=function(I){return new(I||x)}}static{this.\u0275prov=E.Yz7({token:x,factory:()=>new sn,providedIn:"root"})}}return x})();class sn{parse(D){const b=new Ti(D);return new gr(b.parseRootSegment(),b.parseQueryParams(),b.parseFragment())}serialize(D){const b=`/${ns(D.root,!0)}`,I=function oe(x){const D=Object.keys(x).map(b=>{const I=x[b];return Array.isArray(I)?I.map(k=>`${vr(b)}=${vr(k)}`).join("&"):`${vr(b)}=${vr(I)}`}).filter(b=>!!b);return D.length?`?${D.join("&")}`:""}(D.queryParams);return`${b}${I}${"string"==typeof D.fragment?`#${function Gr(x){return encodeURI(x)}(D.fragment)}`:""}`}}const Pn=new sn;function Zr(x){return x.segments.map(D=>Oe(D)).join("/")}function ns(x,D){if(!x.hasChildren())return Zr(x);if(D){const b=x.children[zt]?ns(x.children[zt],!1):"",I=[];return Object.entries(x.children).forEach(([k,$])=>{k!==zt&&I.push(`${k}:${ns($,!1)}`)}),I.length>0?`${b}(${I.join("//")})`:b}{const b=function eo(x,D){let b=[];return Object.entries(x.children).forEach(([I,k])=>{I===zt&&(b=b.concat(D(k,I)))}),Object.entries(x.children).forEach(([I,k])=>{I!==zt&&(b=b.concat(D(k,I)))}),b}(x,(I,k)=>k===zt?[ns(x.children[zt],!1)]:[`${k}:${ns(I,!1)}`]);return 1===Object.keys(x.children).length&&null!=x.children[zt]?`${Zr(x)}/${b[0]}`:`${Zr(x)}/(${b.join("//")})`}}function ws(x){return encodeURIComponent(x).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function vr(x){return ws(x).replace(/%3B/gi,";")}function _i(x){return ws(x).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ar(x){return decodeURIComponent(x)}function ul(x){return ar(x.replace(/\+/g,"%20"))}function Oe(x){return`${_i(x.path)}${function Se(x){return Object.keys(x).map(D=>`;${_i(D)}=${_i(x[D])}`).join("")}(x.parameters)}`}const me=/^[^\/()?;#]+/;function qe(x){const D=x.match(me);return D?D[0]:""}const Lt=/^[^\/()?;=#]+/,Bn=/^[^=?&#]+/,yr=/^[^&#]+/;class Ti{constructor(D){this.url=D,this.remaining=D}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new bi([],{}):new bi([],this.parseChildren())}parseQueryParams(){const D={};if(this.consumeOptional("?"))do{this.parseQueryParam(D)}while(this.consumeOptional("&"));return D}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const D=[];for(this.peekStartsWith("(")||D.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),D.push(this.parseSegment());let b={};this.peekStartsWith("/(")&&(this.capture("/"),b=this.parseParens(!0));let I={};return this.peekStartsWith("(")&&(I=this.parseParens(!1)),(D.length>0||Object.keys(b).length>0)&&(I[zt]=new bi(D,b)),I}parseSegment(){const D=qe(this.remaining);if(""===D&&this.peekStartsWith(";"))throw new E.vHH(4009,!1);return this.capture(D),new Li(ar(D),this.parseMatrixParams())}parseMatrixParams(){const D={};for(;this.consumeOptional(";");)this.parseParam(D);return D}parseParam(D){const b=function Nn(x){const D=x.match(Lt);return D?D[0]:""}(this.remaining);if(!b)return;this.capture(b);let I="";if(this.consumeOptional("=")){const k=qe(this.remaining);k&&(I=k,this.capture(I))}D[ar(b)]=ar(I)}parseQueryParam(D){const b=function Mi(x){const D=x.match(Bn);return D?D[0]:""}(this.remaining);if(!b)return;this.capture(b);let I="";if(this.consumeOptional("=")){const ae=function _r(x){const D=x.match(yr);return D?D[0]:""}(this.remaining);ae&&(I=ae,this.capture(I))}const k=ul(b),$=ul(I);if(D.hasOwnProperty(k)){let ae=D[k];Array.isArray(ae)||(ae=[ae],D[k]=ae),ae.push($)}else D[k]=$}parseParens(D){const b={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const I=qe(this.remaining),k=this.remaining[I.length];if("/"!==k&&")"!==k&&";"!==k)throw new E.vHH(4010,!1);let $;I.indexOf(":")>-1?($=I.slice(0,I.indexOf(":")),this.capture($),this.capture(":")):D&&($=zt);const ae=this.parseChildren();b[$]=1===Object.keys(ae).length?ae[zt]:new bi([],ae),this.consumeOptional("//")}return b}peekStartsWith(D){return this.remaining.startsWith(D)}consumeOptional(D){return!!this.peekStartsWith(D)&&(this.remaining=this.remaining.substring(D.length),!0)}capture(D){if(!this.consumeOptional(D))throw new E.vHH(4011,!1)}}function Jt(x){return x.segments.length>0?new bi([],{[zt]:x}):x}function Fr(x){const D={};for(const I of Object.keys(x.children)){const $=Fr(x.children[I]);if(I===zt&&0===$.segments.length&&$.hasChildren())for(const[ae,we]of Object.entries($.children))D[ae]=we;else($.segments.length>0||$.hasChildren())&&(D[I]=$)}return function to(x){if(1===x.numberOfChildren&&x.children[zt]){const D=x.children[zt];return new bi(x.segments.concat(D.segments),D.children)}return x}(new bi(x.segments,D))}function ds(x){return x instanceof gr}function gi(x){let D;const k=Jt(function b($){const ae={};for(const Ee of $.children){const Ft=b(Ee);ae[Ee.outlet]=Ft}const we=new bi($.url,ae);return $===x&&(D=we),we}(x.root));return D??k}function wa(x,D,b,I){let k=x;for(;k.parent;)k=k.parent;if(0===D.length)return br(k,k,k,b,I);const $=function ve(x){if("string"==typeof x[0]&&1===x.length&&"/"===x[0])return new Ca(!0,0,x);let D=0,b=!1;const I=x.reduce((k,$,ae)=>{if("object"==typeof $&&null!=$){if($.outlets){const we={};return Object.entries($.outlets).forEach(([Ee,Ft])=>{we[Ee]="string"==typeof Ft?Ft.split("/"):Ft}),[...k,{outlets:we}]}if($.segmentPath)return[...k,$.segmentPath]}return"string"!=typeof $?[...k,$]:0===ae?($.split("/").forEach((we,Ee)=>{0==Ee&&"."===we||(0==Ee&&""===we?b=!0:".."===we?D++:""!=we&&k.push(we))}),k):[...k,$]},[]);return new Ca(b,D,I)}(D);if($.toRoot())return br(k,k,new bi([],{}),b,I);const ae=function he(x,D,b){if(x.isAbsolute)return new ue(D,!0,0);if(!b)return new ue(D,!1,NaN);if(null===b.parent)return new ue(b,!0,0);const I=Xs(x.commands[0])?0:1;return function Le(x,D,b){let I=x,k=D,$=b;for(;$>k;){if($-=k,I=I.parent,!I)throw new E.vHH(4005,!1);k=I.segments.length}return new ue(I,!1,k-$)}(b,b.segments.length-1+I,x.numberOfDoubleDots)}($,k,x),we=ae.processChildren?Tt(ae.segmentGroup,ae.index,$.commands):We(ae.segmentGroup,ae.index,$.commands);return br(k,ae.segmentGroup,we,b,I)}function Xs(x){return"object"==typeof x&&null!=x&&!x.outlets&&!x.segmentPath}function Ls(x){return"object"==typeof x&&null!=x&&x.outlets}function br(x,D,b,I,k){let ae,$={};I&&Object.entries(I).forEach(([Ee,Ft])=>{$[Ee]=Array.isArray(Ft)?Ft.map($n=>`${$n}`):`${Ft}`}),ae=x===D?b:na(x,D,b);const we=Jt(Fr(ae));return new gr(we,$,k)}function na(x,D,b){const I={};return Object.entries(x.children).forEach(([k,$])=>{I[k]=$===D?b:na($,D,b)}),new bi(x.segments,I)}class Ca{constructor(D,b,I){if(this.isAbsolute=D,this.numberOfDoubleDots=b,this.commands=I,D&&I.length>0&&Xs(I[0]))throw new E.vHH(4003,!1);const k=I.find(Ls);if(k&&k!==us(I))throw new E.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ue{constructor(D,b,I){this.segmentGroup=D,this.processChildren=b,this.index=I}}function We(x,D,b){if(x||(x=new bi([],{})),0===x.segments.length&&x.hasChildren())return Tt(x,D,b);const I=function Vn(x,D,b){let I=0,k=D;const $={match:!1,pathIndex:0,commandIndex:0};for(;k<x.segments.length;){if(I>=b.length)return $;const ae=x.segments[k],we=b[I];if(Ls(we))break;const Ee=`${we}`,Ft=I<b.length-1?b[I+1]:null;if(k>0&&void 0===Ee)break;if(Ee&&Ft&&"object"==typeof Ft&&void 0===Ft.outlets){if(!Fn(Ee,Ft,ae))return $;I+=2}else{if(!Fn(Ee,{},ae))return $;I++}k++}return{match:!0,pathIndex:k,commandIndex:I}}(x,D,b),k=b.slice(I.commandIndex);if(I.match&&I.pathIndex<x.segments.length){const $=new bi(x.segments.slice(0,I.pathIndex),{});return $.children[zt]=new bi(x.segments.slice(I.pathIndex),x.children),Tt($,0,k)}return I.match&&0===k.length?new bi(x.segments,{}):I.match&&!x.hasChildren()?Bt(x,D,b):I.match?Tt(x,0,k):Bt(x,D,b)}function Tt(x,D,b){if(0===b.length)return new bi(x.segments,{});{const I=function at(x){return Ls(x[0])?x[0].outlets:{[zt]:x}}(b),k={};if(Object.keys(I).some($=>$!==zt)&&x.children[zt]&&1===x.numberOfChildren&&0===x.children[zt].segments.length){const $=Tt(x.children[zt],D,b);return new bi(x.segments,$.children)}return Object.entries(I).forEach(([$,ae])=>{"string"==typeof ae&&(ae=[ae]),null!==ae&&(k[$]=We(x.children[$],D,ae))}),Object.entries(x.children).forEach(([$,ae])=>{void 0===I[$]&&(k[$]=ae)}),new bi(x.segments,k)}}function Bt(x,D,b){const I=x.segments.slice(0,D);let k=0;for(;k<b.length;){const $=b[k];if(Ls($)){const Ee=Ui($.outlets);return new bi(I,Ee)}if(0===k&&Xs(b[0])){I.push(new Li(x.segments[D].path,wi(b[0]))),k++;continue}const ae=Ls($)?$.outlets[zt]:`${$}`,we=k<b.length-1?b[k+1]:null;ae&&we&&Xs(we)?(I.push(new Li(ae,wi(we))),k+=2):(I.push(new Li(ae,{})),k++)}return new bi(I,{})}function Ui(x){const D={};return Object.entries(x).forEach(([b,I])=>{"string"==typeof I&&(I=[I]),null!==I&&(D[b]=Bt(new bi([],{}),0,I))}),D}function wi(x){const D={};return Object.entries(x).forEach(([b,I])=>D[b]=`${I}`),D}function Fn(x,D,b){return x==b.path&&Mn(D,b.parameters)}const qi="imperative";class Ur{constructor(D,b){this.id=D,this.url=b}}class an extends Ur{constructor(D,b,I="imperative",k=null){super(D,b),this.type=0,this.navigationTrigger=I,this.restoredState=k}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Jn extends Ur{constructor(D,b,I){super(D,b),this.urlAfterRedirects=I,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class ti extends Ur{constructor(D,b,I,k){super(D,b),this.reason=I,this.code=k,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class er extends Ur{constructor(D,b,I,k){super(D,b),this.reason=I,this.code=k,this.type=16}}class Cs extends Ur{constructor(D,b,I,k){super(D,b),this.error=I,this.target=k,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class ur extends Ur{constructor(D,b,I,k){super(D,b),this.urlAfterRedirects=I,this.state=k,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ys extends Ur{constructor(D,b,I,k){super(D,b),this.urlAfterRedirects=I,this.state=k,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Fa extends Ur{constructor(D,b,I,k,$){super(D,b),this.urlAfterRedirects=I,this.state=k,this.shouldActivate=$,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Vs extends Ur{constructor(D,b,I,k){super(D,b),this.urlAfterRedirects=I,this.state=k,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Lo extends Ur{constructor(D,b,I,k){super(D,b),this.urlAfterRedirects=I,this.state=k,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ia{constructor(D){this.route=D,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class kl{constructor(D){this.route=D,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Fo{constructor(D){this.snapshot=D,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Jr{constructor(D){this.snapshot=D,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ra{constructor(D){this.snapshot=D,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ua{constructor(D){this.snapshot=D,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ka{constructor(D,b,I){this.routerEvent=D,this.position=b,this.anchor=I,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Ba{}class vo{constructor(D){this.url=D}}class Va{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new hs,this.attachRef=null}}let hs=(()=>{class x{constructor(){this.contexts=new Map}onChildOutletCreated(b,I){const k=this.getOrCreateContext(b);k.outlet=I,this.contexts.set(b,k)}onChildOutletDestroyed(b){const I=this.getContext(b);I&&(I.outlet=null,I.attachRef=null)}onOutletDeactivated(){const b=this.contexts;return this.contexts=new Map,b}onOutletReAttached(b){this.contexts=b}getOrCreateContext(b){let I=this.getContext(b);return I||(I=new Va,this.contexts.set(b,I)),I}getContext(b){return this.contexts.get(b)||null}static{this.\u0275fac=function(I){return new(I||x)}}static{this.\u0275prov=E.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"})}}return x})();class Ha{constructor(D){this._root=D}get root(){return this._root.value}parent(D){const b=this.pathFromRoot(D);return b.length>1?b[b.length-2]:null}children(D){const b=dr(D,this._root);return b?b.children.map(I=>I.value):[]}firstChild(D){const b=dr(D,this._root);return b&&b.children.length>0?b.children[0].value:null}siblings(D){const b=sa(D,this._root);return b.length<2?[]:b[b.length-2].children.map(k=>k.value).filter(k=>k!==D)}pathFromRoot(D){return sa(D,this._root).map(b=>b.value)}}function dr(x,D){if(x===D.value)return D;for(const b of D.children){const I=dr(x,b);if(I)return I}return null}function sa(x,D){if(x===D.value)return[D];for(const b of D.children){const I=sa(x,b);if(I.length)return I.unshift(D),I}return[]}class Hn{constructor(D,b){this.value=D,this.children=b}toString(){return`TreeNode(${this.value})`}}function no(x){const D={};return x&&x.children.forEach(b=>D[b.value.outlet]=b),D}class Uo extends Ha{constructor(D,b){super(D),this.snapshot=b,is(this,D)}toString(){return this.snapshot.toString()}}function oa(x,D){const b=function ko(x,D){const ae=new Wr([],{},{},"",{},zt,D,null,{});return new zs("",new Hn(ae,[]))}(0,D),I=new it.X([new Li("",{})]),k=new it.X({}),$=new it.X({}),ae=new it.X({}),we=new it.X(""),Ee=new Hs(I,k,ae,we,$,zt,D,b.root);return Ee.snapshot=b.root,new Uo(new Hn(Ee,[]),b)}class Hs{constructor(D,b,I,k,$,ae,we,Ee){this.urlSubject=D,this.paramsSubject=b,this.queryParamsSubject=I,this.fragmentSubject=k,this.dataSubject=$,this.outlet=ae,this.component=we,this._futureSnapshot=Ee,this.title=this.dataSubject?.pipe((0,mt.U)(Ft=>Ft[$i]))??(0,xe.of)(void 0),this.url=D,this.params=b,this.queryParams=I,this.fragment=k,this.data=$}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,mt.U)(D=>yi(D)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,mt.U)(D=>yi(D)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Bo(x,D,b="emptyOnly"){let I;const{routeConfig:k}=x;return I=null===D||"always"!==b&&""!==k?.path&&(D.component||D.routeConfig?.loadComponent)?{params:{...x.params},data:{...x.data},resolve:{...x.data,...x._resolvedData??{}}}:{params:{...D.params,...x.params},data:{...D.data,...x.data},resolve:{...x.data,...D.data,...k?.data,...x._resolvedData}},k&&io(k)&&(I.resolve[$i]=k.title),I}class Wr{get title(){return this.data?.[$i]}constructor(D,b,I,k,$,ae,we,Ee,Ft){this.url=D,this.params=b,this.queryParams=I,this.fragment=k,this.data=$,this.outlet=ae,this.component=we,this.routeConfig=Ee,this._resolve=Ft}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=yi(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=yi(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(I=>I.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class zs extends Ha{constructor(D,b){super(b),this.url=D,is(this,b)}toString(){return Ts(this._root)}}function is(x,D){D.value._routerState=x,D.children.forEach(b=>is(x,b))}function Ts(x){const D=x.children.length>0?` { ${x.children.map(Ts).join(", ")} } `:"";return`${x.value}${D}`}function hi(x){if(x.snapshot){const D=x.snapshot,b=x._futureSnapshot;x.snapshot=b,Mn(D.queryParams,b.queryParams)||x.queryParamsSubject.next(b.queryParams),D.fragment!==b.fragment&&x.fragmentSubject.next(b.fragment),Mn(D.params,b.params)||x.paramsSubject.next(b.params),function Qi(x,D){if(x.length!==D.length)return!1;for(let b=0;b<x.length;++b)if(!Mn(x[b],D[b]))return!1;return!0}(D.url,b.url)||x.urlSubject.next(b.url),Mn(D.data,b.data)||x.dataSubject.next(b.data)}else x.snapshot=x._futureSnapshot,x.dataSubject.next(x._futureSnapshot.data)}function aa(x,D){const b=Mn(x.params,D.params)&&function ta(x,D){return Wn(x,D)&&x.every((b,I)=>Mn(b.parameters,D[I].parameters))}(x.url,D.url);return b&&!(!x.parent!=!D.parent)&&(!x.parent||aa(x.parent,D.parent))}function io(x){return"string"==typeof x.title||null===x.title}let Ta=(()=>{class x{constructor(){this.activated=null,this._activatedRoute=null,this.name=zt,this.activateEvents=new E.vpe,this.deactivateEvents=new E.vpe,this.attachEvents=new E.vpe,this.detachEvents=new E.vpe,this.parentContexts=(0,E.f3M)(hs),this.location=(0,E.f3M)(E.s_b),this.changeDetector=(0,E.f3M)(E.sBO),this.environmentInjector=(0,E.f3M)(E.lqb),this.inputBinder=(0,E.f3M)(ro,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(b){if(b.name){const{firstChange:I,previousValue:k}=b.name;if(I)return;this.isTrackedInParentContexts(k)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(k)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(b){return this.parentContexts.getContext(b)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const b=this.parentContexts.getContext(this.name);b?.route&&(b.attachRef?this.attach(b.attachRef,b.route):this.activateWith(b.route,b.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new E.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new E.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new E.vHH(4012,!1);this.location.detach();const b=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(b.instance),b}attach(b,I){this.activated=b,this._activatedRoute=I,this.location.insert(b.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(b.instance)}deactivate(){if(this.activated){const b=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(b)}}activateWith(b,I){if(this.isActivated)throw new E.vHH(4013,!1);this._activatedRoute=b;const k=this.location,ae=b.snapshot.component,we=this.parentContexts.getOrCreateContext(this.name).children,Ee=new bc(b,we,k.injector);this.activated=k.createComponent(ae,{index:k.length,injector:Ee,environmentInjector:I??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(I){return new(I||x)}}static{this.\u0275dir=E.lG2({type:x,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[E.TTD]})}}return x})();class bc{constructor(D,b,I){this.route=D,this.childContexts=b,this.parent=I}get(D,b){return D===Hs?this.route:D===hs?this.childContexts:this.parent.get(D,b)}}const ro=new E.OlP("");let dl=(()=>{class x{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(b){this.unsubscribeFromRouteData(b),this.subscribeToRouteData(b)}unsubscribeFromRouteData(b){this.outletDataSubscriptions.get(b)?.unsubscribe(),this.outletDataSubscriptions.delete(b)}subscribeToRouteData(b){const{activatedRoute:I}=b,k=(0,ht.a)([I.queryParams,I.params,I.data]).pipe((0,en.w)(([$,ae,we],Ee)=>(we={...$,...ae,...we},0===Ee?(0,xe.of)(we):Promise.resolve(we)))).subscribe($=>{if(!b.isActivated||!b.activatedComponentRef||b.activatedRoute!==I||null===I.component)return void this.unsubscribeFromRouteData(b);const ae=(0,E.qFp)(I.component);if(ae)for(const{templateName:we}of ae.inputs)b.activatedComponentRef.setInput(we,$[we]);else this.unsubscribeFromRouteData(b)});this.outletDataSubscriptions.set(b,k)}static{this.\u0275fac=function(I){return new(I||x)}}static{this.\u0275prov=E.Yz7({token:x,factory:x.\u0275fac})}}return x})();function As(x,D,b){if(b&&x.shouldReuseRoute(D.value,b.value.snapshot)){const I=b.value;I._futureSnapshot=D.value;const k=function Bl(x,D,b){return D.children.map(I=>{for(const k of b.children)if(x.shouldReuseRoute(I.value,k.value.snapshot))return As(x,I,k);return As(x,I)})}(x,D,b);return new Hn(I,k)}{if(x.shouldAttach(D.value)){const $=x.retrieve(D.value);if(null!==$){const ae=$.route;return ae.value._futureSnapshot=D.value,ae.children=D.children.map(we=>As(x,we)),ae}}const I=function so(x){return new Hs(new it.X(x.url),new it.X(x.params),new it.X(x.queryParams),new it.X(x.fragment),new it.X(x.data),x.outlet,x.component,x)}(D.value),k=D.children.map($=>As(x,$));return new Hn(I,k)}}const Mr="ngNavigationCancelingError";function Ai(x,D){const{redirectTo:b,navigationBehaviorOptions:I}=ds(D)?{redirectTo:D,navigationBehaviorOptions:void 0}:D,k=za(!1,0,D);return k.url=b,k.navigationBehaviorOptions=I,k}function za(x,D,b){const I=new Error("NavigationCancelingError: "+(x||""));return I[Mr]=!0,I.cancellationCode=D,b&&(I.url=b),I}function Sc(x){return x&&x[Mr]}let _o=(()=>{class x{static{this.\u0275fac=function(I){return new(I||x)}}static{this.\u0275cmp=E.Xpm({type:x,selectors:[["ng-component"]],standalone:!0,features:[E.jDz],decls:1,vars:0,template:function(I,k){1&I&&E._UZ(0,"router-outlet")},dependencies:[Ta],encapsulation:2})}}return x})();function Mo(x){const D=x.children&&x.children.map(Mo),b=D?{...x,children:D}:{...x};return!b.component&&!b.loadComponent&&(D||b.loadChildren)&&b.outlet&&b.outlet!==zt&&(b.component=_o),b}function qs(x){return x.outlet||zt}function Ga(x){if(!x)return null;if(x.routeConfig?._injector)return x.routeConfig._injector;for(let D=x.parent;D;D=D.parent){const b=D.routeConfig;if(b?._loadedInjector)return b._loadedInjector;if(b?._injector)return b._injector}return null}class $r{constructor(D,b,I,k,$){this.routeReuseStrategy=D,this.futureState=b,this.currState=I,this.forwardEvent=k,this.inputBindingEnabled=$}activate(D){const b=this.futureState._root,I=this.currState?this.currState._root:null;this.deactivateChildRoutes(b,I,D),hi(this.futureState.root),this.activateChildRoutes(b,I,D)}deactivateChildRoutes(D,b,I){const k=no(b);D.children.forEach($=>{const ae=$.value.outlet;this.deactivateRoutes($,k[ae],I),delete k[ae]}),Object.values(k).forEach($=>{this.deactivateRouteAndItsChildren($,I)})}deactivateRoutes(D,b,I){const k=D.value,$=b?b.value:null;if(k===$)if(k.component){const ae=I.getContext(k.outlet);ae&&this.deactivateChildRoutes(D,b,ae.children)}else this.deactivateChildRoutes(D,b,I);else $&&this.deactivateRouteAndItsChildren(b,I)}deactivateRouteAndItsChildren(D,b){D.value.component&&this.routeReuseStrategy.shouldDetach(D.value.snapshot)?this.detachAndStoreRouteSubtree(D,b):this.deactivateRouteAndOutlet(D,b)}detachAndStoreRouteSubtree(D,b){const I=b.getContext(D.value.outlet),k=I&&D.value.component?I.children:b,$=no(D);for(const ae of Object.keys($))this.deactivateRouteAndItsChildren($[ae],k);if(I&&I.outlet){const ae=I.outlet.detach(),we=I.children.onOutletDeactivated();this.routeReuseStrategy.store(D.value.snapshot,{componentRef:ae,route:D,contexts:we})}}deactivateRouteAndOutlet(D,b){const I=b.getContext(D.value.outlet),k=I&&D.value.component?I.children:b,$=no(D);for(const ae of Object.keys($))this.deactivateRouteAndItsChildren($[ae],k);I&&(I.outlet&&(I.outlet.deactivate(),I.children.onOutletDeactivated()),I.attachRef=null,I.route=null)}activateChildRoutes(D,b,I){const k=no(b);D.children.forEach($=>{this.activateRoutes($,k[$.value.outlet],I),this.forwardEvent(new Ua($.value.snapshot))}),D.children.length&&this.forwardEvent(new Jr(D.value.snapshot))}activateRoutes(D,b,I){const k=D.value,$=b?b.value:null;if(hi(k),k===$)if(k.component){const ae=I.getOrCreateContext(k.outlet);this.activateChildRoutes(D,b,ae.children)}else this.activateChildRoutes(D,b,I);else if(k.component){const ae=I.getOrCreateContext(k.outlet);if(this.routeReuseStrategy.shouldAttach(k.snapshot)){const we=this.routeReuseStrategy.retrieve(k.snapshot);this.routeReuseStrategy.store(k.snapshot,null),ae.children.onOutletReAttached(we.contexts),ae.attachRef=we.componentRef,ae.route=we.route.value,ae.outlet&&ae.outlet.attach(we.componentRef,we.route.value),hi(we.route.value),this.activateChildRoutes(D,null,ae.children)}else{const we=Ga(k.snapshot);ae.attachRef=null,ae.route=k,ae.injector=we,ae.outlet&&ae.outlet.activateWith(k,ae.injector),this.activateChildRoutes(D,null,ae.children)}}else this.activateChildRoutes(D,null,I)}}class oo{constructor(D){this.path=D,this.route=this.path[this.path.length-1]}}class Rr{constructor(D,b){this.component=D,this.route=b}}function Ac(x,D,b){const I=x._root;return Wa(I,D?D._root:null,b,[I.value])}function Vo(x,D){const b=Symbol(),I=D.get(x,b);return I===b?"function"!=typeof x||(0,E.Z0I)(x)?D.get(x):x:I}function Wa(x,D,b,I,k={canDeactivateChecks:[],canActivateChecks:[]}){const $=no(D);return x.children.forEach(ae=>{(function fl(x,D,b,I,k={canDeactivateChecks:[],canActivateChecks:[]}){const $=x.value,ae=D?D.value:null,we=b?b.getContext(x.value.outlet):null;if(ae&&$.routeConfig===ae.routeConfig){const Ee=function Sr(x,D,b){if("function"==typeof b)return b(x,D);switch(b){case"pathParamsChange":return!Wn(x.url,D.url);case"pathParamsOrQueryParamsChange":return!Wn(x.url,D.url)||!Mn(x.queryParams,D.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!aa(x,D)||!Mn(x.queryParams,D.queryParams);default:return!aa(x,D)}}(ae,$,$.routeConfig.runGuardsAndResolvers);Ee?k.canActivateChecks.push(new oo(I)):($.data=ae.data,$._resolvedData=ae._resolvedData),Wa(x,D,$.component?we?we.children:null:b,I,k),Ee&&we&&we.outlet&&we.outlet.isActivated&&k.canDeactivateChecks.push(new Rr(we.outlet.component,ae))}else ae&&Mt(D,we,k),k.canActivateChecks.push(new oo(I)),Wa(x,null,$.component?we?we.children:null:b,I,k)})(ae,$[ae.value.outlet],b,I.concat([ae.value]),k),delete $[ae.value.outlet]}),Object.entries($).forEach(([ae,we])=>Mt(we,b.getContext(ae),k)),k}function Mt(x,D,b){const I=no(x),k=x.value;Object.entries(I).forEach(([$,ae])=>{Mt(ae,k.component?D?D.children.getContext($):null:D,b)}),b.canDeactivateChecks.push(new Rr(k.component&&D&&D.outlet&&D.outlet.isActivated?D.outlet.component:null,k))}function un(x){return"function"==typeof x}function Tn(x){return x instanceof et||"EmptyError"===x?.name}const rs=Symbol("INITIAL_VALUE");function Pr(){return(0,en.w)(x=>(0,ht.a)(x.map(D=>D.pipe((0,wt.q)(1),(0,xt.O)(rs)))).pipe((0,mt.U)(D=>{for(const b of D)if(!0!==b){if(b===rs)return rs;if(!1===b||b instanceof gr)return b}return!0}),(0,wn.h)(D=>D!==rs),(0,wt.q)(1)))}function Eo(x){return(0,jt.z)((0,zi.b)(D=>{if(ds(D))throw Ai(0,D)}),(0,mt.U)(D=>!0===D))}class Vl{constructor(D){this.segmentGroup=D||null}}class Xa extends Error{constructor(D){super(),this.urlTree=D}}function fs(x){return(0,rt._)(new Vl(x))}class Ya{constructor(D,b){this.urlSerializer=D,this.urlTree=b}lineralizeSegments(D,b){let I=[],k=b.root;for(;;){if(I=I.concat(k.segments),0===k.numberOfChildren)return(0,xe.of)(I);if(k.numberOfChildren>1||!k.children[zt])return(0,rt._)(new E.vHH(4e3,!1));k=k.children[zt]}}applyRedirectCommands(D,b,I){const k=this.applyRedirectCreateUrlTree(b,this.urlSerializer.parse(b),D,I);if(b.startsWith("/"))throw new Xa(k);return k}applyRedirectCreateUrlTree(D,b,I,k){const $=this.createSegmentGroup(D,b.root,I,k);return new gr($,this.createQueryParams(b.queryParams,this.urlTree.queryParams),b.fragment)}createQueryParams(D,b){const I={};return Object.entries(D).forEach(([k,$])=>{if("string"==typeof $&&$.startsWith(":")){const we=$.substring(1);I[k]=b[we]}else I[k]=$}),I}createSegmentGroup(D,b,I,k){const $=this.createSegments(D,b.segments,I,k);let ae={};return Object.entries(b.children).forEach(([we,Ee])=>{ae[we]=this.createSegmentGroup(D,Ee,I,k)}),new bi($,ae)}createSegments(D,b,I,k){return b.map($=>$.path.startsWith(":")?this.findPosParam(D,$,k):this.findOrReturn($,I))}findPosParam(D,b,I){const k=I[b.path.substring(1)];if(!k)throw new E.vHH(4001,!1);return k}findOrReturn(D,b){let I=0;for(const k of b){if(k.path===D.path)return b.splice(I),k;I++}return D}}const Qr={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function os(x,D,b,I,k){const $=zl(x,D,b);return $.matched?(I=function Du(x,D){return x.providers&&!x._injector&&(x._injector=(0,E.MMx)(x.providers,D,`Route: ${x.path}`)),x._injector??D}(D,I),function Un(x,D,b,I){const k=D.canMatch;if(!k||0===k.length)return(0,xe.of)(!0);const $=k.map(ae=>{const we=Vo(ae,x);return qr(function dt(x){return x&&un(x.canMatch)}(we)?we.canMatch(D,b):(0,E.r_H)(x,()=>we(D,b)))});return(0,xe.of)($).pipe(Pr(),Eo())}(I,D,b).pipe((0,mt.U)(ae=>!0===ae?$:{...Qr}))):(0,xe.of)($)}function zl(x,D,b){if("**"===D.path)return function qa(x){return{matched:!0,parameters:x.length>0?us(x).parameters:{},consumedSegments:x,remainingSegments:[],positionalParamSegments:{}}}(b);if(""===D.path)return"full"===D.pathMatch&&(x.hasChildren()||b.length>0)?{...Qr}:{matched:!0,consumedSegments:[],remainingSegments:b,parameters:{},positionalParamSegments:{}};const k=(D.matcher||Hr)(b,x,D);if(!k)return{...Qr};const $={};Object.entries(k.posParams??{}).forEach(([we,Ee])=>{$[we]=Ee.path});const ae=k.consumed.length>0?{...$,...k.consumed[k.consumed.length-1].parameters}:$;return{matched:!0,consumedSegments:k.consumed,remainingSegments:b.slice(k.consumed.length),parameters:ae,positionalParamSegments:k.posParams??{}}}function Gl(x,D,b,I){return b.length>0&&function Ou(x,D,b){return b.some(I=>zn(x,D,I)&&qs(I)!==zt)}(x,b,I)?{segmentGroup:new bi(D,qn(I,new bi(b,x.children))),slicedSegments:[]}:0===b.length&&function Je(x,D,b){return b.some(I=>zn(x,D,I))}(x,b,I)?{segmentGroup:new bi(x.segments,hr(x,0,b,I,x.children)),slicedSegments:b}:{segmentGroup:new bi(x.segments,x.children),slicedSegments:b}}function hr(x,D,b,I,k){const $={};for(const ae of I)if(zn(x,b,ae)&&!k[qs(ae)]){const we=new bi([],{});$[qs(ae)]=we}return{...k,...$}}function qn(x,D){const b={};b[zt]=D;for(const I of x)if(""===I.path&&qs(I)!==zt){const k=new bi([],{});b[qs(I)]=k}return b}function zn(x,D,b){return(!(x.hasChildren()||D.length>0)||"full"!==b.pathMatch)&&""===b.path}class Lu{}class kp{constructor(D,b,I,k,$,ae,we){this.injector=D,this.configLoader=b,this.rootComponentType=I,this.config=k,this.urlTree=$,this.paramsInheritanceStrategy=ae,this.urlSerializer=we,this.applyRedirects=new Ya(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(D){return new E.vHH(4002,`'${D.segmentGroup}'`)}recognize(){const D=Gl(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(D).pipe((0,mt.U)(b=>{const I=new Wr([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},zt,this.rootComponentType,null,{}),k=new Hn(I,b),$=new zs("",k),ae=function Oo(x,D,b=null,I=null){return wa(gi(x),D,b,I)}(I,[],this.urlTree.queryParams,this.urlTree.fragment);return ae.queryParams=this.urlTree.queryParams,$.url=this.urlSerializer.serialize(ae),this.inheritParamsAndData($._root,null),{state:$,tree:ae}}))}match(D){return this.processSegmentGroup(this.injector,this.config,D,zt).pipe((0,De.K)(I=>{if(I instanceof Xa)return this.urlTree=I.urlTree,this.match(I.urlTree.root);throw I instanceof Vl?this.noMatchError(I):I}))}inheritParamsAndData(D,b){const I=D.value,k=Bo(I,b,this.paramsInheritanceStrategy);I.params=Object.freeze(k.params),I.data=Object.freeze(k.data),D.children.forEach($=>this.inheritParamsAndData($,I))}processSegmentGroup(D,b,I,k){return 0===I.segments.length&&I.hasChildren()?this.processChildren(D,b,I):this.processSegment(D,b,I,I.segments,k,!0).pipe((0,mt.U)($=>$ instanceof Hn?[$]:[]))}processChildren(D,b,I){const k=[];for(const $ of Object.keys(I.children))"primary"===$?k.unshift($):k.push($);return(0,be.D)(k).pipe((0,Ir.b)($=>{const ae=I.children[$],we=function Tc(x,D){const b=x.filter(I=>qs(I)===D);return b.push(...x.filter(I=>qs(I)!==D)),b}(b,$);return this.processSegmentGroup(D,we,ae,$)}),function $e(x,D){return(0,$t.e)(function Ne(x,D,b,I,k){return($,ae)=>{let we=b,Ee=D,Ft=0;$.subscribe((0,_n.x)(ae,$n=>{const kn=Ft++;Ee=we?x(Ee,$n,kn):(we=!0,$n),I&&ae.next(Ee)},k&&(()=>{we&&ae.next(Ee),ae.complete()})))}}(x,D,arguments.length>=2,!0))}(($,ae)=>($.push(...ae),$)),ir(null),function gt(x,D){const b=arguments.length>=2;return I=>I.pipe(x?(0,wn.h)((k,$)=>x(k,$,I)):bs.y,Ge(1),b?ir(D):or(()=>new et))}(),(0,tn.z)($=>{if(null===$)return fs(I);const ae=jh($);return function Wh(x){x.sort((D,b)=>D.value.outlet===zt?-1:b.value.outlet===zt?1:D.value.outlet.localeCompare(b.value.outlet))}(ae),(0,xe.of)(ae)}))}processSegment(D,b,I,k,$,ae){return(0,be.D)(b).pipe((0,Ir.b)(we=>this.processSegmentAgainstRoute(we._injector??D,b,we,I,k,$,ae).pipe((0,De.K)(Ee=>{if(Ee instanceof Vl)return(0,xe.of)(null);throw Ee}))),Dr(we=>!!we),(0,De.K)(we=>{if(Tn(we))return function Rd(x,D,b){return 0===D.length&&!x.children[b]}(I,k,$)?(0,xe.of)(new Lu):fs(I);throw we}))}processSegmentAgainstRoute(D,b,I,k,$,ae,we){return function Wl(x,D,b,I){return!!(qs(x)===I||I!==zt&&zn(D,b,x))&&zl(D,x,b).matched}(I,k,$,ae)?void 0===I.redirectTo?this.matchSegmentAgainstRoute(D,k,I,$,ae):this.allowRedirects&&we?this.expandSegmentAgainstRouteUsingRedirect(D,k,b,I,$,ae):fs(k):fs(k)}expandSegmentAgainstRouteUsingRedirect(D,b,I,k,$,ae){const{matched:we,consumedSegments:Ee,positionalParamSegments:Ft,remainingSegments:$n}=zl(b,k,$);if(!we)return fs(b);k.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const kn=this.applyRedirects.applyRedirectCommands(Ee,k.redirectTo,Ft);return this.applyRedirects.lineralizeSegments(k,kn).pipe((0,tn.z)(Si=>this.processSegment(D,I,b,Si.concat($n),ae,!1)))}matchSegmentAgainstRoute(D,b,I,k,$){const ae=os(b,I,k,D);return"**"===I.path&&(b.children={}),ae.pipe((0,en.w)(we=>we.matched?this.getChildConfig(D=I._injector??D,I,k).pipe((0,en.w)(({routes:Ee})=>{const Ft=I._loadedInjector??D,{consumedSegments:$n,remainingSegments:kn,parameters:Si}=we,gs=new Wr($n,Si,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function Bp(x){return x.data||{}}(I),qs(I),I.component??I._loadedComponent??null,I,function fi(x){return x.resolve||{}}(I)),{segmentGroup:Wi,slicedSegments:yl}=Gl(b,$n,kn,Ee);if(0===yl.length&&Wi.hasChildren())return this.processChildren(Ft,Ee,Wi).pipe((0,mt.U)(Vr=>null===Vr?null:new Hn(gs,Vr)));if(0===Ee.length&&0===yl.length)return(0,xe.of)(new Hn(gs,[]));const kt=qs(I)===$;return this.processSegment(Ft,Ee,Wi,yl,kt?zt:$,!0).pipe((0,mt.U)(Vr=>new Hn(gs,Vr instanceof Hn?[Vr]:[])))})):fs(b)))}getChildConfig(D,b,I){return b.children?(0,xe.of)({routes:b.children,injector:D}):b.loadChildren?void 0!==b._loadedRoutes?(0,xe.of)({routes:b._loadedRoutes,injector:b._loadedInjector}):function ca(x,D,b,I){const k=D.canLoad;if(void 0===k||0===k.length)return(0,xe.of)(!0);const $=k.map(ae=>{const we=Vo(ae,x);return qr(function H(x){return x&&un(x.canLoad)}(we)?we.canLoad(D,b):(0,E.r_H)(x,()=>we(D,b)))});return(0,xe.of)($).pipe(Pr(),Eo())}(D,b,I).pipe((0,tn.z)(k=>k?this.configLoader.loadChildren(D,b).pipe((0,zi.b)($=>{b._loadedRoutes=$.routes,b._loadedInjector=$.injector})):function kr(x){return(0,rt._)(za(!1,3))}())):(0,xe.of)({routes:[],injector:D})}}function Rc(x){const D=x.value.routeConfig;return D&&""===D.path}function jh(x){const D=[],b=new Set;for(const I of x){if(!Rc(I)){D.push(I);continue}const k=D.find($=>I.value.routeConfig===$.value.routeConfig);void 0!==k?(k.children.push(...I.children),b.add(k)):D.push(I)}for(const I of b){const k=jh(I.children);D.push(new Hn(I.value,k))}return D.filter(I=>!b.has(I))}function W(x){const D=x.children.map(b=>W(b)).flat();return[x,...D]}function Te(x){return(0,en.w)(D=>{const b=x(D);return b?(0,be.D)(b).pipe((0,mt.U)(()=>D)):(0,xe.of)(D)})}let Ze=(()=>{class x{buildTitle(b){let I,k=b.root;for(;void 0!==k;)I=this.getResolvedTitleForRoute(k)??I,k=k.children.find($=>$.outlet===zt);return I}getResolvedTitleForRoute(b){return b.data[$i]}static{this.\u0275fac=function(I){return new(I||x)}}static{this.\u0275prov=E.Yz7({token:x,factory:()=>(0,E.f3M)(qt),providedIn:"root"})}}return x})(),qt=(()=>{class x extends Ze{constructor(b){super(),this.title=b}updateTitle(b){const I=this.buildTitle(b);void 0!==I&&this.title.setTitle(I)}static{this.\u0275fac=function(I){return new(I||x)(E.LFG(En.Dx))}}static{this.\u0275prov=E.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"})}}return x})();const xi=new E.OlP("",{providedIn:"root",factory:()=>({})}),vi=new E.OlP("ROUTES");let Di=(()=>{class x{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,E.f3M)(E.Sil)}loadComponent(b){if(this.componentLoaders.get(b))return this.componentLoaders.get(b);if(b._loadedComponent)return(0,xe.of)(b._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(b);const I=qr(b.loadComponent()).pipe((0,mt.U)(dn),(0,zi.b)($=>{this.onLoadEndListener&&this.onLoadEndListener(b),b._loadedComponent=$}),(0,xn.x)(()=>{this.componentLoaders.delete(b)})),k=new ui(I,()=>new yt.x).pipe(mi());return this.componentLoaders.set(b,k),k}loadChildren(b,I){if(this.childrenLoaders.get(I))return this.childrenLoaders.get(I);if(I._loadedRoutes)return(0,xe.of)({routes:I._loadedRoutes,injector:I._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(I);const $=function di(x,D,b,I){return qr(x.loadChildren()).pipe((0,mt.U)(dn),(0,tn.z)(k=>k instanceof E.YKP||Array.isArray(k)?(0,xe.of)(k):(0,be.D)(D.compileModuleAsync(k))),(0,mt.U)(k=>{I&&I(x);let $,ae,we=!1;return Array.isArray(k)?(ae=k,!0):($=k.create(b).injector,ae=$.get(vi,[],{optional:!0,self:!0}).flat()),{routes:ae.map(Mo),injector:$}}))}(I,this.compiler,b,this.onLoadEndListener).pipe((0,xn.x)(()=>{this.childrenLoaders.delete(I)})),ae=new ui($,()=>new yt.x).pipe(mi());return this.childrenLoaders.set(I,ae),ae}static{this.\u0275fac=function(I){return new(I||x)}}static{this.\u0275prov=E.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"})}}return x})();function dn(x){return function Ii(x){return x&&"object"==typeof x&&"default"in x}(x)?x.default:x}let Nr=(()=>{class x{static{this.\u0275fac=function(I){return new(I||x)}}static{this.\u0275prov=E.Yz7({token:x,factory:()=>(0,E.f3M)(Ds),providedIn:"root"})}}return x})(),Ds=(()=>{class x{shouldProcessUrl(b){return!0}extract(b){return b}merge(b,I){return b}static{this.\u0275fac=function(I){return new(I||x)}}static{this.\u0275prov=E.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"})}}return x})();const Gs=new E.OlP(""),ua=new E.OlP("");function Ho(x,D,b){const I=x.get(ua),k=x.get(Ye.K0);return x.get(E.R0b).runOutsideAngular(()=>{if(!k.startViewTransition||I.skipNextTransition)return I.skipNextTransition=!1,Promise.resolve();let $;const ae=new Promise(Ft=>{$=Ft}),we=k.startViewTransition(()=>($(),function Is(x){return new Promise(D=>{(0,E.T8G)(D,{injector:x})})}(x))),{onViewTransitionCreated:Ee}=I;return Ee&&(0,E.r_H)(x,()=>Ee({transition:we,from:D,to:b})),ae})}let Ki=(()=>{class x{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new yt.x,this.transitionAbortSubject=new yt.x,this.configLoader=(0,E.f3M)(Di),this.environmentInjector=(0,E.f3M)(E.lqb),this.urlSerializer=(0,E.f3M)(Yi),this.rootContexts=(0,E.f3M)(hs),this.location=(0,E.f3M)(Ye.Ye),this.inputBindingEnabled=null!==(0,E.f3M)(ro,{optional:!0}),this.titleStrategy=(0,E.f3M)(Ze),this.options=(0,E.f3M)(xi,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=(0,E.f3M)(Nr),this.createViewTransition=(0,E.f3M)(Gs,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,xe.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=k=>this.events.next(new kl(k)),this.configLoader.onLoadStartListener=k=>this.events.next(new ia(k))}complete(){this.transitions?.complete()}handleNavigationRequest(b){const I=++this.navigationId;this.transitions?.next({...this.transitions.value,...b,id:I})}setupNavigations(b,I,k){return this.transitions=new it.X({id:0,currentUrlTree:I,currentRawUrl:I,extractedUrl:this.urlHandlingStrategy.extract(I),urlAfterRedirects:this.urlHandlingStrategy.extract(I),rawUrl:I,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:qi,restoredState:null,currentSnapshot:k.snapshot,targetSnapshot:null,currentRouterState:k,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,wn.h)($=>0!==$.id),(0,mt.U)($=>({...$,extractedUrl:this.urlHandlingStrategy.extract($.rawUrl)})),(0,en.w)($=>{this.currentTransition=$;let ae=!1,we=!1;return(0,xe.of)($).pipe((0,zi.b)(Ee=>{this.currentNavigation={id:Ee.id,initialUrl:Ee.rawUrl,extractedUrl:Ee.extractedUrl,trigger:Ee.source,extras:Ee.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,en.w)(Ee=>{const Ft=!b.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!Ft&&"reload"!==(Ee.extras.onSameUrlNavigation??b.onSameUrlNavigation)){const kn="";return this.events.next(new er(Ee.id,this.urlSerializer.serialize(Ee.rawUrl),kn,0)),Ee.resolve(null),St.E}if(this.urlHandlingStrategy.shouldProcessUrl(Ee.rawUrl))return(0,xe.of)(Ee).pipe((0,en.w)(kn=>{const Si=this.transitions?.getValue();return this.events.next(new an(kn.id,this.urlSerializer.serialize(kn.extractedUrl),kn.source,kn.restoredState)),Si!==this.transitions?.getValue()?St.E:Promise.resolve(kn)}),function Aa(x,D,b,I,k,$){return(0,tn.z)(ae=>function jl(x,D,b,I,k,$,ae="emptyOnly"){return new kp(x,D,b,I,k,ae,$).recognize()}(x,D,b,I,ae.extractedUrl,k,$).pipe((0,mt.U)(({state:we,tree:Ee})=>({...ae,targetSnapshot:we,urlAfterRedirects:Ee}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,b.config,this.urlSerializer,this.paramsInheritanceStrategy),(0,zi.b)(kn=>{$.targetSnapshot=kn.targetSnapshot,$.urlAfterRedirects=kn.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:kn.urlAfterRedirects};const Si=new ur(kn.id,this.urlSerializer.serialize(kn.extractedUrl),this.urlSerializer.serialize(kn.urlAfterRedirects),kn.targetSnapshot);this.events.next(Si)}));if(Ft&&this.urlHandlingStrategy.shouldProcessUrl(Ee.currentRawUrl)){const{id:kn,extractedUrl:Si,source:gs,restoredState:Wi,extras:yl}=Ee,kt=new an(kn,this.urlSerializer.serialize(Si),gs,Wi);this.events.next(kt);const Vr=oa(0,this.rootComponentType).snapshot;return this.currentTransition=$={...Ee,targetSnapshot:Vr,urlAfterRedirects:Si,extras:{...yl,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=Si,(0,xe.of)($)}{const kn="";return this.events.next(new er(Ee.id,this.urlSerializer.serialize(Ee.extractedUrl),kn,1)),Ee.resolve(null),St.E}}),(0,zi.b)(Ee=>{const Ft=new Ys(Ee.id,this.urlSerializer.serialize(Ee.extractedUrl),this.urlSerializer.serialize(Ee.urlAfterRedirects),Ee.targetSnapshot);this.events.next(Ft)}),(0,mt.U)(Ee=>(this.currentTransition=$={...Ee,guards:Ac(Ee.targetSnapshot,Ee.currentSnapshot,this.rootContexts)},$)),function ja(x,D){return(0,tn.z)(b=>{const{targetSnapshot:I,currentSnapshot:k,guards:{canActivateChecks:$,canDeactivateChecks:ae}}=b;return 0===ae.length&&0===$.length?(0,xe.of)({...b,guardsResult:!0}):function tr(x,D,b,I){return(0,be.D)(x).pipe((0,tn.z)(k=>function la(x,D,b,I,k){const $=D&&D.routeConfig?D.routeConfig.canDeactivate:null;if(!$||0===$.length)return(0,xe.of)(!0);const ae=$.map(we=>{const Ee=Ga(D)??k,Ft=Vo(we,Ee);return qr(function pe(x){return x&&un(x.canDeactivate)}(Ft)?Ft.canDeactivate(x,D,b,I):(0,E.r_H)(Ee,()=>Ft(x,D,b,I))).pipe(Dr())});return(0,xe.of)(ae).pipe(Pr())}(k.component,k.route,b,D,I)),Dr(k=>!0!==k,!0))}(ae,I,k,x).pipe((0,tn.z)(we=>we&&function U(x){return"boolean"==typeof x}(we)?function xo(x,D,b,I){return(0,be.D)(D).pipe((0,Ir.b)(k=>(0,Ie.z)(function Gi(x,D){return null!==x&&D&&D(new Fo(x)),(0,xe.of)(!0)}(k.route.parent,I),function ss(x,D){return null!==x&&D&&D(new ra(x)),(0,xe.of)(!0)}(k.route,I),function Dc(x,D,b){const I=D[D.length-1],$=D.slice(0,D.length-1).reverse().map(ae=>function Nu(x){const D=x.routeConfig?x.routeConfig.canActivateChild:null;return D&&0!==D.length?{node:x,guards:D}:null}(ae)).filter(ae=>null!==ae).map(ae=>(0,ot.P)(()=>{const we=ae.guards.map(Ee=>{const Ft=Ga(ae.node)??b,$n=Vo(Ee,Ft);return qr(function Y(x){return x&&un(x.canActivateChild)}($n)?$n.canActivateChild(I,x):(0,E.r_H)(Ft,()=>$n(I,x))).pipe(Dr())});return(0,xe.of)(we).pipe(Pr())}));return(0,xe.of)($).pipe(Pr())}(x,k.path,b),function $a(x,D,b){const I=D.routeConfig?D.routeConfig.canActivate:null;if(!I||0===I.length)return(0,xe.of)(!0);const k=I.map($=>(0,ot.P)(()=>{const ae=Ga(D)??b,we=Vo($,ae);return qr(function P(x){return x&&un(x.canActivate)}(we)?we.canActivate(D,x):(0,E.r_H)(ae,()=>we(D,x))).pipe(Dr())}));return(0,xe.of)(k).pipe(Pr())}(x,k.route,b))),Dr(k=>!0!==k,!0))}(I,$,x,D):(0,xe.of)(we)),(0,mt.U)(we=>({...b,guardsResult:we})))})}(this.environmentInjector,Ee=>this.events.next(Ee)),(0,zi.b)(Ee=>{if($.guardsResult=Ee.guardsResult,ds(Ee.guardsResult))throw Ai(0,Ee.guardsResult);const Ft=new Fa(Ee.id,this.urlSerializer.serialize(Ee.extractedUrl),this.urlSerializer.serialize(Ee.urlAfterRedirects),Ee.targetSnapshot,!!Ee.guardsResult);this.events.next(Ft)}),(0,wn.h)(Ee=>!!Ee.guardsResult||(this.cancelNavigationTransition(Ee,"",3),!1)),Te(Ee=>{if(Ee.guards.canActivateChecks.length)return(0,xe.of)(Ee).pipe((0,zi.b)(Ft=>{const $n=new Vs(Ft.id,this.urlSerializer.serialize(Ft.extractedUrl),this.urlSerializer.serialize(Ft.urlAfterRedirects),Ft.targetSnapshot);this.events.next($n)}),(0,en.w)(Ft=>{let $n=!1;return(0,xe.of)(Ft).pipe(function C(x,D){return(0,tn.z)(b=>{const{targetSnapshot:I,guards:{canActivateChecks:k}}=b;if(!k.length)return(0,xe.of)(b);const $=new Set(k.map(Ee=>Ee.route)),ae=new Set;for(const Ee of $)if(!ae.has(Ee))for(const Ft of W(Ee))ae.add(Ft);let we=0;return(0,be.D)(ae).pipe((0,Ir.b)(Ee=>$.has(Ee)?function O(x,D,b,I){const k=x.routeConfig,$=x._resolve;return void 0!==k?.title&&!io(k)&&($[$i]=k.title),function z(x,D,b,I){const k=mr(x);if(0===k.length)return(0,xe.of)({});const $={};return(0,be.D)(k).pipe((0,tn.z)(ae=>function le(x,D,b,I){const k=Ga(D)??I,$=Vo(x,k);return qr($.resolve?$.resolve(D,b):(0,E.r_H)(k,()=>$(D,b)))}(x[ae],D,b,I).pipe(Dr(),(0,zi.b)(we=>{$[ae]=we}))),Ge(1),function _t(x){return(0,mt.U)(()=>x)}($),(0,De.K)(ae=>Tn(ae)?St.E:(0,rt._)(ae)))}($,x,D,I).pipe((0,mt.U)(ae=>(x._resolvedData=ae,x.data=Bo(x,x.parent,b).resolve,null)))}(Ee,I,x,D):(Ee.data=Bo(Ee,Ee.parent,x).resolve,(0,xe.of)(void 0))),(0,zi.b)(()=>we++),Ge(1),(0,tn.z)(Ee=>we===ae.size?(0,xe.of)(b):St.E))})}(this.paramsInheritanceStrategy,this.environmentInjector),(0,zi.b)({next:()=>$n=!0,complete:()=>{$n||this.cancelNavigationTransition(Ft,"",2)}}))}),(0,zi.b)(Ft=>{const $n=new Lo(Ft.id,this.urlSerializer.serialize(Ft.extractedUrl),this.urlSerializer.serialize(Ft.urlAfterRedirects),Ft.targetSnapshot);this.events.next($n)}))}),Te(Ee=>{const Ft=$n=>{const kn=[];$n.routeConfig?.loadComponent&&!$n.routeConfig._loadedComponent&&kn.push(this.configLoader.loadComponent($n.routeConfig).pipe((0,zi.b)(Si=>{$n.component=Si}),(0,mt.U)(()=>{})));for(const Si of $n.children)kn.push(...Ft(Si));return kn};return(0,ht.a)(Ft(Ee.targetSnapshot.root)).pipe(ir(null),(0,wt.q)(1))}),Te(()=>this.afterPreactivation()),(0,en.w)(()=>{const{currentSnapshot:Ee,targetSnapshot:Ft}=$,$n=this.createViewTransition?.(this.environmentInjector,Ee.root,Ft.root);return $n?(0,be.D)($n).pipe((0,mt.U)(()=>$)):(0,xe.of)($)}),(0,mt.U)(Ee=>{const Ft=function Au(x,D,b){const I=As(x,D._root,b?b._root:void 0);return new Uo(I,D)}(b.routeReuseStrategy,Ee.targetSnapshot,Ee.currentRouterState);return this.currentTransition=$={...Ee,targetRouterState:Ft},this.currentNavigation.targetRouterState=Ft,$}),(0,zi.b)(()=>{this.events.next(new Ba)}),((x,D,b,I)=>(0,mt.U)(k=>(new $r(D,k.targetRouterState,k.currentRouterState,b,I).activate(x),k)))(this.rootContexts,b.routeReuseStrategy,Ee=>this.events.next(Ee),this.inputBindingEnabled),(0,wt.q)(1),(0,zi.b)({next:Ee=>{ae=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Jn(Ee.id,this.urlSerializer.serialize(Ee.extractedUrl),this.urlSerializer.serialize(Ee.urlAfterRedirects))),this.titleStrategy?.updateTitle(Ee.targetRouterState.snapshot),Ee.resolve(!0)},complete:()=>{ae=!0}}),(0,ni.R)(this.transitionAbortSubject.pipe((0,zi.b)(Ee=>{throw Ee}))),(0,xn.x)(()=>{ae||we||this.cancelNavigationTransition($,"",1),this.currentNavigation?.id===$.id&&(this.currentNavigation=null)}),(0,De.K)(Ee=>{if(we=!0,Sc(Ee))this.events.next(new ti($.id,this.urlSerializer.serialize($.extractedUrl),Ee.message,Ee.cancellationCode)),function ki(x){return Sc(x)&&ds(x.url)}(Ee)?this.events.next(new vo(Ee.url)):$.resolve(!1);else{this.events.next(new Cs($.id,this.urlSerializer.serialize($.extractedUrl),Ee,$.targetSnapshot??void 0));try{$.resolve(b.errorHandler(Ee))}catch(Ft){$.reject(Ft)}}return St.E}))}))}cancelNavigationTransition(b,I,k){const $=new ti(b.id,this.urlSerializer.serialize(b.extractedUrl),I,k);this.events.next($),b.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static{this.\u0275fac=function(I){return new(I||x)}}static{this.\u0275prov=E.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"})}}return x})();function ee(x){return x!==qi}let Ka=(()=>{class x{static{this.\u0275fac=function(I){return new(I||x)}}static{this.\u0275prov=E.Yz7({token:x,factory:()=>(0,E.f3M)(Ks),providedIn:"root"})}}return x})();class $h{shouldDetach(D){return!1}store(D,b){}shouldAttach(D){return!1}retrieve(D){return null}shouldReuseRoute(D,b){return D.routeConfig===b.routeConfig}}let Ks=(()=>{class x extends $h{static{this.\u0275fac=(()=>{let b;return function(k){return(b||(b=E.n5z(x)))(k||x)}})()}static{this.\u0275prov=E.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"})}}return x})(),Ri=(()=>{class x{static{this.\u0275fac=function(I){return new(I||x)}}static{this.\u0275prov=E.Yz7({token:x,factory:()=>(0,E.f3M)(ao),providedIn:"root"})}}return x})(),ao=(()=>{class x extends Ri{constructor(){super(...arguments),this.location=(0,E.f3M)(Ye.Ye),this.urlSerializer=(0,E.f3M)(Yi),this.options=(0,E.f3M)(xi,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=(0,E.f3M)(Nr),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new gr,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=oa(0,null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(b){return this.location.subscribe(I=>{"popstate"===I.type&&b(I.url,I.state)})}handleRouterEvent(b,I){if(b instanceof an)this.stateMemento=this.createStateMemento();else if(b instanceof er)this.rawUrlTree=I.initialUrl;else if(b instanceof ur){if("eager"===this.urlUpdateStrategy&&!I.extras.skipLocationChange){const k=this.urlHandlingStrategy.merge(I.finalUrl,I.initialUrl);this.setBrowserUrl(k,I)}}else b instanceof Ba?(this.currentUrlTree=I.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(I.finalUrl,I.initialUrl),this.routerState=I.targetRouterState,"deferred"===this.urlUpdateStrategy&&(I.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,I))):b instanceof ti&&(3===b.code||2===b.code)?this.restoreHistory(I):b instanceof Cs?this.restoreHistory(I,!0):b instanceof Jn&&(this.lastSuccessfulId=b.id,this.currentPageId=this.browserPageId)}setBrowserUrl(b,I){const k=this.urlSerializer.serialize(b);if(this.location.isCurrentPathEqualTo(k)||I.extras.replaceUrl){const ae={...I.extras.state,...this.generateNgRouterState(I.id,this.browserPageId)};this.location.replaceState(k,"",ae)}else{const $={...I.extras.state,...this.generateNgRouterState(I.id,this.browserPageId+1)};this.location.go(k,"",$)}}restoreHistory(b,I=!1){if("computed"===this.canceledNavigationResolution){const $=this.currentPageId-this.browserPageId;0!==$?this.location.historyGo($):this.currentUrlTree===b.finalUrl&&0===$&&(this.resetState(b),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(I&&this.resetState(b),this.resetUrlToCurrentUrlTree())}resetState(b){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,b.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(b,I){return"computed"===this.canceledNavigationResolution?{navigationId:b,\u0275routerPageId:I}:{navigationId:b}}static{this.\u0275fac=(()=>{let b;return function(k){return(b||(b=E.n5z(x)))(k||x)}})()}static{this.\u0275prov=E.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"})}}return x})();var bo=function(x){return x[x.COMPLETE=0]="COMPLETE",x[x.FAILED=1]="FAILED",x[x.REDIRECTING=2]="REDIRECTING",x}(bo||{});function Xr(x,D){x.events.pipe((0,wn.h)(b=>b instanceof Jn||b instanceof ti||b instanceof Cs||b instanceof er),(0,mt.U)(b=>b instanceof Jn||b instanceof er?bo.COMPLETE:b instanceof ti&&(0===b.code||1===b.code)?bo.REDIRECTING:bo.FAILED),(0,wn.h)(b=>b!==bo.REDIRECTING),(0,wt.q)(1)).subscribe(()=>{D()})}function $l(x){throw x}const da={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},lo={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Zi=(()=>{class x{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=(0,E.f3M)(E.c2e),this.stateManager=(0,E.f3M)(Ri),this.options=(0,E.f3M)(xi,{optional:!0})||{},this.pendingTasks=(0,E.f3M)(E.I6F),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=(0,E.f3M)(Ki),this.urlSerializer=(0,E.f3M)(Yi),this.location=(0,E.f3M)(Ye.Ye),this.urlHandlingStrategy=(0,E.f3M)(Nr),this._events=new yt.x,this.errorHandler=this.options.errorHandler||$l,this.navigated=!1,this.routeReuseStrategy=(0,E.f3M)(Ka),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=(0,E.f3M)(vi,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!(0,E.f3M)(ro,{optional:!0}),this.eventsSubscription=new Ln.w0,this.isNgZoneEnabled=(0,E.f3M)(E.R0b)instanceof E.R0b&&E.R0b.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:b=>{this.console.warn(b)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const b=this.navigationTransitions.events.subscribe(I=>{try{const k=this.navigationTransitions.currentTransition,$=this.navigationTransitions.currentNavigation;if(null!==k&&null!==$)if(this.stateManager.handleRouterEvent(I,$),I instanceof ti&&0!==I.code&&1!==I.code)this.navigated=!0;else if(I instanceof Jn)this.navigated=!0;else if(I instanceof vo){const ae=this.urlHandlingStrategy.merge(I.url,k.currentRawUrl),we={skipLocationChange:k.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||ee(k.source)};this.scheduleNavigation(ae,qi,null,we,{resolve:k.resolve,reject:k.reject,promise:k.promise})}(function gl(x){return!(x instanceof Ba||x instanceof vo)})(I)&&this._events.next(I)}catch(k){this.navigationTransitions.transitionAbortSubject.next(k)}});this.eventsSubscription.add(b)}resetRootComponentType(b){this.routerState.root.component=b,this.navigationTransitions.rootComponentType=b}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),qi,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription||(this.nonRouterCurrentEntryChangeSubscription=this.stateManager.registerNonRouterCurrentEntryChangeListener((b,I)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(b,"popstate",I)},0)}))}navigateToSyncWithBrowser(b,I,k){const $={replaceUrl:!0},ae=k?.navigationId?k:null;if(k){const Ee={...k};delete Ee.navigationId,delete Ee.\u0275routerPageId,0!==Object.keys(Ee).length&&($.state=Ee)}const we=this.parseUrl(b);this.scheduleNavigation(we,I,ae,$)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(b){this.config=b.map(Mo),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(b,I={}){const{relativeTo:k,queryParams:$,fragment:ae,queryParamsHandling:we,preserveFragment:Ee}=I,Ft=Ee?this.currentUrlTree.fragment:ae;let kn,$n=null;switch(we){case"merge":$n={...this.currentUrlTree.queryParams,...$};break;case"preserve":$n=this.currentUrlTree.queryParams;break;default:$n=$||null}null!==$n&&($n=this.removeEmptyProps($n));try{kn=gi(k?k.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof b[0]||!b[0].startsWith("/"))&&(b=[]),kn=this.currentUrlTree.root}return wa(kn,b,$n,Ft??null)}navigateByUrl(b,I={skipLocationChange:!1}){const k=ds(b)?b:this.parseUrl(b),$=this.urlHandlingStrategy.merge(k,this.rawUrlTree);return this.scheduleNavigation($,qi,null,I)}navigate(b,I={skipLocationChange:!1}){return function ml(x){for(let D=0;D<x.length;D++)if(null==x[D])throw new E.vHH(4008,!1)}(b),this.navigateByUrl(this.createUrlTree(b,I),I)}serializeUrl(b){return this.urlSerializer.serialize(b)}parseUrl(b){try{return this.urlSerializer.parse(b)}catch{return this.urlSerializer.parse("/")}}isActive(b,I){let k;if(k=!0===I?{...da}:!1===I?{...lo}:I,ds(b))return nn(this.currentUrlTree,b,k);const $=this.parseUrl(b);return nn(this.currentUrlTree,$,k)}removeEmptyProps(b){return Object.keys(b).reduce((I,k)=>{const $=b[k];return null!=$&&(I[k]=$),I},{})}scheduleNavigation(b,I,k,$,ae){if(this.disposed)return Promise.resolve(!1);let we,Ee,Ft;ae?(we=ae.resolve,Ee=ae.reject,Ft=ae.promise):Ft=new Promise((kn,Si)=>{we=kn,Ee=Si});const $n=this.pendingTasks.add();return Xr(this,()=>{queueMicrotask(()=>this.pendingTasks.remove($n))}),this.navigationTransitions.handleNavigationRequest({source:I,restoredState:k,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:b,extras:$,resolve:we,reject:Ee,promise:Ft,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Ft.catch(kn=>Promise.reject(kn))}static{this.\u0275fac=function(I){return new(I||x)}}static{this.\u0275prov=E.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"})}}return x})();class Fu{}let Nc=(()=>{class x{constructor(b,I,k,$,ae){this.router=b,this.injector=k,this.preloadingStrategy=$,this.loader=ae}setUpPreloading(){this.subscription=this.router.events.pipe((0,wn.h)(b=>b instanceof Jn),(0,Ir.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(b,I){const k=[];for(const $ of I){$.providers&&!$._injector&&($._injector=(0,E.MMx)($.providers,b,`Route: ${$.path}`));const ae=$._injector??b,we=$._loadedInjector??ae;($.loadChildren&&!$._loadedRoutes&&void 0===$.canLoad||$.loadComponent&&!$._loadedComponent)&&k.push(this.preloadConfig(ae,$)),($.children||$._loadedRoutes)&&k.push(this.processRoutes(we,$.children??$._loadedRoutes))}return(0,be.D)(k).pipe((0,cr.J)())}preloadConfig(b,I){return this.preloadingStrategy.preload(I,()=>{let k;k=I.loadChildren&&void 0===I.canLoad?this.loader.loadChildren(b,I):(0,xe.of)(null);const $=k.pipe((0,tn.z)(ae=>null===ae?(0,xe.of)(void 0):(I._loadedRoutes=ae.routes,I._loadedInjector=ae.injector,this.processRoutes(ae.injector??b,ae.routes))));if(I.loadComponent&&!I._loadedComponent){const ae=this.loader.loadComponent(I);return(0,be.D)([$,ae]).pipe((0,cr.J)())}return $})}static{this.\u0275fac=function(I){return new(I||x)(E.LFG(Zi),E.LFG(E.Sil),E.LFG(E.lqb),E.LFG(Fu),E.LFG(Di))}}static{this.\u0275prov=E.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"})}}return x})();const Br=new E.OlP("");let uo=(()=>{class x{constructor(b,I,k,$,ae={}){this.urlSerializer=b,this.transitions=I,this.viewportScroller=k,this.zone=$,this.options=ae,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},ae.scrollPositionRestoration=ae.scrollPositionRestoration||"disabled",ae.anchorScrolling=ae.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(b=>{b instanceof an?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=b.navigationTrigger,this.restoredId=b.restoredState?b.restoredState.navigationId:0):b instanceof Jn?(this.lastId=b.id,this.scheduleScrollEvent(b,this.urlSerializer.parse(b.urlAfterRedirects).fragment)):b instanceof er&&0===b.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(b,this.urlSerializer.parse(b.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(b=>{b instanceof ka&&(b.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(b.position):b.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(b.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(b,I){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new ka(b,"popstate"===this.lastSource?this.store[this.restoredId]:null,I))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(I){E.$Z()}}static{this.\u0275prov=E.Yz7({token:x,factory:x.\u0275fac})}}return x})();function ps(x,D){return{\u0275kind:x,\u0275providers:D}}function In(){const x=(0,E.f3M)(E.zs3);return D=>{const b=x.get(E.z2F);if(D!==b.components[0])return;const I=x.get(Zi),k=x.get(So);1===x.get(ho)&&I.initialNavigation(),x.get(Lc,null,E.XFs.Optional)?.setUpPreloading(),x.get(Br,null,E.XFs.Optional)?.init(),I.resetRootComponentType(b.componentTypes[0]),k.closed||(k.next(),k.complete(),k.unsubscribe())}}const So=new E.OlP("",{factory:()=>new yt.x}),ho=new E.OlP("",{providedIn:"root",factory:()=>1}),Lc=new E.OlP("");function He(x){return ps(0,[{provide:Lc,useExisting:Nc},{provide:Fu,useExisting:x}])}function Kh(x){return ps(9,[{provide:Gs,useValue:Ho},{provide:ua,useValue:{skipNextTransition:!!x?.skipInitialTransition,...x}}])}const Fs=new E.OlP("ROUTER_FORROOT_GUARD"),zo=[Ye.Ye,{provide:Yi,useClass:sn},Zi,hs,{provide:Hs,useFactory:function On(x){return x.routerState.root},deps:[Zi]},Di,[]];let Yl=(()=>{class x{constructor(b){}static forRoot(b,I){return{ngModule:x,providers:[zo,[],{provide:vi,multi:!0,useValue:b},{provide:Fs,useFactory:Us,deps:[[Zi,new E.FiY,new E.tp0]]},{provide:xi,useValue:I||{}},I?.useHash?{provide:Ye.S$,useClass:Ye.Do}:{provide:Ye.S$,useClass:Ye.b0},{provide:Br,useFactory:()=>{const x=(0,E.f3M)(Ye.EM),D=(0,E.f3M)(E.R0b),b=(0,E.f3M)(xi),I=(0,E.f3M)(Ki),k=(0,E.f3M)(Yi);return b.scrollOffset&&x.setOffset(b.scrollOffset),new uo(k,I,x,D,b)}},I?.preloadingStrategy?He(I.preloadingStrategy).\u0275providers:[],I?.initialNavigation?ha(I):[],I?.bindToComponentInputs?ps(8,[dl,{provide:ro,useExisting:dl}]).\u0275providers:[],I?.enableViewTransitions?Kh().\u0275providers:[],[{provide:ku,useFactory:In},{provide:E.tb,multi:!0,useExisting:ku}]]}}static forChild(b){return{ngModule:x,providers:[{provide:vi,multi:!0,useValue:b}]}}static{this.\u0275fac=function(I){return new(I||x)(E.LFG(Fs,8))}}static{this.\u0275mod=E.oAB({type:x})}static{this.\u0275inj=E.cJS({})}}return x})();function Us(x){return"guarded"}function ha(x){return["disabled"===x.initialNavigation?ps(3,[{provide:E.ip1,multi:!0,useFactory:()=>{const D=(0,E.f3M)(Zi);return()=>{D.setUpLocationChangeListener()}}},{provide:ho,useValue:2}]).\u0275providers:[],"enabledBlocking"===x.initialNavigation?ps(2,[{provide:ho,useValue:0},{provide:E.ip1,multi:!0,deps:[E.zs3],useFactory:D=>{const b=D.get(Ye.V_,Promise.resolve());return()=>b.then(()=>new Promise(I=>{const k=D.get(Zi),$=D.get(So);Xr(k,()=>{I(!0)}),D.get(Ki).afterPreactivation=()=>(I(!0),$.closed?(0,xe.of)(void 0):$),k.initialNavigation()}))}}]).\u0275providers:[]]}const ku=new E.OlP("")},5861:(mn,Ke,Z)=>{function E(ze,Pe,be,xe,it,ht,pt){try{var et=ze[ht](pt),Ie=et.value}catch(ot){return void be(ot)}et.done?Pe(Ie):Promise.resolve(Ie).then(xe,it)}function ie(ze){return function(){var Pe=this,be=arguments;return new Promise(function(xe,it){var ht=ze.apply(Pe,be);function pt(Ie){E(ht,xe,it,pt,et,"next",Ie)}function et(Ie){E(ht,xe,it,pt,et,"throw",Ie)}pt(void 0)})}}Z.d(Ke,{Z:()=>ie})},7582:(mn,Ke,Z)=>{function ot(De,Ne,$e,Ge){return new($e||($e=Promise))(function(_t,xn){function ni(zt){try{En(Ge.next(zt))}catch($i){xn($i)}}function cr(zt){try{En(Ge.throw(zt))}catch($i){xn($i)}}function En(zt){zt.done?_t(zt.value):function gt(_t){return _t instanceof $e?_t:new $e(function(xn){xn(_t)})}(zt.value).then(ni,cr)}En((Ge=Ge.apply(De,Ne||[])).next())})}function yt(De){return this instanceof yt?(this.v=De,this):new yt(De)}function Ye(De,Ne,$e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var gt,Ge=$e.apply(De,Ne||[]),_t=[];return gt={},xn("next"),xn("throw"),xn("return"),gt[Symbol.asyncIterator]=function(){return this},gt;function xn(Zn){Ge[Zn]&&(gt[Zn]=function(yi){return new Promise(function(Hr,Qi){_t.push([Zn,yi,Hr,Qi])>1||ni(Zn,yi)})})}function ni(Zn,yi){try{!function cr(Zn){Zn.value instanceof yt?Promise.resolve(Zn.value.v).then(En,zt):$i(_t[0][2],Zn)}(Ge[Zn](yi))}catch(Hr){$i(_t[0][3],Hr)}}function En(Zn){ni("next",Zn)}function zt(Zn){ni("throw",Zn)}function $i(Zn,yi){Zn(yi),_t.shift(),_t.length&&ni(_t[0][0],_t[0][1])}}function en(De){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var $e,Ne=De[Symbol.asyncIterator];return Ne?Ne.call(De):(De=function Ln(De){var Ne="function"==typeof Symbol&&Symbol.iterator,$e=Ne&&De[Ne],Ge=0;if($e)return $e.call(De);if(De&&"number"==typeof De.length)return{next:function(){return De&&Ge>=De.length&&(De=void 0),{value:De&&De[Ge++],done:!De}}};throw new TypeError(Ne?"Object is not iterable.":"Symbol.iterator is not defined.")}(De),$e={},Ge("next"),Ge("throw"),Ge("return"),$e[Symbol.asyncIterator]=function(){return this},$e);function Ge(_t){$e[_t]=De[_t]&&function(xn){return new Promise(function(ni,cr){!function gt(_t,xn,ni,cr){Promise.resolve(cr).then(function(En){_t({value:En,done:ni})},xn)}(ni,cr,(xn=De[_t](xn)).done,xn.value)})}}}Z.d(Ke,{FC:()=>Ye,KL:()=>en,mG:()=>ot,qq:()=>yt}),"function"==typeof SuppressedError&&SuppressedError}},mn=>{mn(mn.s=2411)}]);