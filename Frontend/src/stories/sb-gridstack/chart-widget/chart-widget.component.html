<!-- Widget Header -->
<div class="widget-header">
    <h3>{{ widget.title || 'Chart Widget ' + widget.id }}</h3>
    <div class="widget-controls">
        <button (click)="refreshWidget(widget.id)" class="refresh-btn" title="Refresh Widget">
            <i class="fas fa-sync-alt"></i>
        </button>
    </div>
</div>

<div class="widget-content">
    <!-- Loading indicator -->
    <div *ngIf="widget.state?.loading" class="loading-spinner">
        <div class="spinner-border" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>

    <!-- Error message -->
    <div *ngIf="widget.state?.error" class="error-message">
        <i class="fas fa-exclamation-triangle"></i>
        {{ widget.state?.error }}
    </div>

    <!-- Chart Image Display -->
    <div *ngIf="!widget.state?.loading && !widget.state?.error" class="chart-display-area">
        <ng-container *ngIf="chartImageUrl; else noChartData">
            <img [src]="chartImageUrl" alt="{{ widget.title || 'Chart' }}" class="chart-image" />
        </ng-container>
        <ng-template #noChartData>
            <p>No chart data to display.</p>
        </ng-template>
    </div>
</div>

<!-- Widget Footer -->
<div class="widget-footer" *ngIf="widget?.state?.lastUpdated">
    <i class="fas fa-clock"></i> Last updated: {{ widget?.state?.lastUpdated | date:'medium' }}
</div>
