<!-- Widget Header -->
<div class="widget-header">
    <h3>{{ widget.title || 'Widget ' + widget.id }}</h3>
    <div class="widget-controls">
        <button (click)="refreshWidget(widget.id)" class="refresh-btn" title="Refresh Widget">
            <i class="fas fa-sync-alt"></i>
        </button>
    </div>
</div>

<!-- Widget Content based on type -->
<div class="widget-content" [ngSwitch]="widget.type">
    <!-- Loading indicator -->
    <div *ngIf="widgetManager.getWidgetState(widget.id)?.loading" class="loading-spinner">
        <div class="spinner-border" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>

    <!-- Error message -->
    <div *ngIf="widgetManager.getWidgetState(widget.id)?.error" class="error-message">
        <i class="fas fa-exclamation-triangle"></i>
        {{ widgetManager.getWidgetState(widget.id)?.error }}
    </div>

    <!-- Table widget -->
    <div *ngSwitchCase="'table'" class="table-widget">
        <widget-table [tableObj]="widgetManager.getWidgetState(widget.id)?.data">
        </widget-table>
    </div>

    <!-- Chart widgets -->
    <div *ngSwitchCase="'pie-chart'" class="chart-widget">
        <widget-pie-chart> </widget-pie-chart>
    </div>

    <div *ngSwitchCase="'doughnut'" class="chart-widget">
        <widget-pie-doughnut [attId]="'chart-' + widget.id"> </widget-pie-doughnut>
    </div>

    <!-- Default content -->
    <div *ngSwitchDefault class="default-widget">
        <pre>{{ widgetManager.getWidgetState(widget.id)?.data | json }}</pre>
    </div>
</div>

<!-- Widget Footer -->
<div class="widget-footer" *ngIf="widgetManager.getLastUpdateTime(widget.id)">
    <i class="fas fa-clock"></i> Last updated: {{ widgetManager.getLastUpdateTime(widget.id) | date:'medium' }}
</div>
